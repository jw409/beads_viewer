<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>beads_viewer | bv Graph</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #0f0f1a;
            --bg-secondary: #1a1a2e;
            --bg-tertiary: #16213e;
            --bg-elevated: #252545;
            --bg-glass: rgba(26, 26, 46, 0.85);
            --fg: #e8e8f0;
            --fg-muted: #8888aa;
            --fg-dim: #555577;
            --purple: #a855f7;
            --purple-glow: rgba(168, 85, 247, 0.4);
            --pink: #ec4899;
            --cyan: #22d3ee;
            --green: #22c55e;
            --orange: #f97316;
            --red: #ef4444;
            --yellow: #eab308;
            --gold: #fbbf24;
            --gold-glow: rgba(251, 191, 36, 0.6);
            --shadow: 0 8px 32px rgba(0,0,0,0.4);
            --shadow-glow: 0 0 40px var(--purple-glow);
            --radius: 12px;
            --radius-lg: 16px;
        }
        /* Light mode overrides */
        body.light-mode {
            --bg: #f8f9fc;
            --bg-secondary: #ffffff;
            --bg-tertiary: #f0f2f5;
            --bg-elevated: #e8eaf0;
            --bg-glass: rgba(255, 255, 255, 0.9);
            --fg: #1a1a2e;
            --fg-muted: #555577;
            --fg-dim: #8888aa;
            --shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        body.light-mode #graph-container {
            background: radial-gradient(ellipse at center, #ffffff 0%, #f0f2f5 100%);
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg);
            color: var(--fg);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            font-size: 14px;
            line-height: 1.5;
        }

        /* Header */
        header {
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary));
            padding: 0.75rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--purple);
            z-index: 100;
            box-shadow: var(--shadow);
            backdrop-filter: blur(10px);
        }
        .logo { display: flex; align-items: center; gap: 0.75rem; }
        .logo-icon {
            width: 40px; height: 40px;
            background: linear-gradient(135deg, var(--purple), var(--pink));
            border-radius: var(--radius);
            display: flex; align-items: center; justify-content: center;
            font-family: 'JetBrains Mono', monospace;
            font-weight: 700; font-size: 16px;
            box-shadow: var(--shadow-glow);
        }
        h1 { font-size: 1.25rem; font-weight: 600; letter-spacing: -0.02em; }
        h1 span {
            background: linear-gradient(90deg, var(--purple), var(--pink), var(--cyan));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            background-size: 200% auto;
            animation: shimmer 3s linear infinite;
        }
        @keyframes shimmer { 0% { background-position: 0% center; } 100% { background-position: 200% center; } }

        /* Toolbar */
        .toolbar { display: flex; gap: 0.75rem; align-items: center; flex-wrap: wrap; }
        .toolbar-group {
            display: flex; gap: 0.25rem;
            padding: 0.25rem;
            background: var(--bg);
            border-radius: var(--radius);
            border: 1px solid var(--bg-elevated);
        }
        button, select {
            font-family: inherit;
            font-size: 0.8rem;
            padding: 0.5rem 0.875rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
        }
        button { background: transparent; color: var(--fg-muted); }
        button:hover { background: var(--bg-elevated); color: var(--fg); transform: translateY(-1px); }
        button.active {
            background: linear-gradient(135deg, var(--purple), var(--pink));
            color: white;
            box-shadow: 0 4px 15px var(--purple-glow);
        }
        select {
            background: var(--bg);
            color: var(--fg);
            border: 1px solid var(--bg-elevated);
            padding-right: 2rem;
        }
        select:focus { outline: none; border-color: var(--purple); box-shadow: 0 0 0 3px var(--purple-glow); }

        /* Search */
        .search-container { position: relative; }
        .search-input {
            font-family: inherit;
            font-size: 0.875rem;
            padding: 0.5rem 1rem 0.5rem 2.5rem;
            background: var(--bg);
            color: var(--fg);
            border: 1px solid var(--bg-elevated);
            border-radius: var(--radius);
            width: 280px;
            transition: all 0.2s ease;
        }
        .search-input:focus {
            outline: none;
            border-color: var(--purple);
            box-shadow: 0 0 0 3px var(--purple-glow);
            width: 320px;
        }
        .search-icon {
            position: absolute; left: 0.875rem; top: 50%; transform: translateY(-50%);
            color: var(--fg-muted); font-size: 0.875rem;
        }

        /* Search Results Dropdown */
        .search-results {
            position: absolute; top: 100%; left: 0; right: 0;
            background: var(--bg-glass); backdrop-filter: blur(20px);
            border: 1px solid var(--purple); border-radius: var(--radius);
            margin-top: 0.5rem; max-height: 400px; overflow-y: auto;
            z-index: 1000; display: none; box-shadow: var(--shadow);
        }
        .search-results.visible { display: block; }
        .search-result-item {
            padding: 0.875rem 1rem; cursor: pointer;
            border-bottom: 1px solid var(--bg-elevated);
            transition: all 0.15s ease;
        }
        .search-result-item:hover { background: var(--bg-elevated); }
        .search-result-item:last-child { border-bottom: none; }
        .search-result-id { font-family: 'JetBrains Mono', monospace; color: var(--cyan); font-size: 0.8rem; font-weight: 600; }
        .search-result-title { font-size: 0.875rem; margin-top: 0.25rem; }
        .search-result-preview {
            font-size: 0.75rem; color: var(--fg-muted); margin-top: 0.5rem;
            max-height: 60px; overflow: hidden;
        }
        .search-result-preview p { margin: 0.25rem 0; }

        /* Main */
        main { flex: 1; display: flex; overflow: hidden; position: relative; }

        /* Detail Sidebar (Left - Docked Mode) */
        #detail-sidebar {
            width: 420px;
            background: linear-gradient(180deg, var(--bg-secondary) 0%, var(--bg) 100%);
            border-right: 1px solid var(--purple);
            overflow-y: auto; padding: 0;
            display: flex; flex-direction: column;
            transition: width 0.3s ease, opacity 0.3s ease;
        }
        #detail-sidebar.collapsed { width: 0; padding: 0; overflow: hidden; opacity: 0; }
        #detail-sidebar .panel-header {
            display: flex; justify-content: space-between; align-items: center;
            padding: 1rem 1.25rem; background: var(--bg-tertiary);
            border-bottom: 1px solid var(--bg-elevated);
            position: sticky; top: 0; z-index: 5;
        }
        #detail-sidebar .panel-header h3 {
            font-size: 0.9rem; font-weight: 600; color: var(--fg);
            display: flex; align-items: center; gap: 0.5rem;
        }
        #detail-sidebar .panel-header .icon { color: var(--gold); }
        .detach-btn {
            background: var(--bg-elevated); border: 1px solid var(--fg-dim);
            color: var(--fg-muted); padding: 0.375rem 0.75rem; border-radius: 6px;
            cursor: pointer; font-size: 0.75rem; transition: all 0.15s ease;
            display: flex; align-items: center; gap: 0.375rem;
        }
        .detach-btn:hover { background: var(--purple); color: white; border-color: var(--purple); }
        #detail-sidebar .no-selection {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            height: 300px; color: var(--fg-muted); text-align: center; padding: 2rem;
        }
        #detail-sidebar .no-selection-icon { font-size: 3rem; margin-bottom: 1rem; opacity: 0.5; }
        #detail-sidebar .no-selection-text { font-size: 0.875rem; }
        #detail-sidebar .detail-content { padding: 1.25rem; flex: 1; }

        #graph-wrapper { flex: 1; position: relative; }
        #graph-container {
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: radial-gradient(ellipse at center, var(--bg-secondary) 0%, var(--bg) 100%);
        }

        /* Overlay Stats */
        .overlay-stats {
            position: absolute; top: 1rem; left: 1rem;
            background: var(--bg-glass); backdrop-filter: blur(15px);
            padding: 0.75rem 1rem; border-radius: var(--radius);
            font-size: 0.8rem; color: var(--fg-muted);
            z-index: 10; display: flex; gap: 1.25rem;
            border: 1px solid var(--bg-elevated);
            box-shadow: var(--shadow);
        }
        .overlay-stats .stat { display: flex; align-items: center; gap: 0.375rem; }
        .overlay-stats .stat-value { color: var(--cyan); font-weight: 600; font-family: 'JetBrains Mono', monospace; }

        /* Hover Panel - Full Details (Floating Mode) */
        #hover-panel {
            position: absolute; top: 1rem; left: 50%; transform: translateX(-50%);
            background: var(--bg-glass); backdrop-filter: blur(20px);
            border: 1px solid var(--gold); border-radius: var(--radius-lg);
            padding: 1.25rem; width: 500px; max-height: 70vh;
            overflow-y: auto; z-index: 50;
            box-shadow: 0 8px 32px rgba(0,0,0,0.5), 0 0 60px var(--gold-glow);
            display: none;
        }
        #hover-panel.visible { display: block; animation: panelIn 0.2s ease-out; }
        #hover-panel.docked { display: none !important; } /* Hidden when docked mode active */
        @keyframes panelIn { from { opacity: 0; transform: translateX(-50%) translateY(-10px); } }

        /* Docked Panel Content - inside detail-sidebar */
        #docked-panel {
            display: none;
        }
        #docked-panel.visible { display: block; }
        .hover-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem; }
        .hover-id { font-family: 'JetBrains Mono', monospace; font-size: 1rem; color: var(--cyan); font-weight: 600; }
        .hover-type-badge {
            padding: 0.25rem 0.625rem; border-radius: 6px;
            font-size: 0.7rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em;
        }
        .hover-title { font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; line-height: 1.4; }
        .hover-badges { display: flex; flex-wrap: wrap; gap: 0.375rem; margin-bottom: 1rem; }
        .hover-section { margin-bottom: 1rem; }
        .hover-section-title {
            font-size: 0.7rem; font-weight: 600; color: var(--purple);
            text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 0.5rem;
            padding-bottom: 0.25rem; border-bottom: 1px solid var(--bg-elevated);
        }
        .hover-content { font-size: 0.875rem; color: var(--fg); line-height: 1.6; }
        .hover-content p { margin-bottom: 0.5rem; }
        .hover-content ul, .hover-content ol { margin-left: 1.25rem; margin-bottom: 0.5rem; }
        .hover-content code {
            background: var(--bg); padding: 0.125rem 0.375rem; border-radius: 4px;
            font-family: 'JetBrains Mono', monospace; font-size: 0.8rem;
        }
        .hover-content pre {
            background: var(--bg); padding: 0.75rem; border-radius: 8px;
            overflow-x: auto; margin: 0.5rem 0;
        }
        .hover-content pre code { padding: 0; background: none; }
        .hover-meta { display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.5rem; font-size: 0.8rem; }
        .hover-meta-item { display: flex; flex-direction: column; }
        .hover-meta-label { color: var(--fg-muted); font-size: 0.7rem; }
        .hover-meta-value { font-weight: 500; }
        .hover-deps { display: flex; flex-wrap: wrap; gap: 0.375rem; }
        .hover-dep-chip {
            padding: 0.25rem 0.5rem; background: var(--bg);
            border-radius: 6px; font-size: 0.75rem; font-family: 'JetBrains Mono', monospace;
            cursor: pointer; transition: all 0.15s ease;
        }
        .hover-dep-chip:hover { background: var(--purple); color: white; }
        .hover-commits { max-height: 150px; overflow-y: auto; }
        .hover-commit {
            padding: 0.5rem; background: var(--bg); border-radius: 6px;
            margin-bottom: 0.375rem; font-size: 0.75rem;
        }
        .hover-commit-sha { font-family: 'JetBrains Mono', monospace; color: var(--cyan); }
        .hover-commit-msg { margin-top: 0.25rem; color: var(--fg-muted); }
        .hover-close {
            position: absolute; top: 0.75rem; right: 0.75rem;
            background: none; border: none; color: var(--fg-muted);
            cursor: pointer; font-size: 1.25rem; padding: 0.25rem;
        }
        .hover-close:hover { color: var(--fg); }

        /* Sidebar */
        #sidebar {
            width: 340px;
            background: linear-gradient(180deg, var(--bg-secondary) 0%, var(--bg) 100%);
            border-left: 1px solid var(--purple);
            overflow-y: auto; padding: 1.25rem;
            display: flex; flex-direction: column; gap: 1rem;
        }
        .stats-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.625rem; }
        .stat-card {
            background: var(--bg-tertiary); padding: 0.875rem;
            border-radius: var(--radius); text-align: center;
            border: 1px solid var(--bg-elevated);
            transition: all 0.2s ease;
        }
        .stat-card:hover { border-color: var(--purple); transform: translateY(-2px); box-shadow: var(--shadow); }
        .stat-card .stat-value {
            font-size: 1.75rem; font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
            background: linear-gradient(135deg, var(--green), var(--cyan));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .stat-card .stat-value.warning {
            background: linear-gradient(135deg, var(--orange), var(--red));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .stat-card .stat-label {
            font-size: 0.7rem; color: var(--fg-muted);
            text-transform: uppercase; letter-spacing: 0.05em; margin-top: 0.25rem;
        }

        /* Panels */
        .panel {
            background: var(--bg-tertiary); border-radius: var(--radius);
            padding: 1rem; border: 1px solid var(--bg-elevated);
        }
        .panel-title {
            font-size: 0.75rem; font-weight: 600; color: var(--purple);
            text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 0.75rem;
            display: flex; align-items: center; gap: 0.5rem;
        }
        .panel-title::before {
            content: ''; width: 4px; height: 14px;
            background: linear-gradient(180deg, var(--purple), var(--pink));
            border-radius: 2px;
        }

        /* Legend */
        .legend { display: flex; flex-wrap: wrap; gap: 0.5rem; }
        .legend-item {
            display: flex; align-items: center; gap: 0.375rem;
            font-size: 0.75rem; color: var(--fg-muted);
            padding: 0.25rem 0.5rem; background: var(--bg); border-radius: 6px;
        }
        .legend-dot {
            width: 12px; height: 12px; border-radius: 50%;
            box-shadow: 0 0 8px currentColor;
        }

        /* Triage Panel */
        .triage-item {
            padding: 0.75rem; background: var(--bg); border-radius: 8px;
            margin-bottom: 0.5rem; cursor: pointer; transition: all 0.15s ease;
            border-left: 3px solid var(--purple);
        }
        .triage-item:hover { transform: translateX(4px); border-left-color: var(--gold); }
        .triage-item-header { display: flex; justify-content: space-between; align-items: center; }
        .triage-item-id { font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; color: var(--cyan); font-weight: 600; }
        .triage-item-score { font-size: 0.7rem; color: var(--gold); font-weight: 600; }
        .triage-item-title { font-size: 0.8rem; margin-top: 0.25rem; }
        .triage-item-reason { font-size: 0.7rem; color: var(--fg-muted); margin-top: 0.375rem; }

        /* Badges */
        .badge {
            font-size: 0.65rem; padding: 0.2rem 0.5rem; border-radius: 4px;
            text-transform: uppercase; font-weight: 600; letter-spacing: 0.03em;
        }
        .badge-open { background: var(--green); color: var(--bg); }
        .badge-in_progress { background: var(--orange); color: var(--bg); }
        .badge-blocked { background: var(--red); color: white; }
        .badge-closed { background: var(--fg-dim); color: var(--bg); }
        .badge-type { background: var(--purple); color: white; }
        .badge-feature { background: linear-gradient(135deg, var(--purple), var(--pink)); color: white; }
        .badge-bug { background: var(--red); color: white; }
        .badge-task { background: var(--cyan); color: var(--bg); }
        .badge-epic { background: linear-gradient(135deg, var(--gold), var(--orange)); color: var(--bg); }
        .badge-articulation { background: linear-gradient(135deg, var(--pink), var(--purple)); color: white; animation: pulse 2s infinite; }
        .badge-critical { background: linear-gradient(135deg, var(--red), var(--orange)); color: white; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }

        /* Node Detail */
        #node-detail { display: none; }
        #node-detail.visible { display: block; }
        .detail-header { display: flex; align-items: flex-start; justify-content: space-between; margin-bottom: 0.75rem; }
        .detail-id { font-size: 1rem; font-weight: 700; color: var(--cyan); font-family: 'JetBrains Mono', monospace; }
        .detail-priority {
            padding: 0.25rem 0.625rem; border-radius: 6px;
            font-size: 0.7rem; font-weight: 700; text-transform: uppercase;
        }
        .detail-name { font-size: 0.875rem; color: var(--fg); line-height: 1.5; margin-bottom: 0.625rem; }
        .detail-badges { display: flex; gap: 0.375rem; flex-wrap: wrap; margin-bottom: 0.75rem; }
        .detail-metrics { display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.375rem; font-size: 0.75rem; }
        .metric-item {
            display: flex; justify-content: space-between;
            padding: 0.375rem 0; border-bottom: 1px solid var(--bg-elevated);
        }
        .metric-label { color: var(--fg-muted); }
        .metric-value { color: var(--fg); font-weight: 500; font-family: 'JetBrains Mono', monospace; }
        .metric-value.highlight { color: var(--green); }
        .no-selection { text-align: center; padding: 2rem 1rem; color: var(--fg-muted); font-size: 0.8rem; }
        .no-selection-icon { font-size: 2rem; margin-bottom: 0.625rem; opacity: 0.4; }

        /* Shortcuts */
        .keyboard-hints { font-size: 0.75rem; color: var(--fg-muted); line-height: 1.8; }
        .keyboard-hints kbd {
            display: inline-block; background: var(--bg);
            padding: 0.2rem 0.5rem; border-radius: 4px;
            margin: 0 0.125rem; border: 1px solid var(--bg-elevated);
            font-family: 'JetBrains Mono', monospace; font-size: 0.7rem;
        }

        /* Footer */
        footer {
            background: var(--bg-tertiary); padding: 0.5rem 1.25rem;
            font-size: 0.75rem; color: var(--fg-muted);
            display: flex; justify-content: space-between; align-items: center;
            border-top: 1px solid var(--bg-elevated);
        }
        footer a { color: var(--cyan); text-decoration: none; transition: color 0.15s; }
        footer a:hover { color: var(--purple); }

        /* Toast */
        .toast {
            position: fixed; bottom: 100px; left: 50%; transform: translateX(-50%);
            background: var(--bg-glass); backdrop-filter: blur(15px);
            border: 1px solid var(--purple); padding: 0.75rem 1.5rem;
            border-radius: var(--radius); font-size: 0.875rem;
            z-index: 1000; box-shadow: var(--shadow);
            opacity: 0; transition: all 0.3s ease;
        }
        .toast.visible { opacity: 1; transform: translateX(-50%) translateY(-10px); }

        /* Context Menu */
        .context-menu {
            position: fixed; background: var(--bg-glass); backdrop-filter: blur(20px);
            border: 1px solid var(--purple); border-radius: var(--radius);
            padding: 0.5rem 0; z-index: 1000; min-width: 200px;
            box-shadow: var(--shadow); display: none;
        }
        .context-menu.visible { display: block; animation: menuIn 0.15s ease-out; }
        @keyframes menuIn { from { opacity: 0; transform: scale(0.95); } }
        .context-menu-item {
            padding: 0.625rem 1rem; font-size: 0.8rem; cursor: pointer;
            display: flex; align-items: center; gap: 0.625rem; transition: all 0.1s;
        }
        .context-menu-item:hover { background: var(--bg-elevated); }
        .context-menu-divider { height: 1px; background: var(--bg-elevated); margin: 0.375rem 0; }

        /* Fullscreen Button */
        .fullscreen-btn {
            position: absolute; top: 1rem; right: 1rem;
            background: var(--bg-glass); backdrop-filter: blur(10px);
            border: 1px solid var(--purple); color: var(--fg);
            padding: 0.5rem 0.75rem; border-radius: 8px;
            z-index: 10; cursor: pointer; font-size: 1rem;
            transition: all 0.2s ease;
        }
        .fullscreen-btn:hover { background: var(--bg-elevated); box-shadow: var(--shadow-glow); }

        /* Top Nodes Panel */
        .top-nodes-panel {
            position: absolute; top: 60px; right: 1rem;
            background: var(--bg-glass); backdrop-filter: blur(15px);
            border: 1px solid var(--purple); border-radius: var(--radius);
            padding: 0.75rem; z-index: 10; max-height: 250px;
            overflow-y: auto; width: 220px; display: none;
        }
        .top-nodes-panel.visible { display: block; }
        .top-node-item {
            padding: 0.5rem; font-size: 0.75rem; cursor: pointer;
            border-radius: 6px; display: flex; justify-content: space-between;
            transition: all 0.15s ease;
        }
        .top-node-item:hover { background: var(--bg-elevated); transform: translateX(4px); }
        .top-node-item .rank { color: var(--gold); font-weight: 600; }

        /* Heatmap Legend - Always visible */
        .heatmap-legend {
            position: absolute; bottom: 1rem; right: 1rem;
            background: var(--bg-glass); backdrop-filter: blur(15px);
            border: 1px solid var(--fg-dim); border-radius: var(--radius);
            padding: 0.75rem; z-index: 10;
            transition: all 0.2s ease;
        }
        .heatmap-legend.heatmap-active { border-color: var(--gold); box-shadow: 0 0 20px var(--gold-glow); }
        .heatmap-gradient {
            width: 140px; height: 14px;
            background: linear-gradient(90deg, var(--green), var(--yellow), var(--orange), var(--red));
            border-radius: 4px; margin-bottom: 0.375rem;
        }
        .heatmap-labels { display: flex; justify-content: space-between; font-size: 0.7rem; color: var(--fg-muted); }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg); }
        ::-webkit-scrollbar-thumb { background: var(--bg-elevated); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--purple); }
    </style>
</head>
<body>
    <header>
        <div class="logo">
            <div class="logo-icon">bv</div>
            <h1><span>beads_viewer</span> Graph</h1>
        </div>
        <div class="toolbar">
            <div class="search-container">
                <span class="search-icon">üîç</span>
                <input type="text" class="search-input" id="search-input" placeholder="Search beads... (full text)">
                <div class="search-results" id="search-results"></div>
            </div>
            <div class="toolbar-group">
                <select id="view-mode" title="Graph layout mode: Force (physics simulation), DAG (directed acyclic graph), or Radial. Press 1-4 for shortcuts.">
                    <option value="force">Force</option>
                    <option value="td">DAG ‚Üì</option>
                    <option value="lr">DAG ‚Üí</option>
                    <option value="radialout">Radial</option>
                </select>
            </div>
            <div class="toolbar-group">
                <select id="filter-status" title="Filter nodes by status. Shows only beads matching the selected status.">
                    <option value="">All Status</option>
                    <option value="open">Open</option>
                    <option value="in_progress">In Progress</option>
                    <option value="blocked">Blocked</option>
                    <option value="closed">Closed</option>
                </select>
                <select id="filter-type" title="Filter nodes by type. Shows only beads matching the selected type.">
                    <option value="">All Types</option>
                    <option value="feature">Feature</option>
                    <option value="bug">Bug</option>
                    <option value="task">Task</option>
                    <option value="epic">Epic</option>
                </select>
            </div>
            <div class="toolbar-group">
                <select id="size-by" title="Control what metric determines node size. Larger nodes have higher values of the selected metric.">
                    <option value="pagerank">Size: PageRank</option>
                    <option value="betweenness">Size: Betweenness</option>
                    <option value="critical">Size: Critical Path</option>
                    <option value="indegree">Size: In-Degree</option>
                </select>
            </div>
            <div class="toolbar-group">
                <button id="btn-heatmap" title="Toggle heatmap coloring - shows node importance by color intensity (H)">üî•</button>
                <button id="btn-triage" title="Show/hide triage recommendations panel with prioritized work items (G)">üìã</button>
                <button id="btn-top" title="Show/hide top nodes panel with highest PageRank nodes (T)">‚≠ê</button>
                <button id="btn-theme" title="Switch to light mode (L)">‚òÄÔ∏è</button>
                <button id="btn-fit" title="Fit all nodes in view (F)">Fit</button>
                <button id="btn-reset" title="Reset graph to initial state with all filters cleared (R)">Reset</button>
            </div>
        </div>
    </header>
    <main>
        <div id="detail-sidebar">
            <div class="panel-header">
                <h3><span class="icon">‚ú®</span> Bead Details</h3>
                <button class="detach-btn" id="btn-detach" title="Detach panel (D)">
                    <span>‚á±</span> Detach
                </button>
            </div>
            <div id="docked-no-selection" class="no-selection">
                <div class="no-selection-icon">üîç</div>
                <div class="no-selection-text">Hover over a node to see details</div>
            </div>
            <div id="docked-panel" class="detail-content">
                <div class="hover-header">
                    <span class="hover-id" id="docked-id">-</span>
                    <span class="hover-type-badge" id="docked-type-badge">-</span>
                </div>
                <div class="hover-title" id="docked-title">-</div>
                <div class="hover-badges" id="docked-badges"></div>
                <div id="docked-description" class="hover-section" style="display:none;">
                    <div class="hover-section-title">Description</div>
                    <div class="hover-content" id="docked-description-content"></div>
                </div>
                <div id="docked-design" class="hover-section" style="display:none;">
                    <div class="hover-section-title">Design</div>
                    <div class="hover-content" id="docked-design-content"></div>
                </div>
                <div id="docked-acceptance" class="hover-section" style="display:none;">
                    <div class="hover-section-title">Acceptance Criteria</div>
                    <div class="hover-content" id="docked-acceptance-content"></div>
                </div>
                <div id="docked-notes" class="hover-section" style="display:none;">
                    <div class="hover-section-title">Notes</div>
                    <div class="hover-content" id="docked-notes-content"></div>
                </div>
                <div class="hover-section">
                    <div class="hover-section-title">Metadata</div>
                    <div class="hover-meta" id="docked-meta"></div>
                </div>
                <div id="docked-blocked-by" class="hover-section" style="display:none;">
                    <div class="hover-section-title">Blocked By</div>
                    <div class="hover-deps" id="docked-blocked-by-list"></div>
                </div>
                <div id="docked-blocks" class="hover-section" style="display:none;">
                    <div class="hover-section-title">Blocks</div>
                    <div class="hover-deps" id="docked-blocks-list"></div>
                </div>
                <div id="docked-commits" class="hover-section" style="display:none;">
                    <div class="hover-section-title">Related Commits</div>
                    <div class="hover-commits" id="docked-commits-list"></div>
                </div>
                <div class="hover-section">
                    <div class="hover-section-title">Graph Metrics</div>
                    <div class="hover-meta" id="docked-metrics"></div>
                </div>
            </div>
        </div>
        <div id="graph-wrapper">
            <div id="graph-container"></div>
            <div class="overlay-stats">
                <div class="stat"><span class="stat-value">344</span> nodes</div>
                <div class="stat"><span class="stat-value">504</span> edges</div>
                <div class="stat" id="stat-visible"><span class="stat-value">344</span> visible</div>
            </div>
            <button class="fullscreen-btn" id="btn-fullscreen" title="Toggle fullscreen mode for immersive graph viewing (Space)">‚õ∂</button>
            <div class="top-nodes-panel" id="top-nodes-panel"></div>
            <div class="heatmap-legend" id="heatmap-legend">
                <div class="heatmap-gradient"></div>
                <div class="heatmap-labels"><span>Low</span><span id="heatmap-metric">PageRank</span><span>High</span></div>
            </div>
            <div id="hover-panel">
                <button class="hover-close" id="hover-close">√ó</button>
                <div class="hover-header">
                    <span class="hover-id" id="hover-id">-</span>
                    <span class="hover-type-badge" id="hover-type-badge">-</span>
                </div>
                <div class="hover-title" id="hover-title">-</div>
                <div class="hover-badges" id="hover-badges"></div>
                <div id="hover-description" class="hover-section" style="display:none;">
                    <div class="hover-section-title">Description</div>
                    <div class="hover-content" id="hover-description-content"></div>
                </div>
                <div id="hover-design" class="hover-section" style="display:none;">
                    <div class="hover-section-title">Design</div>
                    <div class="hover-content" id="hover-design-content"></div>
                </div>
                <div id="hover-acceptance" class="hover-section" style="display:none;">
                    <div class="hover-section-title">Acceptance Criteria</div>
                    <div class="hover-content" id="hover-acceptance-content"></div>
                </div>
                <div id="hover-notes" class="hover-section" style="display:none;">
                    <div class="hover-section-title">Notes</div>
                    <div class="hover-content" id="hover-notes-content"></div>
                </div>
                <div class="hover-section">
                    <div class="hover-section-title">Metadata</div>
                    <div class="hover-meta" id="hover-meta"></div>
                </div>
                <div id="hover-blocked-by" class="hover-section" style="display:none;">
                    <div class="hover-section-title">Blocked By</div>
                    <div class="hover-deps" id="hover-blocked-by-list"></div>
                </div>
                <div id="hover-blocks" class="hover-section" style="display:none;">
                    <div class="hover-section-title">Blocks</div>
                    <div class="hover-deps" id="hover-blocks-list"></div>
                </div>
                <div id="hover-commits" class="hover-section" style="display:none;">
                    <div class="hover-section-title">Related Commits</div>
                    <div class="hover-commits" id="hover-commits-list"></div>
                </div>
                <div class="hover-section">
                    <div class="hover-section-title">Graph Metrics</div>
                    <div class="hover-meta" id="hover-metrics"></div>
                </div>
            </div>
        </div>
        <div id="sidebar">
            <div class="stats-grid">
                <div class="stat-card"><div class="stat-value" id="stat-nodes">344</div><div class="stat-label">Nodes</div></div>
                <div class="stat-card"><div class="stat-value" id="stat-edges">504</div><div class="stat-label">Edges</div></div>
                <div class="stat-card"><div class="stat-value" id="stat-actionable">-</div><div class="stat-label">Actionable</div></div>
                <div class="stat-card"><div class="stat-value warning" id="stat-blocked">-</div><div class="stat-label">Blocked</div></div>
                <div class="stat-card"><div class="stat-value" id="stat-critical">-</div><div class="stat-label">Critical</div></div>
                <div class="stat-card"><div class="stat-value warning" id="stat-articulation">-</div><div class="stat-label">Cut Pts</div></div>
            </div>
            <div class="panel" id="triage-panel" style="display:none;">
                <div class="panel-title">Top Recommendations</div>
                <div id="triage-list"></div>
            </div>
            <div class="panel">
                <div class="panel-title">Status Legend</div>
                <div class="legend">
                    <div class="legend-item"><div class="legend-dot" style="background:#22c55e;color:#22c55e"></div>Open</div>
                    <div class="legend-item"><div class="legend-dot" style="background:#f97316;color:#f97316"></div>In Progress</div>
                    <div class="legend-item"><div class="legend-dot" style="background:#ef4444;color:#ef4444"></div>Blocked</div>
                    <div class="legend-item"><div class="legend-dot" style="background:#555577;color:#555577"></div>Closed</div>
                </div>
            </div>
            <div class="panel">
                <div class="panel-title">Type Shapes</div>
                <div class="legend">
                    <div class="legend-item"><span style="font-size:1rem">‚óè</span> Feature</div>
                    <div class="legend-item"><span style="font-size:1rem">‚ñ≤</span> Bug</div>
                    <div class="legend-item"><span style="font-size:1rem">‚ñ†</span> Task</div>
                    <div class="legend-item"><span style="font-size:1rem">‚óÜ</span> Epic</div>
                </div>
            </div>
            <div class="panel">
                <div class="panel-title">Selected Node</div>
                <div id="node-detail">
                    <div class="detail-header">
                        <div class="detail-id" id="detail-id">-</div>
                        <div class="detail-priority" id="detail-priority">P2</div>
                    </div>
                    <div class="detail-name" id="detail-name">-</div>
                    <div class="detail-badges" id="detail-badges"></div>
                    <div class="detail-metrics">
                        <div class="metric-item"><span class="metric-label">PageRank</span><span class="metric-value" id="m-pagerank">-</span></div>
                        <div class="metric-item"><span class="metric-label">Rank</span><span class="metric-value" id="m-prrank">-</span></div>
                        <div class="metric-item"><span class="metric-label">Betweenness</span><span class="metric-value" id="m-between">-</span></div>
                        <div class="metric-item"><span class="metric-label">BW Rank</span><span class="metric-value" id="m-bwrank">-</span></div>
                        <div class="metric-item"><span class="metric-label">Critical</span><span class="metric-value" id="m-critical">-</span></div>
                        <div class="metric-item"><span class="metric-label">Slack</span><span class="metric-value" id="m-slack">-</span></div>
                        <div class="metric-item"><span class="metric-label">In-Deg</span><span class="metric-value" id="m-indeg">-</span></div>
                        <div class="metric-item"><span class="metric-label">Out-Deg</span><span class="metric-value" id="m-outdeg">-</span></div>
                    </div>
                </div>
                <div class="no-selection" id="no-selection">
                    <div class="no-selection-icon">üîç</div>
                    Click a node to see details<br>
                    <small>or hover for full info</small>
                </div>
            </div>
            <div class="panel">
                <div class="panel-title">Shortcuts</div>
                <div class="keyboard-hints">
                    <kbd>F</kbd> Fit ¬∑ <kbd>R</kbd> Reset ¬∑ <kbd>Space</kbd> Fullscreen<br>
                    <kbd>Esc</kbd> Clear ¬∑ <kbd>1-4</kbd> View modes<br>
                    <kbd>H</kbd> Heatmap ¬∑ <kbd>T</kbd> Top ¬∑ <kbd>G</kbd> Triage
                </div>
            </div>
        </div>
    </main>
    <footer>
        <div>Generated 2025-12-17 13:04:12 | Hash: 04cc066823493e86</div>
        <div>Project: beads_viewer | <a href="https://github.com/Dicklesworthstone/beads_viewer">bv</a></div>
    </footer>
    <div class="toast" id="toast"></div>
    <div class="context-menu" id="context-menu">
        <div class="context-menu-item" id="ctx-focus">üéØ Focus on this node</div>
        <div class="context-menu-item" id="ctx-details">üìÑ Show full details</div>
        <div class="context-menu-item" id="ctx-deps">üì• Show dependencies</div>
        <div class="context-menu-item" id="ctx-dependents">üì§ Show dependents</div>
        <div class="context-menu-item" id="ctx-connected">‚ú® Highlight connected</div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" id="ctx-path">üõ§Ô∏è Find path to...</div>
        <div class="context-menu-item" id="ctx-copy">üìã Copy ID</div>
    </div>
    <script>// Version 1.43.5 force-graph - https://github.com/vasturiano/force-graph
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t="undefined"!=typeof globalThis?globalThis:t||self).ForceGraph=n()}(this,(function(){"use strict";function n(t,n,r){if(e())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,n);var o=new(t.bind.apply(t,i));return r&&s(o,r.prototype),o}function e(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(e=function(){return!!t})()}function r(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function i(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?r(Object(e),!0).forEach((function(n){u(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):r(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function o(t){var n=function(t,n){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==typeof n?n:String(n)}function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t,n,e){return(n=o(n))in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function s(t,n){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},s(t,n)}function l(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,i,o,a,u=[],s=!0,l=!1;try{if(o=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;s=!1}else for(;!(s=(r=o.call(e)).done)&&(u.push(r.value),u.length!==n);s=!0);}catch(t){l=!0,i=t}finally{try{if(!s&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(l)throw i}}return u}}(t,n)||h(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t){return function(t){if(Array.isArray(t))return f(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||h(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,n){if(t){if("string"==typeof t)return f(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?f(t,n):void 0}}function f(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}!function(t,n){void 0===n&&(n={});var e=n.insertAt;if(t&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===e&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t))}}(".force-graph-container canvas {\n  display: block;\n  user-select: none;\n  outline: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.force-graph-container .graph-tooltip {\n  position: absolute;\n  top: 0;\n  font-family: sans-serif;\n  font-size: 16px;\n  padding: 4px;\n  border-radius: 3px;\n  color: #eee;\n  background: rgba(0,0,0,0.65);\n  visibility: hidden; /* by default */\n}\n\n.force-graph-container .clickable {\n  cursor: pointer;\n}\n\n.force-graph-container .grabbable {\n  cursor: move;\n  cursor: grab;\n  cursor: -moz-grab;\n  cursor: -webkit-grab;\n}\n\n.force-graph-container .grabbable:active {\n  cursor: grabbing;\n  cursor: -moz-grabbing;\n  cursor: -webkit-grabbing;\n}\n");var d="http://www.w3.org/1999/xhtml",p={svg:"http://www.w3.org/2000/svg",xhtml:d,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function g(t){var n=t+="",e=n.indexOf(":");return e>=0&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),p.hasOwnProperty(n)?{space:p[n],local:t}:t}function y(t){return function(){var n=this.ownerDocument,e=this.namespaceURI;return e===d&&n.documentElement.namespaceURI===d?n.createElement(t):n.createElementNS(e,t)}}function v(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function _(t){var n=g(t);return(n.local?v:y)(n)}function m(){}function x(t){return null==t?m:function(){return this.querySelector(t)}}function b(){return[]}function w(t){return null==t?b:function(){return this.querySelectorAll(t)}}function k(t){return function(){return function(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}(t.apply(this,arguments))}}function M(t){return function(){return this.matches(t)}}function z(t){return function(n){return n.matches(t)}}var A=Array.prototype.find;function S(){return this.firstElementChild}var C=Array.prototype.filter;function E(){return Array.from(this.children)}function O(t){return new Array(t.length)}function N(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}function P(t,n,e,r,i,o){for(var a,u=0,s=n.length,l=o.length;u<l;++u)(a=n[u])?(a.__data__=o[u],r[u]=a):e[u]=new N(t,o[u]);for(;u<s;++u)(a=n[u])&&(i[u]=a)}function j(t,n,e,r,i,o,a){var u,s,l,c=new Map,h=n.length,f=o.length,d=new Array(h);for(u=0;u<h;++u)(s=n[u])&&(d[u]=l=a.call(s,s.__data__,u,n)+"",c.has(l)?i[u]=s:c.set(l,s));for(u=0;u<f;++u)l=a.call(t,o[u],u,o)+"",(s=c.get(l))?(r[u]=s,s.__data__=o[u],c.delete(l)):e[u]=new N(t,o[u]);for(u=0;u<h;++u)(s=n[u])&&c.get(d[u])===s&&(i[u]=s)}function T(t){return t.__data__}function R(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function D(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function I(t){return function(){this.removeAttribute(t)}}function U(t){return function(){this.removeAttributeNS(t.space,t.local)}}function F(t,n){return function(){this.setAttribute(t,n)}}function L(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}function q(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttribute(t):this.setAttribute(t,e)}}function B(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}}function $(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function H(t){return function(){this.style.removeProperty(t)}}function V(t,n,e){return function(){this.style.setProperty(t,n,e)}}function X(t,n,e){return function(){var r=n.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,e)}}function G(t,n){return t.style.getPropertyValue(n)||$(t).getComputedStyle(t,null).getPropertyValue(n)}function Y(t){return function(){delete this[t]}}function W(t,n){return function(){this[t]=n}}function Z(t,n){return function(){var e=n.apply(this,arguments);null==e?delete this[t]:this[t]=e}}function Q(t){return t.trim().split(/^|\s+/)}function K(t){return t.classList||new J(t)}function J(t){this._node=t,this._names=Q(t.getAttribute("class")||"")}function tt(t,n){for(var e=K(t),r=-1,i=n.length;++r<i;)e.add(n[r])}function nt(t,n){for(var e=K(t),r=-1,i=n.length;++r<i;)e.remove(n[r])}function et(t){return function(){tt(this,t)}}function rt(t){return function(){nt(this,t)}}function it(t,n){return function(){(n.apply(this,arguments)?tt:nt)(this,t)}}function ot(){this.textContent=""}function at(t){return function(){this.textContent=t}}function ut(t){return function(){var n=t.apply(this,arguments);this.textContent=null==n?"":n}}function st(){this.innerHTML=""}function lt(t){return function(){this.innerHTML=t}}function ct(t){return function(){var n=t.apply(this,arguments);this.innerHTML=null==n?"":n}}function ht(){this.nextSibling&&this.parentNode.appendChild(this)}function ft(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function dt(){return null}function pt(){var t=this.parentNode;t&&t.removeChild(this)}function gt(){var t=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function yt(){var t=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function vt(t){return function(){var n=this.__on;if(n){for(var e,r=0,i=-1,o=n.length;r<o;++r)e=n[r],t.type&&e.type!==t.type||e.name!==t.name?n[++i]=e:this.removeEventListener(e.type,e.listener,e.options);++i?n.length=i:delete this.__on}}}function _t(t,n,e){return function(){var r,i=this.__on,o=function(t){return function(n){t.call(this,n,this.__data__)}}(n);if(i)for(var a=0,u=i.length;a<u;++a)if((r=i[a]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=e),void(r.value=n);this.addEventListener(t.type,o,e),r={type:t.type,name:t.name,value:n,listener:o,options:e},i?i.push(r):this.__on=[r]}}function mt(t,n,e){var r=$(t),i=r.CustomEvent;"function"==typeof i?i=new i(n,e):(i=r.document.createEvent("Event"),e?(i.initEvent(n,e.bubbles,e.cancelable),i.detail=e.detail):i.initEvent(n,!1,!1)),t.dispatchEvent(i)}function xt(t,n){return function(){return mt(this,t,n)}}function bt(t,n){return function(){return mt(this,t,n.apply(this,arguments))}}N.prototype={constructor:N,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},J.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var n=this._names.indexOf(t);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var wt=[null];function kt(t,n){this._groups=t,this._parents=n}function Mt(){return new kt([[document.documentElement]],wt)}function zt(t){return"string"==typeof t?new kt([[document.querySelector(t)]],[document.documentElement]):new kt([[t]],wt)}function At(t,n){if(t=function(t){let n;for(;n=t.sourceEvent;)t=n;return t}(t),void 0===n&&(n=t.currentTarget),n){var e=n.ownerSVGElement||n;if(e.createSVGPoint){var r=e.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(n.getScreenCTM().inverse())).x,r.y]}if(n.getBoundingClientRect){var i=n.getBoundingClientRect();return[t.clientX-i.left-n.clientLeft,t.clientY-i.top-n.clientTop]}}return[t.pageX,t.pageY]}kt.prototype=Mt.prototype={constructor:kt,select:function(t){"function"!=typeof t&&(t=x(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,a,u=n[i],s=u.length,l=r[i]=new Array(s),c=0;c<s;++c)(o=u[c])&&(a=t.call(o,o.__data__,c,u))&&("__data__"in o&&(a.__data__=o.__data__),l[c]=a);return new kt(r,this._parents)},selectAll:function(t){t="function"==typeof t?k(t):w(t);for(var n=this._groups,e=n.length,r=[],i=[],o=0;o<e;++o)for(var a,u=n[o],s=u.length,l=0;l<s;++l)(a=u[l])&&(r.push(t.call(a,a.__data__,l,u)),i.push(a));return new kt(r,i)},selectChild:function(t){return this.select(null==t?S:function(t){return function(){return A.call(this.children,t)}}("function"==typeof t?t:z(t)))},selectChildren:function(t){return this.selectAll(null==t?E:function(t){return function(){return C.call(this.children,t)}}("function"==typeof t?t:z(t)))},filter:function(t){"function"!=typeof t&&(t=M(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,a=n[i],u=a.length,s=r[i]=[],l=0;l<u;++l)(o=a[l])&&t.call(o,o.__data__,l,a)&&s.push(o);return new kt(r,this._parents)},data:function(t,n){if(!arguments.length)return Array.from(this,T);var e=n?j:P,r=this._parents,i=this._groups;"function"!=typeof t&&(t=function(t){return function(){return t}}(t));for(var o=i.length,a=new Array(o),u=new Array(o),s=new Array(o),l=0;l<o;++l){var c=r[l],h=i[l],f=h.length,d=R(t.call(c,c&&c.__data__,l,r)),p=d.length,g=u[l]=new Array(p),y=a[l]=new Array(p);e(c,h,g,y,s[l]=new Array(f),d,n);for(var v,_,m=0,x=0;m<p;++m)if(v=g[m]){for(m>=x&&(x=m+1);!(_=y[x])&&++x<p;);v._next=_||null}}return(a=new kt(a,r))._enter=u,a._exit=s,a},enter:function(){return new kt(this._enter||this._groups.map(O),this._parents)},exit:function(){return new kt(this._exit||this._groups.map(O),this._parents)},join:function(t,n,e){var r=this.enter(),i=this,o=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=n&&(i=n(i))&&(i=i.selection()),null==e?o.remove():e(o),r&&i?r.merge(i).order():i},merge:function(t){for(var n=t.selection?t.selection():t,e=this._groups,r=n._groups,i=e.length,o=r.length,a=Math.min(i,o),u=new Array(i),s=0;s<a;++s)for(var l,c=e[s],h=r[s],f=c.length,d=u[s]=new Array(f),p=0;p<f;++p)(l=c[p]||h[p])&&(d[p]=l);for(;s<i;++s)u[s]=e[s];return new kt(u,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,n=-1,e=t.length;++n<e;)for(var r,i=t[n],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function n(n,e){return n&&e?t(n.__data__,e.__data__):!n-!e}t||(t=D);for(var e=this._groups,r=e.length,i=new Array(r),o=0;o<r;++o){for(var a,u=e[o],s=u.length,l=i[o]=new Array(s),c=0;c<s;++c)(a=u[c])&&(l[c]=a);l.sort(n)}return new kt(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r=t[n],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){let t=0;for(const n of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var n=this._groups,e=0,r=n.length;e<r;++e)for(var i,o=n[e],a=0,u=o.length;a<u;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,n){var e=g(t);if(arguments.length<2){var r=this.node();return e.local?r.getAttributeNS(e.space,e.local):r.getAttribute(e)}return this.each((null==n?e.local?U:I:"function"==typeof n?e.local?B:q:e.local?L:F)(e,n))},style:function(t,n,e){return arguments.length>1?this.each((null==n?H:"function"==typeof n?X:V)(t,n,null==e?"":e)):G(this.node(),t)},property:function(t,n){return arguments.length>1?this.each((null==n?Y:"function"==typeof n?Z:W)(t,n)):this.node()[t]},classed:function(t,n){var e=Q(t+"");if(arguments.length<2){for(var r=K(this.node()),i=-1,o=e.length;++i<o;)if(!r.contains(e[i]))return!1;return!0}return this.each(("function"==typeof n?it:n?et:rt)(e,n))},text:function(t){return arguments.length?this.each(null==t?ot:("function"==typeof t?ut:at)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?st:("function"==typeof t?ct:lt)(t)):this.node().innerHTML},raise:function(){return this.each(ht)},lower:function(){return this.each(ft)},append:function(t){var n="function"==typeof t?t:_(t);return this.select((function(){return this.appendChild(n.apply(this,arguments))}))},insert:function(t,n){var e="function"==typeof t?t:_(t),r=null==n?dt:"function"==typeof n?n:x(n);return this.select((function(){return this.insertBefore(e.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(pt)},clone:function(t){return this.select(t?yt:gt)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,n,e){var r,i,o=function(t){return t.trim().split(/^|\s+/).map((function(t){var n="",e=t.indexOf(".");return e>=0&&(n=t.slice(e+1),t=t.slice(0,e)),{type:t,name:n}}))}(t+""),a=o.length;if(!(arguments.length<2)){for(u=n?_t:vt,r=0;r<a;++r)this.each(u(o[r],n,e));return this}var u=this.node().__on;if(u)for(var s,l=0,c=u.length;l<c;++l)for(r=0,s=u[l];r<a;++r)if((i=o[r]).type===s.type&&i.name===s.name)return s.value},dispatch:function(t,n){return this.each(("function"==typeof n?bt:xt)(t,n))},[Symbol.iterator]:function*(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r,i=t[n],o=0,a=i.length;o<a;++o)(r=i[o])&&(yield r)}};var St={value:()=>{}};function Ct(){for(var t,n=0,e=arguments.length,r={};n<e;++n){if(!(t=arguments[n]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new Et(r)}function Et(t){this._=t}function Ot(t,n){for(var e,r=0,i=t.length;r<i;++r)if((e=t[r]).name===n)return e.value}function Nt(t,n,e){for(var r=0,i=t.length;r<i;++r)if(t[r].name===n){t[r]=St,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=e&&t.push({name:n,value:e}),t}Et.prototype=Ct.prototype={constructor:Et,on:function(t,n){var e,r,i=this._,o=(r=i,(t+"").trim().split(/^|\s+/).map((function(t){var n="",e=t.indexOf(".");if(e>=0&&(n=t.slice(e+1),t=t.slice(0,e)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))),a=-1,u=o.length;if(!(arguments.length<2)){if(null!=n&&"function"!=typeof n)throw new Error("invalid callback: "+n);for(;++a<u;)if(e=(t=o[a]).type)i[e]=Nt(i[e],t.name,n);else if(null==n)for(e in i)i[e]=Nt(i[e],t.name,null);return this}for(;++a<u;)if((e=(t=o[a]).type)&&(e=Ot(i[e],t.name)))return e},copy:function(){var t={},n=this._;for(var e in n)t[e]=n[e].slice();return new Et(t)},call:function(t,n){if((e=arguments.length-2)>0)for(var e,r,i=new Array(e),o=0;o<e;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,e=(r=this._[t]).length;o<e;++o)r[o].value.apply(n,i)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(n,e)}};const Pt={passive:!1},jt={capture:!0,passive:!1};function Tt(t){t.stopImmediatePropagation()}function Rt(t){t.preventDefault(),t.stopImmediatePropagation()}function Dt(t){var n=t.document.documentElement,e=zt(t).on("dragstart.drag",Rt,jt);"onselectstart"in n?e.on("selectstart.drag",Rt,jt):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}function It(t,n){var e=t.document.documentElement,r=zt(t).on("dragstart.drag",null);n&&(r.on("click.drag",Rt,jt),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in e?r.on("selectstart.drag",null):(e.style.MozUserSelect=e.__noselect,delete e.__noselect)}var Ut=t=>()=>t;function Ft(t,{sourceEvent:n,subject:e,target:r,identifier:i,active:o,x:a,y:u,dx:s,dy:l,dispatch:c}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:e,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:u,enumerable:!0,configurable:!0},dx:{value:s,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:c}})}function Lt(t){return!t.ctrlKey&&!t.button}function qt(){return this.parentNode}function Bt(t,n){return null==n?{x:t.x,y:t.y}:n}function $t(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ht(t,n,e){t.prototype=n.prototype=e,e.constructor=t}function Vt(t,n){var e=Object.create(t.prototype);for(var r in n)e[r]=n[r];return e}function Xt(){}Ft.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var Gt=.7,Yt=1/Gt,Wt="\\s*([+-]?\\d+)\\s*",Zt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Qt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Kt=/^#([0-9a-f]{3,8})$/,Jt=new RegExp(`^rgb\\(${Wt},${Wt},${Wt}\\)$`),tn=new RegExp(`^rgb\\(${Qt},${Qt},${Qt}\\)$`),nn=new RegExp(`^rgba\\(${Wt},${Wt},${Wt},${Zt}\\)$`),en=new RegExp(`^rgba\\(${Qt},${Qt},${Qt},${Zt}\\)$`),rn=new RegExp(`^hsl\\(${Zt},${Qt},${Qt}\\)$`),on=new RegExp(`^hsla\\(${Zt},${Qt},${Qt},${Zt}\\)$`),an={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function un(){return this.rgb().formatHex()}function sn(){return this.rgb().formatRgb()}function ln(t){var n,e;return t=(t+"").trim().toLowerCase(),(n=Kt.exec(t))?(e=n[1].length,n=parseInt(n[1],16),6===e?cn(n):3===e?new dn(n>>8&15|n>>4&240,n>>4&15|240&n,(15&n)<<4|15&n,1):8===e?hn(n>>24&255,n>>16&255,n>>8&255,(255&n)/255):4===e?hn(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|240&n,((15&n)<<4|15&n)/255):null):(n=Jt.exec(t))?new dn(n[1],n[2],n[3],1):(n=tn.exec(t))?new dn(255*n[1]/100,255*n[2]/100,255*n[3]/100,1):(n=nn.exec(t))?hn(n[1],n[2],n[3],n[4]):(n=en.exec(t))?hn(255*n[1]/100,255*n[2]/100,255*n[3]/100,n[4]):(n=rn.exec(t))?mn(n[1],n[2]/100,n[3]/100,1):(n=on.exec(t))?mn(n[1],n[2]/100,n[3]/100,n[4]):an.hasOwnProperty(t)?cn(an[t]):"transparent"===t?new dn(NaN,NaN,NaN,0):null}function cn(t){return new dn(t>>16&255,t>>8&255,255&t,1)}function hn(t,n,e,r){return r<=0&&(t=n=e=NaN),new dn(t,n,e,r)}function fn(t,n,e,r){return 1===arguments.length?((i=t)instanceof Xt||(i=ln(i)),i?new dn((i=i.rgb()).r,i.g,i.b,i.opacity):new dn):new dn(t,n,e,null==r?1:r);var i}function dn(t,n,e,r){this.r=+t,this.g=+n,this.b=+e,this.opacity=+r}function pn(){return`#${_n(this.r)}${_n(this.g)}${_n(this.b)}`}function gn(){const t=yn(this.opacity);return`${1===t?"rgb(":"rgba("}${vn(this.r)}, ${vn(this.g)}, ${vn(this.b)}${1===t?")":`, ${t})`}`}function yn(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function vn(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function _n(t){return((t=vn(t))<16?"0":"")+t.toString(16)}function mn(t,n,e,r){return r<=0?t=n=e=NaN:e<=0||e>=1?t=n=NaN:n<=0&&(t=NaN),new bn(t,n,e,r)}function xn(t){if(t instanceof bn)return new bn(t.h,t.s,t.l,t.opacity);if(t instanceof Xt||(t=ln(t)),!t)return new bn;if(t instanceof bn)return t;var n=(t=t.rgb()).r/255,e=t.g/255,r=t.b/255,i=Math.min(n,e,r),o=Math.max(n,e,r),a=NaN,u=o-i,s=(o+i)/2;return u?(a=n===o?(e-r)/u+6*(e<r):e===o?(r-n)/u+2:(n-e)/u+4,u/=s<.5?o+i:2-o-i,a*=60):u=s>0&&s<1?0:a,new bn(a,u,s,t.opacity)}function bn(t,n,e,r){this.h=+t,this.s=+n,this.l=+e,this.opacity=+r}function wn(t){return(t=(t||0)%360)<0?t+360:t}function kn(t){return Math.max(0,Math.min(1,t||0))}function Mn(t,n,e){return 255*(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)}Ht(Xt,ln,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:un,formatHex:un,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return xn(this).formatHsl()},formatRgb:sn,toString:sn}),Ht(dn,fn,Vt(Xt,{brighter(t){return t=null==t?Yt:Math.pow(Yt,t),new dn(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?Gt:Math.pow(Gt,t),new dn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new dn(vn(this.r),vn(this.g),vn(this.b),yn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:pn,formatHex:pn,formatHex8:function(){return`#${_n(this.r)}${_n(this.g)}${_n(this.b)}${_n(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:gn,toString:gn})),Ht(bn,(function(t,n,e,r){return 1===arguments.length?xn(t):new bn(t,n,e,null==r?1:r)}),Vt(Xt,{brighter(t){return t=null==t?Yt:Math.pow(Yt,t),new bn(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Gt:Math.pow(Gt,t),new bn(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,r=e+(e<.5?e:1-e)*n,i=2*e-r;return new dn(Mn(t>=240?t-240:t+120,i,r),Mn(t,i,r),Mn(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new bn(wn(this.h),kn(this.s),kn(this.l),yn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=yn(this.opacity);return`${1===t?"hsl(":"hsla("}${wn(this.h)}, ${100*kn(this.s)}%, ${100*kn(this.l)}%${1===t?")":`, ${t})`}`}}));var zn=t=>()=>t;function An(t){return 1==(t=+t)?Sn:function(n,e){return e-n?function(t,n,e){return t=Math.pow(t,e),n=Math.pow(n,e)-t,e=1/e,function(r){return Math.pow(t+r*n,e)}}(n,e,t):zn(isNaN(n)?e:n)}}function Sn(t,n){var e=n-t;return e?function(t,n){return function(e){return t+e*n}}(t,e):zn(isNaN(t)?n:t)}var Cn=function t(n){var e=An(n);function r(t,n){var r=e((t=fn(t)).r,(n=fn(n)).r),i=e(t.g,n.g),o=e(t.b,n.b),a=Sn(t.opacity,n.opacity);return function(n){return t.r=r(n),t.g=i(n),t.b=o(n),t.opacity=a(n),t+""}}return r.gamma=t,r}(1);function En(t,n){return t=+t,n=+n,function(e){return t*(1-e)+n*e}}var On=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Nn=new RegExp(On.source,"g");function Pn(t,n){var e,r,i,o=On.lastIndex=Nn.lastIndex=0,a=-1,u=[],s=[];for(t+="",n+="";(e=On.exec(t))&&(r=Nn.exec(n));)(i=r.index)>o&&(i=n.slice(o,i),u[a]?u[a]+=i:u[++a]=i),(e=e[0])===(r=r[0])?u[a]?u[a]+=r:u[++a]=r:(u[++a]=null,s.push({i:a,x:En(e,r)})),o=Nn.lastIndex;return o<n.length&&(i=n.slice(o),u[a]?u[a]+=i:u[++a]=i),u.length<2?s[0]?function(t){return function(n){return t(n)+""}}(s[0].x):function(t){return function(){return t}}(n):(n=s.length,function(t){for(var e,r=0;r<n;++r)u[(e=s[r]).i]=e.x(t);return u.join("")})}var jn,Tn=180/Math.PI,Rn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Dn(t,n,e,r,i,o){var a,u,s;return(a=Math.sqrt(t*t+n*n))&&(t/=a,n/=a),(s=t*e+n*r)&&(e-=t*s,r-=n*s),(u=Math.sqrt(e*e+r*r))&&(e/=u,r/=u,s/=u),t*r<n*e&&(t=-t,n=-n,s=-s,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(n,t)*Tn,skewX:Math.atan(s)*Tn,scaleX:a,scaleY:u}}function In(t,n,e,r){function i(t){return t.length?t.pop()+" ":""}return function(o,a){var u=[],s=[];return o=t(o),a=t(a),function(t,r,i,o,a,u){if(t!==i||r!==o){var s=a.push("translate(",null,n,null,e);u.push({i:s-4,x:En(t,i)},{i:s-2,x:En(r,o)})}else(i||o)&&a.push("translate("+i+n+o+e)}(o.translateX,o.translateY,a.translateX,a.translateY,u,s),function(t,n,e,o){t!==n?(t-n>180?n+=360:n-t>180&&(t+=360),o.push({i:e.push(i(e)+"rotate(",null,r)-2,x:En(t,n)})):n&&e.push(i(e)+"rotate("+n+r)}(o.rotate,a.rotate,u,s),function(t,n,e,o){t!==n?o.push({i:e.push(i(e)+"skewX(",null,r)-2,x:En(t,n)}):n&&e.push(i(e)+"skewX("+n+r)}(o.skewX,a.skewX,u,s),function(t,n,e,r,o,a){if(t!==e||n!==r){var u=o.push(i(o)+"scale(",null,",",null,")");a.push({i:u-4,x:En(t,e)},{i:u-2,x:En(n,r)})}else 1===e&&1===r||o.push(i(o)+"scale("+e+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,u,s),o=a=null,function(t){for(var n,e=-1,r=s.length;++e<r;)u[(n=s[e]).i]=n.x(t);return u.join("")}}}var Un=In((function(t){const n=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return n.isIdentity?Rn:Dn(n.a,n.b,n.c,n.d,n.e,n.f)}),"px, ","px)","deg)"),Fn=In((function(t){return null==t?Rn:(jn||(jn=document.createElementNS("http://www.w3.org/2000/svg","g")),jn.setAttribute("transform",t),(t=jn.transform.baseVal.consolidate())?Dn((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Rn)}),", ",")",")");function Ln(t){return((t=Math.exp(t))+1/t)/2}var qn,Bn,$n=function t(n,e,r){function i(t,i){var o,a,u=t[0],s=t[1],l=t[2],c=i[0],h=i[1],f=i[2],d=c-u,p=h-s,g=d*d+p*p;if(g<1e-12)a=Math.log(f/l)/n,o=function(t){return[u+t*d,s+t*p,l*Math.exp(n*t*a)]};else{var y=Math.sqrt(g),v=(f*f-l*l+r*g)/(2*l*e*y),_=(f*f-l*l-r*g)/(2*f*e*y),m=Math.log(Math.sqrt(v*v+1)-v),x=Math.log(Math.sqrt(_*_+1)-_);a=(x-m)/n,o=function(t){var r=t*a,i=Ln(m),o=l/(e*y)*(i*function(t){return((t=Math.exp(2*t))-1)/(t+1)}(n*r+m)-function(t){return((t=Math.exp(t))-1/t)/2}(m));return[u+o*d,s+o*p,l*i/Ln(n*r+m)]}}return o.duration=1e3*a*n/Math.SQRT2,o}return i.rho=function(n){var e=Math.max(.001,+n),r=e*e;return t(e,r,r*r)},i}(Math.SQRT2,2,4),Hn=0,Vn=0,Xn=0,Gn=1e3,Yn=0,Wn=0,Zn=0,Qn="object"==typeof performance&&performance.now?performance:Date,Kn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Jn(){return Wn||(Kn(te),Wn=Qn.now()+Zn)}function te(){Wn=0}function ne(){this._call=this._time=this._next=null}function ee(t,n,e){var r=new ne;return r.restart(t,n,e),r}function re(){Wn=(Yn=Qn.now())+Zn,Hn=Vn=0;try{!function(){Jn(),++Hn;for(var t,n=qn;n;)(t=Wn-n._time)>=0&&n._call.call(void 0,t),n=n._next;--Hn}()}finally{Hn=0,function(){var t,n,e=qn,r=1/0;for(;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:qn=n);Bn=t,oe(r)}(),Wn=0}}function ie(){var t=Qn.now(),n=t-Yn;n>Gn&&(Zn-=n,Yn=t)}function oe(t){Hn||(Vn&&(Vn=clearTimeout(Vn)),t-Wn>24?(t<1/0&&(Vn=setTimeout(re,t-Qn.now()-Zn)),Xn&&(Xn=clearInterval(Xn))):(Xn||(Yn=Qn.now(),Xn=setInterval(ie,Gn)),Hn=1,Kn(re)))}function ae(t,n,e){var r=new ne;return n=null==n?0:+n,r.restart((e=>{r.stop(),t(e+n)}),n,e),r}ne.prototype=ee.prototype={constructor:ne,restart:function(t,n,e){if("function"!=typeof t)throw new TypeError("callback is not a function");e=(null==e?Jn():+e)+(null==n?0:+n),this._next||Bn===this||(Bn?Bn._next=this:qn=this,Bn=this),this._call=t,this._time=e,oe()},stop:function(){this._call&&(this._call=null,this._time=1/0,oe())}};var ue=Ct("start","end","cancel","interrupt"),se=[],le=0,ce=1,he=2,fe=3,de=4,pe=5,ge=6;function ye(t,n,e,r,i,o){var a=t.__transition;if(a){if(e in a)return}else t.__transition={};!function(t,n,e){var r,i=t.__transition;function o(t){e.state=ce,e.timer.restart(a,e.delay,e.time),e.delay<=t&&a(t-e.delay)}function a(o){var l,c,h,f;if(e.state!==ce)return s();for(l in i)if((f=i[l]).name===e.name){if(f.state===fe)return ae(a);f.state===de?(f.state=ge,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete i[l]):+l<n&&(f.state=ge,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete i[l])}if(ae((function(){e.state===fe&&(e.state=de,e.timer.restart(u,e.delay,e.time),u(o))})),e.state=he,e.on.call("start",t,t.__data__,e.index,e.group),e.state===he){for(e.state=fe,r=new Array(h=e.tween.length),l=0,c=-1;l<h;++l)(f=e.tween[l].value.call(t,t.__data__,e.index,e.group))&&(r[++c]=f);r.length=c+1}}function u(n){for(var i=n<e.duration?e.ease.call(null,n/e.duration):(e.timer.restart(s),e.state=pe,1),o=-1,a=r.length;++o<a;)r[o].call(t,i);e.state===pe&&(e.on.call("end",t,t.__data__,e.index,e.group),s())}function s(){for(var r in e.state=ge,e.timer.stop(),delete i[n],i)return;delete t.__transition}i[n]=e,e.timer=ee(o,0,e.time)}(t,e,{name:n,index:r,group:i,on:ue,tween:se,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:le})}function ve(t,n){var e=me(t,n);if(e.state>le)throw new Error("too late; already scheduled");return e}function _e(t,n){var e=me(t,n);if(e.state>fe)throw new Error("too late; already running");return e}function me(t,n){var e=t.__transition;if(!e||!(e=e[n]))throw new Error("transition not found");return e}function xe(t,n){var e,r,i,o=t.__transition,a=!0;if(o){for(i in n=null==n?null:n+"",o)(e=o[i]).name===n?(r=e.state>he&&e.state<pe,e.state=ge,e.timer.stop(),e.on.call(r?"interrupt":"cancel",t,t.__data__,e.index,e.group),delete o[i]):a=!1;a&&delete t.__transition}}function be(t,n){var e,r;return function(){var i=_e(this,t),o=i.tween;if(o!==e)for(var a=0,u=(r=e=o).length;a<u;++a)if(r[a].name===n){(r=r.slice()).splice(a,1);break}i.tween=r}}function we(t,n,e){var r,i;if("function"!=typeof e)throw new Error;return function(){var o=_e(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var u={name:n,value:e},s=0,l=i.length;s<l;++s)if(i[s].name===n){i[s]=u;break}s===l&&i.push(u)}o.tween=i}}function ke(t,n,e){var r=t._id;return t.each((function(){var t=_e(this,r);(t.value||(t.value={}))[n]=e.apply(this,arguments)})),function(t){return me(t,r).value[n]}}function Me(t,n){var e;return("number"==typeof n?En:n instanceof ln?Cn:(e=ln(n))?(n=e,Cn):Pn)(t,n)}function ze(t){return function(){this.removeAttribute(t)}}function Ae(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Se(t,n,e){var r,i,o=e+"";return function(){var a=this.getAttribute(t);return a===o?null:a===r?i:i=n(r=a,e)}}function Ce(t,n,e){var r,i,o=e+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===r?i:i=n(r=a,e)}}function Ee(t,n,e){var r,i,o;return function(){var a,u,s=e(this);if(null!=s)return(a=this.getAttribute(t))===(u=s+"")?null:a===r&&u===i?o:(i=u,o=n(r=a,s));this.removeAttribute(t)}}function Oe(t,n,e){var r,i,o;return function(){var a,u,s=e(this);if(null!=s)return(a=this.getAttributeNS(t.space,t.local))===(u=s+"")?null:a===r&&u===i?o:(i=u,o=n(r=a,s));this.removeAttributeNS(t.space,t.local)}}function Ne(t,n){var e,r;function i(){var i=n.apply(this,arguments);return i!==r&&(e=(r=i)&&function(t,n){return function(e){this.setAttributeNS(t.space,t.local,n.call(this,e))}}(t,i)),e}return i._value=n,i}function Pe(t,n){var e,r;function i(){var i=n.apply(this,arguments);return i!==r&&(e=(r=i)&&function(t,n){return function(e){this.setAttribute(t,n.call(this,e))}}(t,i)),e}return i._value=n,i}function je(t,n){return function(){ve(this,t).delay=+n.apply(this,arguments)}}function Te(t,n){return n=+n,function(){ve(this,t).delay=n}}function Re(t,n){return function(){_e(this,t).duration=+n.apply(this,arguments)}}function De(t,n){return n=+n,function(){_e(this,t).duration=n}}var Ie=Mt.prototype.constructor;function Ue(t){return function(){this.style.removeProperty(t)}}var Fe=0;function Le(t,n,e,r){this._groups=t,this._parents=n,this._name=e,this._id=r}function qe(){return++Fe}var Be=Mt.prototype;Le.prototype={constructor:Le,select:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=x(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var u,s,l=r[a],c=l.length,h=o[a]=new Array(c),f=0;f<c;++f)(u=l[f])&&(s=t.call(u,u.__data__,f,l))&&("__data__"in u&&(s.__data__=u.__data__),h[f]=s,ye(h[f],n,e,f,h,me(u,e)));return new Le(o,this._parents,n,e)},selectAll:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=w(t));for(var r=this._groups,i=r.length,o=[],a=[],u=0;u<i;++u)for(var s,l=r[u],c=l.length,h=0;h<c;++h)if(s=l[h]){for(var f,d=t.call(s,s.__data__,h,l),p=me(s,e),g=0,y=d.length;g<y;++g)(f=d[g])&&ye(f,n,e,g,d,p);o.push(d),a.push(s)}return new Le(o,a,n,e)},selectChild:Be.selectChild,selectChildren:Be.selectChildren,filter:function(t){"function"!=typeof t&&(t=M(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,a=n[i],u=a.length,s=r[i]=[],l=0;l<u;++l)(o=a[l])&&t.call(o,o.__data__,l,a)&&s.push(o);return new Le(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var n=this._groups,e=t._groups,r=n.length,i=e.length,o=Math.min(r,i),a=new Array(r),u=0;u<o;++u)for(var s,l=n[u],c=e[u],h=l.length,f=a[u]=new Array(h),d=0;d<h;++d)(s=l[d]||c[d])&&(f[d]=s);for(;u<r;++u)a[u]=n[u];return new Le(a,this._parents,this._name,this._id)},selection:function(){return new Ie(this._groups,this._parents)},transition:function(){for(var t=this._name,n=this._id,e=qe(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,u=r[o],s=u.length,l=0;l<s;++l)if(a=u[l]){var c=me(a,n);ye(a,t,e,l,u,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Le(r,this._parents,t,e)},call:Be.call,nodes:Be.nodes,node:Be.node,size:Be.size,empty:Be.empty,each:Be.each,on:function(t,n){var e=this._id;return arguments.length<2?me(this.node(),e).on.on(t):this.each(function(t,n,e){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||"start"===t}))}(n)?ve:_e;return function(){var a=o(this,t),u=a.on;u!==r&&(i=(r=u).copy()).on(n,e),a.on=i}}(e,t,n))},attr:function(t,n){var e=g(t),r="transform"===e?Fn:Me;return this.attrTween(t,"function"==typeof n?(e.local?Oe:Ee)(e,r,ke(this,"attr."+t,n)):null==n?(e.local?Ae:ze)(e):(e.local?Ce:Se)(e,r,n))},attrTween:function(t,n){var e="attr."+t;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(null==n)return this.tween(e,null);if("function"!=typeof n)throw new Error;var r=g(t);return this.tween(e,(r.local?Ne:Pe)(r,n))},style:function(t,n,e){var r="transform"==(t+="")?Un:Me;return null==n?this.styleTween(t,function(t,n){var e,r,i;return function(){var o=G(this,t),a=(this.style.removeProperty(t),G(this,t));return o===a?null:o===e&&a===r?i:i=n(e=o,r=a)}}(t,r)).on("end.style."+t,Ue(t)):"function"==typeof n?this.styleTween(t,function(t,n,e){var r,i,o;return function(){var a=G(this,t),u=e(this),s=u+"";return null==u&&(this.style.removeProperty(t),s=u=G(this,t)),a===s?null:a===r&&s===i?o:(i=s,o=n(r=a,u))}}(t,r,ke(this,"style."+t,n))).each(function(t,n){var e,r,i,o,a="style."+n,u="end."+a;return function(){var s=_e(this,t),l=s.on,c=null==s.value[a]?o||(o=Ue(n)):void 0;l===e&&i===c||(r=(e=l).copy()).on(u,i=c),s.on=r}}(this._id,t)):this.styleTween(t,function(t,n,e){var r,i,o=e+"";return function(){var a=G(this,t);return a===o?null:a===r?i:i=n(r=a,e)}}(t,r,n),e).on("end.style."+t,null)},styleTween:function(t,n,e){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==n)return this.tween(r,null);if("function"!=typeof n)throw new Error;return this.tween(r,function(t,n,e){var r,i;function o(){var o=n.apply(this,arguments);return o!==i&&(r=(i=o)&&function(t,n,e){return function(r){this.style.setProperty(t,n.call(this,r),e)}}(t,o,e)),r}return o._value=n,o}(t,n,null==e?"":e))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var n=t(this);this.textContent=null==n?"":n}}(ke(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;return this.tween(n,function(t){var n,e;function r(){var r=t.apply(this,arguments);return r!==e&&(n=(e=r)&&function(t){return function(n){this.textContent=t.call(this,n)}}(r)),n}return r._value=t,r}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var n=this.parentNode;for(var e in this.__transition)if(+e!==t)return;n&&n.removeChild(this)}}(this._id))},tween:function(t,n){var e=this._id;if(t+="",arguments.length<2){for(var r,i=me(this.node(),e).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==n?be:we)(e,t,n))},delay:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?je:Te)(n,t)):me(this.node(),n).delay},duration:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?Re:De)(n,t)):me(this.node(),n).duration},ease:function(t){var n=this._id;return arguments.length?this.each(function(t,n){if("function"!=typeof n)throw new Error;return function(){_e(this,t).ease=n}}(n,t)):me(this.node(),n).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,n){return function(){var e=n.apply(this,arguments);if("function"!=typeof e)throw new Error;_e(this,t).ease=e}}(this._id,t))},end:function(){var t,n,e=this,r=e._id,i=e.size();return new Promise((function(o,a){var u={value:a},s={value:function(){0==--i&&o()}};e.each((function(){var e=_e(this,r),i=e.on;i!==t&&((n=(t=i).copy())._.cancel.push(u),n._.interrupt.push(u),n._.end.push(s)),e.on=n})),0===i&&o()}))},[Symbol.iterator]:Be[Symbol.iterator]};var $e={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function He(t,n){for(var e;!(e=t.__transition)||!(e=e[n]);)if(!(t=t.parentNode))throw new Error(`transition ${n} not found`);return e}Mt.prototype.interrupt=function(t){return this.each((function(){xe(this,t)}))},Mt.prototype.transition=function(t){var n,e;t instanceof Le?(n=t._id,t=t._name):(n=qe(),(e=$e).time=Jn(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,u=r[o],s=u.length,l=0;l<s;++l)(a=u[l])&&ye(a,t,n,l,u,e||He(a,n));return new Le(r,this._parents,t,n)};var Ve=t=>()=>t;function Xe(t,{sourceEvent:n,target:e,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:e,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Ge(t,n,e){this.k=t,this.x=n,this.y=e}Ge.prototype={constructor:Ge,scale:function(t){return 1===t?this:new Ge(this.k*t,this.x,this.y)},translate:function(t,n){return 0===t&0===n?this:new Ge(this.k,this.x+this.k*t,this.y+this.k*n)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Ye=new Ge(1,0,0);function We(t){for(;!t.__zoom;)if(!(t=t.parentNode))return Ye;return t.__zoom}function Ze(t){t.stopImmediatePropagation()}function Qe(t){t.preventDefault(),t.stopImmediatePropagation()}function Ke(t){return!(t.ctrlKey&&"wheel"!==t.type||t.button)}function Je(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function tr(){return this.__zoom||Ye}function nr(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function er(){return navigator.maxTouchPoints||"ontouchstart"in this}function rr(t,n,e){var r=t.invertX(n[0][0])-e[0][0],i=t.invertX(n[1][0])-e[1][0],o=t.invertY(n[0][1])-e[0][1],a=t.invertY(n[1][1])-e[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}function ir(){var t,n,e,r=Ke,i=Je,o=rr,a=nr,u=er,s=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],c=250,h=$n,f=Ct("start","zoom","end"),d=500,p=150,g=0,y=10;function v(t){t.property("__zoom",tr).on("wheel.zoom",M,{passive:!1}).on("mousedown.zoom",z).on("dblclick.zoom",A).filter(u).on("touchstart.zoom",S).on("touchmove.zoom",C).on("touchend.zoom touchcancel.zoom",E).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function _(t,n){return(n=Math.max(s[0],Math.min(s[1],n)))===t.k?t:new Ge(n,t.x,t.y)}function m(t,n,e){var r=n[0]-e[0]*t.k,i=n[1]-e[1]*t.k;return r===t.x&&i===t.y?t:new Ge(t.k,r,i)}function x(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function b(t,n,e,r){t.on("start.zoom",(function(){w(this,arguments).event(r).start()})).on("interrupt.zoom end.zoom",(function(){w(this,arguments).event(r).end()})).tween("zoom",(function(){var t=this,o=arguments,a=w(t,o).event(r),u=i.apply(t,o),s=null==e?x(u):"function"==typeof e?e.apply(t,o):e,l=Math.max(u[1][0]-u[0][0],u[1][1]-u[0][1]),c=t.__zoom,f="function"==typeof n?n.apply(t,o):n,d=h(c.invert(s).concat(l/c.k),f.invert(s).concat(l/f.k));return function(t){if(1===t)t=f;else{var n=d(t),e=l/n[2];t=new Ge(e,s[0]-n[0]*e,s[1]-n[1]*e)}a.zoom(null,t)}}))}function w(t,n,e){return!e&&t.__zooming||new k(t,n)}function k(t,n){this.that=t,this.args=n,this.active=0,this.sourceEvent=null,this.extent=i.apply(t,n),this.taps=0}function M(t,...n){if(r.apply(this,arguments)){var e=w(this,n).event(t),i=this.__zoom,u=Math.max(s[0],Math.min(s[1],i.k*Math.pow(2,a.apply(this,arguments)))),c=At(t);if(e.wheel)e.mouse[0][0]===c[0]&&e.mouse[0][1]===c[1]||(e.mouse[1]=i.invert(e.mouse[0]=c)),clearTimeout(e.wheel);else{if(i.k===u)return;e.mouse=[c,i.invert(c)],xe(this),e.start()}Qe(t),e.wheel=setTimeout((function(){e.wheel=null,e.end()}),p),e.zoom("mouse",o(m(_(i,u),e.mouse[0],e.mouse[1]),e.extent,l))}}function z(t,...n){if(!e&&r.apply(this,arguments)){var i=t.currentTarget,a=w(this,n,!0).event(t),u=zt(t.view).on("mousemove.zoom",(function(t){if(Qe(t),!a.moved){var n=t.clientX-c,e=t.clientY-h;a.moved=n*n+e*e>g}a.event(t).zoom("mouse",o(m(a.that.__zoom,a.mouse[0]=At(t,i),a.mouse[1]),a.extent,l))}),!0).on("mouseup.zoom",(function(t){u.on("mousemove.zoom mouseup.zoom",null),It(t.view,a.moved),Qe(t),a.event(t).end()}),!0),s=At(t,i),c=t.clientX,h=t.clientY;Dt(t.view),Ze(t),a.mouse=[s,this.__zoom.invert(s)],xe(this),a.start()}}function A(t,...n){if(r.apply(this,arguments)){var e=this.__zoom,a=At(t.changedTouches?t.changedTouches[0]:t,this),u=e.invert(a),s=e.k*(t.shiftKey?.5:2),h=o(m(_(e,s),a,u),i.apply(this,n),l);Qe(t),c>0?zt(this).transition().duration(c).call(b,h,a,t):zt(this).call(v.transform,h,a,t)}}function S(e,...i){if(r.apply(this,arguments)){var o,a,u,s,l=e.touches,c=l.length,h=w(this,i,e.changedTouches.length===c).event(e);for(Ze(e),a=0;a<c;++a)s=[s=At(u=l[a],this),this.__zoom.invert(s),u.identifier],h.touch0?h.touch1||h.touch0[2]===s[2]||(h.touch1=s,h.taps=0):(h.touch0=s,o=!0,h.taps=1+!!t);t&&(t=clearTimeout(t)),o&&(h.taps<2&&(n=s[0],t=setTimeout((function(){t=null}),d)),xe(this),h.start())}}function C(t,...n){if(this.__zooming){var e,r,i,a,u=w(this,n).event(t),s=t.changedTouches,c=s.length;for(Qe(t),e=0;e<c;++e)i=At(r=s[e],this),u.touch0&&u.touch0[2]===r.identifier?u.touch0[0]=i:u.touch1&&u.touch1[2]===r.identifier&&(u.touch1[0]=i);if(r=u.that.__zoom,u.touch1){var h=u.touch0[0],f=u.touch0[1],d=u.touch1[0],p=u.touch1[1],g=(g=d[0]-h[0])*g+(g=d[1]-h[1])*g,y=(y=p[0]-f[0])*y+(y=p[1]-f[1])*y;r=_(r,Math.sqrt(g/y)),i=[(h[0]+d[0])/2,(h[1]+d[1])/2],a=[(f[0]+p[0])/2,(f[1]+p[1])/2]}else{if(!u.touch0)return;i=u.touch0[0],a=u.touch0[1]}u.zoom("touch",o(m(r,i,a),u.extent,l))}}function E(t,...r){if(this.__zooming){var i,o,a=w(this,r).event(t),u=t.changedTouches,s=u.length;for(Ze(t),e&&clearTimeout(e),e=setTimeout((function(){e=null}),d),i=0;i<s;++i)o=u[i],a.touch0&&a.touch0[2]===o.identifier?delete a.touch0:a.touch1&&a.touch1[2]===o.identifier&&delete a.touch1;if(a.touch1&&!a.touch0&&(a.touch0=a.touch1,delete a.touch1),a.touch0)a.touch0[1]=this.__zoom.invert(a.touch0[0]);else if(a.end(),2===a.taps&&(o=At(o,this),Math.hypot(n[0]-o[0],n[1]-o[1])<y)){var l=zt(this).on("dblclick.zoom");l&&l.apply(this,arguments)}}}return v.transform=function(t,n,e,r){var i=t.selection?t.selection():t;i.property("__zoom",tr),t!==i?b(t,n,e,r):i.interrupt().each((function(){w(this,arguments).event(r).start().zoom(null,"function"==typeof n?n.apply(this,arguments):n).end()}))},v.scaleBy=function(t,n,e,r){v.scaleTo(t,(function(){return this.__zoom.k*("function"==typeof n?n.apply(this,arguments):n)}),e,r)},v.scaleTo=function(t,n,e,r){v.transform(t,(function(){var t=i.apply(this,arguments),r=this.__zoom,a=null==e?x(t):"function"==typeof e?e.apply(this,arguments):e,u=r.invert(a),s="function"==typeof n?n.apply(this,arguments):n;return o(m(_(r,s),a,u),t,l)}),e,r)},v.translateBy=function(t,n,e,r){v.transform(t,(function(){return o(this.__zoom.translate("function"==typeof n?n.apply(this,arguments):n,"function"==typeof e?e.apply(this,arguments):e),i.apply(this,arguments),l)}),null,r)},v.translateTo=function(t,n,e,r,a){v.transform(t,(function(){var t=i.apply(this,arguments),a=this.__zoom,u=null==r?x(t):"function"==typeof r?r.apply(this,arguments):r;return o(Ye.translate(u[0],u[1]).scale(a.k).translate("function"==typeof n?-n.apply(this,arguments):-n,"function"==typeof e?-e.apply(this,arguments):-e),t,l)}),r,a)},k.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,n){return this.mouse&&"mouse"!==t&&(this.mouse[1]=n.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=n.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=n.invert(this.touch1[0])),this.that.__zoom=n,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var n=zt(this.that).datum();f.call(t,this.that,new Xe(t,{sourceEvent:this.sourceEvent,target:v,type:t,transform:this.that.__zoom,dispatch:f}),n)}},v.wheelDelta=function(t){return arguments.length?(a="function"==typeof t?t:Ve(+t),v):a},v.filter=function(t){return arguments.length?(r="function"==typeof t?t:Ve(!!t),v):r},v.touchable=function(t){return arguments.length?(u="function"==typeof t?t:Ve(!!t),v):u},v.extent=function(t){return arguments.length?(i="function"==typeof t?t:Ve([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),v):i},v.scaleExtent=function(t){return arguments.length?(s[0]=+t[0],s[1]=+t[1],v):[s[0],s[1]]},v.translateExtent=function(t){return arguments.length?(l[0][0]=+t[0][0],l[1][0]=+t[1][0],l[0][1]=+t[0][1],l[1][1]=+t[1][1],v):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},v.constrain=function(t){return arguments.length?(o=t,v):o},v.duration=function(t){return arguments.length?(c=+t,v):c},v.interpolate=function(t){return arguments.length?(h=t,v):h},v.on=function(){var t=f.on.apply(f,arguments);return t===f?v:t},v.clickDistance=function(t){return arguments.length?(g=(t=+t)*t,v):Math.sqrt(g)},v.tapDistance=function(t){return arguments.length?(y=+t,v):y},v}We.prototype=Ge.prototype;class or extends Map{constructor(t,n=ur){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),null!=t)for(const[n,e]of t)this.set(n,e)}get(t){return super.get(ar(this,t))}has(t){return super.has(ar(this,t))}set(t,n){return super.set(function({_intern:t,_key:n},e){const r=n(e);return t.has(r)?t.get(r):(t.set(r,e),e)}(this,t),n)}delete(t){return super.delete(function({_intern:t,_key:n},e){const r=n(e);t.has(r)&&(e=t.get(r),t.delete(r));return e}(this,t))}}function ar({_intern:t,_key:n},e){const r=n(e);return t.has(r)?t.get(r):e}function ur(t){return null!==t&&"object"==typeof t?t.valueOf():t}function sr(t,n){let e;if(void 0===n)for(const n of t)null!=n&&(e<n||void 0===e&&n>=n)&&(e=n);else{let r=-1;for(let i of t)null!=(i=n(i,++r,t))&&(e<i||void 0===e&&i>=i)&&(e=i)}return e}function lr(t,n){let e;if(void 0===n)for(const n of t)null!=n&&(e>n||void 0===e&&n>=n)&&(e=n);else{let r=-1;for(let i of t)null!=(i=n(i,++r,t))&&(e>i||void 0===e&&i>=i)&&(e=i)}return e}var cr="object"==typeof global&&global&&global.Object===Object&&global,hr="object"==typeof self&&self&&self.Object===Object&&self,fr=cr||hr||Function("return this")(),dr=fr.Symbol,pr=Object.prototype,gr=pr.hasOwnProperty,yr=pr.toString,vr=dr?dr.toStringTag:void 0;var _r=Object.prototype.toString;var mr="[object Null]",xr="[object Undefined]",br=dr?dr.toStringTag:void 0;function wr(t){return null==t?void 0===t?xr:mr:br&&br in Object(t)?function(t){var n=gr.call(t,vr),e=t[vr];try{t[vr]=void 0;var r=!0}catch(t){}var i=yr.call(t);return r&&(n?t[vr]=e:delete t[vr]),i}(t):function(t){return _r.call(t)}(t)}var kr="[object Symbol]";var Mr=/\s/;var zr=/^\s+/;function Ar(t){return t?t.slice(0,function(t){for(var n=t.length;n--&&Mr.test(t.charAt(n)););return n}(t)+1).replace(zr,""):t}function Sr(t){var n=typeof t;return null!=t&&("object"==n||"function"==n)}var Cr=NaN,Er=/^[-+]0x[0-9a-f]+$/i,Or=/^0b[01]+$/i,Nr=/^0o[0-7]+$/i,Pr=parseInt;function jr(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return null!=t&&"object"==typeof t}(t)&&wr(t)==kr}(t))return Cr;if(Sr(t)){var n="function"==typeof t.valueOf?t.valueOf():t;t=Sr(n)?n+"":n}if("string"!=typeof t)return 0===t?t:+t;t=Ar(t);var e=Or.test(t);return e||Nr.test(t)?Pr(t.slice(2),e?2:8):Er.test(t)?Cr:+t}var Tr=function(){return fr.Date.now()},Rr="Expected a function",Dr=Math.max,Ir=Math.min;function Ur(t,n,e){var r,i,o,a,u,s,l=0,c=!1,h=!1,f=!0;if("function"!=typeof t)throw new TypeError(Rr);function d(n){var e=r,o=i;return r=i=void 0,l=n,a=t.apply(o,e)}function p(t){var e=t-s;return void 0===s||e>=n||e<0||h&&t-l>=o}function g(){var t=Tr();if(p(t))return y(t);u=setTimeout(g,function(t){var e=n-(t-s);return h?Ir(e,o-(t-l)):e}(t))}function y(t){return u=void 0,f&&r?d(t):(r=i=void 0,a)}function v(){var t=Tr(),e=p(t);if(r=arguments,i=this,s=t,e){if(void 0===u)return function(t){return l=t,u=setTimeout(g,n),c?d(t):a}(s);if(h)return clearTimeout(u),u=setTimeout(g,n),d(s)}return void 0===u&&(u=setTimeout(g,n)),a}return n=jr(n)||0,Sr(e)&&(c=!!e.leading,o=(h="maxWait"in e)?Dr(jr(e.maxWait)||0,n):o,f="trailing"in e?!!e.trailing:f),v.cancel=function(){void 0!==u&&clearTimeout(u),l=0,r=s=i=u=void 0},v.flush=function(){return void 0===u?a:y(Tr())},v}var Fr=Object.freeze({Linear:Object.freeze({None:function(t){return t},In:function(t){return this.None(t)},Out:function(t){return this.None(t)},InOut:function(t){return this.None(t)}}),Quadratic:Object.freeze({In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}}),Cubic:Object.freeze({In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}}),Quartic:Object.freeze({In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}}),Quintic:Object.freeze({In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}}),Sinusoidal:Object.freeze({In:function(t){return 1-Math.sin((1-t)*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.sin(Math.PI*(.5-t)))}}),Exponential:Object.freeze({In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}}),Circular:Object.freeze({In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}}),Elastic:Object.freeze({In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}}),Back:Object.freeze({In:function(t){var n=1.70158;return 1===t?1:t*t*((n+1)*t-n)},Out:function(t){var n=1.70158;return 0===t?0:--t*t*((n+1)*t+n)+1},InOut:function(t){var n=2.5949095;return(t*=2)<1?t*t*((n+1)*t-n)*.5:.5*((t-=2)*t*((n+1)*t+n)+2)}}),Bounce:Object.freeze({In:function(t){return 1-Fr.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*Fr.Bounce.In(2*t):.5*Fr.Bounce.Out(2*t-1)+.5}}),generatePow:function(t){return void 0===t&&(t=4),t=(t=t<Number.EPSILON?Number.EPSILON:t)>1e4?1e4:t,{In:function(n){return Math.pow(n,t)},Out:function(n){return 1-Math.pow(1-n,t)},InOut:function(n){return n<.5?Math.pow(2*n,t)/2:(1-Math.pow(2-2*n,t))/2+.5}}}}),Lr=function(){return performance.now()},qr=function(){function t(){this._tweens={},this._tweensAddedDuringUpdate={}}return t.prototype.getAll=function(){var t=this;return Object.keys(this._tweens).map((function(n){return t._tweens[n]}))},t.prototype.removeAll=function(){this._tweens={}},t.prototype.add=function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},t.prototype.remove=function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},t.prototype.update=function(t,n){void 0===t&&(t=Lr()),void 0===n&&(n=!1);var e=Object.keys(this._tweens);if(0===e.length)return!1;for(;e.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<e.length;r++){var i=this._tweens[e[r]],o=!n;i&&!1===i.update(t,o)&&!n&&delete this._tweens[e[r]]}e=Object.keys(this._tweensAddedDuringUpdate)}return!0},t}(),Br={Linear:function(t,n){var e=t.length-1,r=e*n,i=Math.floor(r),o=Br.Utils.Linear;return n<0?o(t[0],t[1],r):n>1?o(t[e],t[e-1],e-r):o(t[i],t[i+1>e?e:i+1],r-i)},Bezier:function(t,n){for(var e=0,r=t.length-1,i=Math.pow,o=Br.Utils.Bernstein,a=0;a<=r;a++)e+=i(1-n,r-a)*i(n,a)*t[a]*o(r,a);return e},CatmullRom:function(t,n){var e=t.length-1,r=e*n,i=Math.floor(r),o=Br.Utils.CatmullRom;return t[0]===t[e]?(n<0&&(i=Math.floor(r=e*(1+n))),o(t[(i-1+e)%e],t[i],t[(i+1)%e],t[(i+2)%e],r-i)):n<0?t[0]-(o(t[0],t[0],t[1],t[1],-r)-t[0]):n>1?t[e]-(o(t[e],t[e],t[e-1],t[e-1],r-e)-t[e]):o(t[i?i-1:0],t[i],t[e<i+1?e:i+1],t[e<i+2?e:i+2],r-i)},Utils:{Linear:function(t,n,e){return(n-t)*e+t},Bernstein:function(t,n){var e=Br.Utils.Factorial;return e(t)/e(n)/e(t-n)},Factorial:function(){var t=[1];return function(n){var e=1;if(t[n])return t[n];for(var r=n;r>1;r--)e*=r;return t[n]=e,e}}(),CatmullRom:function(t,n,e,r,i){var o=.5*(e-t),a=.5*(r-n),u=i*i;return(2*n-2*e+o+a)*(i*u)+(-3*n+3*e-2*o-a)*u+o*i+n}}},$r=function(){function t(){}return t.nextId=function(){return t._nextId++},t._nextId=0,t}(),Hr=new qr,Vr=function(){function t(t,n){void 0===n&&(n=Hr),this._object=t,this._group=n,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=Fr.Linear.None,this._interpolationFunction=Br.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=$r.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return t.prototype.getId=function(){return this._id},t.prototype.isPlaying=function(){return this._isPlaying},t.prototype.isPaused=function(){return this._isPaused},t.prototype.getDuration=function(){return this._duration},t.prototype.to=function(t,n){if(void 0===n&&(n=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=t,this._propertiesAreSetUp=!1,this._duration=n<0?0:n,this},t.prototype.duration=function(t){return void 0===t&&(t=1e3),this._duration=t<0?0:t,this},t.prototype.dynamic=function(t){return void 0===t&&(t=!1),this._isDynamic=t,this},t.prototype.start=function(t,n){if(void 0===t&&(t=Lr()),void 0===n&&(n=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var e in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(e),this._valuesStart[e]=this._valuesStartRepeat[e];if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=t,this._startTime+=this._delayTime,!this._propertiesAreSetUp||n){if(this._propertiesAreSetUp=!0,!this._isDynamic){var r={};for(var i in this._valuesEnd)r[i]=this._valuesEnd[i];this._valuesEnd=r}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,n)}return this},t.prototype.startFromCurrentValues=function(t){return this.start(t,!0)},t.prototype._setupProperties=function(t,n,e,r,i){for(var o in e){var a=t[o],u=Array.isArray(a),s=u?"array":typeof a,l=!u&&Array.isArray(e[o]);if("undefined"!==s&&"function"!==s){if(l){if(0===(y=e[o]).length)continue;for(var c=[a],h=0,f=y.length;h<f;h+=1){var d=this._handleRelativeValue(a,y[h]);if(isNaN(d)){l=!1,console.warn("Found invalid interpolation list. Skipping.");break}c.push(d)}l&&(e[o]=c)}if("object"!==s&&!u||!a||l)(void 0===n[o]||i)&&(n[o]=a),u||(n[o]*=1),r[o]=l?e[o].slice().reverse():n[o]||0;else{n[o]=u?[]:{};var p=a;for(var g in p)n[o][g]=p[g];r[o]=u?[]:{};var y=e[o];if(!this._isDynamic){var v={};for(var g in y)v[g]=y[g];e[o]=y=v}this._setupProperties(p,n[o],y,r[o],i)}}}},t.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},t.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},t.prototype.pause=function(t){return void 0===t&&(t=Lr()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=t,this._group&&this._group.remove(this)),this},t.prototype.resume=function(t){return void 0===t&&(t=Lr()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=t-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},t.prototype.stopChainedTweens=function(){for(var t=0,n=this._chainedTweens.length;t<n;t++)this._chainedTweens[t].stop();return this},t.prototype.group=function(t){return void 0===t&&(t=Hr),this._group=t,this},t.prototype.delay=function(t){return void 0===t&&(t=0),this._delayTime=t,this},t.prototype.repeat=function(t){return void 0===t&&(t=0),this._initialRepeat=t,this._repeat=t,this},t.prototype.repeatDelay=function(t){return this._repeatDelayTime=t,this},t.prototype.yoyo=function(t){return void 0===t&&(t=!1),this._yoyo=t,this},t.prototype.easing=function(t){return void 0===t&&(t=Fr.Linear.None),this._easingFunction=t,this},t.prototype.interpolation=function(t){return void 0===t&&(t=Br.Linear),this._interpolationFunction=t,this},t.prototype.chain=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this._chainedTweens=t,this},t.prototype.onStart=function(t){return this._onStartCallback=t,this},t.prototype.onEveryStart=function(t){return this._onEveryStartCallback=t,this},t.prototype.onUpdate=function(t){return this._onUpdateCallback=t,this},t.prototype.onRepeat=function(t){return this._onRepeatCallback=t,this},t.prototype.onComplete=function(t){return this._onCompleteCallback=t,this},t.prototype.onStop=function(t){return this._onStopCallback=t,this},t.prototype.update=function(t,n){var e,r,i=this;if(void 0===t&&(t=Lr()),void 0===n&&(n=!0),this._isPaused)return!0;var o=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(t>o)return!1;n&&this.start(t,!0)}if(this._goToEnd=!1,t<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),!1===this._onEveryStartCallbackFired&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var a=t-this._startTime,u=this._duration+(null!==(e=this._repeatDelayTime)&&void 0!==e?e:this._delayTime),s=this._duration+this._repeat*u,l=function(){if(0===i._duration)return 1;if(a>s)return 1;var t=Math.trunc(a/u),n=a-t*u,e=Math.min(n/i._duration,1);return 0===e&&a===i._duration?1:e}(),c=this._easingFunction(l);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,c),this._onUpdateCallback&&this._onUpdateCallback(this._object,l),0===this._duration||a>=this._duration){if(this._repeat>0){var h=Math.min(Math.trunc((a-this._duration)/u)+1,this._repeat);for(r in isFinite(this._repeat)&&(this._repeat-=h),this._valuesStartRepeat)this._yoyo||"string"!=typeof this._valuesEnd[r]||(this._valuesStartRepeat[r]=this._valuesStartRepeat[r]+parseFloat(this._valuesEnd[r])),this._yoyo&&this._swapEndStartRepeatValues(r),this._valuesStart[r]=this._valuesStartRepeat[r];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=u*h,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var f=0,d=this._chainedTweens.length;f<d;f++)this._chainedTweens[f].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},t.prototype._updateProperties=function(t,n,e,r){for(var i in e)if(void 0!==n[i]){var o=n[i]||0,a=e[i],u=Array.isArray(t[i]),s=Array.isArray(a);!u&&s?t[i]=this._interpolationFunction(a,r):"object"==typeof a&&a?this._updateProperties(t[i],o,a,r):"number"==typeof(a=this._handleRelativeValue(o,a))&&(t[i]=o+(a-o)*r)}},t.prototype._handleRelativeValue=function(t,n){return"string"!=typeof n?n:"+"===n.charAt(0)||"-"===n.charAt(0)?t+parseFloat(n):parseFloat(n)},t.prototype._swapEndStartRepeatValues=function(t){var n=this._valuesStartRepeat[t],e=this._valuesEnd[t];this._valuesStartRepeat[t]="string"==typeof e?this._valuesStartRepeat[t]+parseFloat(e):this._valuesEnd[t],this._valuesEnd[t]=n},t}(),Xr=Hr;Xr.getAll.bind(Xr),Xr.removeAll.bind(Xr),Xr.add.bind(Xr),Xr.remove.bind(Xr);var Gr=Xr.update.bind(Xr);function Yr(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(i=r.key,o=void 0,"symbol"==typeof(o=function(t,n){if("object"!=typeof t||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(i,"string"))?o:String(o)),r)}var i,o}function Wr(t,n,e){return n&&Yr(t.prototype,n),e&&Yr(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Zr(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,i,o,a,u=[],s=!0,l=!1;try{if(o=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;s=!1}else for(;!(s=(r=o.call(e)).done)&&(u.push(r.value),u.length!==n);s=!0);}catch(t){l=!0,i=t}finally{try{if(!s&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(l)throw i}}return u}}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return Qr(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Qr(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qr(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var Kr=Wr((function t(n,e){var r=e.default,i=void 0===r?null:r,o=e.triggerUpdate,a=void 0===o||o,u=e.onChange,s=void 0===u?function(t,n){}:u;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.name=n,this.defaultVal=i,this.triggerUpdate=a,this.onChange=s}));function Jr(t){var n=t.stateInit,e=void 0===n?function(){return{}}:n,r=t.props,i=void 0===r?{}:r,o=t.methods,a=void 0===o?{}:o,u=t.aliases,s=void 0===u?{}:u,l=t.init,c=void 0===l?function(){}:l,h=t.update,f=void 0===h?function(){}:h,d=Object.keys(i).map((function(t){return new Kr(t,i[t])}));return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=Object.assign({},e instanceof Function?e(t):e,{initialised:!1}),r={};function i(n){return o(n,t),u(),i}var o=function(t,e){c.call(i,t,n,e),n.initialised=!0},u=Ur((function(){n.initialised&&(f.call(i,n,r),r={})}),1);return d.forEach((function(t){i[t.name]=function(t){var e=t.name,o=t.triggerUpdate,a=void 0!==o&&o,s=t.onChange,l=void 0===s?function(t,n){}:s,c=t.defaultVal,h=void 0===c?null:c;return function(t){var o=n[e];if(!arguments.length)return o;var s=void 0===t?h:t;return n[e]=s,l.call(i,s,n,o),!r.hasOwnProperty(e)&&(r[e]=o),a&&u(),i}}(t)})),Object.keys(a).forEach((function(t){i[t]=function(){for(var e,r=arguments.length,o=new Array(r),u=0;u<r;u++)o[u]=arguments[u];return(e=a[t]).call.apply(e,[i,n].concat(o))}})),Object.entries(s).forEach((function(t){var n=Zr(t,2),e=n[0],r=n[1];return i[e]=i[r]})),i.resetProps=function(){return d.forEach((function(t){i[t.name](t.defaultVal)})),i},i.resetProps(),n._rerender=u,i}}var ti=function(t){return"function"==typeof t?t:"string"==typeof t?function(n){return n[t]}:function(n){return t}};function ni(t){return ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ni(t)}var ei=/^\s+/,ri=/\s+$/;function ii(t,n){if(n=n||{},(t=t||"")instanceof ii)return t;if(!(this instanceof ii))return new ii(t,n);var e=function(t){var n={r:0,g:0,b:0},e=1,r=null,i=null,o=null,a=!1,u=!1;"string"==typeof t&&(t=function(t){t=t.replace(ei,"").replace(ri,"").toLowerCase();var n,e=!1;if(bi[t])t=bi[t],e=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};if(n=Ti.rgb.exec(t))return{r:n[1],g:n[2],b:n[3]};if(n=Ti.rgba.exec(t))return{r:n[1],g:n[2],b:n[3],a:n[4]};if(n=Ti.hsl.exec(t))return{h:n[1],s:n[2],l:n[3]};if(n=Ti.hsla.exec(t))return{h:n[1],s:n[2],l:n[3],a:n[4]};if(n=Ti.hsv.exec(t))return{h:n[1],s:n[2],v:n[3]};if(n=Ti.hsva.exec(t))return{h:n[1],s:n[2],v:n[3],a:n[4]};if(n=Ti.hex8.exec(t))return{r:Ai(n[1]),g:Ai(n[2]),b:Ai(n[3]),a:Oi(n[4]),format:e?"name":"hex8"};if(n=Ti.hex6.exec(t))return{r:Ai(n[1]),g:Ai(n[2]),b:Ai(n[3]),format:e?"name":"hex"};if(n=Ti.hex4.exec(t))return{r:Ai(n[1]+""+n[1]),g:Ai(n[2]+""+n[2]),b:Ai(n[3]+""+n[3]),a:Oi(n[4]+""+n[4]),format:e?"name":"hex8"};if(n=Ti.hex3.exec(t))return{r:Ai(n[1]+""+n[1]),g:Ai(n[2]+""+n[2]),b:Ai(n[3]+""+n[3]),format:e?"name":"hex"};return!1}(t));"object"==ni(t)&&(Ri(t.r)&&Ri(t.g)&&Ri(t.b)?(s=t.r,l=t.g,c=t.b,n={r:255*Mi(s,255),g:255*Mi(l,255),b:255*Mi(c,255)},a=!0,u="%"===String(t.r).substr(-1)?"prgb":"rgb"):Ri(t.h)&&Ri(t.s)&&Ri(t.v)?(r=Ci(t.s),i=Ci(t.v),n=function(t,n,e){t=6*Mi(t,360),n=Mi(n,100),e=Mi(e,100);var r=Math.floor(t),i=t-r,o=e*(1-n),a=e*(1-i*n),u=e*(1-(1-i)*n),s=r%6,l=[e,a,o,o,u,e][s],c=[u,e,e,a,o,o][s],h=[o,o,u,e,e,a][s];return{r:255*l,g:255*c,b:255*h}}(t.h,r,i),a=!0,u="hsv"):Ri(t.h)&&Ri(t.s)&&Ri(t.l)&&(r=Ci(t.s),o=Ci(t.l),n=function(t,n,e){var r,i,o;function a(t,n,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?t+6*(n-t)*e:e<.5?n:e<2/3?t+(n-t)*(2/3-e)*6:t}if(t=Mi(t,360),n=Mi(n,100),e=Mi(e,100),0===n)r=i=o=e;else{var u=e<.5?e*(1+n):e+n-e*n,s=2*e-u;r=a(s,u,t+1/3),i=a(s,u,t),o=a(s,u,t-1/3)}return{r:255*r,g:255*i,b:255*o}}(t.h,r,o),a=!0,u="hsl"),t.hasOwnProperty("a")&&(e=t.a));var s,l,c;return e=ki(e),{ok:a,format:t.format||u,r:Math.min(255,Math.max(n.r,0)),g:Math.min(255,Math.max(n.g,0)),b:Math.min(255,Math.max(n.b,0)),a:e}}(t);this._originalInput=t,this._r=e.r,this._g=e.g,this._b=e.b,this._a=e.a,this._roundA=Math.round(100*this._a)/100,this._format=n.format||e.format,this._gradientType=n.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=e.ok}function oi(t,n,e){t=Mi(t,255),n=Mi(n,255),e=Mi(e,255);var r,i,o=Math.max(t,n,e),a=Math.min(t,n,e),u=(o+a)/2;if(o==a)r=i=0;else{var s=o-a;switch(i=u>.5?s/(2-o-a):s/(o+a),o){case t:r=(n-e)/s+(n<e?6:0);break;case n:r=(e-t)/s+2;break;case e:r=(t-n)/s+4}r/=6}return{h:r,s:i,l:u}}function ai(t,n,e){t=Mi(t,255),n=Mi(n,255),e=Mi(e,255);var r,i,o=Math.max(t,n,e),a=Math.min(t,n,e),u=o,s=o-a;if(i=0===o?0:s/o,o==a)r=0;else{switch(o){case t:r=(n-e)/s+(n<e?6:0);break;case n:r=(e-t)/s+2;break;case e:r=(t-n)/s+4}r/=6}return{h:r,s:i,v:u}}function ui(t,n,e,r){var i=[Si(Math.round(t).toString(16)),Si(Math.round(n).toString(16)),Si(Math.round(e).toString(16))];return r&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function si(t,n,e,r){return[Si(Ei(r)),Si(Math.round(t).toString(16)),Si(Math.round(n).toString(16)),Si(Math.round(e).toString(16))].join("")}function li(t,n){n=0===n?0:n||10;var e=ii(t).toHsl();return e.s-=n/100,e.s=zi(e.s),ii(e)}function ci(t,n){n=0===n?0:n||10;var e=ii(t).toHsl();return e.s+=n/100,e.s=zi(e.s),ii(e)}function hi(t){return ii(t).desaturate(100)}function fi(t,n){n=0===n?0:n||10;var e=ii(t).toHsl();return e.l+=n/100,e.l=zi(e.l),ii(e)}function di(t,n){n=0===n?0:n||10;var e=ii(t).toRgb();return e.r=Math.max(0,Math.min(255,e.r-Math.round(-n/100*255))),e.g=Math.max(0,Math.min(255,e.g-Math.round(-n/100*255))),e.b=Math.max(0,Math.min(255,e.b-Math.round(-n/100*255))),ii(e)}function pi(t,n){n=0===n?0:n||10;var e=ii(t).toHsl();return e.l-=n/100,e.l=zi(e.l),ii(e)}function gi(t,n){var e=ii(t).toHsl(),r=(e.h+n)%360;return e.h=r<0?360+r:r,ii(e)}function yi(t){var n=ii(t).toHsl();return n.h=(n.h+180)%360,ii(n)}function vi(t,n){if(isNaN(n)||n<=0)throw new Error("Argument to polyad must be a positive number");for(var e=ii(t).toHsl(),r=[ii(t)],i=360/n,o=1;o<n;o++)r.push(ii({h:(e.h+o*i)%360,s:e.s,l:e.l}));return r}function _i(t){var n=ii(t).toHsl(),e=n.h;return[ii(t),ii({h:(e+72)%360,s:n.s,l:n.l}),ii({h:(e+216)%360,s:n.s,l:n.l})]}function mi(t,n,e){n=n||6,e=e||30;var r=ii(t).toHsl(),i=360/e,o=[ii(t)];for(r.h=(r.h-(i*n>>1)+720)%360;--n;)r.h=(r.h+i)%360,o.push(ii(r));return o}function xi(t,n){n=n||6;for(var e=ii(t).toHsv(),r=e.h,i=e.s,o=e.v,a=[],u=1/n;n--;)a.push(ii({h:r,s:i,v:o})),o=(o+u)%1;return a}ii.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},getLuminance:function(){var t,n,e,r=this.toRgb();return t=r.r/255,n=r.g/255,e=r.b/255,.2126*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.0722*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))},setAlpha:function(t){return this._a=ki(t),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var t=ai(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=ai(this._r,this._g,this._b),n=Math.round(360*t.h),e=Math.round(100*t.s),r=Math.round(100*t.v);return 1==this._a?"hsv("+n+", "+e+"%, "+r+"%)":"hsva("+n+", "+e+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var t=oi(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=oi(this._r,this._g,this._b),n=Math.round(360*t.h),e=Math.round(100*t.s),r=Math.round(100*t.l);return 1==this._a?"hsl("+n+", "+e+"%, "+r+"%)":"hsla("+n+", "+e+"%, "+r+"%, "+this._roundA+")"},toHex:function(t){return ui(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(t){return function(t,n,e,r,i){var o=[Si(Math.round(t).toString(16)),Si(Math.round(n).toString(16)),Si(Math.round(e).toString(16)),Si(Ei(r))];if(i&&o[0].charAt(0)==o[0].charAt(1)&&o[1].charAt(0)==o[1].charAt(1)&&o[2].charAt(0)==o[2].charAt(1)&&o[3].charAt(0)==o[3].charAt(1))return o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0)+o[3].charAt(0);return o.join("")}(this._r,this._g,this._b,this._a,t)},toHex8String:function(t){return"#"+this.toHex8(t)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(100*Mi(this._r,255))+"%",g:Math.round(100*Mi(this._g,255))+"%",b:Math.round(100*Mi(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+Math.round(100*Mi(this._r,255))+"%, "+Math.round(100*Mi(this._g,255))+"%, "+Math.round(100*Mi(this._b,255))+"%)":"rgba("+Math.round(100*Mi(this._r,255))+"%, "+Math.round(100*Mi(this._g,255))+"%, "+Math.round(100*Mi(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(wi[ui(this._r,this._g,this._b,!0)]||!1)},toFilter:function(t){var n="#"+si(this._r,this._g,this._b,this._a),e=n,r=this._gradientType?"GradientType = 1, ":"";if(t){var i=ii(t);e="#"+si(i._r,i._g,i._b,i._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+n+",endColorstr="+e+")"},toString:function(t){var n=!!t;t=t||this._format;var e=!1,r=this._a<1&&this._a>=0;return n||!r||"hex"!==t&&"hex6"!==t&&"hex3"!==t&&"hex4"!==t&&"hex8"!==t&&"name"!==t?("rgb"===t&&(e=this.toRgbString()),"prgb"===t&&(e=this.toPercentageRgbString()),"hex"!==t&&"hex6"!==t||(e=this.toHexString()),"hex3"===t&&(e=this.toHexString(!0)),"hex4"===t&&(e=this.toHex8String(!0)),"hex8"===t&&(e=this.toHex8String()),"name"===t&&(e=this.toName()),"hsl"===t&&(e=this.toHslString()),"hsv"===t&&(e=this.toHsvString()),e||this.toHexString()):"name"===t&&0===this._a?this.toName():this.toRgbString()},clone:function(){return ii(this.toString())},_applyModification:function(t,n){var e=t.apply(null,[this].concat([].slice.call(n)));return this._r=e._r,this._g=e._g,this._b=e._b,this.setAlpha(e._a),this},lighten:function(){return this._applyModification(fi,arguments)},brighten:function(){return this._applyModification(di,arguments)},darken:function(){return this._applyModification(pi,arguments)},desaturate:function(){return this._applyModification(li,arguments)},saturate:function(){return this._applyModification(ci,arguments)},greyscale:function(){return this._applyModification(hi,arguments)},spin:function(){return this._applyModification(gi,arguments)},_applyCombination:function(t,n){return t.apply(null,[this].concat([].slice.call(n)))},analogous:function(){return this._applyCombination(mi,arguments)},complement:function(){return this._applyCombination(yi,arguments)},monochromatic:function(){return this._applyCombination(xi,arguments)},splitcomplement:function(){return this._applyCombination(_i,arguments)},triad:function(){return this._applyCombination(vi,[3])},tetrad:function(){return this._applyCombination(vi,[4])}},ii.fromRatio=function(t,n){if("object"==ni(t)){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[r]="a"===r?t[r]:Ci(t[r]));t=e}return ii(t,n)},ii.equals=function(t,n){return!(!t||!n)&&ii(t).toRgbString()==ii(n).toRgbString()},ii.random=function(){return ii.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})},ii.mix=function(t,n,e){e=0===e?0:e||50;var r=ii(t).toRgb(),i=ii(n).toRgb(),o=e/100;return ii({r:(i.r-r.r)*o+r.r,g:(i.g-r.g)*o+r.g,b:(i.b-r.b)*o+r.b,a:(i.a-r.a)*o+r.a})},
// <http://www.w3.org/TR/2008/REC-WCAG20-20081211/#contrast-ratiodef (WCAG Version 2)
// Analyze the 2 colors and returns the color contrast defined by (WCAG Version 2)
ii.readability=function(t,n){var e=ii(t),r=ii(n);return(Math.max(e.getLuminance(),r.getLuminance())+.05)/(Math.min(e.getLuminance(),r.getLuminance())+.05)},ii.isReadable=function(t,n,e){var r,i,o=ii.readability(t,n);switch(i=!1,(r=function(t){var n,e;n=((t=t||{level:"AA",size:"small"}).level||"AA").toUpperCase(),e=(t.size||"small").toLowerCase(),"AA"!==n&&"AAA"!==n&&(n="AA");"small"!==e&&"large"!==e&&(e="small");return{level:n,size:e}}(e)).level+r.size){case"AAsmall":case"AAAlarge":i=o>=4.5;break;case"AAlarge":i=o>=3;break;case"AAAsmall":i=o>=7}return i},ii.mostReadable=function(t,n,e){var r,i,o,a,u=null,s=0;i=(e=e||{}).includeFallbackColors,o=e.level,a=e.size;for(var l=0;l<n.length;l++)(r=ii.readability(t,n[l]))>s&&(s=r,u=ii(n[l]));return ii.isReadable(t,u,{level:o,size:a})||!i?u:(e.includeFallbackColors=!1,ii.mostReadable(t,["#fff","#000"],e))};var bi=ii.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},wi=ii.hexNames=function(t){var n={};for(var e in t)t.hasOwnProperty(e)&&(n[t[e]]=e);return n}(bi);function ki(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function Mi(t,n){(function(t){return"string"==typeof t&&-1!=t.indexOf(".")&&1===parseFloat(t)})(t)&&(t="100%");var e=function(t){return"string"==typeof t&&-1!=t.indexOf("%")}(t);return t=Math.min(n,Math.max(0,parseFloat(t))),e&&(t=parseInt(t*n,10)/100),Math.abs(t-n)<1e-6?1:t%n/parseFloat(n)}function zi(t){return Math.min(1,Math.max(0,t))}function Ai(t){return parseInt(t,16)}function Si(t){return 1==t.length?"0"+t:""+t}function Ci(t){return t<=1&&(t=100*t+"%"),t}function Ei(t){return Math.round(255*parseFloat(t)).toString(16)}function Oi(t){return Ai(t)/255}var Ni,Pi,ji,Ti=(Pi="[\\s|\\(]+("+(Ni="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+Ni+")[,|\\s]+("+Ni+")\\s*\\)?",ji="[\\s|\\(]+("+Ni+")[,|\\s]+("+Ni+")[,|\\s]+("+Ni+")[,|\\s]+("+Ni+")\\s*\\)?",{CSS_UNIT:new RegExp(Ni),rgb:new RegExp("rgb"+Pi),rgba:new RegExp("rgba"+ji),hsl:new RegExp("hsl"+Pi),hsla:new RegExp("hsla"+ji),hsv:new RegExp("hsv"+Pi),hsva:new RegExp("hsva"+ji),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function Ri(t){return!!Ti.CSS_UNIT.exec(t)}function Di(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(i=r.key,o=void 0,"symbol"==typeof(o=function(t,n){if("object"!=typeof t||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(i,"string"))?o:String(o)),r)}var i,o}function Ii(t){return function(t){if(Array.isArray(t))return Ui(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(!t)return;if("string"==typeof t)return Ui(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Ui(t,n)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ui(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var Fi=function(t,n,e){return(t<<16)+(n<<8)+e},Li=function(t,n){return 123*t%Math.pow(2,n)},qi=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.csBits=n,this.registry=["__reserved for background__"]}var n,e,r;return n=t,e=[{key:"register",value:function(t){if(this.registry.length>=Math.pow(2,24-this.csBits))return null;var n,e=this.registry.length,r=Li(e,this.csBits),i=(n=e+(r<<24-this.csBits),"#".concat(Math.min(n,Math.pow(2,24)).toString(16).padStart(6,"0")));return this.registry.push(t),i}},{key:"lookup",value:function(t){var n,e,r,i,o="string"==typeof t?(n=ii(t).toRgb(),e=n.r,r=n.g,i=n.b,Fi(e,r,i)):Fi.apply(void 0,Ii(t));if(!o)return null;var a=o&Math.pow(2,24-this.csBits)-1,u=o>>24-this.csBits&Math.pow(2,this.csBits)-1;return Li(a,this.csBits)!==u||a>=this.registry.length?null:this.registry[a]}}],e&&Di(n.prototype,e),r&&Di(n,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function Bi(t,n,e){var r,i=1;function o(){var o,a,u=r.length,s=0,l=0,c=0;for(o=0;o<u;++o)s+=(a=r[o]).x||0,l+=a.y||0,c+=a.z||0;for(s=(s/u-t)*i,l=(l/u-n)*i,c=(c/u-e)*i,o=0;o<u;++o)a=r[o],s&&(a.x-=s),l&&(a.y-=l),c&&(a.z-=c)}return null==t&&(t=0),null==n&&(n=0),null==e&&(e=0),o.initialize=function(t){r=t},o.x=function(n){return arguments.length?(t=+n,o):t},o.y=function(t){return arguments.length?(n=+t,o):n},o.z=function(t){return arguments.length?(e=+t,o):e},o.strength=function(t){return arguments.length?(i=+t,o):i},o}function $i(t,n,e){if(isNaN(n))return t;var r,i,o,a,u,s,l=t._root,c={data:e},h=t._x0,f=t._x1;if(!l)return t._root=c,t;for(;l.length;)if((a=n>=(i=(h+f)/2))?h=i:f=i,r=l,!(l=l[u=+a]))return r[u]=c,t;if(n===(o=+t._x.call(null,l.data)))return c.next=l,r?r[u]=c:t._root=c,t;do{r=r?r[u]=new Array(2):t._root=new Array(2),(a=n>=(i=(h+f)/2))?h=i:f=i}while((u=+a)==(s=+(o>=i)));return r[s]=l,r[u]=c,t}function Hi(t,n,e){this.node=t,this.x0=n,this.x1=e}function Vi(t){return t[0]}function Xi(t,n){var e=new Gi(null==n?Vi:n,NaN,NaN);return null==t?e:e.addAll(t)}function Gi(t,n,e){this._x=t,this._x0=n,this._x1=e,this._root=void 0}function Yi(t){for(var n={data:t.data},e=n;t=t.next;)e=e.next={data:t.data};return n}var Wi=Xi.prototype=Gi.prototype;function Zi(t,n,e,r){if(isNaN(n)||isNaN(e))return t;var i,o,a,u,s,l,c,h,f,d=t._root,p={data:r},g=t._x0,y=t._y0,v=t._x1,_=t._y1;if(!d)return t._root=p,t;for(;d.length;)if((l=n>=(o=(g+v)/2))?g=o:v=o,(c=e>=(a=(y+_)/2))?y=a:_=a,i=d,!(d=d[h=c<<1|l]))return i[h]=p,t;if(u=+t._x.call(null,d.data),s=+t._y.call(null,d.data),n===u&&e===s)return p.next=d,i?i[h]=p:t._root=p,t;do{i=i?i[h]=new Array(4):t._root=new Array(4),(l=n>=(o=(g+v)/2))?g=o:v=o,(c=e>=(a=(y+_)/2))?y=a:_=a}while((h=c<<1|l)==(f=(s>=a)<<1|u>=o));return i[f]=d,i[h]=p,t}function Qi(t,n,e,r,i){this.node=t,this.x0=n,this.y0=e,this.x1=r,this.y1=i}function Ki(t){return t[0]}function Ji(t){return t[1]}function to(t,n,e){var r=new no(null==n?Ki:n,null==e?Ji:e,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function no(t,n,e,r,i,o){this._x=t,this._y=n,this._x0=e,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function eo(t){for(var n={data:t.data},e=n;t=t.next;)e=e.next={data:t.data};return n}Wi.copy=function(){var t,n,e=new Gi(this._x,this._x0,this._x1),r=this._root;if(!r)return e;if(!r.length)return e._root=Yi(r),e;for(t=[{source:r,target:e._root=new Array(2)}];r=t.pop();)for(var i=0;i<2;++i)(n=r.source[i])&&(n.length?t.push({source:n,target:r.target[i]=new Array(2)}):r.target[i]=Yi(n));return e},Wi.add=function(t){const n=+this._x.call(null,t);return $i(this.cover(n),n,t)},Wi.addAll=function(t){Array.isArray(t)||(t=Array.from(t));const n=t.length,e=new Float64Array(n);let r=1/0,i=-1/0;for(let o,a=0;a<n;++a)isNaN(o=+this._x.call(null,t[a]))||(e[a]=o,o<r&&(r=o),o>i&&(i=o));if(r>i)return this;this.cover(r).cover(i);for(let r=0;r<n;++r)$i(this,e[r],t[r]);return this},Wi.cover=function(t){if(isNaN(t=+t))return this;var n=this._x0,e=this._x1;if(isNaN(n))e=(n=Math.floor(t))+1;else{for(var r,i,o=e-n||1,a=this._root;n>t||t>=e;)switch(i=+(t<n),(r=new Array(2))[i]=a,a=r,o*=2,i){case 0:e=n+o;break;case 1:n=e-o}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._x1=e,this},Wi.data=function(){var t=[];return this.visit((function(n){if(!n.length)do{t.push(n.data)}while(n=n.next)})),t},Wi.extent=function(t){return arguments.length?this.cover(+t[0][0]).cover(+t[1][0]):isNaN(this._x0)?void 0:[[this._x0],[this._x1]]},Wi.find=function(t,n){var e,r,i,o,a,u=this._x0,s=this._x1,l=[],c=this._root;for(c&&l.push(new Hi(c,u,s)),null==n?n=1/0:(u=t-n,s=t+n);o=l.pop();)if(!(!(c=o.node)||(r=o.x0)>s||(i=o.x1)<u))if(c.length){var h=(r+i)/2;l.push(new Hi(c[1],h,i),new Hi(c[0],r,h)),(a=+(t>=h))&&(o=l[l.length-1],l[l.length-1]=l[l.length-1-a],l[l.length-1-a]=o)}else{var f=Math.abs(t-+this._x.call(null,c.data));f<n&&(n=f,u=t-f,s=t+f,e=c.data)}return e},Wi.remove=function(t){if(isNaN(o=+this._x.call(null,t)))return this;var n,e,r,i,o,a,u,s,l,c=this._root,h=this._x0,f=this._x1;if(!c)return this;if(c.length)for(;;){if((u=o>=(a=(h+f)/2))?h=a:f=a,n=c,!(c=c[s=+u]))return this;if(!c.length)break;n[s+1&1]&&(e=n,l=s)}for(;c.data!==t;)if(r=c,!(c=c.next))return this;return(i=c.next)&&delete c.next,r?(i?r.next=i:delete r.next,this):n?(i?n[s]=i:delete n[s],(c=n[0]||n[1])&&c===(n[1]||n[0])&&!c.length&&(e?e[l]=c:this._root=c),this):(this._root=i,this)},Wi.removeAll=function(t){for(var n=0,e=t.length;n<e;++n)this.remove(t[n]);return this},Wi.root=function(){return this._root},Wi.size=function(){var t=0;return this.visit((function(n){if(!n.length)do{++t}while(n=n.next)})),t},Wi.visit=function(t){var n,e,r,i,o=[],a=this._root;for(a&&o.push(new Hi(a,this._x0,this._x1));n=o.pop();)if(!t(a=n.node,r=n.x0,i=n.x1)&&a.length){var u=(r+i)/2;(e=a[1])&&o.push(new Hi(e,u,i)),(e=a[0])&&o.push(new Hi(e,r,u))}return this},Wi.visitAfter=function(t){var n,e=[],r=[];for(this._root&&e.push(new Hi(this._root,this._x0,this._x1));n=e.pop();){var i=n.node;if(i.length){var o,a=n.x0,u=n.x1,s=(a+u)/2;(o=i[0])&&e.push(new Hi(o,a,s)),(o=i[1])&&e.push(new Hi(o,s,u))}r.push(n)}for(;n=r.pop();)t(n.node,n.x0,n.x1);return this},Wi.x=function(t){return arguments.length?(this._x=t,this):this._x};var ro=to.prototype=no.prototype;function io(t,n,e,r,i){if(isNaN(n)||isNaN(e)||isNaN(r))return t;var o,a,u,s,l,c,h,f,d,p,g,y,v=t._root,_={data:i},m=t._x0,x=t._y0,b=t._z0,w=t._x1,k=t._y1,M=t._z1;if(!v)return t._root=_,t;for(;v.length;)if((f=n>=(a=(m+w)/2))?m=a:w=a,(d=e>=(u=(x+k)/2))?x=u:k=u,(p=r>=(s=(b+M)/2))?b=s:M=s,o=v,!(v=v[g=p<<2|d<<1|f]))return o[g]=_,t;if(l=+t._x.call(null,v.data),c=+t._y.call(null,v.data),h=+t._z.call(null,v.data),n===l&&e===c&&r===h)return _.next=v,o?o[g]=_:t._root=_,t;do{o=o?o[g]=new Array(8):t._root=new Array(8),(f=n>=(a=(m+w)/2))?m=a:w=a,(d=e>=(u=(x+k)/2))?x=u:k=u,(p=r>=(s=(b+M)/2))?b=s:M=s}while((g=p<<2|d<<1|f)==(y=(h>=s)<<2|(c>=u)<<1|l>=a));return o[y]=v,o[g]=_,t}function oo(t,n,e,r,i,o,a){this.node=t,this.x0=n,this.y0=e,this.z0=r,this.x1=i,this.y1=o,this.z1=a}function ao(t){return t[0]}function uo(t){return t[1]}function so(t){return t[2]}function lo(t,n,e,r){var i=new co(null==n?ao:n,null==e?uo:e,null==r?so:r,NaN,NaN,NaN,NaN,NaN,NaN);return null==t?i:i.addAll(t)}function co(t,n,e,r,i,o,a,u,s){this._x=t,this._y=n,this._z=e,this._x0=r,this._y0=i,this._z0=o,this._x1=a,this._y1=u,this._z1=s,this._root=void 0}function ho(t){for(var n={data:t.data},e=n;t=t.next;)e=e.next={data:t.data};return n}ro.copy=function(){var t,n,e=new no(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return e;if(!r.length)return e._root=eo(r),e;for(t=[{source:r,target:e._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(n=r.source[i])&&(n.length?t.push({source:n,target:r.target[i]=new Array(4)}):r.target[i]=eo(n));return e},ro.add=function(t){const n=+this._x.call(null,t),e=+this._y.call(null,t);return Zi(this.cover(n,e),n,e,t)},ro.addAll=function(t){var n,e,r,i,o=t.length,a=new Array(o),u=new Array(o),s=1/0,l=1/0,c=-1/0,h=-1/0;for(e=0;e<o;++e)isNaN(r=+this._x.call(null,n=t[e]))||isNaN(i=+this._y.call(null,n))||(a[e]=r,u[e]=i,r<s&&(s=r),r>c&&(c=r),i<l&&(l=i),i>h&&(h=i));if(s>c||l>h)return this;for(this.cover(s,l).cover(c,h),e=0;e<o;++e)Zi(this,a[e],u[e],t[e]);return this},ro.cover=function(t,n){if(isNaN(t=+t)||isNaN(n=+n))return this;var e=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(e))i=(e=Math.floor(t))+1,o=(r=Math.floor(n))+1;else{for(var a,u,s=i-e||1,l=this._root;e>t||t>=i||r>n||n>=o;)switch(u=(n<r)<<1|t<e,(a=new Array(4))[u]=l,l=a,s*=2,u){case 0:i=e+s,o=r+s;break;case 1:e=i-s,o=r+s;break;case 2:i=e+s,r=o-s;break;case 3:e=i-s,r=o-s}this._root&&this._root.length&&(this._root=l)}return this._x0=e,this._y0=r,this._x1=i,this._y1=o,this},ro.data=function(){var t=[];return this.visit((function(n){if(!n.length)do{t.push(n.data)}while(n=n.next)})),t},ro.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},ro.find=function(t,n,e){var r,i,o,a,u,s,l,c=this._x0,h=this._y0,f=this._x1,d=this._y1,p=[],g=this._root;for(g&&p.push(new Qi(g,c,h,f,d)),null==e?e=1/0:(c=t-e,h=n-e,f=t+e,d=n+e,e*=e);s=p.pop();)if(!(!(g=s.node)||(i=s.x0)>f||(o=s.y0)>d||(a=s.x1)<c||(u=s.y1)<h))if(g.length){var y=(i+a)/2,v=(o+u)/2;p.push(new Qi(g[3],y,v,a,u),new Qi(g[2],i,v,y,u),new Qi(g[1],y,o,a,v),new Qi(g[0],i,o,y,v)),(l=(n>=v)<<1|t>=y)&&(s=p[p.length-1],p[p.length-1]=p[p.length-1-l],p[p.length-1-l]=s)}else{var _=t-+this._x.call(null,g.data),m=n-+this._y.call(null,g.data),x=_*_+m*m;if(x<e){var b=Math.sqrt(e=x);c=t-b,h=n-b,f=t+b,d=n+b,r=g.data}}return r},ro.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var n,e,r,i,o,a,u,s,l,c,h,f,d=this._root,p=this._x0,g=this._y0,y=this._x1,v=this._y1;if(!d)return this;if(d.length)for(;;){if((l=o>=(u=(p+y)/2))?p=u:y=u,(c=a>=(s=(g+v)/2))?g=s:v=s,n=d,!(d=d[h=c<<1|l]))return this;if(!d.length)break;(n[h+1&3]||n[h+2&3]||n[h+3&3])&&(e=n,f=h)}for(;d.data!==t;)if(r=d,!(d=d.next))return this;return(i=d.next)&&delete d.next,r?(i?r.next=i:delete r.next,this):n?(i?n[h]=i:delete n[h],(d=n[0]||n[1]||n[2]||n[3])&&d===(n[3]||n[2]||n[1]||n[0])&&!d.length&&(e?e[f]=d:this._root=d),this):(this._root=i,this)},ro.removeAll=function(t){for(var n=0,e=t.length;n<e;++n)this.remove(t[n]);return this},ro.root=function(){return this._root},ro.size=function(){var t=0;return this.visit((function(n){if(!n.length)do{++t}while(n=n.next)})),t},ro.visit=function(t){var n,e,r,i,o,a,u=[],s=this._root;for(s&&u.push(new Qi(s,this._x0,this._y0,this._x1,this._y1));n=u.pop();)if(!t(s=n.node,r=n.x0,i=n.y0,o=n.x1,a=n.y1)&&s.length){var l=(r+o)/2,c=(i+a)/2;(e=s[3])&&u.push(new Qi(e,l,c,o,a)),(e=s[2])&&u.push(new Qi(e,r,c,l,a)),(e=s[1])&&u.push(new Qi(e,l,i,o,c)),(e=s[0])&&u.push(new Qi(e,r,i,l,c))}return this},ro.visitAfter=function(t){var n,e=[],r=[];for(this._root&&e.push(new Qi(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var i=n.node;if(i.length){var o,a=n.x0,u=n.y0,s=n.x1,l=n.y1,c=(a+s)/2,h=(u+l)/2;(o=i[0])&&e.push(new Qi(o,a,u,c,h)),(o=i[1])&&e.push(new Qi(o,c,u,s,h)),(o=i[2])&&e.push(new Qi(o,a,h,c,l)),(o=i[3])&&e.push(new Qi(o,c,h,s,l))}r.push(n)}for(;n=r.pop();)t(n.node,n.x0,n.y0,n.x1,n.y1);return this},ro.x=function(t){return arguments.length?(this._x=t,this):this._x},ro.y=function(t){return arguments.length?(this._y=t,this):this._y};var fo=lo.prototype=co.prototype;function po(t){return function(){return t}}function go(t){return 1e-6*(t()-.5)}function yo(t){return t.index}function vo(t,n){var e=t.get(n);if(!e)throw new Error("node not found: "+n);return e}function _o(t){var n,e,r,i,o,a,u,s=yo,l=function(t){return 1/Math.min(o[t.source.index],o[t.target.index])},c=po(30),h=1;function f(r){for(var o=0,s=t.length;o<h;++o)for(var l,c,f,d,p,g=0,y=0,v=0,_=0;g<s;++g)c=(l=t[g]).source,y=(f=l.target).x+f.vx-c.x-c.vx||go(u),i>1&&(v=f.y+f.vy-c.y-c.vy||go(u)),i>2&&(_=f.z+f.vz-c.z-c.vz||go(u)),y*=d=((d=Math.sqrt(y*y+v*v+_*_))-e[g])/d*r*n[g],v*=d,_*=d,f.vx-=y*(p=a[g]),i>1&&(f.vy-=v*p),i>2&&(f.vz-=_*p),c.vx+=y*(p=1-p),i>1&&(c.vy+=v*p),i>2&&(c.vz+=_*p)}function d(){if(r){var i,u,l=r.length,c=t.length,h=new Map(r.map(((t,n)=>[s(t,n,r),t])));for(i=0,o=new Array(l);i<c;++i)(u=t[i]).index=i,"object"!=typeof u.source&&(u.source=vo(h,u.source)),"object"!=typeof u.target&&(u.target=vo(h,u.target)),o[u.source.index]=(o[u.source.index]||0)+1,o[u.target.index]=(o[u.target.index]||0)+1;for(i=0,a=new Array(c);i<c;++i)u=t[i],a[i]=o[u.source.index]/(o[u.source.index]+o[u.target.index]);n=new Array(c),p(),e=new Array(c),g()}}function p(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+l(t[e],e,t)}function g(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+c(t[n],n,t)}return null==t&&(t=[]),f.initialize=function(t,...n){r=t,u=n.find((t=>"function"==typeof t))||Math.random,i=n.find((t=>[1,2,3].includes(t)))||2,d()},f.links=function(n){return arguments.length?(t=n,d(),f):t},f.id=function(t){return arguments.length?(s=t,f):s},f.iterations=function(t){return arguments.length?(h=+t,f):h},f.strength=function(t){return arguments.length?(l="function"==typeof t?t:po(+t),p(),f):l},f.distance=function(t){return arguments.length?(c="function"==typeof t?t:po(+t),g(),f):c},f}fo.copy=function(){var t,n,e=new co(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),r=this._root;if(!r)return e;if(!r.length)return e._root=ho(r),e;for(t=[{source:r,target:e._root=new Array(8)}];r=t.pop();)for(var i=0;i<8;++i)(n=r.source[i])&&(n.length?t.push({source:n,target:r.target[i]=new Array(8)}):r.target[i]=ho(n));return e},fo.add=function(t){const n=+this._x.call(null,t),e=+this._y.call(null,t),r=+this._z.call(null,t);return io(this.cover(n,e,r),n,e,r,t)},fo.addAll=function(t){Array.isArray(t)||(t=Array.from(t));const n=t.length,e=new Float64Array(n),r=new Float64Array(n),i=new Float64Array(n);let o=1/0,a=1/0,u=1/0,s=-1/0,l=-1/0,c=-1/0;for(let h,f,d,p,g=0;g<n;++g)isNaN(f=+this._x.call(null,h=t[g]))||isNaN(d=+this._y.call(null,h))||isNaN(p=+this._z.call(null,h))||(e[g]=f,r[g]=d,i[g]=p,f<o&&(o=f),f>s&&(s=f),d<a&&(a=d),d>l&&(l=d),p<u&&(u=p),p>c&&(c=p));if(o>s||a>l||u>c)return this;this.cover(o,a,u).cover(s,l,c);for(let o=0;o<n;++o)io(this,e[o],r[o],i[o],t[o]);return this},fo.cover=function(t,n,e){if(isNaN(t=+t)||isNaN(n=+n)||isNaN(e=+e))return this;var r=this._x0,i=this._y0,o=this._z0,a=this._x1,u=this._y1,s=this._z1;if(isNaN(r))a=(r=Math.floor(t))+1,u=(i=Math.floor(n))+1,s=(o=Math.floor(e))+1;else{for(var l,c,h=a-r||1,f=this._root;r>t||t>=a||i>n||n>=u||o>e||e>=s;)switch(c=(e<o)<<2|(n<i)<<1|t<r,(l=new Array(8))[c]=f,f=l,h*=2,c){case 0:a=r+h,u=i+h,s=o+h;break;case 1:r=a-h,u=i+h,s=o+h;break;case 2:a=r+h,i=u-h,s=o+h;break;case 3:r=a-h,i=u-h,s=o+h;break;case 4:a=r+h,u=i+h,o=s-h;break;case 5:r=a-h,u=i+h,o=s-h;break;case 6:a=r+h,i=u-h,o=s-h;break;case 7:r=a-h,i=u-h,o=s-h}this._root&&this._root.length&&(this._root=f)}return this._x0=r,this._y0=i,this._z0=o,this._x1=a,this._y1=u,this._z1=s,this},fo.data=function(){var t=[];return this.visit((function(n){if(!n.length)do{t.push(n.data)}while(n=n.next)})),t},fo.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1],+t[0][2]).cover(+t[1][0],+t[1][1],+t[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]},fo.find=function(t,n,e,r){var i,o,a,u,s,l,c,h,f,d=this._x0,p=this._y0,g=this._z0,y=this._x1,v=this._y1,_=this._z1,m=[],x=this._root;for(x&&m.push(new oo(x,d,p,g,y,v,_)),null==r?r=1/0:(d=t-r,p=n-r,g=e-r,y=t+r,v=n+r,_=e+r,r*=r);h=m.pop();)if(!(!(x=h.node)||(o=h.x0)>y||(a=h.y0)>v||(u=h.z0)>_||(s=h.x1)<d||(l=h.y1)<p||(c=h.z1)<g))if(x.length){var b=(o+s)/2,w=(a+l)/2,k=(u+c)/2;m.push(new oo(x[7],b,w,k,s,l,c),new oo(x[6],o,w,k,b,l,c),new oo(x[5],b,a,k,s,w,c),new oo(x[4],o,a,k,b,w,c),new oo(x[3],b,w,u,s,l,k),new oo(x[2],o,w,u,b,l,k),new oo(x[1],b,a,u,s,w,k),new oo(x[0],o,a,u,b,w,k)),(f=(e>=k)<<2|(n>=w)<<1|t>=b)&&(h=m[m.length-1],m[m.length-1]=m[m.length-1-f],m[m.length-1-f]=h)}else{var M=t-+this._x.call(null,x.data),z=n-+this._y.call(null,x.data),A=e-+this._z.call(null,x.data),S=M*M+z*z+A*A;if(S<r){var C=Math.sqrt(r=S);d=t-C,p=n-C,g=e-C,y=t+C,v=n+C,_=e+C,i=x.data}}return i},fo.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t))||isNaN(u=+this._z.call(null,t)))return this;var n,e,r,i,o,a,u,s,l,c,h,f,d,p,g,y=this._root,v=this._x0,_=this._y0,m=this._z0,x=this._x1,b=this._y1,w=this._z1;if(!y)return this;if(y.length)for(;;){if((h=o>=(s=(v+x)/2))?v=s:x=s,(f=a>=(l=(_+b)/2))?_=l:b=l,(d=u>=(c=(m+w)/2))?m=c:w=c,n=y,!(y=y[p=d<<2|f<<1|h]))return this;if(!y.length)break;(n[p+1&7]||n[p+2&7]||n[p+3&7]||n[p+4&7]||n[p+5&7]||n[p+6&7]||n[p+7&7])&&(e=n,g=p)}for(;y.data!==t;)if(r=y,!(y=y.next))return this;return(i=y.next)&&delete y.next,r?(i?r.next=i:delete r.next,this):n?(i?n[p]=i:delete n[p],(y=n[0]||n[1]||n[2]||n[3]||n[4]||n[5]||n[6]||n[7])&&y===(n[7]||n[6]||n[5]||n[4]||n[3]||n[2]||n[1]||n[0])&&!y.length&&(e?e[g]=y:this._root=y),this):(this._root=i,this)},fo.removeAll=function(t){for(var n=0,e=t.length;n<e;++n)this.remove(t[n]);return this},fo.root=function(){return this._root},fo.size=function(){var t=0;return this.visit((function(n){if(!n.length)do{++t}while(n=n.next)})),t},fo.visit=function(t){var n,e,r,i,o,a,u,s,l=[],c=this._root;for(c&&l.push(new oo(c,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));n=l.pop();)if(!t(c=n.node,r=n.x0,i=n.y0,o=n.z0,a=n.x1,u=n.y1,s=n.z1)&&c.length){var h=(r+a)/2,f=(i+u)/2,d=(o+s)/2;(e=c[7])&&l.push(new oo(e,h,f,d,a,u,s)),(e=c[6])&&l.push(new oo(e,r,f,d,h,u,s)),(e=c[5])&&l.push(new oo(e,h,i,d,a,f,s)),(e=c[4])&&l.push(new oo(e,r,i,d,h,f,s)),(e=c[3])&&l.push(new oo(e,h,f,o,a,u,d)),(e=c[2])&&l.push(new oo(e,r,f,o,h,u,d)),(e=c[1])&&l.push(new oo(e,h,i,o,a,f,d)),(e=c[0])&&l.push(new oo(e,r,i,o,h,f,d))}return this},fo.visitAfter=function(t){var n,e=[],r=[];for(this._root&&e.push(new oo(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));n=e.pop();){var i=n.node;if(i.length){var o,a=n.x0,u=n.y0,s=n.z0,l=n.x1,c=n.y1,h=n.z1,f=(a+l)/2,d=(u+c)/2,p=(s+h)/2;(o=i[0])&&e.push(new oo(o,a,u,s,f,d,p)),(o=i[1])&&e.push(new oo(o,f,u,s,l,d,p)),(o=i[2])&&e.push(new oo(o,a,d,s,f,c,p)),(o=i[3])&&e.push(new oo(o,f,d,s,l,c,p)),(o=i[4])&&e.push(new oo(o,a,u,p,f,d,h)),(o=i[5])&&e.push(new oo(o,f,u,p,l,d,h)),(o=i[6])&&e.push(new oo(o,a,d,p,f,c,h)),(o=i[7])&&e.push(new oo(o,f,d,p,l,c,h))}r.push(n)}for(;n=r.pop();)t(n.node,n.x0,n.y0,n.z0,n.x1,n.y1,n.z1);return this},fo.x=function(t){return arguments.length?(this._x=t,this):this._x},fo.y=function(t){return arguments.length?(this._y=t,this):this._y},fo.z=function(t){return arguments.length?(this._z=t,this):this._z};const mo=1664525,xo=1013904223,bo=4294967296;function wo(t){return t.x}function ko(t){return t.y}function Mo(t){return t.z}var zo=Math.PI*(3-Math.sqrt(5)),Ao=20*Math.PI/(9+Math.sqrt(221));function So(t,n){n=n||2;var e,r=Math.min(3,Math.max(1,Math.round(n))),i=1,o=.001,a=1-Math.pow(o,1/300),u=0,s=.6,l=new Map,c=ee(d),h=Ct("tick","end"),f=function(){let t=1;return()=>(t=(mo*t+xo)%bo)/bo}();function d(){p(),h.call("tick",e),i<o&&(c.stop(),h.call("end",e))}function p(n){var o,c,h=t.length;void 0===n&&(n=1);for(var f=0;f<n;++f)for(i+=(u-i)*a,l.forEach((function(t){t(i)})),o=0;o<h;++o)null==(c=t[o]).fx?c.x+=c.vx*=s:(c.x=c.fx,c.vx=0),r>1&&(null==c.fy?c.y+=c.vy*=s:(c.y=c.fy,c.vy=0)),r>2&&(null==c.fz?c.z+=c.vz*=s:(c.z=c.fz,c.vz=0));return e}function g(){for(var n,e=0,i=t.length;e<i;++e){if((n=t[e]).index=e,null!=n.fx&&(n.x=n.fx),null!=n.fy&&(n.y=n.fy),null!=n.fz&&(n.z=n.fz),isNaN(n.x)||r>1&&isNaN(n.y)||r>2&&isNaN(n.z)){var o=10*(r>2?Math.cbrt(.5+e):r>1?Math.sqrt(.5+e):e),a=e*zo,u=e*Ao;1===r?n.x=o:2===r?(n.x=o*Math.cos(a),n.y=o*Math.sin(a)):(n.x=o*Math.sin(a)*Math.cos(u),n.y=o*Math.cos(a),n.z=o*Math.sin(a)*Math.sin(u))}(isNaN(n.vx)||r>1&&isNaN(n.vy)||r>2&&isNaN(n.vz))&&(n.vx=0,r>1&&(n.vy=0),r>2&&(n.vz=0))}}function y(n){return n.initialize&&n.initialize(t,f,r),n}return null==t&&(t=[]),g(),e={tick:p,restart:function(){return c.restart(d),e},stop:function(){return c.stop(),e},numDimensions:function(t){return arguments.length?(r=Math.min(3,Math.max(1,Math.round(t))),l.forEach(y),e):r},nodes:function(n){return arguments.length?(t=n,g(),l.forEach(y),e):t},alpha:function(t){return arguments.length?(i=+t,e):i},alphaMin:function(t){return arguments.length?(o=+t,e):o},alphaDecay:function(t){return arguments.length?(a=+t,e):+a},alphaTarget:function(t){return arguments.length?(u=+t,e):u},velocityDecay:function(t){return arguments.length?(s=1-t,e):1-s},randomSource:function(t){return arguments.length?(f=t,l.forEach(y),e):f},force:function(t,n){return arguments.length>1?(null==n?l.delete(t):l.set(t,y(n)),e):l.get(t)},find:function(){var n,e,i,o,a,u,s=Array.prototype.slice.call(arguments),l=s.shift()||0,c=(r>1?s.shift():null)||0,h=(r>2?s.shift():null)||0,f=s.shift()||1/0,d=0,p=t.length;for(f*=f,d=0;d<p;++d)(o=(n=l-(a=t[d]).x)*n+(e=c-(a.y||0))*e+(i=h-(a.z||0))*i)<f&&(u=a,f=o);return u},on:function(t,n){return arguments.length>1?(h.on(t,n),e):h.on(t)}}}function Co(){var t,n,e,r,i,o,a=po(-30),u=1,s=1/0,l=.81;function c(r){var o,a=t.length,u=(1===n?Xi(t,wo):2===n?to(t,wo,ko):3===n?lo(t,wo,ko,Mo):null).visitAfter(f);for(i=r,o=0;o<a;++o)e=t[o],u.visit(d)}function h(){if(t){var n,e,r=t.length;for(o=new Array(r),n=0;n<r;++n)e=t[n],o[e.index]=+a(e,n,t)}}function f(t){var e,r,i,a,u,s,l=0,c=0,h=t.length;if(h){for(i=a=u=s=0;s<h;++s)(e=t[s])&&(r=Math.abs(e.value))&&(l+=e.value,c+=r,i+=r*(e.x||0),a+=r*(e.y||0),u+=r*(e.z||0));l*=Math.sqrt(4/h),t.x=i/c,n>1&&(t.y=a/c),n>2&&(t.z=u/c)}else{(e=t).x=e.data.x,n>1&&(e.y=e.data.y),n>2&&(e.z=e.data.z);do{l+=o[e.data.index]}while(e=e.next)}t.value=l}function d(t,a,c,h,f){if(!t.value)return!0;var d=[c,h,f][n-1],p=t.x-e.x,g=n>1?t.y-e.y:0,y=n>2?t.z-e.z:0,v=d-a,_=p*p+g*g+y*y;if(v*v/l<_)return _<s&&(0===p&&(_+=(p=go(r))*p),n>1&&0===g&&(_+=(g=go(r))*g),n>2&&0===y&&(_+=(y=go(r))*y),_<u&&(_=Math.sqrt(u*_)),e.vx+=p*t.value*i/_,n>1&&(e.vy+=g*t.value*i/_),n>2&&(e.vz+=y*t.value*i/_)),!0;if(!(t.length||_>=s)){(t.data!==e||t.next)&&(0===p&&(_+=(p=go(r))*p),n>1&&0===g&&(_+=(g=go(r))*g),n>2&&0===y&&(_+=(y=go(r))*y),_<u&&(_=Math.sqrt(u*_)));do{t.data!==e&&(v=o[t.data.index]*i/_,e.vx+=p*v,n>1&&(e.vy+=g*v),n>2&&(e.vz+=y*v))}while(t=t.next)}}return c.initialize=function(e,...i){t=e,r=i.find((t=>"function"==typeof t))||Math.random,n=i.find((t=>[1,2,3].includes(t)))||2,h()},c.strength=function(t){return arguments.length?(a="function"==typeof t?t:po(+t),h(),c):a},c.distanceMin=function(t){return arguments.length?(u=t*t,c):Math.sqrt(u)},c.distanceMax=function(t){return arguments.length?(s=t*t,c):Math.sqrt(s)},c.theta=function(t){return arguments.length?(l=t*t,c):Math.sqrt(l)},c}const{abs:Eo,cos:Oo,sin:No,acos:Po,atan2:jo,sqrt:To,pow:Ro}=Math;function Do(t){return t<0?-Ro(-t,1/3):Ro(t,1/3)}const Io=Math.PI,Uo=2*Io,Fo=Io/2,Lo=Number.MAX_SAFE_INTEGER||9007199254740991,qo=Number.MIN_SAFE_INTEGER||-9007199254740991,Bo={x:0,y:0,z:0},$o={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(t,n){const e=n(t);let r=e.x*e.x+e.y*e.y;return void 0!==e.z&&(r+=e.z*e.z),To(r)},compute:function(t,n,e){if(0===t)return n[0].t=0,n[0];const r=n.length-1;if(1===t)return n[r].t=1,n[r];const i=1-t;let o=n;if(0===r)return n[0].t=t,n[0];if(1===r){const n={x:i*o[0].x+t*o[1].x,y:i*o[0].y+t*o[1].y,t:t};return e&&(n.z=i*o[0].z+t*o[1].z),n}if(r<4){let n,a,u,s=i*i,l=t*t,c=0;2===r?(o=[o[0],o[1],o[2],Bo],n=s,a=i*t*2,u=l):3===r&&(n=s*i,a=s*t*3,u=i*l*3,c=t*l);const h={x:n*o[0].x+a*o[1].x+u*o[2].x+c*o[3].x,y:n*o[0].y+a*o[1].y+u*o[2].y+c*o[3].y,t:t};return e&&(h.z=n*o[0].z+a*o[1].z+u*o[2].z+c*o[3].z),h}const a=JSON.parse(JSON.stringify(n));for(;a.length>1;){for(let n=0;n<a.length-1;n++)a[n]={x:a[n].x+(a[n+1].x-a[n].x)*t,y:a[n].y+(a[n+1].y-a[n].y)*t},void 0!==a[n].z&&(a[n].z=a[n].z+(a[n+1].z-a[n].z)*t);a.splice(a.length-1,1)}return a[0].t=t,a[0]},computeWithRatios:function(t,n,e,r){const i=1-t,o=e,a=n;let u,s=o[0],l=o[1],c=o[2],h=o[3];return s*=i,l*=t,2===a.length?(u=s+l,{x:(s*a[0].x+l*a[1].x)/u,y:(s*a[0].y+l*a[1].y)/u,z:!!r&&(s*a[0].z+l*a[1].z)/u,t:t}):(s*=i,l*=2*i,c*=t*t,3===a.length?(u=s+l+c,{x:(s*a[0].x+l*a[1].x+c*a[2].x)/u,y:(s*a[0].y+l*a[1].y+c*a[2].y)/u,z:!!r&&(s*a[0].z+l*a[1].z+c*a[2].z)/u,t:t}):(s*=i,l*=1.5*i,c*=3*i,h*=t*t*t,4===a.length?(u=s+l+c+h,{x:(s*a[0].x+l*a[1].x+c*a[2].x+h*a[3].x)/u,y:(s*a[0].y+l*a[1].y+c*a[2].y+h*a[3].y)/u,z:!!r&&(s*a[0].z+l*a[1].z+c*a[2].z+h*a[3].z)/u,t:t}):void 0))},derive:function(t,n){const e=[];for(let r=t,i=r.length,o=i-1;i>1;i--,o--){const t=[];for(let e,i=0;i<o;i++)e={x:o*(r[i+1].x-r[i].x),y:o*(r[i+1].y-r[i].y)},n&&(e.z=o*(r[i+1].z-r[i].z)),t.push(e);e.push(t),r=t}return e},between:function(t,n,e){return n<=t&&t<=e||$o.approximately(t,n)||$o.approximately(t,e)},approximately:function(t,n,e){return Eo(t-n)<=(e||1e-6)},length:function(t){const n=$o.Tvalues.length;let e=0;for(let r,i=0;i<n;i++)r=.5*$o.Tvalues[i]+.5,e+=$o.Cvalues[i]*$o.arcfn(r,t);return.5*e},map:function(t,n,e,r,i){return r+(i-r)*((t-n)/(e-n))},lerp:function(t,n,e){const r={x:n.x+t*(e.x-n.x),y:n.y+t*(e.y-n.y)};return void 0!==n.z&&void 0!==e.z&&(r.z=n.z+t*(e.z-n.z)),r},pointToString:function(t){let n=t.x+"/"+t.y;return void 0!==t.z&&(n+="/"+t.z),n},pointsToString:function(t){return"["+t.map($o.pointToString).join(", ")+"]"},copy:function(t){return JSON.parse(JSON.stringify(t))},angle:function(t,n,e){const r=n.x-t.x,i=n.y-t.y,o=e.x-t.x,a=e.y-t.y;return jo(r*a-i*o,r*o+i*a)},round:function(t,n){const e=""+t,r=e.indexOf(".");return parseFloat(e.substring(0,r+1+n))},dist:function(t,n){const e=t.x-n.x,r=t.y-n.y;return To(e*e+r*r)},closest:function(t,n){let e,r,i=Ro(2,63);return t.forEach((function(t,o){r=$o.dist(n,t),r<i&&(i=r,e=o)})),{mdist:i,mpos:e}},abcratio:function(t,n){if(2!==n&&3!==n)return!1;if(void 0===t)t=.5;else if(0===t||1===t)return t;const e=Ro(t,n)+Ro(1-t,n);return Eo((e-1)/e)},projectionratio:function(t,n){if(2!==n&&3!==n)return!1;if(void 0===t)t=.5;else if(0===t||1===t)return t;const e=Ro(1-t,n);return e/(Ro(t,n)+e)},lli8:function(t,n,e,r,i,o,a,u){const s=(t-e)*(o-u)-(n-r)*(i-a);return 0!=s&&{x:((t*r-n*e)*(i-a)-(t-e)*(i*u-o*a))/s,y:((t*r-n*e)*(o-u)-(n-r)*(i*u-o*a))/s}},lli4:function(t,n,e,r){const i=t.x,o=t.y,a=n.x,u=n.y,s=e.x,l=e.y,c=r.x,h=r.y;return $o.lli8(i,o,a,u,s,l,c,h)},lli:function(t,n){return $o.lli4(t,t.c,n,n.c)},makeline:function(t,n){return new Jo(t.x,t.y,(t.x+n.x)/2,(t.y+n.y)/2,n.x,n.y)},findbbox:function(t){let n=Lo,e=Lo,r=qo,i=qo;return t.forEach((function(t){const o=t.bbox();n>o.x.min&&(n=o.x.min),e>o.y.min&&(e=o.y.min),r<o.x.max&&(r=o.x.max),i<o.y.max&&(i=o.y.max)})),{x:{min:n,mid:(n+r)/2,max:r,size:r-n},y:{min:e,mid:(e+i)/2,max:i,size:i-e}}},shapeintersections:function(t,n,e,r,i){if(!$o.bboxoverlap(n,r))return[];const o=[],a=[t.startcap,t.forward,t.back,t.endcap],u=[e.startcap,e.forward,e.back,e.endcap];return a.forEach((function(n){n.virtual||u.forEach((function(r){if(r.virtual)return;const a=n.intersects(r,i);a.length>0&&(a.c1=n,a.c2=r,a.s1=t,a.s2=e,o.push(a))}))})),o},makeshape:function(t,n,e){const r=n.points.length,i=t.points.length,o=$o.makeline(n.points[r-1],t.points[0]),a=$o.makeline(t.points[i-1],n.points[0]),u={startcap:o,forward:t,back:n,endcap:a,bbox:$o.findbbox([o,t,n,a]),intersections:function(t){return $o.shapeintersections(u,u.bbox,t,t.bbox,e)}};return u},getminmax:function(t,n,e){if(!e)return{min:0,max:0};let r,i,o=Lo,a=qo;-1===e.indexOf(0)&&(e=[0].concat(e)),-1===e.indexOf(1)&&e.push(1);for(let u=0,s=e.length;u<s;u++)r=e[u],i=t.get(r),i[n]<o&&(o=i[n]),i[n]>a&&(a=i[n]);return{min:o,mid:(o+a)/2,max:a,size:a-o}},align:function(t,n){const e=n.p1.x,r=n.p1.y,i=-jo(n.p2.y-r,n.p2.x-e);return t.map((function(t){return{x:(t.x-e)*Oo(i)-(t.y-r)*No(i),y:(t.x-e)*No(i)+(t.y-r)*Oo(i)}}))},roots:function(t,n){n=n||{p1:{x:0,y:0},p2:{x:1,y:0}};const e=t.length-1,r=$o.align(t,n),i=function(t){return 0<=t&&t<=1};if(2===e){const t=r[0].y,n=r[1].y,e=r[2].y,o=t-2*n+e;if(0!==o){const r=-To(n*n-t*e),a=-t+n;return[-(r+a)/o,-(-r+a)/o].filter(i)}return n!==e&&0===o?[(2*n-e)/(2*n-2*e)].filter(i):[]}const o=r[0].y,a=r[1].y,u=r[2].y;let s=3*a-o-3*u+r[3].y,l=3*o-6*a+3*u,c=-3*o+3*a,h=o;if($o.approximately(s,0)){if($o.approximately(l,0))return $o.approximately(c,0)?[]:[-h/c].filter(i);const t=To(c*c-4*l*h),n=2*l;return[(t-c)/n,(-c-t)/n].filter(i)}l/=s,c/=s,h/=s;const f=(3*c-l*l)/3,d=f/3,p=(2*l*l*l-9*l*c+27*h)/27,g=p/2,y=g*g+d*d*d;let v,_,m,x,b;if(y<0){const t=-f/3,n=To(t*t*t),e=-p/(2*n),r=Po(e<-1?-1:e>1?1:e),o=2*Do(n);return m=o*Oo(r/3)-l/3,x=o*Oo((r+Uo)/3)-l/3,b=o*Oo((r+2*Uo)/3)-l/3,[m,x,b].filter(i)}if(0===y)return v=g<0?Do(-g):-Do(g),m=2*v-l/3,x=-v-l/3,[m,x].filter(i);{const t=To(y);return v=Do(-g+t),_=Do(g+t),[v-_-l/3].filter(i)}},droots:function(t){if(3===t.length){const n=t[0],e=t[1],r=t[2],i=n-2*e+r;if(0!==i){const t=-To(e*e-n*r),o=-n+e;return[-(t+o)/i,-(-t+o)/i]}return e!==r&&0===i?[(2*e-r)/(2*(e-r))]:[]}if(2===t.length){const n=t[0],e=t[1];return n!==e?[n/(n-e)]:[]}return[]},curvature:function(t,n,e,r,i){let o,a,u,s,l=0,c=0;const h=$o.compute(t,n),f=$o.compute(t,e),d=h.x*h.x+h.y*h.y;if(r?(o=To(Ro(h.y*f.z-f.y*h.z,2)+Ro(h.z*f.x-f.z*h.x,2)+Ro(h.x*f.y-f.x*h.y,2)),a=Ro(d+h.z*h.z,1.5)):(o=h.x*f.y-h.y*f.x,a=Ro(d,1.5)),0===o||0===a)return{k:0,r:0};if(l=o/a,c=a/o,!i){const i=$o.curvature(t-.001,n,e,r,!0).k,o=$o.curvature(t+.001,n,e,r,!0).k;s=(o-l+(l-i))/2,u=(Eo(o-l)+Eo(l-i))/2}return{k:l,r:c,dk:s,adk:u}},inflections:function(t){if(t.length<4)return[];const n=$o.align(t,{p1:t[0],p2:t.slice(-1)[0]}),e=n[2].x*n[1].y,r=n[3].x*n[1].y,i=n[1].x*n[2].y,o=18*(-3*e+2*r+3*i-n[3].x*n[2].y),a=18*(3*e-r-3*i),u=18*(i-e);if($o.approximately(o,0)){if(!$o.approximately(a,0)){let t=-u/a;if(0<=t&&t<=1)return[t]}return[]}const s=2*o;if($o.approximately(s,0))return[];const l=a*a-4*o*u;if(l<0)return[];const c=Math.sqrt(l);return[(c-a)/s,-(a+c)/s].filter((function(t){return 0<=t&&t<=1}))},bboxoverlap:function(t,n){const e=["x","y"],r=e.length;for(let i,o,a,u,s=0;s<r;s++)if(i=e[s],o=t[i].mid,a=n[i].mid,u=(t[i].size+n[i].size)/2,Eo(o-a)>=u)return!1;return!0},expandbox:function(t,n){n.x.min<t.x.min&&(t.x.min=n.x.min),n.y.min<t.y.min&&(t.y.min=n.y.min),n.z&&n.z.min<t.z.min&&(t.z.min=n.z.min),n.x.max>t.x.max&&(t.x.max=n.x.max),n.y.max>t.y.max&&(t.y.max=n.y.max),n.z&&n.z.max>t.z.max&&(t.z.max=n.z.max),t.x.mid=(t.x.min+t.x.max)/2,t.y.mid=(t.y.min+t.y.max)/2,t.z&&(t.z.mid=(t.z.min+t.z.max)/2),t.x.size=t.x.max-t.x.min,t.y.size=t.y.max-t.y.min,t.z&&(t.z.size=t.z.max-t.z.min)},pairiteration:function(t,n,e){const r=t.bbox(),i=n.bbox(),o=1e5,a=e||.5;if(r.x.size+r.y.size<a&&i.x.size+i.y.size<a)return[(o*(t._t1+t._t2)/2|0)/o+"/"+(o*(n._t1+n._t2)/2|0)/o];let u=t.split(.5),s=n.split(.5),l=[{left:u.left,right:s.left},{left:u.left,right:s.right},{left:u.right,right:s.right},{left:u.right,right:s.left}];l=l.filter((function(t){return $o.bboxoverlap(t.left.bbox(),t.right.bbox())}));let c=[];return 0===l.length||(l.forEach((function(t){c=c.concat($o.pairiteration(t.left,t.right,a))})),c=c.filter((function(t,n){return c.indexOf(t)===n}))),c},getccenter:function(t,n,e){const r=n.x-t.x,i=n.y-t.y,o=e.x-n.x,a=e.y-n.y,u=r*Oo(Fo)-i*No(Fo),s=r*No(Fo)+i*Oo(Fo),l=o*Oo(Fo)-a*No(Fo),c=o*No(Fo)+a*Oo(Fo),h=(t.x+n.x)/2,f=(t.y+n.y)/2,d=(n.x+e.x)/2,p=(n.y+e.y)/2,g=h+u,y=f+s,v=d+l,_=p+c,m=$o.lli8(h,f,g,y,d,p,v,_),x=$o.dist(m,t);let b,w=jo(t.y-m.y,t.x-m.x),k=jo(n.y-m.y,n.x-m.x),M=jo(e.y-m.y,e.x-m.x);return w<M?((w>k||k>M)&&(w+=Uo),w>M&&(b=M,M=w,w=b)):M<k&&k<w?(b=M,M=w,w=b):M+=Uo,m.s=w,m.e=M,m.r=x,m},numberSort:function(t,n){return t-n}};class Ho{constructor(t){this.curves=[],this._3d=!1,t&&(this.curves=t,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map((function(t){return $o.pointsToString(t.points)})).join(", ")+"]"}addCurve(t){this.curves.push(t),this._3d=this._3d||t._3d}length(){return this.curves.map((function(t){return t.length()})).reduce((function(t,n){return t+n}))}curve(t){return this.curves[t]}bbox(){const t=this.curves;for(var n=t[0].bbox(),e=1;e<t.length;e++)$o.expandbox(n,t[e].bbox());return n}offset(t){const n=[];return this.curves.forEach((function(e){n.push(...e.offset(t))})),new Ho(n)}}const{abs:Vo,min:Xo,max:Go,cos:Yo,sin:Wo,acos:Zo,sqrt:Qo}=Math,Ko=Math.PI;class Jo{constructor(t){let n=t&&t.forEach?t:Array.from(arguments).slice(),e=!1;if("object"==typeof n[0]){e=n.length;const t=[];n.forEach((function(n){["x","y","z"].forEach((function(e){void 0!==n[e]&&t.push(n[e])}))})),n=t}let r=!1;const i=n.length;if(e){if(e>4){if(1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");r=!0}}else if(6!==i&&8!==i&&9!==i&&12!==i&&1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const o=this._3d=!r&&(9===i||12===i)||t&&t[0]&&void 0!==t[0].z,a=this.points=[];for(let t=0,e=o?3:2;t<i;t+=e){var u={x:n[t],y:n[t+1]};o&&(u.z=n[t+2]),a.push(u)}const s=this.order=a.length-1,l=this.dims=["x","y"];o&&l.push("z"),this.dimlen=l.length;const c=$o.align(a,{p1:a[0],p2:a[s]}),h=$o.dist(a[0],a[s]);this._linear=c.reduce(((t,n)=>t+Vo(n.y)),0)<h/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(t,n,e,r){if(void 0===r&&(r=.5),0===r)return new Jo(n,n,e);if(1===r)return new Jo(t,n,n);const i=Jo.getABC(2,t,n,e,r);return new Jo(t,i.A,e)}static cubicFromPoints(t,n,e,r,i){void 0===r&&(r=.5);const o=Jo.getABC(3,t,n,e,r);void 0===i&&(i=$o.dist(n,o.C));const a=i*(1-r)/r,u=$o.dist(t,e),s=(e.x-t.x)/u,l=(e.y-t.y)/u,c=i*s,h=i*l,f=a*s,d=a*l,p=n.x-c,g=n.y-h,y=n.x+f,v=n.y+d,_=o.A,m=_.x+(p-_.x)/(1-r),x=_.y+(g-_.y)/(1-r),b=_.x+(y-_.x)/r,w=_.y+(v-_.y)/r,k={x:t.x+(m-t.x)/r,y:t.y+(x-t.y)/r},M={x:e.x+(b-e.x)/(1-r),y:e.y+(w-e.y)/(1-r)};return new Jo(t,k,M,e)}static getUtils(){return $o}getUtils(){return Jo.getUtils()}static get PolyBezier(){return Ho}valueOf(){return this.toString()}toString(){return $o.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const t=this.points,n=["M",t[0].x,t[0].y,2===this.order?"Q":"C"];for(let e=1,r=t.length;e<r;e++)n.push(t[e].x),n.push(t[e].y);return n.join(" ")}setRatios(t){if(t.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=t,this._lut=[]}verify(){const t=this.coordDigest();t!==this._print&&(this._print=t,this.update())}coordDigest(){return this.points.map((function(t,n){return""+n+t.x+t.y+(t.z?t.z:0)})).join("")}update(){this._lut=[],this.dpoints=$o.derive(this.points,this._3d),this.computedirection()}computedirection(){const t=this.points,n=$o.angle(t[0],t[this.order],t[1]);this.clockwise=n>0}length(){return $o.length(this.derivative.bind(this))}static getABC(t=2,n,e,r,i=.5){const o=$o.projectionratio(i,t),a=1-o,u={x:o*n.x+a*r.x,y:o*n.y+a*r.y},s=$o.abcratio(i,t);return{A:{x:e.x+(e.x-u.x)/s,y:e.y+(e.y-u.y)/s},B:e,C:u,S:n,E:r}}getABC(t,n){n=n||this.get(t);let e=this.points[0],r=this.points[this.order];return Jo.getABC(this.order,e,n,r,t)}getLUT(t){if(this.verify(),t=t||100,this._lut.length===t+1)return this._lut;this._lut=[],t++,this._lut=[];for(let n,e,r=0;r<t;r++)e=r/(t-1),n=this.compute(e),n.t=e,this._lut.push(n);return this._lut}on(n,e){e=e||5;const r=this.getLUT(),i=[];for(let t,o=0,a=0;o<r.length;o++)t=r[o],$o.dist(t,n)<e&&(i.push(t),a+=o/r.length);return!!i.length&&(t/=i.length)}project(t){const n=this.getLUT(),e=n.length-1,r=$o.closest(n,t),i=r.mpos,o=(i-1)/e,a=(i+1)/e,u=.1/e;let s,l=r.mdist,c=o,h=c;l+=1;for(let n;c<a+u;c+=u)s=this.compute(c),n=$o.dist(t,s),n<l&&(l=n,h=c);return h=h<0?0:h>1?1:h,s=this.compute(h),s.t=h,s.d=l,s}get(t){return this.compute(t)}point(t){return this.points[t]}compute(t){return this.ratios?$o.computeWithRatios(t,this.points,this.ratios,this._3d):$o.compute(t,this.points,this._3d,this.ratios)}raise(){const t=this.points,n=[t[0]],e=t.length;for(let r,i,o=1;o<e;o++)r=t[o],i=t[o-1],n[o]={x:(e-o)/e*r.x+o/e*i.x,y:(e-o)/e*r.y+o/e*i.y};return n[e]=t[e-1],new Jo(n)}derivative(t){return $o.compute(t,this.dpoints[0],this._3d)}dderivative(t){return $o.compute(t,this.dpoints[1],this._3d)}align(){let t=this.points;return new Jo($o.align(t,{p1:t[0],p2:t[t.length-1]}))}curvature(t){return $o.curvature(t,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return $o.inflections(this.points)}normal(t){return this._3d?this.__normal3(t):this.__normal2(t)}__normal2(t){const n=this.derivative(t),e=Qo(n.x*n.x+n.y*n.y);return{t:t,x:-n.y/e,y:n.x/e}}__normal3(t){const n=this.derivative(t),e=this.derivative(t+.01),r=Qo(n.x*n.x+n.y*n.y+n.z*n.z),i=Qo(e.x*e.x+e.y*e.y+e.z*e.z);n.x/=r,n.y/=r,n.z/=r,e.x/=i,e.y/=i,e.z/=i;const o={x:e.y*n.z-e.z*n.y,y:e.z*n.x-e.x*n.z,z:e.x*n.y-e.y*n.x},a=Qo(o.x*o.x+o.y*o.y+o.z*o.z);o.x/=a,o.y/=a,o.z/=a;const u=[o.x*o.x,o.x*o.y-o.z,o.x*o.z+o.y,o.x*o.y+o.z,o.y*o.y,o.y*o.z-o.x,o.x*o.z-o.y,o.y*o.z+o.x,o.z*o.z];return{t:t,x:u[0]*n.x+u[1]*n.y+u[2]*n.z,y:u[3]*n.x+u[4]*n.y+u[5]*n.z,z:u[6]*n.x+u[7]*n.y+u[8]*n.z}}hull(t){let n=this.points,e=[],r=[],i=0;for(r[i++]=n[0],r[i++]=n[1],r[i++]=n[2],3===this.order&&(r[i++]=n[3]);n.length>1;){e=[];for(let o,a=0,u=n.length-1;a<u;a++)o=$o.lerp(t,n[a],n[a+1]),r[i++]=o,e.push(o);n=e}return r}split(t,n){if(0===t&&n)return this.split(n).left;if(1===n)return this.split(t).right;const e=this.hull(t),r={left:2===this.order?new Jo([e[0],e[3],e[5]]):new Jo([e[0],e[4],e[7],e[9]]),right:2===this.order?new Jo([e[5],e[4],e[2]]):new Jo([e[9],e[8],e[6],e[3]]),span:e};return r.left._t1=$o.map(0,0,1,this._t1,this._t2),r.left._t2=$o.map(t,0,1,this._t1,this._t2),r.right._t1=$o.map(t,0,1,this._t1,this._t2),r.right._t2=$o.map(1,0,1,this._t1,this._t2),n?(n=$o.map(n,t,1,0,1),r.right.split(n).left):r}extrema(){const t={};let n=[];return this.dims.forEach(function(e){let r=function(t){return t[e]},i=this.dpoints[0].map(r);t[e]=$o.droots(i),3===this.order&&(i=this.dpoints[1].map(r),t[e]=t[e].concat($o.droots(i))),t[e]=t[e].filter((function(t){return t>=0&&t<=1})),n=n.concat(t[e].sort($o.numberSort))}.bind(this)),t.values=n.sort($o.numberSort).filter((function(t,e){return n.indexOf(t)===e})),t}bbox(){const t=this.extrema(),n={};return this.dims.forEach(function(e){n[e]=$o.getminmax(this,e,t[e])}.bind(this)),n}overlaps(t){const n=this.bbox(),e=t.bbox();return $o.bboxoverlap(n,e)}offset(t,n){if(void 0!==n){const e=this.get(t),r=this.normal(t),i={c:e,n:r,x:e.x+r.x*n,y:e.y+r.y*n};return this._3d&&(i.z=e.z+r.z*n),i}if(this._linear){const n=this.normal(0),e=this.points.map((function(e){const r={x:e.x+t*n.x,y:e.y+t*n.y};return e.z&&n.z&&(r.z=e.z+t*n.z),r}));return[new Jo(e)]}return this.reduce().map((function(n){return n._linear?n.offset(t)[0]:n.scale(t)}))}simple(){if(3===this.order){const t=$o.angle(this.points[0],this.points[3],this.points[1]),n=$o.angle(this.points[0],this.points[3],this.points[2]);if(t>0&&n<0||t<0&&n>0)return!1}const t=this.normal(0),n=this.normal(1);let e=t.x*n.x+t.y*n.y;return this._3d&&(e+=t.z*n.z),Vo(Zo(e))<Ko/3}reduce(){let t,n,e=0,r=0,i=.01,o=[],a=[],u=this.extrema().values;for(-1===u.indexOf(0)&&(u=[0].concat(u)),-1===u.indexOf(1)&&u.push(1),e=u[0],t=1;t<u.length;t++)r=u[t],n=this.split(e,r),n._t1=e,n._t2=r,o.push(n),e=r;return o.forEach((function(t){for(e=0,r=0;r<=1;)for(r=e+i;r<=1.01;r+=i)if(n=t.split(e,r),!n.simple()){if(r-=i,Vo(e-r)<i)return[];n=t.split(e,r),n._t1=$o.map(e,0,1,t._t1,t._t2),n._t2=$o.map(r,0,1,t._t1,t._t2),a.push(n),e=r;break}e<1&&(n=t.split(e,1),n._t1=$o.map(e,0,1,t._t1,t._t2),n._t2=t._t2,a.push(n))})),a}translate(t,n,e){e="number"==typeof e?e:n;const r=this.order;let i=this.points.map(((t,i)=>(1-i/r)*n+i/r*e));return new Jo(this.points.map(((n,e)=>({x:n.x+t.x*i[e],y:n.y+t.y*i[e]}))))}scale(t){const n=this.order;let e=!1;if("function"==typeof t&&(e=t),e&&2===n)return this.raise().scale(e);const r=this.clockwise,i=this.points;if(this._linear)return this.translate(this.normal(0),e?e(0):t,e?e(1):t);const o=e?e(0):t,a=e?e(1):t,u=[this.offset(0,10),this.offset(1,10)],s=[],l=$o.lli4(u[0],u[0].c,u[1],u[1].c);if(!l)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach((function(t){const e=s[t*n]=$o.copy(i[t*n]);e.x+=(t?a:o)*u[t].n.x,e.y+=(t?a:o)*u[t].n.y})),e?([0,1].forEach((function(o){if(2!==n||!o){var a=i[o+1],u={x:a.x-l.x,y:a.y-l.y},c=e?e((o+1)/n):t;e&&!r&&(c=-c);var h=Qo(u.x*u.x+u.y*u.y);u.x/=h,u.y/=h,s[o+1]={x:a.x+c*u.x,y:a.y+c*u.y}}})),new Jo(s)):([0,1].forEach((t=>{if(2===n&&t)return;const e=s[t*n],r=this.derivative(t),o={x:e.x+r.x,y:e.y+r.y};s[t+1]=$o.lli4(e,o,l,i[t+1])})),new Jo(s))}outline(t,n,e,r){if(n=void 0===n?t:n,this._linear){const i=this.normal(0),o=this.points[0],a=this.points[this.points.length-1];let u,s,l;void 0===e&&(e=t,r=n),u={x:o.x+i.x*t,y:o.y+i.y*t},l={x:a.x+i.x*e,y:a.y+i.y*e},s={x:(u.x+l.x)/2,y:(u.y+l.y)/2};const c=[u,s,l];u={x:o.x-i.x*n,y:o.y-i.y*n},l={x:a.x-i.x*r,y:a.y-i.y*r},s={x:(u.x+l.x)/2,y:(u.y+l.y)/2};const h=[l,s,u],f=$o.makeline(h[2],c[0]),d=$o.makeline(c[2],h[0]),p=[f,new Jo(c),d,new Jo(h)];return new Ho(p)}const i=this.reduce(),o=i.length,a=[];let u,s=[],l=0,c=this.length();const h=void 0!==e&&void 0!==r;function f(t,n,e,r,i){return function(o){const a=r/e,u=(r+i)/e,s=n-t;return $o.map(o,0,1,t+a*s,t+u*s)}}i.forEach((function(i){const o=i.length();h?(a.push(i.scale(f(t,e,c,l,o))),s.push(i.scale(f(-n,-r,c,l,o)))):(a.push(i.scale(t)),s.push(i.scale(-n))),l+=o})),s=s.map((function(t){return u=t.points,u[3]?t.points=[u[3],u[2],u[1],u[0]]:t.points=[u[2],u[1],u[0]],t})).reverse();const d=a[0].points[0],p=a[o-1].points[a[o-1].points.length-1],g=s[o-1].points[s[o-1].points.length-1],y=s[0].points[0],v=$o.makeline(g,d),_=$o.makeline(p,y),m=[v].concat(a).concat([_]).concat(s);return new Ho(m)}outlineshapes(t,n,e){n=n||t;const r=this.outline(t,n).curves,i=[];for(let t=1,n=r.length;t<n/2;t++){const o=$o.makeshape(r[t],r[n-t],e);o.startcap.virtual=t>1,o.endcap.virtual=t<n/2-1,i.push(o)}return i}intersects(t,n){return t?t.p1&&t.p2?this.lineIntersects(t):(t instanceof Jo&&(t=t.reduce()),this.curveintersects(this.reduce(),t,n)):this.selfintersects(n)}lineIntersects(t){const n=Xo(t.p1.x,t.p2.x),e=Xo(t.p1.y,t.p2.y),r=Go(t.p1.x,t.p2.x),i=Go(t.p1.y,t.p2.y);return $o.roots(this.points,t).filter((t=>{var o=this.get(t);return $o.between(o.x,n,r)&&$o.between(o.y,e,i)}))}selfintersects(t){const n=this.reduce(),e=n.length-2,r=[];for(let i,o,a,u=0;u<e;u++)o=n.slice(u,u+1),a=n.slice(u+2),i=this.curveintersects(o,a,t),r.push(...i);return r}curveintersects(t,n,e){const r=[];t.forEach((function(t){n.forEach((function(n){t.overlaps(n)&&r.push({left:t,right:n})}))}));let i=[];return r.forEach((function(t){const n=$o.pairiteration(t.left,t.right,e);n.length>0&&(i=i.concat(n))})),i}arcs(t){return t=t||.5,this._iterate(t,[])}_error(t,n,e,r){const i=(r-e)/4,o=this.get(e+i),a=this.get(r-i),u=$o.dist(t,n),s=$o.dist(t,o),l=$o.dist(t,a);return Vo(s-u)+Vo(l-u)}_iterate(t,n){let e,r=0,i=1;do{e=0,i=1;let o,a,u,s,l,c=this.get(r),h=!1,f=!1,d=i,p=1;do{if(f=h,s=u,d=(r+i)/2,o=this.get(d),a=this.get(i),u=$o.getccenter(c,o,a),u.interval={start:r,end:i},h=this._error(u,c,r,i)<=t,l=f&&!h,l||(p=i),h){if(i>=1){if(u.interval.end=p=1,s=u,i>1){let t={x:u.x+u.r*Yo(u.e),y:u.y+u.r*Wo(u.e)};u.e+=$o.angle({x:u.x,y:u.y},t,this.get(1))}break}i+=(i-r)/2}else i=d}while(!l&&e++<100);if(e>=100)break;s=s||u,n.push(s),r=p}while(i<1);return n}}function ta(t,n){if(null==t)return{};var e,r,i=function(t,n){if(null==t)return{};var e,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)e=o[r],n.indexOf(e)>=0||(i[e]=t[e]);return i}(t,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)e=o[r],n.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(t,e)&&(i[e]=t[e])}return i}function na(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,i,o,a,u=[],s=!0,l=!1;try{if(o=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;s=!1}else for(;!(s=(r=o.call(e)).done)&&(u.push(r.value),u.length!==n);s=!0);}catch(t){l=!0,i=t}finally{try{if(!s&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(l)throw i}}return u}}(t,n)||ra(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ea(t){return function(t){if(Array.isArray(t))return ia(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||ra(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ra(t,n){if(t){if("string"==typeof t)return ia(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?ia(t,n):void 0}}function ia(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function oa(t){var n=function(t,n){if("object"!=typeof t||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==typeof n?n:String(n)}function aa(t,n){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(n).domain(t)}return this}const ua=Symbol("implicit");var sa=function(t){for(var n=t.length/6|0,e=new Array(n),r=0;r<n;)e[r]="#"+t.slice(6*r,6*++r);return e}("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),la=function t(){var n=new or,e=[],r=[],i=ua;function o(t){let o=n.get(t);if(void 0===o){if(i!==ua)return i;n.set(t,o=e.push(t)-1)}return r[o%r.length]}return o.domain=function(t){if(!arguments.length)return e.slice();e=[],n=new or;for(const r of t)n.has(r)||n.set(r,e.push(r)-1);return o},o.range=function(t){return arguments.length?(r=Array.from(t),o):r.slice()},o.unknown=function(t){return arguments.length?(i=t,o):i},o.copy=function(){return t(e,r).unknown(i)},aa.apply(o,arguments),o}(sa);function ca(t,n,e){n&&"string"==typeof e&&t.filter((function(t){return!t[e]})).forEach((function(t){t[e]=la(n(t))}))}var ha=function(t,n){return n.onNeedsRedraw&&n.onNeedsRedraw()},fa=function(t,n){if(!n.isShadow){var e=ti(n.linkDirectionalParticles);n.graphData.links.forEach((function(t){var n=Math.round(Math.abs(e(t)));n?t.__photons=c(Array(n)).map((function(){return{}})):delete t.__photons}))}},da=Jr({props:{graphData:{default:{nodes:[],links:[]},onChange:function(t,n){n.engineRunning=!1,fa(0,n)}},dagMode:{onChange:function(t,n){!t&&(n.graphData.nodes||[]).forEach((function(t){return t.fx=t.fy=void 0}))}},dagLevelDistance:{},dagNodeFilter:{default:function(t){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{default:4,triggerUpdate:!1,onChange:ha},nodeId:{default:"id"},nodeVal:{default:"val",triggerUpdate:!1,onChange:ha},nodeColor:{default:"color",triggerUpdate:!1,onChange:ha},nodeAutoColorBy:{},nodeCanvasObject:{triggerUpdate:!1,onChange:ha},nodeCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:ha},nodeVisibility:{default:!0,triggerUpdate:!1,onChange:ha},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0,triggerUpdate:!1,onChange:ha},linkColor:{default:"color",triggerUpdate:!1,onChange:ha},linkAutoColorBy:{},linkLineDash:{triggerUpdate:!1,onChange:ha},linkWidth:{default:1,triggerUpdate:!1,onChange:ha},linkCurvature:{default:0,triggerUpdate:!1,onChange:ha},linkCanvasObject:{triggerUpdate:!1,onChange:ha},linkCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:ha},linkDirectionalArrowLength:{default:0,triggerUpdate:!1,onChange:ha},linkDirectionalArrowColor:{triggerUpdate:!1,onChange:ha},linkDirectionalArrowRelPos:{default:.5,triggerUpdate:!1,onChange:ha},linkDirectionalParticles:{default:0,triggerUpdate:!1,onChange:fa},linkDirectionalParticleSpeed:{default:.01,triggerUpdate:!1},linkDirectionalParticleWidth:{default:4,triggerUpdate:!1},linkDirectionalParticleColor:{triggerUpdate:!1},globalScale:{default:1,triggerUpdate:!1},d3AlphaMin:{default:0,triggerUpdate:!1},d3AlphaDecay:{default:.0228,triggerUpdate:!1,onChange:function(t,n){n.forceLayout.alphaDecay(t)}},d3AlphaTarget:{default:0,triggerUpdate:!1,onChange:function(t,n){n.forceLayout.alphaTarget(t)}},d3VelocityDecay:{default:.4,triggerUpdate:!1,onChange:function(t,n){n.forceLayout.velocityDecay(t)}},warmupTicks:{default:0,triggerUpdate:!1},cooldownTicks:{default:1/0,triggerUpdate:!1},cooldownTime:{default:15e3,triggerUpdate:!1},onUpdate:{default:function(){},triggerUpdate:!1},onFinishUpdate:{default:function(){},triggerUpdate:!1},onEngineTick:{default:function(){},triggerUpdate:!1},onEngineStop:{default:function(){},triggerUpdate:!1},onNeedsRedraw:{triggerUpdate:!1},isShadow:{default:!1,triggerUpdate:!1}},methods:{d3Force:function(t,n,e){return void 0===e?t.forceLayout.force(n):(t.forceLayout.force(n,e),this)},d3ReheatSimulation:function(t){return t.forceLayout.alpha(1),this.resetCountdown(),this},resetCountdown:function(t){return t.cntTicks=0,t.startTickTime=new Date,t.engineRunning=!0,this},isEngineRunning:function(t){return!!t.engineRunning},tickFrame:function(t){var e,r,i,o,a,u;return!t.isShadow&&t.engineRunning&&(++t.cntTicks>t.cooldownTicks||new Date-t.startTickTime>t.cooldownTime||t.d3AlphaMin>0&&t.forceLayout.alpha()<t.d3AlphaMin?(t.engineRunning=!1,t.onEngineStop()):(t.forceLayout.tick(),t.onEngineTick())),function(){var n=ti(t.linkVisibility),e=ti(t.linkColor),r=ti(t.linkWidth),i=ti(t.linkLineDash),o=ti(t.linkCurvature),a=ti(t.linkCanvasObjectMode),u=t.ctx,s=2*t.isShadow,h=t.graphData.links.filter(n);h.forEach((function(t){var n=o(t);if(!n)return void(t.__controlPoints=null);var e=t.source,r=t.target;if(!(e&&r&&e.hasOwnProperty("x")&&r.hasOwnProperty("x")))return;var i=Math.sqrt(Math.pow(r.x-e.x,2)+Math.pow(r.y-e.y,2));if(i>0){var a=Math.atan2(r.y-e.y,r.x-e.x),u=i*n,s={x:(e.x+r.x)/2+u*Math.cos(a-Math.PI/2),y:(e.y+r.y)/2+u*Math.sin(a-Math.PI/2)};t.__controlPoints=[s.x,s.y]}else{var l=70*n;t.__controlPoints=[r.x,r.y-l,r.x+l,r.y]}}));var f=[],d=[],p=h;if(t.linkCanvasObject){var g=[],y=[];h.forEach((function(t){return({before:f,after:d,replace:g}[a(t)]||y).push(t)})),p=[].concat(c(f),d,y),f=f.concat(g)}u.save(),f.forEach((function(n){return t.linkCanvasObject(n,u,t.globalScale)})),u.restore();var v=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=(n instanceof Array?n.length?n:[void 0]:[n]).map((function(t){return{keyAccessor:t,isProp:!(t instanceof Function)}})),o=t.reduce((function(t,n){var r=t,o=n;return i.forEach((function(t,n){var a,u=t.keyAccessor;if(t.isProp){var s=o,l=s[u],c=ta(s,[u].map(oa));a=l,o=c}else a=u(o,n);n+1<i.length?(r.hasOwnProperty(a)||(r[a]={}),r=r[a]):e?(r.hasOwnProperty(a)||(r[a]=[]),r[a].push(o)):r[a]=o})),t}),{});e instanceof Function&&function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;r===i.length?Object.keys(n).forEach((function(t){return n[t]=e(n[t])})):Object.values(n).forEach((function(n){return t(n,r+1)}))}(o);var a=o;return r&&(a=[],function t(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];e.length===i.length?a.push({keys:e,vals:n}):Object.entries(n).forEach((function(n){var r=na(n,2),i=r[0],o=r[1];return t(o,[].concat(ea(e),[i]))}))}(o),n instanceof Array&&0===n.length&&1===a.length&&(a[0].keys=[])),a}(p,[e,r,i]);u.save(),Object.entries(v).forEach((function(n){var e=l(n,2),r=e[0],o=e[1],a=r&&"undefined"!==r?r:"rgba(0,0,0,0.15)";Object.entries(o).forEach((function(n){var e=l(n,2),r=e[0],o=e[1],h=(r||1)/t.globalScale+s;Object.entries(o).forEach((function(t){var n=l(t,2);n[0];var e=n[1],r=i(e[0]);u.beginPath(),e.forEach((function(t){var n=t.source,e=t.target;if(n&&e&&n.hasOwnProperty("x")&&e.hasOwnProperty("x")){u.moveTo(n.x,n.y);var r=t.__controlPoints;r?u[2===r.length?"quadraticCurveTo":"bezierCurveTo"].apply(u,c(r).concat([e.x,e.y])):u.lineTo(e.x,e.y)}})),u.strokeStyle=a,u.lineWidth=h,u.setLineDash(r||[]),u.stroke()}))}))})),u.restore(),u.save(),d.forEach((function(n){return t.linkCanvasObject(n,u,t.globalScale)})),u.restore()}(),!t.isShadow&&(e=ti(t.linkDirectionalArrowLength),r=ti(t.linkDirectionalArrowRelPos),i=ti(t.linkVisibility),o=ti(t.linkDirectionalArrowColor||t.linkColor),a=ti(t.nodeVal),(u=t.ctx).save(),t.graphData.links.filter(i).forEach((function(i){var s=e(i);if(s&&!(s<0)){var l=i.source,h=i.target;if(l&&h&&l.hasOwnProperty("x")&&h.hasOwnProperty("x")){var f=Math.sqrt(Math.max(0,a(l)||1))*t.nodeRelSize,d=Math.sqrt(Math.max(0,a(h)||1))*t.nodeRelSize,p=Math.min(1,Math.max(0,r(i))),g=o(i)||"rgba(0,0,0,0.28)",y=s/1.6/2,v=i.__controlPoints&&n(Jo,[l.x,l.y].concat(c(i.__controlPoints),[h.x,h.y])),_=v?function(t){return v.get(t)}:function(t){return{x:l.x+(h.x-l.x)*t||0,y:l.y+(h.y-l.y)*t||0}},m=v?v.length():Math.sqrt(Math.pow(h.x-l.x,2)+Math.pow(h.y-l.y,2)),x=f+s+(m-f-d-s)*p,b=_(x/m),w=_((x-s)/m),k=_((x-.8*s)/m),M=Math.atan2(b.y-w.y,b.x-w.x)-Math.PI/2;u.beginPath(),u.moveTo(b.x,b.y),u.lineTo(w.x+y*Math.cos(M),w.y+y*Math.sin(M)),u.lineTo(k.x,k.y),u.lineTo(w.x-y*Math.cos(M),w.y-y*Math.sin(M)),u.fillStyle=g,u.fill()}}})),u.restore()),!t.isShadow&&function(){var e=ti(t.linkDirectionalParticles),r=ti(t.linkDirectionalParticleSpeed),i=ti(t.linkDirectionalParticleWidth),o=ti(t.linkVisibility),a=ti(t.linkDirectionalParticleColor||t.linkColor),u=t.ctx;u.save(),t.graphData.links.filter(o).forEach((function(o){var s=e(o);if(o.hasOwnProperty("__photons")&&o.__photons.length){var l=o.source,h=o.target;if(l&&h&&l.hasOwnProperty("x")&&h.hasOwnProperty("x")){var f=r(o),d=o.__photons||[],p=Math.max(0,i(o)/2)/Math.sqrt(t.globalScale),g=a(o)||"rgba(0,0,0,0.28)";u.fillStyle=g;var y=o.__controlPoints?n(Jo,[l.x,l.y].concat(c(o.__controlPoints),[h.x,h.y])):null,v=0,_=!1;d.forEach((function(t){var n=!!t.__singleHop;if(t.hasOwnProperty("__progressRatio")||(t.__progressRatio=n?0:v/s),!n&&v++,t.__progressRatio+=f,t.__progressRatio>=1){if(n)return void(_=!0);t.__progressRatio=t.__progressRatio%1}var e=t.__progressRatio,r=y?y.get(e):{x:l.x+(h.x-l.x)*e||0,y:l.y+(h.y-l.y)*e||0};u.beginPath(),u.arc(r.x,r.y,p,0,2*Math.PI,!1),u.fill()})),_&&(o.__photons=o.__photons.filter((function(t){return!t.__singleHop||t.__progressRatio<=1})))}}})),u.restore()}(),function(){var n=ti(t.nodeVisibility),e=ti(t.nodeVal),r=ti(t.nodeColor),i=ti(t.nodeCanvasObjectMode),o=t.ctx,a=t.isShadow/t.globalScale,u=t.graphData.nodes.filter(n);o.save(),u.forEach((function(n){var u=i(n);if(!t.nodeCanvasObject||"before"!==u&&"replace"!==u||(t.nodeCanvasObject(n,o,t.globalScale),"replace"!==u)){var s=Math.sqrt(Math.max(0,e(n)||1))*t.nodeRelSize+a;o.beginPath(),o.arc(n.x,n.y,s,0,2*Math.PI,!1),o.fillStyle=r(n)||"rgba(31, 120, 180, 0.92)",o.fill(),t.nodeCanvasObject&&"after"===u&&t.nodeCanvasObject(n,t.ctx,t.globalScale)}else o.restore()})),o.restore()}(),this},emitParticle:function(t,n){return n&&(!n.__photons&&(n.__photons=[]),n.__photons.push({__singleHop:!0})),this}},stateInit:function(){return{forceLayout:So().force("link",_o()).force("charge",Co()).force("center",Bi()).force("dagRadial",null).stop(),engineRunning:!1}},init:function(t,n){n.ctx=t},update:function(t){t.engineRunning=!1,t.onUpdate(),null!==t.nodeAutoColorBy&&ca(t.graphData.nodes,ti(t.nodeAutoColorBy),t.nodeColor),null!==t.linkAutoColorBy&&ca(t.graphData.links,ti(t.linkAutoColorBy),t.linkColor),t.graphData.links.forEach((function(n){n.source=n[t.linkSource],n.target=n[t.linkTarget]})),t.forceLayout.stop().alpha(1).nodes(t.graphData.nodes);var n=t.forceLayout.force("link");n&&n.id((function(n){return n[t.nodeId]})).links(t.graphData.links);var e=t.dagMode&&function(t,n){var e=t.nodes,r=t.links,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=i.nodeFilter,s=void 0===o?function(){return!0}:o,h=i.onLoopError,f=void 0===h?function(t){throw"Invalid DAG structure! Found cycle in node path: ".concat(t.join(" -> "),".")}:h,d={};e.forEach((function(t){return d[n(t)]={data:t,out:[],depth:-1,skip:!s(t)}})),r.forEach((function(t){var e=t.source,r=t.target,i=l(e),o=l(r);if(!d.hasOwnProperty(i))throw"Missing source node with id: ".concat(i);if(!d.hasOwnProperty(o))throw"Missing target node with id: ".concat(o);var u=d[i],s=d[o];function l(t){return"object"===a(t)?n(t):t}u.out.push(s)}));var p=[];return function t(e){for(var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=function(){var o=e[a];if(-1!==r.indexOf(o)){var u=[].concat(c(r.slice(r.indexOf(o))),[o]).map((function(t){return n(t.data)}));return p.some((function(t){return t.length===u.length&&t.every((function(t,n){return t===u[n]}))}))||(p.push(u),f(u)),1}i>o.depth&&(o.depth=i,t(o.out,[].concat(c(r),[o]),i+(o.skip?0:1)))},a=0,u=e.length;a<u;a++)o()}(Object.values(d)),Object.assign.apply(Object,[{}].concat(c(Object.entries(d).filter((function(t){return!l(t,2)[1].skip})).map((function(t){var n=l(t,2);return u({},n[0],n[1].depth)})))))}(t.graphData,(function(n){return n[t.nodeId]}),{nodeFilter:t.dagNodeFilter,onLoopError:t.onDagError||void 0}),r=Math.max.apply(Math,c(Object.values(e||[]))),i=t.dagLevelDistance||t.graphData.nodes.length/(r||1)*2*(-1!==["radialin","radialout"].indexOf(t.dagMode)?.7:1);if(t.dagMode){var o=function(n,o){return function(a){return n?(e[a[t.nodeId]]-r/2)*i*(o?-1:1):void 0}},s=o(-1!==["lr","rl"].indexOf(t.dagMode),"rl"===t.dagMode),h=o(-1!==["td","bu"].indexOf(t.dagMode),"bu"===t.dagMode);t.graphData.nodes.filter(t.dagNodeFilter).forEach((function(t){t.fx=s(t),t.fy=h(t)}))}t.forceLayout.force("dagRadial",-1!==["radialin","radialout"].indexOf(t.dagMode)?function(t,n,e,r){var i,o,a,u,s=po(.1);function l(t){for(var s=0,l=i.length;s<l;++s){var c=i[s],h=c.x-n||1e-6,f=(c.y||0)-e||1e-6,d=(c.z||0)-r||1e-6,p=Math.sqrt(h*h+f*f+d*d),g=(u[s]-p)*a[s]*t/p;c.vx+=h*g,o>1&&(c.vy+=f*g),o>2&&(c.vz+=d*g)}}function c(){if(i){var n,e=i.length;for(a=new Array(e),u=new Array(e),n=0;n<e;++n)u[n]=+t(i[n],n,i),a[n]=isNaN(u[n])?0:+s(i[n],n,i)}}return"function"!=typeof t&&(t=po(+t)),null==n&&(n=0),null==e&&(e=0),null==r&&(r=0),l.initialize=function(t,...n){i=t,o=n.find((t=>[1,2,3].includes(t)))||2,c()},l.strength=function(t){return arguments.length?(s="function"==typeof t?t:po(+t),c(),l):s},l.radius=function(n){return arguments.length?(t="function"==typeof n?n:po(+n),c(),l):t},l.x=function(t){return arguments.length?(n=+t,l):n},l.y=function(t){return arguments.length?(e=+t,l):e},l.z=function(t){return arguments.length?(r=+t,l):r},l}((function(n){var o=e[n[t.nodeId]]||-1;return("radialin"===t.dagMode?r-o:o)*i})).strength((function(n){return t.dagNodeFilter(n)?1:0})):null);for(var f=0;f<t.warmupTicks&&!(t.d3AlphaMin>0&&t.forceLayout.alpha()<t.d3AlphaMin);f++)t.forceLayout.tick();this.resetCountdown(),t.onFinishUpdate()}});function pa(t,n){var e=t instanceof Array?t:[t],r=new n;return r._destructor&&r._destructor(),{linkProp:function(t){return{default:r[t](),onChange:function(n,r){e.forEach((function(e){return r[e][t](n)}))},triggerUpdate:!1}},linkMethod:function(t){return function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];var a=[];return e.forEach((function(e){var r=n[e],o=r[t].apply(r,i);o!==r&&a.push(o)})),a.length?a[0]:this}}}}var ga=pa("forceGraph",da),ya=pa(["forceGraph","shadowGraph"],da),va=Object.assign.apply(Object,c(["nodeColor","nodeAutoColorBy","nodeCanvasObject","nodeCanvasObjectMode","linkColor","linkAutoColorBy","linkLineDash","linkWidth","linkCanvasObject","linkCanvasObjectMode","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","dagMode","dagLevelDistance","dagNodeFilter","onDagError","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].map((function(t){return u({},t,ga.linkProp(t))}))).concat(c(["nodeRelSize","nodeId","nodeVal","nodeVisibility","linkSource","linkTarget","linkVisibility","linkCurvature"].map((function(t){return u({},t,ya.linkProp(t))}))))),_a=Object.assign.apply(Object,c(["d3Force","d3ReheatSimulation","emitParticle"].map((function(t){return u({},t,ga.linkMethod(t))}))));function ma(t){if(t.canvas){var n=t.canvas.width,e=t.canvas.height;300===n&&150===e&&(n=e=0);var r=window.devicePixelRatio;n/=r,e/=r,[t.canvas,t.shadowCanvas].forEach((function(i){i.style.width="".concat(t.width,"px"),i.style.height="".concat(t.height,"px"),i.width=t.width*r,i.height=t.height*r,n||e||i.getContext("2d").scale(r,r)}));var i=We(t.canvas).k;t.zoom.translateBy(t.zoom.__baseElem,(t.width-n)/2/i,(t.height-e)/2/i),t.needsRedraw=!0}}function xa(t){var n=window.devicePixelRatio;t.setTransform(n,0,0,n,0,0)}function ba(t,n,e){t.save(),xa(t),t.clearRect(0,0,n,e),t.restore()}var wa=Jr({props:i({width:{default:window.innerWidth,onChange:function(t,n){return ma(n)},triggerUpdate:!1},height:{default:window.innerHeight,onChange:function(t,n){return ma(n)},triggerUpdate:!1},graphData:{default:{nodes:[],links:[]},onChange:function(t,n){[{type:"Node",objs:t.nodes},{type:"Link",objs:t.links}].forEach((function(t){var e=t.type;t.objs.filter((function(t){if(!t.hasOwnProperty("__indexColor"))return!0;var e=n.colorTracker.lookup(t.__indexColor);return!e||!e.hasOwnProperty("d")||e.d!==t})).forEach((function(t){t.__indexColor=n.colorTracker.register({type:e,d:t})}))})),n.forceGraph.graphData(t),n.shadowGraph.graphData(t)},triggerUpdate:!1},backgroundColor:{onChange:function(t,n){n.canvas&&t&&(n.canvas.style.background=t)},triggerUpdate:!1},nodeLabel:{default:"name",triggerUpdate:!1},nodePointerAreaPaint:{onChange:function(t,n){n.shadowGraph.nodeCanvasObject(t?function(n,e,r){return t(n,n.__indexColor,e,r)}:null),n.flushShadowCanvas&&n.flushShadowCanvas()},triggerUpdate:!1},linkPointerAreaPaint:{onChange:function(t,n){n.shadowGraph.linkCanvasObject(t?function(n,e,r){return t(n,n.__indexColor,e,r)}:null),n.flushShadowCanvas&&n.flushShadowCanvas()},triggerUpdate:!1},linkLabel:{default:"name",triggerUpdate:!1},linkHoverPrecision:{default:4,triggerUpdate:!1},minZoom:{default:.01,onChange:function(t,n){n.zoom.scaleExtent([t,n.zoom.scaleExtent()[1]])},triggerUpdate:!1},maxZoom:{default:1e3,onChange:function(t,n){n.zoom.scaleExtent([n.zoom.scaleExtent()[0],t])},triggerUpdate:!1},enableNodeDrag:{default:!0,triggerUpdate:!1},enableZoomInteraction:{default:!0,triggerUpdate:!1},enablePanInteraction:{default:!0,triggerUpdate:!1},enableZoomPanInteraction:{default:!0,triggerUpdate:!1},enablePointerInteraction:{default:!0,onChange:function(t,n){n.hoverObj=null},triggerUpdate:!1},autoPauseRedraw:{default:!0,triggerUpdate:!1},onNodeDrag:{default:function(){},triggerUpdate:!1},onNodeDragEnd:{default:function(){},triggerUpdate:!1},onNodeClick:{triggerUpdate:!1},onNodeRightClick:{triggerUpdate:!1},onNodeHover:{triggerUpdate:!1},onLinkClick:{triggerUpdate:!1},onLinkRightClick:{triggerUpdate:!1},onLinkHover:{triggerUpdate:!1},onBackgroundClick:{triggerUpdate:!1},onBackgroundRightClick:{triggerUpdate:!1},onZoom:{triggerUpdate:!1},onZoomEnd:{triggerUpdate:!1},onRenderFramePre:{triggerUpdate:!1},onRenderFramePost:{triggerUpdate:!1}},va),aliases:{stopAnimation:"pauseAnimation"},methods:i({graph2ScreenCoords:function(t,n,e){var r=We(t.canvas);return{x:n*r.k+r.x,y:e*r.k+r.y}},screen2GraphCoords:function(t,n,e){var r=We(t.canvas);return{x:(n-r.x)/r.k,y:(e-r.y)/r.k}},centerAt:function(t,n,e,r){if(!t.canvas)return null;if(void 0!==n||void 0!==e){var i=Object.assign({},void 0!==n?{x:n}:{},void 0!==e?{y:e}:{});return r?new Vr(o()).to(i,r).easing(Fr.Quadratic.Out).onUpdate(a).start():a(i),this}return o();function o(){var n=We(t.canvas);return{x:(t.width/2-n.x)/n.k,y:(t.height/2-n.y)/n.k}}function a(n){var e=n.x,r=n.y;t.zoom.translateTo(t.zoom.__baseElem,void 0===e?o().x:e,void 0===r?o().y:r),t.needsRedraw=!0}},zoom:function(t,n,e){return t.canvas?void 0!==n?(e?new Vr({k:r()}).to({k:n},e).easing(Fr.Quadratic.Out).onUpdate((function(t){return i(t.k)})).start():i(n),this):r():null;function r(){return We(t.canvas).k}function i(n){t.zoom.scaleTo(t.zoom.__baseElem,n),t.needsRedraw=!0}},zoomToFit:function(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=arguments.length,i=new Array(r>3?r-3:0),o=3;o<r;o++)i[o-3]=arguments[o];var a=this.getGraphBbox.apply(this,i);if(a){var u={x:(a.x[0]+a.x[1])/2,y:(a.y[0]+a.y[1])/2},s=Math.max(1e-12,Math.min(1e12,(t.width-2*e)/(a.x[1]-a.x[0]),(t.height-2*e)/(a.y[1]-a.y[0])));this.centerAt(u.x,u.y,n),this.zoom(s,n)}return this},getGraphBbox:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},e=ti(t.nodeVal),r=function(n){return Math.sqrt(Math.max(0,e(n)||1))*t.nodeRelSize},i=t.graphData.nodes.filter(n).map((function(t){return{x:t.x,y:t.y,r:r(t)}}));return i.length?{x:[lr(i,(function(t){return t.x-t.r})),sr(i,(function(t){return t.x+t.r}))],y:[lr(i,(function(t){return t.y-t.r})),sr(i,(function(t){return t.y+t.r}))]}:null},pauseAnimation:function(t){return t.animationFrameRequestId&&(cancelAnimationFrame(t.animationFrameRequestId),t.animationFrameRequestId=null),this},resumeAnimation:function(t){return t.animationFrameRequestId||this._animationCycle(),this},_destructor:function(){this.pauseAnimation(),this.graphData({nodes:[],links:[]})}},_a),stateInit:function(){return{lastSetZoom:1,zoom:ir(),forceGraph:new da,shadowGraph:(new da).cooldownTicks(0).nodeColor("__indexColor").linkColor("__indexColor").isShadow(!0),colorTracker:new qi}},init:function(t,n){var e=this;t.innerHTML="";var r=document.createElement("div");r.classList.add("force-graph-container"),r.style.position="relative",t.appendChild(r),n.canvas=document.createElement("canvas"),n.backgroundColor&&(n.canvas.style.background=n.backgroundColor),r.appendChild(n.canvas),n.shadowCanvas=document.createElement("canvas");var o=n.canvas.getContext("2d"),a=n.shadowCanvas.getContext("2d",{willReadFrequently:!0}),u={x:-1e12,y:-1e12},s=function(){var t=null,e=window.devicePixelRatio,r=u.x>0&&u.y>0?a.getImageData(u.x*e,u.y*e,1,1):null;return r&&(t=n.colorTracker.lookup(r.data)),t};zt(n.canvas).call(function(){var t,n,e,r,i=Lt,o=qt,a=Bt,u=$t,s={},l=Ct("start","drag","end"),c=0,h=0;function f(t){t.on("mousedown.drag",d).filter(u).on("touchstart.drag",y).on("touchmove.drag",v,Pt).on("touchend.drag touchcancel.drag",_).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(a,u){if(!r&&i.call(this,a,u)){var s=m(this,o.call(this,a,u),a,u,"mouse");s&&(zt(a.view).on("mousemove.drag",p,jt).on("mouseup.drag",g,jt),Dt(a.view),Tt(a),e=!1,t=a.clientX,n=a.clientY,s("start",a))}}function p(r){if(Rt(r),!e){var i=r.clientX-t,o=r.clientY-n;e=i*i+o*o>h}s.mouse("drag",r)}function g(t){zt(t.view).on("mousemove.drag mouseup.drag",null),It(t.view,e),Rt(t),s.mouse("end",t)}function y(t,n){if(i.call(this,t,n)){var e,r,a=t.changedTouches,u=o.call(this,t,n),s=a.length;for(e=0;e<s;++e)(r=m(this,u,t,n,a[e].identifier,a[e]))&&(Tt(t),r("start",t,a[e]))}}function v(t){var n,e,r=t.changedTouches,i=r.length;for(n=0;n<i;++n)(e=s[r[n].identifier])&&(Rt(t),e("drag",t,r[n]))}function _(t){var n,e,i=t.changedTouches,o=i.length;for(r&&clearTimeout(r),r=setTimeout((function(){r=null}),500),n=0;n<o;++n)(e=s[i[n].identifier])&&(Tt(t),e("end",t,i[n]))}function m(t,n,e,r,i,o){var u,h,d,p=l.copy(),g=At(o||e,n);if(null!=(d=a.call(t,new Ft("beforestart",{sourceEvent:e,target:f,identifier:i,active:c,x:g[0],y:g[1],dx:0,dy:0,dispatch:p}),r)))return u=d.x-g[0]||0,h=d.y-g[1]||0,function e(o,a,l){var y,v=g;switch(o){case"start":s[i]=e,y=c++;break;case"end":delete s[i],--c;case"drag":g=At(l||a,n),y=c}p.call(o,t,new Ft(o,{sourceEvent:a,subject:d,target:f,identifier:i,active:y,x:g[0]+u,y:g[1]+h,dx:g[0]-v[0],dy:g[1]-v[1],dispatch:p}),r)}}return f.filter=function(t){return arguments.length?(i="function"==typeof t?t:Ut(!!t),f):i},f.container=function(t){return arguments.length?(o="function"==typeof t?t:Ut(t),f):o},f.subject=function(t){return arguments.length?(a="function"==typeof t?t:Ut(t),f):a},f.touchable=function(t){return arguments.length?(u="function"==typeof t?t:Ut(!!t),f):u},f.on=function(){var t=l.on.apply(l,arguments);return t===l?f:t},f.clickDistance=function(t){return arguments.length?(h=(t=+t)*t,f):Math.sqrt(h)},f}().subject((function(){if(!n.enableNodeDrag)return null;var t=s();return t&&"Node"===t.type?t.d:null})).on("start",(function(t){var e=t.subject;e.__initialDragPos={x:e.x,y:e.y,fx:e.fx,fy:e.fy},t.active||(e.fx=e.x,e.fy=e.y),n.canvas.classList.add("grabbable")})).on("drag",(function(t){var e=t.subject,r=e.__initialDragPos,i=t,o=We(n.canvas).k,a={x:r.x+(i.x-r.x)/o-e.x,y:r.y+(i.y-r.y)/o-e.y};["x","y"].forEach((function(t){return e["f".concat(t)]=e[t]=r[t]+(i[t]-r[t])/o})),n.forceGraph.d3AlphaTarget(.3).resetCountdown(),n.isPointerDragging=!0,e.__dragged=!0,n.onNodeDrag(e,a)})).on("end",(function(t){var e=t.subject,r=e.__initialDragPos,i={x:e.x-r.x,y:e.y-r.y};void 0===r.fx&&(e.fx=void 0),void 0===r.fy&&(e.fy=void 0),delete e.__initialDragPos,n.forceGraph.d3AlphaTarget()&&n.forceGraph.d3AlphaTarget(0).resetCountdown(),n.canvas.classList.remove("grabbable"),n.isPointerDragging=!1,e.__dragged&&(delete e.__dragged,n.onNodeDragEnd(e,i))}))),n.zoom(n.zoom.__baseElem=zt(n.canvas)),n.zoom.__baseElem.on("dblclick.zoom",null),n.zoom.filter((function(t){return!t.button&&n.enableZoomPanInteraction&&(n.enableZoomInteraction||"wheel"!==t.type)&&(n.enablePanInteraction||"wheel"===t.type)})).on("zoom",(function(t){var r=t.transform;[o,a].forEach((function(t){xa(t),t.translate(r.x,r.y),t.scale(r.k,r.k)})),n.onZoom&&n.onZoom(i(i({},r),e.centerAt())),n.needsRedraw=!0})).on("end",(function(t){return n.onZoomEnd&&n.onZoomEnd(i(i({},t.transform),e.centerAt()))})),ma(n),n.forceGraph.onNeedsRedraw((function(){return n.needsRedraw=!0})).onFinishUpdate((function(){We(n.canvas).k===n.lastSetZoom&&n.graphData.nodes.length&&(n.zoom.scaleTo(n.zoom.__baseElem,n.lastSetZoom=4/Math.cbrt(n.graphData.nodes.length)),n.needsRedraw=!0)}));var l=document.createElement("div");l.classList.add("graph-tooltip"),r.appendChild(l),["pointermove","pointerdown"].forEach((function(t){return r.addEventListener(t,(function(e){"pointerdown"===t&&(n.isPointerPressed=!0,n.pointerDownEvent=e),!n.isPointerDragging&&"pointermove"===e.type&&n.onBackgroundClick&&(e.pressure>0||n.isPointerPressed)&&("touch"!==e.pointerType||void 0===e.movementX||[e.movementX,e.movementY].some((function(t){return Math.abs(t)>1})))&&(n.isPointerDragging=!0);var i,o,a,s=(i=r.getBoundingClientRect(),o=window.pageXOffset||document.documentElement.scrollLeft,a=window.pageYOffset||document.documentElement.scrollTop,{top:i.top+a,left:i.left+o});u.x=e.pageX-s.left,u.y=e.pageY-s.top,l.style.top="".concat(u.y,"px"),l.style.left="".concat(u.x,"px"),l.style.transform="translate(-".concat(u.x/n.width*100,"%, ").concat(n.height-u.y<100?"calc(-100% - 8px)":"21px",")")}),{passive:!0})})),r.addEventListener("pointerup",(function(t){if(n.isPointerPressed=!1,n.isPointerDragging)n.isPointerDragging=!1;else{var e=[t,n.pointerDownEvent];requestAnimationFrame((function(){if(0===t.button)if(n.hoverObj){var r=n["on".concat(n.hoverObj.type,"Click")];r&&r.apply(void 0,[n.hoverObj.d].concat(e))}else n.onBackgroundClick&&n.onBackgroundClick.apply(n,e);if(2===t.button)if(n.hoverObj){var i=n["on".concat(n.hoverObj.type,"RightClick")];i&&i.apply(void 0,[n.hoverObj.d].concat(e))}else n.onBackgroundRightClick&&n.onBackgroundRightClick.apply(n,e)}))}}),{passive:!0}),r.addEventListener("contextmenu",(function(t){return!(n.onBackgroundRightClick||n.onNodeRightClick||n.onLinkRightClick)||(t.preventDefault(),!1)})),n.forceGraph(o),n.shadowGraph(a);var c=function(t,n,e){var r=!0,i=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return Sr(e)&&(r="leading"in e?!!e.leading:r,i="trailing"in e?!!e.trailing:i),Ur(t,n,{leading:r,maxWait:n,trailing:i})}((function(){ba(a,n.width,n.height),n.shadowGraph.linkWidth((function(t){return ti(n.linkWidth)(t)+n.linkHoverPrecision}));var t=We(n.canvas);n.shadowGraph.globalScale(t.k).tickFrame()}),800);n.flushShadowCanvas=c.flush,(this._animationCycle=function t(){var e=!n.autoPauseRedraw||!!n.needsRedraw||n.forceGraph.isEngineRunning()||n.graphData.links.some((function(t){return t.__photons&&t.__photons.length}));if(n.needsRedraw=!1,n.enablePointerInteraction){var r=n.isPointerDragging?null:s();if(r!==n.hoverObj){var i=n.hoverObj,a=i?i.type:null,u=r?r.type:null;if(a&&a!==u){var h=n["on".concat(a,"Hover")];h&&h(null,i.d)}if(u){var f=n["on".concat(u,"Hover")];f&&f(r.d,a===u?i.d:null)}var d=r&&ti(n["".concat(r.type.toLowerCase(),"Label")])(r.d)||"";l.style.visibility=d?"visible":"hidden",l.innerHTML=d,n.canvas.classList[r&&n["on".concat(u,"Click")]||!r&&n.onBackgroundClick?"add":"remove"]("clickable"),n.hoverObj=r}e&&c()}if(e){ba(o,n.width,n.height);var p=We(n.canvas).k;n.onRenderFramePre&&n.onRenderFramePre(o,p),n.forceGraph.globalScale(p).tickFrame(),n.onRenderFramePost&&n.onRenderFramePost(o,p)}Gr(),n.animationFrameRequestId=requestAnimationFrame(t)})()},update:function(t){}});return wa}));
</script>
    <script>/**
 * marked v14.1.0 - a markdown parser
 * Copyright (c) 2011-2024, Christopher Jeffrey. (MIT Licensed)
 * https://github.com/markedjs/marked
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).marked={})}(this,(function(e){"use strict";function t(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}function n(t){e.defaults=t}e.defaults={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};const s=/[&<>"']/,r=new RegExp(s.source,"g"),i=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,l=new RegExp(i.source,"g"),o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},a=e=>o[e];function c(e,t){if(t){if(s.test(e))return e.replace(r,a)}else if(i.test(e))return e.replace(l,a);return e}const h=/(^|[^\[])\^/g;function p(e,t){let n="string"==typeof e?e:e.source;t=t||"";const s={replace:(e,t)=>{let r="string"==typeof t?t:t.source;return r=r.replace(h,"$1"),n=n.replace(e,r),s},getRegex:()=>new RegExp(n,t)};return s}function u(e){try{e=encodeURI(e).replace(/%25/g,"%")}catch{return null}return e}const k={exec:()=>null};function g(e,t){const n=e.replace(/\|/g,((e,t,n)=>{let s=!1,r=t;for(;--r>=0&&"\\"===n[r];)s=!s;return s?"|":" |"})).split(/ \|/);let s=0;if(n[0].trim()||n.shift(),n.length>0&&!n[n.length-1].trim()&&n.pop(),t)if(n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;s<n.length;s++)n[s]=n[s].trim().replace(/\\\|/g,"|");return n}function f(e,t,n){const s=e.length;if(0===s)return"";let r=0;for(;r<s;){const i=e.charAt(s-r-1);if(i!==t||n){if(i===t||!n)break;r++}else r++}return e.slice(0,s-r)}function d(e,t,n,s){const r=t.href,i=t.title?c(t.title):null,l=e[1].replace(/\\([\[\]])/g,"$1");if("!"!==e[0].charAt(0)){s.state.inLink=!0;const e={type:"link",raw:n,href:r,title:i,text:l,tokens:s.inlineTokens(l)};return s.state.inLink=!1,e}return{type:"image",raw:n,href:r,title:i,text:c(l)}}class x{options;rules;lexer;constructor(t){this.options=t||e.defaults}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const e=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?e:f(e,"\n")}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const e=t[0],n=function(e,t){const n=e.match(/^(\s+)(?:```)/);if(null===n)return t;const s=n[1];return t.split("\n").map((e=>{const t=e.match(/^\s+/);if(null===t)return e;const[n]=t;return n.length>=s.length?e.slice(s.length):e})).join("\n")}(e,t[3]||"");return{type:"code",raw:e,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:n}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let e=t[2].trim();if(/#$/.test(e)){const t=f(e,"#");this.options.pedantic?e=t.trim():t&&!/ $/.test(t)||(e=t.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:e,tokens:this.lexer.inline(e)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:f(t[0],"\n")}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let e=f(t[0],"\n").split("\n"),n="",s="";const r=[];for(;e.length>0;){let t=!1;const i=[];let l;for(l=0;l<e.length;l++)if(/^ {0,3}>/.test(e[l]))i.push(e[l]),t=!0;else{if(t)break;i.push(e[l])}e=e.slice(l);const o=i.join("\n"),a=o.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,"\n    $1").replace(/^ {0,3}>[ \t]?/gm,"");n=n?`${n}\n${o}`:o,s=s?`${s}\n${a}`:a;const c=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(a,r,!0),this.lexer.state.top=c,0===e.length)break;const h=r[r.length-1];if("code"===h?.type)break;if("blockquote"===h?.type){const t=h,i=t.raw+"\n"+e.join("\n"),l=this.blockquote(i);r[r.length-1]=l,n=n.substring(0,n.length-t.raw.length)+l.raw,s=s.substring(0,s.length-t.text.length)+l.text;break}if("list"!==h?.type);else{const t=h,i=t.raw+"\n"+e.join("\n"),l=this.list(i);r[r.length-1]=l,n=n.substring(0,n.length-h.raw.length)+l.raw,s=s.substring(0,s.length-t.raw.length)+l.raw,e=i.substring(r[r.length-1].raw.length).split("\n")}}return{type:"blockquote",raw:n,tokens:r,text:s}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim();const s=n.length>1,r={type:"list",raw:"",ordered:s,start:s?+n.slice(0,-1):"",loose:!1,items:[]};n=s?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=s?n:"[*+-]");const i=new RegExp(`^( {0,3}${n})((?:[\t ][^\\n]*)?(?:\\n|$))`);let l=!1;for(;e;){let n=!1,s="",o="";if(!(t=i.exec(e)))break;if(this.rules.block.hr.test(e))break;s=t[0],e=e.substring(s.length);let a=t[2].split("\n",1)[0].replace(/^\t+/,(e=>" ".repeat(3*e.length))),c=e.split("\n",1)[0],h=!a.trim(),p=0;if(this.options.pedantic?(p=2,o=a.trimStart()):h?p=t[1].length+1:(p=t[2].search(/[^ ]/),p=p>4?1:p,o=a.slice(p),p+=t[1].length),h&&/^ *$/.test(c)&&(s+=c+"\n",e=e.substring(c.length+1),n=!0),!n){const t=new RegExp(`^ {0,${Math.min(3,p-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`),n=new RegExp(`^ {0,${Math.min(3,p-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),r=new RegExp(`^ {0,${Math.min(3,p-1)}}(?:\`\`\`|~~~)`),i=new RegExp(`^ {0,${Math.min(3,p-1)}}#`);for(;e;){const l=e.split("\n",1)[0];if(c=l,this.options.pedantic&&(c=c.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),r.test(c))break;if(i.test(c))break;if(t.test(c))break;if(n.test(e))break;if(c.search(/[^ ]/)>=p||!c.trim())o+="\n"+c.slice(p);else{if(h)break;if(a.search(/[^ ]/)>=4)break;if(r.test(a))break;if(i.test(a))break;if(n.test(a))break;o+="\n"+c}h||c.trim()||(h=!0),s+=l+"\n",e=e.substring(l.length+1),a=c.slice(p)}}r.loose||(l?r.loose=!0:/\n *\n *$/.test(s)&&(l=!0));let u,k=null;this.options.gfm&&(k=/^\[[ xX]\] /.exec(o),k&&(u="[ ] "!==k[0],o=o.replace(/^\[[ xX]\] +/,""))),r.items.push({type:"list_item",raw:s,task:!!k,checked:u,loose:!1,text:o,tokens:[]}),r.raw+=s}r.items[r.items.length-1].raw=r.items[r.items.length-1].raw.trimEnd(),r.items[r.items.length-1].text=r.items[r.items.length-1].text.trimEnd(),r.raw=r.raw.trimEnd();for(let e=0;e<r.items.length;e++)if(this.lexer.state.top=!1,r.items[e].tokens=this.lexer.blockTokens(r.items[e].text,[]),!r.loose){const t=r.items[e].tokens.filter((e=>"space"===e.type)),n=t.length>0&&t.some((e=>/\n.*\n/.test(e.raw)));r.loose=n}if(r.loose)for(let e=0;e<r.items.length;e++)r.items[e].loose=!0;return r}}html(e){const t=this.rules.block.html.exec(e);if(t){return{type:"html",block:!0,raw:t[0],pre:"pre"===t[1]||"script"===t[1]||"style"===t[1],text:t[0]}}}def(e){const t=this.rules.block.def.exec(e);if(t){const e=t[1].toLowerCase().replace(/\s+/g," "),n=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:e,raw:t[0],href:n,title:s}}}table(e){const t=this.rules.block.table.exec(e);if(!t)return;if(!/[:|]/.test(t[2]))return;const n=g(t[1]),s=t[2].replace(/^\||\| *$/g,"").split("|"),r=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split("\n"):[],i={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===s.length){for(const e of s)/^ *-+: *$/.test(e)?i.align.push("right"):/^ *:-+: *$/.test(e)?i.align.push("center"):/^ *:-+ *$/.test(e)?i.align.push("left"):i.align.push(null);for(let e=0;e<n.length;e++)i.header.push({text:n[e],tokens:this.lexer.inline(n[e]),header:!0,align:i.align[e]});for(const e of r)i.rows.push(g(e,i.header.length).map(((e,t)=>({text:e,tokens:this.lexer.inline(e),header:!1,align:i.align[t]}))));return i}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const e="\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:e,tokens:this.lexer.inline(e)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:c(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const e=t[2].trim();if(!this.options.pedantic&&/^</.test(e)){if(!/>$/.test(e))return;const t=f(e.slice(0,-1),"\\");if((e.length-t.length)%2==0)return}else{const e=function(e,t){if(-1===e.indexOf(t[1]))return-1;let n=0;for(let s=0;s<e.length;s++)if("\\"===e[s])s++;else if(e[s]===t[0])n++;else if(e[s]===t[1]&&(n--,n<0))return s;return-1}(t[2],"()");if(e>-1){const n=(0===t[0].indexOf("!")?5:4)+t[1].length+e;t[2]=t[2].substring(0,e),t[0]=t[0].substring(0,n).trim(),t[3]=""}}let n=t[2],s="";if(this.options.pedantic){const e=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(n);e&&(n=e[1],s=e[3])}else s=t[3]?t[3].slice(1,-1):"";return n=n.trim(),/^</.test(n)&&(n=this.options.pedantic&&!/>$/.test(e)?n.slice(1):n.slice(1,-1)),d(t,{href:n?n.replace(this.rules.inline.anyPunctuation,"$1"):n,title:s?s.replace(this.rules.inline.anyPunctuation,"$1"):s},t[0],this.lexer)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){const e=t[(n[2]||n[1]).replace(/\s+/g," ").toLowerCase()];if(!e){const e=n[0].charAt(0);return{type:"text",raw:e,text:e}}return d(n,e,n[0],this.lexer)}}emStrong(e,t,n=""){let s=this.rules.inline.emStrongLDelim.exec(e);if(!s)return;if(s[3]&&n.match(/[\p{L}\p{N}]/u))return;if(!(s[1]||s[2]||"")||!n||this.rules.inline.punctuation.exec(n)){const n=[...s[0]].length-1;let r,i,l=n,o=0;const a="*"===s[0][0]?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(a.lastIndex=0,t=t.slice(-1*e.length+n);null!=(s=a.exec(t));){if(r=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!r)continue;if(i=[...r].length,s[3]||s[4]){l+=i;continue}if((s[5]||s[6])&&n%3&&!((n+i)%3)){o+=i;continue}if(l-=i,l>0)continue;i=Math.min(i,i+l+o);const t=[...s[0]][0].length,a=e.slice(0,n+s.index+t+i);if(Math.min(n,i)%2){const e=a.slice(1,-1);return{type:"em",raw:a,text:e,tokens:this.lexer.inlineTokens(e)}}const c=a.slice(2,-2);return{type:"strong",raw:a,text:c,tokens:this.lexer.inlineTokens(c)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let e=t[2].replace(/\n/g," ");const n=/[^ ]/.test(e),s=/^ /.test(e)&&/ $/.test(e);return n&&s&&(e=e.substring(1,e.length-1)),e=c(e,!0),{type:"codespan",raw:t[0],text:e}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let e,n;return"@"===t[2]?(e=c(t[1]),n="mailto:"+e):(e=c(t[1]),n=e),{type:"link",raw:t[0],text:e,href:n,tokens:[{type:"text",raw:e,text:e}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let e,n;if("@"===t[2])e=c(t[0]),n="mailto:"+e;else{let s;do{s=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??""}while(s!==t[0]);e=c(t[0]),n="www."===t[1]?"http://"+t[0]:t[0]}return{type:"link",raw:t[0],text:e,href:n,tokens:[{type:"text",raw:e,text:e}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let e;return e=this.lexer.state.inRawBlock?t[0]:c(t[0]),{type:"text",raw:t[0],text:e}}}}const b=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,w=/(?:[*+-]|\d{1,9}[.)])/,m=p(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,w).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),y=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,$=/(?!\s*\])(?:\\.|[^\[\]\\])+/,z=p(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",$).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),T=p(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,w).getRegex(),R="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",_=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,A=p("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",_).replace("tag",R).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),S=p(y).replace("hr",b).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",R).getRegex(),I={blockquote:p(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",S).getRegex(),code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,def:z,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hr:b,html:A,lheading:m,list:T,newline:/^(?: *(?:\n|$))+/,paragraph:S,table:k,text:/^[^\n]+/},E=p("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",b).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",R).getRegex(),q={...I,table:E,paragraph:p(y).replace("hr",b).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",E).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",R).getRegex()},Z={...I,html:p("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",_).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:k,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:p(y).replace("hr",b).replace("heading"," *#{1,6} *[^\n]").replace("lheading",m).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},P=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,L=/^( {2,}|\\)\n(?!\s*$)/,v="\\p{P}\\p{S}",Q=p(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,v).getRegex(),B=p(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,v).getRegex(),M=p("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,v).getRegex(),O=p("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,v).getRegex(),j=p(/\\([punct])/,"gu").replace(/punct/g,v).getRegex(),D=p(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),C=p(_).replace("(?:--\x3e|$)","--\x3e").getRegex(),H=p("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",C).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),U=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,X=p(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",U).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),F=p(/^!?\[(label)\]\[(ref)\]/).replace("label",U).replace("ref",$).getRegex(),N=p(/^!?\[(ref)\](?:\[\])?/).replace("ref",$).getRegex(),G={_backpedal:k,anyPunctuation:j,autolink:D,blockSkip:/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,br:L,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,del:k,emStrongLDelim:B,emStrongRDelimAst:M,emStrongRDelimUnd:O,escape:P,link:X,nolink:N,punctuation:Q,reflink:F,reflinkSearch:p("reflink|nolink(?!\\()","g").replace("reflink",F).replace("nolink",N).getRegex(),tag:H,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,url:k},J={...G,link:p(/^!?\[(label)\]\((.*?)\)/).replace("label",U).getRegex(),reflink:p(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",U).getRegex()},K={...G,escape:p(P).replace("])","~|])").getRegex(),url:p(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},V={...K,br:p(L).replace("{2,}","*").getRegex(),text:p(K.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},W={normal:I,gfm:q,pedantic:Z},Y={normal:G,gfm:K,breaks:V,pedantic:J};class ee{tokens;options;state;tokenizer;inlineQueue;constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||e.defaults,this.options.tokenizer=this.options.tokenizer||new x,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={block:W.normal,inline:Y.normal};this.options.pedantic?(n.block=W.pedantic,n.inline=Y.pedantic):this.options.gfm&&(n.block=W.gfm,this.options.breaks?n.inline=Y.breaks:n.inline=Y.gfm),this.tokenizer.rules=n}static get rules(){return{block:W,inline:Y}}static lex(e,t){return new ee(t).lex(e)}static lexInline(e,t){return new ee(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,"\n"),this.blockTokens(e,this.tokens);for(let e=0;e<this.inlineQueue.length;e++){const t=this.inlineQueue[e];this.inlineTokens(t.src,t.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],n=!1){let s,r,i;for(e=this.options.pedantic?e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e.replace(/^( *)(\t+)/gm,((e,t,n)=>t+"    ".repeat(n.length)));e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some((n=>!!(s=n.call({lexer:this},e,t))&&(e=e.substring(s.raw.length),t.push(s),!0)))))if(s=this.tokenizer.space(e))e=e.substring(s.raw.length),1===s.raw.length&&t.length>0?t[t.length-1].raw+="\n":t.push(s);else if(s=this.tokenizer.code(e))e=e.substring(s.raw.length),r=t[t.length-1],!r||"paragraph"!==r.type&&"text"!==r.type?t.push(s):(r.raw+="\n"+s.raw,r.text+="\n"+s.text,this.inlineQueue[this.inlineQueue.length-1].src=r.text);else if(s=this.tokenizer.fences(e))e=e.substring(s.raw.length),t.push(s);else if(s=this.tokenizer.heading(e))e=e.substring(s.raw.length),t.push(s);else if(s=this.tokenizer.hr(e))e=e.substring(s.raw.length),t.push(s);else if(s=this.tokenizer.blockquote(e))e=e.substring(s.raw.length),t.push(s);else if(s=this.tokenizer.list(e))e=e.substring(s.raw.length),t.push(s);else if(s=this.tokenizer.html(e))e=e.substring(s.raw.length),t.push(s);else if(s=this.tokenizer.def(e))e=e.substring(s.raw.length),r=t[t.length-1],!r||"paragraph"!==r.type&&"text"!==r.type?this.tokens.links[s.tag]||(this.tokens.links[s.tag]={href:s.href,title:s.title}):(r.raw+="\n"+s.raw,r.text+="\n"+s.raw,this.inlineQueue[this.inlineQueue.length-1].src=r.text);else if(s=this.tokenizer.table(e))e=e.substring(s.raw.length),t.push(s);else if(s=this.tokenizer.lheading(e))e=e.substring(s.raw.length),t.push(s);else{if(i=e,this.options.extensions&&this.options.extensions.startBlock){let t=1/0;const n=e.slice(1);let s;this.options.extensions.startBlock.forEach((e=>{s=e.call({lexer:this},n),"number"==typeof s&&s>=0&&(t=Math.min(t,s))})),t<1/0&&t>=0&&(i=e.substring(0,t+1))}if(this.state.top&&(s=this.tokenizer.paragraph(i)))r=t[t.length-1],n&&"paragraph"===r?.type?(r.raw+="\n"+s.raw,r.text+="\n"+s.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(s),n=i.length!==e.length,e=e.substring(s.raw.length);else if(s=this.tokenizer.text(e))e=e.substring(s.raw.length),r=t[t.length-1],r&&"text"===r.type?(r.raw+="\n"+s.raw,r.text+="\n"+s.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(s);else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let n,s,r,i,l,o,a=e;if(this.tokens.links){const e=Object.keys(this.tokens.links);if(e.length>0)for(;null!=(i=this.tokenizer.rules.inline.reflinkSearch.exec(a));)e.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(a=a.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(i=this.tokenizer.rules.inline.blockSkip.exec(a));)a=a.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(i=this.tokenizer.rules.inline.anyPunctuation.exec(a));)a=a.slice(0,i.index)+"++"+a.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(l||(o=""),l=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some((s=>!!(n=s.call({lexer:this},e,t))&&(e=e.substring(n.raw.length),t.push(n),!0)))))if(n=this.tokenizer.escape(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.tag(e))e=e.substring(n.raw.length),s=t[t.length-1],s&&"text"===n.type&&"text"===s.type?(s.raw+=n.raw,s.text+=n.text):t.push(n);else if(n=this.tokenizer.link(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.reflink(e,this.tokens.links))e=e.substring(n.raw.length),s=t[t.length-1],s&&"text"===n.type&&"text"===s.type?(s.raw+=n.raw,s.text+=n.text):t.push(n);else if(n=this.tokenizer.emStrong(e,a,o))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.codespan(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.br(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.del(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.autolink(e))e=e.substring(n.raw.length),t.push(n);else if(this.state.inLink||!(n=this.tokenizer.url(e))){if(r=e,this.options.extensions&&this.options.extensions.startInline){let t=1/0;const n=e.slice(1);let s;this.options.extensions.startInline.forEach((e=>{s=e.call({lexer:this},n),"number"==typeof s&&s>=0&&(t=Math.min(t,s))})),t<1/0&&t>=0&&(r=e.substring(0,t+1))}if(n=this.tokenizer.inlineText(r))e=e.substring(n.raw.length),"_"!==n.raw.slice(-1)&&(o=n.raw.slice(-1)),l=!0,s=t[t.length-1],s&&"text"===s.type?(s.raw+=n.raw,s.text+=n.text):t.push(n);else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}else e=e.substring(n.raw.length),t.push(n);return t}}class te{options;parser;constructor(t){this.options=t||e.defaults}space(e){return""}code({text:e,lang:t,escaped:n}){const s=(t||"").match(/^\S*/)?.[0],r=e.replace(/\n$/,"")+"\n";return s?'<pre><code class="language-'+c(s)+'">'+(n?r:c(r,!0))+"</code></pre>\n":"<pre><code>"+(n?r:c(r,!0))+"</code></pre>\n"}blockquote({tokens:e}){return`<blockquote>\n${this.parser.parse(e)}</blockquote>\n`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>\n`}hr(e){return"<hr>\n"}list(e){const t=e.ordered,n=e.start;let s="";for(let t=0;t<e.items.length;t++){const n=e.items[t];s+=this.listitem(n)}const r=t?"ol":"ul";return"<"+r+(t&&1!==n?' start="'+n+'"':"")+">\n"+s+"</"+r+">\n"}listitem(e){let t="";if(e.task){const n=this.checkbox({checked:!!e.checked});e.loose?e.tokens.length>0&&"paragraph"===e.tokens[0].type?(e.tokens[0].text=n+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&"text"===e.tokens[0].tokens[0].type&&(e.tokens[0].tokens[0].text=n+" "+e.tokens[0].tokens[0].text)):e.tokens.unshift({type:"text",raw:n+" ",text:n+" "}):t+=n+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>\n`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>\n`}table(e){let t="",n="";for(let t=0;t<e.header.length;t++)n+=this.tablecell(e.header[t]);t+=this.tablerow({text:n});let s="";for(let t=0;t<e.rows.length;t++){const r=e.rows[t];n="";for(let e=0;e<r.length;e++)n+=this.tablecell(r[e]);s+=this.tablerow({text:n})}return s&&(s=`<tbody>${s}</tbody>`),"<table>\n<thead>\n"+t+"</thead>\n"+s+"</table>\n"}tablerow({text:e}){return`<tr>\n${e}</tr>\n`}tablecell(e){const t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>\n`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${e}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){const s=this.parser.parseInline(n),r=u(e);if(null===r)return s;let i='<a href="'+(e=r)+'"';return t&&(i+=' title="'+t+'"'),i+=">"+s+"</a>",i}image({href:e,title:t,text:n}){const s=u(e);if(null===s)return n;let r=`<img src="${e=s}" alt="${n}"`;return t&&(r+=` title="${t}"`),r+=">",r}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):e.text}}class ne{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class se{options;renderer;textRenderer;constructor(t){this.options=t||e.defaults,this.options.renderer=this.options.renderer||new te,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new ne}static parse(e,t){return new se(t).parse(e)}static parseInline(e,t){return new se(t).parseInline(e)}parse(e,t=!0){let n="";for(let s=0;s<e.length;s++){const r=e[s];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[r.type]){const e=r,t=this.options.extensions.renderers[e.type].call({parser:this},e);if(!1!==t||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(e.type)){n+=t||"";continue}}const i=r;switch(i.type){case"space":n+=this.renderer.space(i);continue;case"hr":n+=this.renderer.hr(i);continue;case"heading":n+=this.renderer.heading(i);continue;case"code":n+=this.renderer.code(i);continue;case"table":n+=this.renderer.table(i);continue;case"blockquote":n+=this.renderer.blockquote(i);continue;case"list":n+=this.renderer.list(i);continue;case"html":n+=this.renderer.html(i);continue;case"paragraph":n+=this.renderer.paragraph(i);continue;case"text":{let r=i,l=this.renderer.text(r);for(;s+1<e.length&&"text"===e[s+1].type;)r=e[++s],l+="\n"+this.renderer.text(r);n+=t?this.renderer.paragraph({type:"paragraph",raw:l,text:l,tokens:[{type:"text",raw:l,text:l}]}):l;continue}default:{const e='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw new Error(e)}}}return n}parseInline(e,t){t=t||this.renderer;let n="";for(let s=0;s<e.length;s++){const r=e[s];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[r.type]){const e=this.options.extensions.renderers[r.type].call({parser:this},r);if(!1!==e||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(r.type)){n+=e||"";continue}}const i=r;switch(i.type){case"escape":case"text":n+=t.text(i);break;case"html":n+=t.html(i);break;case"link":n+=t.link(i);break;case"image":n+=t.image(i);break;case"strong":n+=t.strong(i);break;case"em":n+=t.em(i);break;case"codespan":n+=t.codespan(i);break;case"br":n+=t.br(i);break;case"del":n+=t.del(i);break;default:{const e='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw new Error(e)}}}return n}}class re{options;block;constructor(t){this.options=t||e.defaults}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?ee.lex:ee.lexInline}provideParser(){return this.block?se.parse:se.parseInline}}class ie{defaults={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=se;Renderer=te;TextRenderer=ne;Lexer=ee;Tokenizer=x;Hooks=re;constructor(...e){this.use(...e)}walkTokens(e,t){let n=[];for(const s of e)switch(n=n.concat(t.call(this,s)),s.type){case"table":{const e=s;for(const s of e.header)n=n.concat(this.walkTokens(s.tokens,t));for(const s of e.rows)for(const e of s)n=n.concat(this.walkTokens(e.tokens,t));break}case"list":{const e=s;n=n.concat(this.walkTokens(e.items,t));break}default:{const e=s;this.defaults.extensions?.childTokens?.[e.type]?this.defaults.extensions.childTokens[e.type].forEach((s=>{const r=e[s].flat(1/0);n=n.concat(this.walkTokens(r,t))})):e.tokens&&(n=n.concat(this.walkTokens(e.tokens,t)))}}return n}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach((e=>{const n={...e};if(n.async=this.defaults.async||n.async||!1,e.extensions&&(e.extensions.forEach((e=>{if(!e.name)throw new Error("extension name required");if("renderer"in e){const n=t.renderers[e.name];t.renderers[e.name]=n?function(...t){let s=e.renderer.apply(this,t);return!1===s&&(s=n.apply(this,t)),s}:e.renderer}if("tokenizer"in e){if(!e.level||"block"!==e.level&&"inline"!==e.level)throw new Error("extension level must be 'block' or 'inline'");const n=t[e.level];n?n.unshift(e.tokenizer):t[e.level]=[e.tokenizer],e.start&&("block"===e.level?t.startBlock?t.startBlock.push(e.start):t.startBlock=[e.start]:"inline"===e.level&&(t.startInline?t.startInline.push(e.start):t.startInline=[e.start]))}"childTokens"in e&&e.childTokens&&(t.childTokens[e.name]=e.childTokens)})),n.extensions=t),e.renderer){const t=this.defaults.renderer||new te(this.defaults);for(const n in e.renderer){if(!(n in t))throw new Error(`renderer '${n}' does not exist`);if(["options","parser"].includes(n))continue;const s=n,r=e.renderer[s],i=t[s];t[s]=(...e)=>{let n=r.apply(t,e);return!1===n&&(n=i.apply(t,e)),n||""}}n.renderer=t}if(e.tokenizer){const t=this.defaults.tokenizer||new x(this.defaults);for(const n in e.tokenizer){if(!(n in t))throw new Error(`tokenizer '${n}' does not exist`);if(["options","rules","lexer"].includes(n))continue;const s=n,r=e.tokenizer[s],i=t[s];t[s]=(...e)=>{let n=r.apply(t,e);return!1===n&&(n=i.apply(t,e)),n}}n.tokenizer=t}if(e.hooks){const t=this.defaults.hooks||new re;for(const n in e.hooks){if(!(n in t))throw new Error(`hook '${n}' does not exist`);if(["options","block"].includes(n))continue;const s=n,r=e.hooks[s],i=t[s];re.passThroughHooks.has(n)?t[s]=e=>{if(this.defaults.async)return Promise.resolve(r.call(t,e)).then((e=>i.call(t,e)));const n=r.call(t,e);return i.call(t,n)}:t[s]=(...e)=>{let n=r.apply(t,e);return!1===n&&(n=i.apply(t,e)),n}}n.hooks=t}if(e.walkTokens){const t=this.defaults.walkTokens,s=e.walkTokens;n.walkTokens=function(e){let n=[];return n.push(s.call(this,e)),t&&(n=n.concat(t.call(this,e))),n}}this.defaults={...this.defaults,...n}})),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return ee.lex(e,t??this.defaults)}parser(e,t){return se.parse(e,t??this.defaults)}parseMarkdown(e){return(t,n)=>{const s={...n},r={...this.defaults,...s},i=this.onError(!!r.silent,!!r.async);if(!0===this.defaults.async&&!1===s.async)return i(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(null==t)return i(new Error("marked(): input parameter is undefined or null"));if("string"!=typeof t)return i(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));r.hooks&&(r.hooks.options=r,r.hooks.block=e);const l=r.hooks?r.hooks.provideLexer():e?ee.lex:ee.lexInline,o=r.hooks?r.hooks.provideParser():e?se.parse:se.parseInline;if(r.async)return Promise.resolve(r.hooks?r.hooks.preprocess(t):t).then((e=>l(e,r))).then((e=>r.hooks?r.hooks.processAllTokens(e):e)).then((e=>r.walkTokens?Promise.all(this.walkTokens(e,r.walkTokens)).then((()=>e)):e)).then((e=>o(e,r))).then((e=>r.hooks?r.hooks.postprocess(e):e)).catch(i);try{r.hooks&&(t=r.hooks.preprocess(t));let e=l(t,r);r.hooks&&(e=r.hooks.processAllTokens(e)),r.walkTokens&&this.walkTokens(e,r.walkTokens);let n=o(e,r);return r.hooks&&(n=r.hooks.postprocess(n)),n}catch(e){return i(e)}}}onError(e,t){return n=>{if(n.message+="\nPlease report this to https://github.com/markedjs/marked.",e){const e="<p>An error occurred:</p><pre>"+c(n.message+"",!0)+"</pre>";return t?Promise.resolve(e):e}if(t)return Promise.reject(n);throw n}}}const le=new ie;function oe(e,t){return le.parse(e,t)}oe.options=oe.setOptions=function(e){return le.setOptions(e),oe.defaults=le.defaults,n(oe.defaults),oe},oe.getDefaults=t,oe.defaults=e.defaults,oe.use=function(...e){return le.use(...e),oe.defaults=le.defaults,n(oe.defaults),oe},oe.walkTokens=function(e,t){return le.walkTokens(e,t)},oe.parseInline=le.parseInline,oe.Parser=se,oe.parser=se.parse,oe.Renderer=te,oe.TextRenderer=ne,oe.Lexer=ee,oe.lexer=ee.lex,oe.Tokenizer=x,oe.Hooks=re,oe.parse=oe;const ae=oe.options,ce=oe.setOptions,he=oe.use,pe=oe.walkTokens,ue=oe.parseInline,ke=oe,ge=se.parse,fe=ee.lex;e.Hooks=re,e.Lexer=ee,e.Marked=ie,e.Parser=se,e.Renderer=te,e.TextRenderer=ne,e.Tokenizer=x,e.getDefaults=t,e.lexer=fe,e.marked=oe,e.options=ae,e.parse=ke,e.parseInline=ue,e.parser=ge,e.setOptions=ce,e.use=he,e.walkTokens=pe}));
</script>
    <script>
const DATA = {"links":[{"source":"bv-0kll","target":"bv-xcf1","type":"blocks","critical":false},{"source":"bv-0kll","target":"bv-otc5","type":"blocks","critical":false},{"source":"bv-0kll","target":"bv-75ds","type":"blocks","critical":false},{"source":"bv-0kll","target":"bv-ixzo","type":"blocks","critical":false},{"source":"bv-0kll","target":"bv-tm6c","type":"blocks","critical":false},{"source":"bv-0zk6","target":"bv-cwzm","type":"blocks","critical":false},{"source":"bv-100","target":"bv-99","type":"blocks","critical":false},{"source":"bv-101","target":"bv-99","type":"blocks","critical":false},{"source":"bv-102","target":"bv-101","type":"blocks","critical":false},{"source":"bv-102","target":"bv-99","type":"blocks","critical":false},{"source":"bv-103","target":"bv-100","type":"blocks","critical":false},{"source":"bv-103","target":"bv-101","type":"blocks","critical":false},{"source":"bv-103","target":"bv-102","type":"blocks","critical":false},{"source":"bv-103","target":"bv-99","type":"blocks","critical":false},{"source":"bv-104","target":"bv-103","type":"blocks","critical":false},{"source":"bv-104","target":"bv-99","type":"blocks","critical":false},{"source":"bv-105","target":"bv-104","type":"blocks","critical":false},{"source":"bv-105","target":"bv-99","type":"blocks","critical":false},{"source":"bv-106","target":"bv-104","type":"blocks","critical":false},{"source":"bv-106","target":"bv-105","type":"blocks","critical":false},{"source":"bv-106","target":"bv-99","type":"blocks","critical":false},{"source":"bv-107","target":"bv-104","type":"blocks","critical":false},{"source":"bv-107","target":"bv-99","type":"blocks","critical":false},{"source":"bv-108","target":"bv-107","type":"blocks","critical":false},{"source":"bv-108","target":"bv-110","type":"blocks","critical":false},{"source":"bv-108","target":"bv-99","type":"blocks","critical":false},{"source":"bv-109","target":"bv-107","type":"blocks","critical":false},{"source":"bv-109","target":"bv-113","type":"blocks","critical":false},{"source":"bv-109","target":"bv-114","type":"blocks","critical":false},{"source":"bv-109","target":"bv-115","type":"blocks","critical":false},{"source":"bv-109","target":"bv-99","type":"blocks","critical":false},{"source":"bv-10g","target":"bv-73f","type":"blocks","critical":false},{"source":"bv-10g","target":"bv-50r","type":"blocks","critical":false},{"source":"bv-10g","target":"bv-kdn","type":"blocks","critical":false},{"source":"bv-110","target":"bv-101","type":"blocks","critical":false},{"source":"bv-110","target":"bv-99","type":"blocks","critical":false},{"source":"bv-111","target":"bv-110","type":"blocks","critical":false},{"source":"bv-111","target":"bv-99","type":"blocks","critical":false},{"source":"bv-112","target":"bv-110","type":"blocks","critical":false},{"source":"bv-112","target":"bv-99","type":"blocks","critical":false},{"source":"bv-113","target":"bv-101","type":"blocks","critical":false},{"source":"bv-113","target":"bv-99","type":"blocks","critical":false},{"source":"bv-114","target":"bv-113","type":"blocks","critical":false},{"source":"bv-114","target":"bv-99","type":"blocks","critical":false},{"source":"bv-115","target":"bv-113","type":"blocks","critical":false},{"source":"bv-115","target":"bv-99","type":"blocks","critical":false},{"source":"bv-116","target":"bv-103","type":"blocks","critical":false},{"source":"bv-116","target":"bv-114","type":"blocks","critical":false},{"source":"bv-116","target":"bv-99","type":"blocks","critical":false},{"source":"bv-117","target":"bv-116","type":"blocks","critical":false},{"source":"bv-117","target":"bv-99","type":"blocks","critical":false},{"source":"bv-118","target":"bv-116","type":"blocks","critical":false},{"source":"bv-118","target":"bv-110","type":"blocks","critical":false},{"source":"bv-118","target":"bv-99","type":"blocks","critical":false},{"source":"bv-119","target":"bv-103","type":"blocks","critical":false},{"source":"bv-119","target":"bv-99","type":"blocks","critical":false},{"source":"bv-120","target":"bv-110","type":"blocks","critical":false},{"source":"bv-120","target":"bv-99","type":"blocks","critical":false},{"source":"bv-121","target":"bv-116","type":"blocks","critical":false},{"source":"bv-121","target":"bv-99","type":"blocks","critical":false},{"source":"bv-122","target":"bv-113","type":"blocks","critical":false},{"source":"bv-122","target":"bv-103","type":"blocks","critical":false},{"source":"bv-122","target":"bv-99","type":"blocks","critical":false},{"source":"bv-123","target":"bv-102","type":"blocks","critical":false},{"source":"bv-123","target":"bv-99","type":"blocks","critical":false},{"source":"bv-124","target":"bv-123","type":"blocks","critical":false},{"source":"bv-124","target":"bv-99","type":"blocks","critical":false},{"source":"bv-125","target":"bv-124","type":"blocks","critical":false},{"source":"bv-125","target":"bv-99","type":"blocks","critical":false},{"source":"bv-126","target":"bv-104","type":"blocks","critical":false},{"source":"bv-126","target":"bv-99","type":"blocks","critical":false},{"source":"bv-127","target":"bv-103","type":"blocks","critical":false},{"source":"bv-127","target":"bv-110","type":"blocks","critical":false},{"source":"bv-127","target":"bv-113","type":"blocks","critical":false},{"source":"bv-127","target":"bv-116","type":"blocks","critical":false},{"source":"bv-127","target":"bv-99","type":"blocks","critical":false},{"source":"bv-128","target":"bv-119","type":"blocks","critical":false},{"source":"bv-128","target":"bv-120","type":"blocks","critical":false},{"source":"bv-128","target":"bv-121","type":"blocks","critical":false},{"source":"bv-128","target":"bv-122","type":"blocks","critical":false},{"source":"bv-128","target":"bv-99","type":"blocks","critical":false},{"source":"bv-129","target":"bv-80","type":"parent-child","critical":false},{"source":"bv-129","target":"bv-81","type":"blocks","critical":false},{"source":"bv-129","target":"bv-82","type":"blocks","critical":false},{"source":"bv-130","target":"bv-80","type":"parent-child","critical":false},{"source":"bv-130","target":"bv-54","type":"blocks","critical":false},{"source":"bv-130","target":"bv-85","type":"blocks","critical":false},{"source":"bv-131","target":"bv-92","type":"parent-child","critical":false},{"source":"bv-131","target":"bv-84","type":"blocks","critical":false},{"source":"bv-131","target":"bv-94","type":"blocks","critical":false},{"source":"bv-131","target":"bv-96","type":"blocks","critical":false},{"source":"bv-131","target":"bv-89","type":"blocks","critical":false},{"source":"bv-138","target":"bv-132","type":"blocks","critical":false},{"source":"bv-139","target":"bv-132","type":"blocks","critical":false},{"source":"bv-139","target":"bv-138","type":"blocks","critical":false},{"source":"bv-140","target":"bv-132","type":"blocks","critical":false},{"source":"bv-140","target":"bv-139","type":"blocks","critical":false},{"source":"bv-141","target":"bv-132","type":"blocks","critical":false},{"source":"bv-141","target":"bv-139","type":"blocks","critical":false},{"source":"bv-142","target":"bv-132","type":"blocks","critical":false},{"source":"bv-142","target":"bv-140","type":"blocks","critical":false},{"source":"bv-142","target":"bv-141","type":"blocks","critical":false},{"source":"bv-143","target":"bv-132","type":"blocks","critical":false},{"source":"bv-143","target":"bv-140","type":"blocks","critical":false},{"source":"bv-143","target":"bv-53","type":"blocks","critical":false},{"source":"bv-144","target":"bv-132","type":"blocks","critical":false},{"source":"bv-144","target":"bv-139","type":"blocks","critical":false},{"source":"bv-145","target":"bv-80","type":"parent-child","critical":false},{"source":"bv-145","target":"bv-81","type":"blocks","critical":false},{"source":"bv-145","target":"bv-82","type":"blocks","critical":false},{"source":"bv-146","target":"bv-133","type":"blocks","critical":false},{"source":"bv-147","target":"bv-133","type":"blocks","critical":false},{"source":"bv-147","target":"bv-146","type":"blocks","critical":false},{"source":"bv-147","target":"bv-80","type":"blocks","critical":false},{"source":"bv-147","target":"bv-99","type":"blocks","critical":false},{"source":"bv-148","target":"bv-133","type":"blocks","critical":false},{"source":"bv-148","target":"bv-146","type":"blocks","critical":false},{"source":"bv-149","target":"bv-133","type":"blocks","critical":false},{"source":"bv-149","target":"bv-147","type":"blocks","critical":false},{"source":"bv-149","target":"bv-148","type":"blocks","critical":false},{"source":"bv-150","target":"bv-133","type":"blocks","critical":false},{"source":"bv-150","target":"bv-149","type":"blocks","critical":false},{"source":"bv-150","target":"bv-140","type":"blocks","critical":false},{"source":"bv-151","target":"bv-133","type":"blocks","critical":false},{"source":"bv-151","target":"bv-149","type":"blocks","critical":false},{"source":"bv-152","target":"bv-80","type":"parent-child","critical":false},{"source":"bv-152","target":"bv-85","type":"blocks","critical":false},{"source":"bv-153","target":"bv-80","type":"parent-child","critical":false},{"source":"bv-153","target":"bv-85","type":"blocks","critical":false},{"source":"bv-154","target":"bv-80","type":"parent-child","critical":false},{"source":"bv-154","target":"bv-85","type":"blocks","critical":false},{"source":"bv-155","target":"bv-134","type":"parent-child","critical":false},{"source":"bv-156","target":"bv-155","type":"blocks","critical":false},{"source":"bv-156","target":"bv-134","type":"parent-child","critical":false},{"source":"bv-157","target":"bv-155","type":"blocks","critical":false},{"source":"bv-157","target":"bv-102","type":"blocks","critical":false},{"source":"bv-157","target":"bv-134","type":"parent-child","critical":false},{"source":"bv-158","target":"bv-157","type":"blocks","critical":false},{"source":"bv-158","target":"bv-134","type":"parent-child","critical":false},{"source":"bv-159","target":"bv-156","type":"blocks","critical":false},{"source":"bv-159","target":"bv-134","type":"parent-child","critical":false},{"source":"bv-160","target":"bv-157","type":"blocks","critical":false},{"source":"bv-160","target":"bv-134","type":"parent-child","critical":false},{"source":"bv-161","target":"bv-156","type":"blocks","critical":false},{"source":"bv-161","target":"bv-134","type":"parent-child","critical":false},{"source":"bv-162","target":"bv-135","type":"blocks","critical":false},{"source":"bv-163","target":"bv-135","type":"blocks","critical":false},{"source":"bv-163","target":"bv-162","type":"blocks","critical":false},{"source":"bv-163","target":"bv-62","type":"blocks","critical":false},{"source":"bv-164","target":"bv-135","type":"blocks","critical":false},{"source":"bv-164","target":"bv-162","type":"blocks","critical":false},{"source":"bv-164","target":"bv-102","type":"blocks","critical":false},{"source":"bv-164","target":"bv-99","type":"blocks","critical":false},{"source":"bv-165","target":"bv-135","type":"blocks","critical":false},{"source":"bv-165","target":"bv-162","type":"blocks","critical":false},{"source":"bv-166","target":"bv-135","type":"blocks","critical":false},{"source":"bv-166","target":"bv-163","type":"blocks","critical":false},{"source":"bv-166","target":"bv-164","type":"blocks","critical":false},{"source":"bv-166","target":"bv-165","type":"blocks","critical":false},{"source":"bv-167","target":"bv-135","type":"blocks","critical":false},{"source":"bv-168","target":"bv-135","type":"blocks","critical":false},{"source":"bv-168","target":"bv-166","type":"blocks","critical":false},{"source":"bv-169","target":"bv-136","type":"blocks","critical":false},{"source":"bv-169","target":"bv-174","type":"blocks","critical":false},{"source":"bv-170","target":"bv-136","type":"blocks","critical":false},{"source":"bv-170","target":"bv-174","type":"blocks","critical":false},{"source":"bv-171","target":"bv-136","type":"blocks","critical":false},{"source":"bv-171","target":"bv-174","type":"blocks","critical":false},{"source":"bv-172","target":"bv-136","type":"blocks","critical":false},{"source":"bv-172","target":"bv-169","type":"blocks","critical":false},{"source":"bv-172","target":"bv-170","type":"blocks","critical":false},{"source":"bv-172","target":"bv-171","type":"blocks","critical":false},{"source":"bv-173","target":"bv-136","type":"blocks","critical":false},{"source":"bv-173","target":"bv-171","type":"blocks","critical":false},{"source":"bv-174","target":"bv-136","type":"blocks","critical":false},{"source":"bv-174","target":"bv-53","type":"blocks","critical":false},{"source":"bv-175","target":"bv-137","type":"parent-child","critical":false},{"source":"bv-176","target":"bv-137","type":"blocks","critical":false},{"source":"bv-176","target":"bv-175","type":"blocks","critical":false},{"source":"bv-177","target":"bv-137","type":"blocks","critical":false},{"source":"bv-177","target":"bv-175","type":"blocks","critical":false},{"source":"bv-177","target":"bv-9gf","type":"blocks","critical":false},{"source":"bv-178","target":"bv-137","type":"blocks","critical":false},{"source":"bv-178","target":"bv-175","type":"blocks","critical":false},{"source":"bv-179","target":"bv-137","type":"blocks","critical":false},{"source":"bv-179","target":"bv-175","type":"blocks","critical":false},{"source":"bv-180","target":"bv-137","type":"blocks","critical":false},{"source":"bv-180","target":"bv-176","type":"blocks","critical":false},{"source":"bv-180","target":"bv-177","type":"blocks","critical":false},{"source":"bv-180","target":"bv-178","type":"blocks","critical":false},{"source":"bv-180","target":"bv-179","type":"blocks","critical":false},{"source":"bv-181","target":"bv-80","type":"parent-child","critical":false},{"source":"bv-181","target":"bv-84","type":"blocks","critical":false},{"source":"bv-181","target":"bv-58","type":"blocks","critical":false},{"source":"bv-184","target":"bv-183","type":"parent-child","critical":false},{"source":"bv-185","target":"bv-183","type":"parent-child","critical":false},{"source":"bv-186","target":"bv-183","type":"parent-child","critical":false},{"source":"bv-187","target":"bv-183","type":"parent-child","critical":false},{"source":"bv-188","target":"bv-183","type":"parent-child","critical":false},{"source":"bv-189","target":"bv-183","type":"parent-child","critical":false},{"source":"bv-190","target":"bv-183","type":"parent-child","critical":false},{"source":"bv-1hnb","target":"bv-bxoe","type":"blocks","critical":false},{"source":"bv-1opc","target":"bv-jndd","type":"blocks","critical":false},{"source":"bv-2a4.2","target":"bv-2a4.1","type":"blocks","critical":false},{"source":"bv-2a4.3","target":"bv-2a4.2","type":"blocks","critical":false},{"source":"bv-2a4.4","target":"bv-2a4.2","type":"blocks","critical":false},{"source":"bv-2nyt","target":"bv-bikt","type":"blocks","critical":false},{"source":"bv-3bhq","target":"bv-xcf1","type":"blocks","critical":false},{"source":"bv-3bhq","target":"bv-0kll","type":"blocks","critical":false},{"source":"bv-3bhq","target":"bv-otc5","type":"blocks","critical":false},{"source":"bv-3bhq","target":"bv-75ds","type":"blocks","critical":false},{"source":"bv-3bhq","target":"bv-ixzo","type":"blocks","critical":false},{"source":"bv-3bhq","target":"bv-21qx","type":"blocks","critical":false},{"source":"bv-3bhq","target":"bv-tm6c","type":"blocks","critical":false},{"source":"bv-3bhq","target":"bv-m2cg","type":"blocks","critical":false},{"source":"bv-3ht4","target":"bv-mvvu","type":"blocks","critical":false},{"source":"bv-3krz","target":"bv-7bob","type":"blocks","critical":false},{"source":"bv-3krz","target":"bv-6jyn","type":"blocks","critical":false},{"source":"bv-3m20","target":"bv-bxoe","type":"blocks","critical":false},{"source":"bv-3m20","target":"bv-yi6k","type":"blocks","critical":false},{"source":"bv-3qi5","target":"bv-43js","type":"blocks","critical":false},{"source":"bv-406","target":"bv-jdl","type":"blocks","critical":false},{"source":"bv-40bw","target":"bv-158","type":"blocks","critical":false},{"source":"bv-470n","target":"bv-jndd","type":"blocks","critical":false},{"source":"bv-470n","target":"bv-njah","type":"blocks","critical":false},{"source":"bv-50r","target":"bv-73f","type":"blocks","critical":false},{"source":"bv-52t.2","target":"bv-52t.1","type":"blocks","critical":false},{"source":"bv-52t.3","target":"bv-52t.2","type":"blocks","critical":false},{"source":"bv-53.1","target":"bv-53","type":"parent-child","critical":false},{"source":"bv-54","target":"bv-53","type":"parent-child","critical":false},{"source":"bv-55","target":"bv-53","type":"parent-child","critical":false},{"source":"bv-56","target":"bv-53","type":"parent-child","critical":false},{"source":"bv-57","target":"bv-53","type":"parent-child","critical":false},{"source":"bv-58","target":"bv-53","type":"parent-child","critical":false},{"source":"bv-58","target":"bv-53.1","type":"blocks","critical":false},{"source":"bv-58","target":"bv-54","type":"blocks","critical":false},{"source":"bv-58","target":"bv-57","type":"blocks","critical":false},{"source":"bv-58","target":"bv-60","type":"blocks","critical":false},{"source":"bv-59","target":"bv-53","type":"parent-child","critical":false},{"source":"bv-59","target":"bv-53.1","type":"blocks","critical":false},{"source":"bv-59","target":"bv-54","type":"blocks","critical":false},{"source":"bv-5yb","target":"bv-jdl","type":"blocks","critical":false},{"source":"bv-5yb","target":"bv-w97","type":"blocks","critical":false},{"source":"bv-60","target":"bv-53","type":"parent-child","critical":false},{"source":"bv-60","target":"bv-55","type":"blocks","critical":false},{"source":"bv-60","target":"bv-54","type":"blocks","critical":false},{"source":"bv-61","target":"bv-53","type":"parent-child","critical":false},{"source":"bv-61","target":"bv-53.1","type":"blocks","critical":false},{"source":"bv-61","target":"bv-54","type":"blocks","critical":false},{"source":"bv-61","target":"bv-55","type":"blocks","critical":false},{"source":"bv-61","target":"bv-56","type":"blocks","critical":false},{"source":"bv-61","target":"bv-57","type":"blocks","critical":false},{"source":"bv-61","target":"bv-58","type":"blocks","critical":false},{"source":"bv-61","target":"bv-60","type":"blocks","critical":false},{"source":"bv-61hu","target":"bv-7bob","type":"blocks","critical":false},{"source":"bv-64","target":"bv-63","type":"blocks","critical":true},{"source":"bv-65","target":"bv-64","type":"blocks","critical":true},{"source":"bv-66","target":"bv-65","type":"blocks","critical":true},{"source":"bv-67","target":"bv-66","type":"blocks","critical":true},{"source":"bv-68","target":"bv-66","type":"blocks","critical":true},{"source":"bv-69","target":"bv-67","type":"blocks","critical":true},{"source":"bv-69","target":"bv-68","type":"blocks","critical":true},{"source":"bv-70","target":"bv-69","type":"blocks","critical":false},{"source":"bv-71","target":"bv-69","type":"blocks","critical":true},{"source":"bv-72","target":"bv-71","type":"blocks","critical":true},{"source":"bv-73","target":"bv-72","type":"blocks","critical":true},{"source":"bv-73f","target":"bv-w97","type":"blocks","critical":false},{"source":"bv-73f","target":"bv-jdl","type":"blocks","critical":false},{"source":"bv-74","target":"bv-73","type":"blocks","critical":true},{"source":"bv-75","target":"bv-74","type":"blocks","critical":true},{"source":"bv-76","target":"bv-75","type":"blocks","critical":true},{"source":"bv-77","target":"bv-76","type":"blocks","critical":true},{"source":"bv-78","target":"bv-77","type":"blocks","critical":true},{"source":"bv-79","target":"bv-78","type":"blocks","critical":true},{"source":"bv-7pu","target":"bv-73f","type":"blocks","critical":false},{"source":"bv-7pu","target":"bv-10g","type":"blocks","critical":false},{"source":"bv-81","target":"bv-80","type":"parent-child","critical":false},{"source":"bv-81ew","target":"bv-bxoe","type":"blocks","critical":false},{"source":"bv-82","target":"bv-80","type":"parent-child","critical":false},{"source":"bv-83","target":"bv-80","type":"parent-child","critical":false},{"source":"bv-83","target":"bv-81","type":"blocks","critical":false},{"source":"bv-83","target":"bv-82","type":"blocks","critical":false},{"source":"bv-84","target":"bv-80","type":"parent-child","critical":false},{"source":"bv-84","target":"bv-83","type":"blocks","critical":false},{"source":"bv-85","target":"bv-80","type":"parent-child","critical":false},{"source":"bv-85","target":"bv-82","type":"blocks","critical":false},{"source":"bv-86","target":"bv-80","type":"parent-child","critical":false},{"source":"bv-86","target":"bv-83","type":"blocks","critical":false},{"source":"bv-87","target":"bv-80","type":"parent-child","critical":false},{"source":"bv-87","target":"bv-84","type":"blocks","critical":false},{"source":"bv-87","target":"bv-81","type":"blocks","critical":false},{"source":"bv-87","target":"bv-82","type":"blocks","critical":false},{"source":"bv-88","target":"bv-80","type":"parent-child","critical":false},{"source":"bv-88","target":"bv-83","type":"blocks","critical":false},{"source":"bv-88","target":"bv-84","type":"blocks","critical":false},{"source":"bv-89","target":"bv-80","type":"parent-child","critical":false},{"source":"bv-89","target":"bv-84","type":"blocks","critical":false},{"source":"bv-8f0b","target":"bv-bxoe","type":"blocks","critical":false},{"source":"bv-90","target":"bv-80","type":"parent-child","critical":false},{"source":"bv-90","target":"bv-83","type":"blocks","critical":false},{"source":"bv-91","target":"bv-80","type":"parent-child","critical":false},{"source":"bv-91","target":"bv-84","type":"blocks","critical":false},{"source":"bv-93","target":"bv-92","type":"parent-child","critical":false},{"source":"bv-93","target":"bv-83","type":"blocks","critical":false},{"source":"bv-93","target":"bv-84","type":"blocks","critical":false},{"source":"bv-94","target":"bv-92","type":"parent-child","critical":false},{"source":"bv-94","target":"bv-85","type":"blocks","critical":false},{"source":"bv-95","target":"bv-92","type":"parent-child","critical":false},{"source":"bv-95","target":"bv-84","type":"blocks","critical":false},{"source":"bv-95","target":"bv-81","type":"blocks","critical":false},{"source":"bv-95","target":"bv-82","type":"blocks","critical":false},{"source":"bv-95","target":"bv-83","type":"blocks","critical":false},{"source":"bv-96","target":"bv-92","type":"parent-child","critical":false},{"source":"bv-96","target":"bv-84","type":"blocks","critical":false},{"source":"bv-96","target":"bv-83","type":"blocks","critical":false},{"source":"bv-96","target":"bv-81","type":"blocks","critical":false},{"source":"bv-96","target":"bv-94","type":"blocks","critical":false},{"source":"bv-97","target":"bv-92","type":"parent-child","critical":false},{"source":"bv-97","target":"bv-94","type":"blocks","critical":false},{"source":"bv-9gf.2","target":"bv-9gf.1","type":"blocks","critical":false},{"source":"bv-9gf.3","target":"bv-9gf.2","type":"blocks","critical":false},{"source":"bv-a00v","target":"bv-njah","type":"blocks","critical":false},{"source":"bv-a276","target":"bv-bxoe","type":"blocks","critical":false},{"source":"bv-ake","target":"bv-w97","type":"blocks","critical":false},{"source":"bv-ake","target":"bv-kdn","type":"blocks","critical":false},{"source":"bv-awl","target":"bv-uun","type":"blocks","critical":false},{"source":"bv-awl","target":"bv-5yb","type":"blocks","critical":false},{"source":"bv-b23i","target":"bv-5mgw","type":"blocks","critical":false},{"source":"bv-b23i","target":"bv-y5i","type":"blocks","critical":false},{"source":"bv-bikt","target":"bv-yi6k","type":"blocks","critical":false},{"source":"bv-bxoe","target":"bv-d4w7","type":"blocks","critical":false},{"source":"bv-dgyb","target":"bv-psjp","type":"blocks","critical":false},{"source":"bv-dvp3","target":"bv-bxoe","type":"blocks","critical":false},{"source":"bv-dyg","target":"bv-jdl","type":"blocks","critical":false},{"source":"bv-dyg","target":"bv-w97","type":"blocks","critical":false},{"source":"bv-epf.2","target":"bv-epf.1","type":"blocks","critical":false},{"source":"bv-epf.3","target":"bv-epf.2","type":"blocks","critical":false},{"source":"bv-epf.4","target":"bv-epf.3","type":"blocks","critical":false},{"source":"bv-evyl","target":"bv-7bob","type":"blocks","critical":false},{"source":"bv-evyl","target":"bv-z5oa","type":"blocks","critical":false},{"source":"bv-evyl","target":"bv-6jyn","type":"blocks","critical":false},{"source":"bv-evyl","target":"bv-yc2v","type":"blocks","critical":false},{"source":"bv-evyl","target":"bv-wzvo","type":"blocks","critical":false},{"source":"bv-evyl","target":"bv-3krz","type":"blocks","critical":false},{"source":"bv-evyl","target":"bv-61hu","type":"blocks","critical":false},{"source":"bv-evyl","target":"bv-f1zg","type":"blocks","critical":false},{"source":"bv-evyl","target":"bv-m2cg","type":"blocks","critical":false},{"source":"bv-gdlt","target":"bv-jdl","type":"blocks","critical":false},{"source":"bv-gij1","target":"bv-jndd","type":"blocks","critical":false},{"source":"bv-gij1","target":"bv-bikt","type":"blocks","critical":false},{"source":"bv-gmka","target":"bv-ct7m","type":"blocks","critical":false},{"source":"bv-gv7","target":"bv-uun","type":"blocks","critical":false},{"source":"bv-gv7","target":"bv-5yb","type":"blocks","critical":false},{"source":"bv-gv9v","target":"bv-3bhq","type":"blocks","critical":false},{"source":"bv-gv9v","target":"bv-ul1l","type":"blocks","critical":false},{"source":"bv-gv9v","target":"bv-ubra","type":"blocks","critical":false},{"source":"bv-hdu4","target":"bv-focq","type":"blocks","critical":false},{"source":"bv-hdu4","target":"bv-ufsr","type":"blocks","critical":false},{"source":"bv-hdu4","target":"bv-mwlh","type":"blocks","critical":false},{"source":"bv-hdu4","target":"bv-ct7m","type":"blocks","critical":false},{"source":"bv-hdu4","target":"bv-pua7","type":"blocks","critical":false},{"source":"bv-hdu4","target":"bv-gmka","type":"blocks","critical":false},{"source":"bv-hdu4","target":"bv-2ino","type":"blocks","critical":false},{"source":"bv-jl4n","target":"bv-kvtj","type":"blocks","critical":false},{"source":"bv-jl6j","target":"bv-xg92","type":"blocks","critical":false},{"source":"bv-k0cl","target":"bv-lkz5","type":"blocks","critical":false},{"source":"bv-k79d","target":"bv-y7a0","type":"blocks","critical":false},{"source":"bv-kdug","target":"bv-bxoe","type":"blocks","critical":false},{"source":"bv-ktru","target":"bv-bxoe","type":"blocks","critical":false},{"source":"bv-lkk.2","target":"bv-lkk.1","type":"blocks","critical":false},{"source":"bv-lkk.3","target":"bv-lkk.2","type":"blocks","critical":false},{"source":"bv-lkk.4","target":"bv-lkk.2","type":"blocks","critical":false},{"source":"bv-lkz5","target":"bv-nnsc","type":"blocks","critical":false},{"source":"bv-mwlh","target":"bv-focq","type":"blocks","critical":false},{"source":"bv-njah","target":"bv-kdug","type":"blocks","critical":false},{"source":"bv-njah","target":"bv-bikt","type":"blocks","critical":false},{"source":"bv-njah","target":"bv-8f0b","type":"blocks","critical":false},{"source":"bv-nnsc","target":"bv-kvtj","type":"blocks","critical":false},{"source":"bv-p32k","target":"bv-y7a0","type":"blocks","critical":false},{"source":"bv-pbs6","target":"bv-bxoe","type":"blocks","critical":false},{"source":"bv-psjp","target":"bv-y7a0","type":"blocks","critical":false},{"source":"bv-pua7","target":"bv-ct7m","type":"blocks","critical":false},{"source":"bv-q923","target":"bv-3bhq","type":"blocks","critical":false},{"source":"bv-q923","target":"bv-ul1l","type":"blocks","critical":false},{"source":"bv-q923","target":"bv-ubra","type":"blocks","critical":false},{"source":"bv-q923","target":"bv-syeo","type":"blocks","critical":false},{"source":"bv-q923","target":"bv-hdu4","type":"blocks","critical":false},{"source":"bv-q923","target":"bv-evyl","type":"blocks","critical":false},{"source":"bv-q923","target":"bv-m2cg","type":"blocks","critical":false},{"source":"bv-q923","target":"bv-gv9v","type":"blocks","critical":false},{"source":"bv-q923","target":"bv-6tqt","type":"blocks","critical":false},{"source":"bv-qfr5","target":"bv-cwzm","type":"blocks","critical":false},{"source":"bv-qjc.3","target":"bv-qjc.2","type":"blocks","critical":false},{"source":"bv-qpt0","target":"bv-jndd","type":"blocks","critical":false},{"source":"bv-runn.1","target":"bv-runn","type":"parent-child","critical":false},{"source":"bv-runn.10","target":"bv-runn","type":"parent-child","critical":false},{"source":"bv-runn.10","target":"bv-runn.2","type":"blocks","critical":false},{"source":"bv-runn.10","target":"bv-runn.9","type":"blocks","critical":false},{"source":"bv-runn.11","target":"bv-runn","type":"parent-child","critical":false},{"source":"bv-runn.11","target":"bv-runn.2","type":"blocks","critical":false},{"source":"bv-runn.12","target":"bv-runn","type":"parent-child","critical":false},{"source":"bv-runn.12","target":"bv-runn.11","type":"blocks","critical":false},{"source":"bv-runn.13","target":"bv-runn","type":"parent-child","critical":false},{"source":"bv-runn.13","target":"bv-runn.12","type":"blocks","critical":false},{"source":"bv-runn.14","target":"bv-runn","type":"parent-child","critical":false},{"source":"bv-runn.2","target":"bv-runn","type":"parent-child","critical":false},{"source":"bv-runn.3","target":"bv-runn","type":"parent-child","critical":false},{"source":"bv-runn.4","target":"bv-runn","type":"parent-child","critical":false},{"source":"bv-runn.5","target":"bv-runn","type":"parent-child","critical":false},{"source":"bv-runn.6","target":"bv-runn","type":"parent-child","critical":false},{"source":"bv-runn.7","target":"bv-runn","type":"parent-child","critical":false},{"source":"bv-runn.8","target":"bv-runn","type":"parent-child","critical":false},{"source":"bv-runn.8","target":"bv-runn.7","type":"blocks","critical":false},{"source":"bv-runn.8","target":"bv-runn.2","type":"blocks","critical":false},{"source":"bv-runn.9","target":"bv-runn","type":"parent-child","critical":false},{"source":"bv-runn.9","target":"bv-runn.2","type":"blocks","critical":false},{"source":"bv-syeo","target":"bv-cwzm","type":"blocks","critical":false},{"source":"bv-syeo","target":"bv-0zk6","type":"blocks","critical":false},{"source":"bv-syeo","target":"bv-qfr5","type":"blocks","critical":false},{"source":"bv-syeo","target":"bv-fqpv","type":"blocks","critical":false},{"source":"bv-syeo","target":"bv-kozq","type":"blocks","critical":false},{"source":"bv-syeo","target":"bv-ut9x","type":"blocks","critical":false},{"source":"bv-ta9l","target":"bv-kvtj","type":"blocks","critical":false},{"source":"bv-ub7.2","target":"bv-ub7.1","type":"blocks","critical":false},{"source":"bv-ub7.3","target":"bv-ub7.2","type":"blocks","critical":false},{"source":"bv-ub7.4","target":"bv-ub7.2","type":"blocks","critical":false},{"source":"bv-ub7.5","target":"bv-ub7.2","type":"blocks","critical":false},{"source":"bv-ubra","target":"bv-i5st","type":"blocks","critical":false},{"source":"bv-ubra","target":"bv-kjna","type":"blocks","critical":false},{"source":"bv-ubra","target":"bv-ewhp","type":"blocks","critical":false},{"source":"bv-ubra","target":"bv-p0bm","type":"blocks","critical":false},{"source":"bv-ufd.2","target":"bv-ufd.1","type":"blocks","critical":false},{"source":"bv-ufd.3","target":"bv-ufd.1","type":"blocks","critical":false},{"source":"bv-ufd.4","target":"bv-ufd.2","type":"blocks","critical":false},{"source":"bv-ufd.5","target":"bv-ufd.2","type":"blocks","critical":false},{"source":"bv-ufsr","target":"bv-focq","type":"blocks","critical":false},{"source":"bv-ul1l","target":"bv-wpmc","type":"blocks","critical":false},{"source":"bv-ul1l","target":"bv-qcgs","type":"blocks","critical":false},{"source":"bv-ul1l","target":"bv-i10k","type":"blocks","critical":false},{"source":"bv-ul1l","target":"bv-fou9","type":"blocks","critical":false},{"source":"bv-ul1l","target":"bv-ehsl","type":"blocks","critical":false},{"source":"bv-ul1l","target":"bv-bw7z","type":"blocks","critical":false},{"source":"bv-ul1l","target":"bv-3bez","type":"blocks","critical":false},{"source":"bv-uqoh","target":"bv-hmkz","type":"blocks","critical":false},{"source":"bv-uqoh","target":"bv-mvvu","type":"blocks","critical":false},{"source":"bv-uqoh","target":"bv-3ht4","type":"blocks","critical":false},{"source":"bv-uqoh","target":"bv-f103","type":"blocks","critical":false},{"source":"bv-uqoh","target":"bv-3fcg","type":"blocks","critical":false},{"source":"bv-uqoh","target":"bv-43js","type":"blocks","critical":false},{"source":"bv-uqoh","target":"bv-5h6q","type":"blocks","critical":false},{"source":"bv-uqoh","target":"bv-g4gs","type":"blocks","critical":false},{"source":"bv-uqoh","target":"bv-zaxb","type":"blocks","critical":false},{"source":"bv-uqoh","target":"bv-3qi5","type":"blocks","critical":false},{"source":"bv-utky","target":"bv-bxoe","type":"blocks","critical":false},{"source":"bv-uun","target":"bv-jdl","type":"blocks","critical":false},{"source":"bv-uun","target":"bv-w97","type":"blocks","critical":false},{"source":"bv-uvxe","target":"bv-jndd","type":"blocks","critical":false},{"source":"bv-uvxe","target":"bv-xg92","type":"blocks","critical":false},{"source":"bv-vt0","target":"bv-jdl","type":"blocks","critical":false},{"source":"bv-vt0","target":"bv-w97","type":"blocks","critical":false},{"source":"bv-w97","target":"bv-6hl","type":"blocks","critical":false},{"source":"bv-wb6h","target":"bv-jndd","type":"blocks","critical":false},{"source":"bv-xg92","target":"bv-bxoe","type":"blocks","critical":false},{"source":"bv-y4km","target":"bv-jndd","type":"blocks","critical":false},{"source":"bv-y5i","target":"bv-6hl","type":"blocks","critical":false},{"source":"bv-y5i","target":"bv-w97","type":"blocks","critical":false},{"source":"bv-y5i","target":"bv-jdl","type":"blocks","critical":false},{"source":"bv-y5i","target":"bv-73f","type":"blocks","critical":false},{"source":"bv-y5i","target":"bv-uun","type":"blocks","critical":false},{"source":"bv-y5i","target":"bv-5yb","type":"blocks","critical":false},{"source":"bv-y5i","target":"bv-dyg","type":"blocks","critical":false},{"source":"bv-y5i","target":"bv-vt0","type":"blocks","critical":false},{"source":"bv-y5i","target":"bv-10g","type":"blocks","critical":false},{"source":"bv-y5i","target":"bv-kdn","type":"blocks","critical":false},{"source":"bv-y5i","target":"bv-5dl","type":"blocks","critical":false},{"source":"bv-y5i","target":"bv-50r","type":"blocks","critical":false},{"source":"bv-y5i","target":"bv-406","type":"blocks","critical":false},{"source":"bv-y5i","target":"bv-awl","type":"blocks","critical":false},{"source":"bv-y5i","target":"bv-ake","type":"blocks","critical":false},{"source":"bv-y5i","target":"bv-gv7","type":"blocks","critical":false},{"source":"bv-y5i","target":"bv-7pu","type":"blocks","critical":false},{"source":"bv-y5i","target":"bv-gdlt","type":"blocks","critical":false},{"source":"bv-y5i","target":"bv-5mgw","type":"blocks","critical":false},{"source":"bv-y7a0","target":"bv-njah","type":"blocks","critical":false},{"source":"bv-y7a0","target":"bv-jl6j","type":"blocks","critical":false},{"source":"bv-y7a0","target":"bv-a00v","type":"blocks","critical":false},{"source":"bv-y7a0","target":"bv-3m20","type":"blocks","critical":false},{"source":"bv-y7a0","target":"bv-1hnb","type":"blocks","critical":false},{"source":"bv-y7a0","target":"bv-ywd5","type":"blocks","critical":false},{"source":"bv-y7a0","target":"bv-2nyt","type":"blocks","critical":false},{"source":"bv-y7a0","target":"bv-dvp3","type":"blocks","critical":false},{"source":"bv-y7a0","target":"bv-utky","type":"blocks","critical":false},{"source":"bv-y7a0","target":"bv-xg92","type":"blocks","critical":false},{"source":"bv-y7a0","target":"bv-bikt","type":"blocks","critical":false},{"source":"bv-y7a0","target":"bv-pbs6","type":"blocks","critical":false},{"source":"bv-y7a0","target":"bv-bxoe","type":"blocks","critical":false},{"source":"bv-yc2v","target":"bv-z5oa","type":"blocks","critical":false},{"source":"bv-yc2v","target":"bv-6jyn","type":"blocks","critical":false},{"source":"bv-yi6k","target":"bv-bxoe","type":"blocks","critical":false},{"source":"bv-yrcn","target":"bv-bxoe","type":"blocks","critical":false},{"source":"bv-ywd5","target":"bv-bxoe","type":"blocks","critical":false},{"source":"bv-z38b","target":"bv-jndd","type":"blocks","critical":false},{"source":"bv-z38b","target":"bv-gij1","type":"blocks","critical":false},{"source":"bv-zaxb","target":"bv-mvvu","type":"blocks","critical":false}],"nodes":[{"id":"bv-0kll","title":"Unit test: suggest_all.go - Suggestion orchestration","description":"Create comprehensive unit tests for pkg/analysis/suggest_all.go\n\n## File Overview\nsuggest_all.go orchestrates all suggestion types:\n- Calls each individual suggester\n- Combines and deduplicates results\n- Applies global filtering and ranking\n\n## Test Cases to Implement\n1. **Orchestration Tests**\n   - Empty graph produces no suggestions\n   - Single suggester enabled\n   - All suggesters enabled\n   - Verify no duplicate suggestions across types\n\n2. **Configuration Tests**\n   - Test with each suggester enabled/disabled\n   - Test confidence threshold filtering\n   - Test maximum suggestions limit\n   - Test type filtering\n\n3. **Integration Tests**\n   - Small graph with known suggestion opportunities\n   - Graph with cycles (should produce cycle suggestions)\n   - Graph with similar titles (should produce duplicate suggestions)\n   - Graph with unlabeled high-impact items (should produce label suggestions)\n\n4. **Ranking Tests**\n   - Verify suggestions sorted by confidence\n   - Verify deterministic ordering (stable sort)\n   - Test tie-breaking behavior\n\n## Implementation Notes\n- Create fixture graphs with known properties\n- Test each suggester independently first\n- Then test orchestration combinations\n- Benchmark full suggestion pipeline","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-16 20:05","updated_at":"2025-12-16 22:57","closed_at":"2025-12-16 22:57","blocked_by":["bv-xcf1","bv-otc5","bv-75ds","bv-ixzo","bv-tm6c"],"blocks":["bv-3bhq"],"pagerank":0.0016968161178715197,"betweenness":0,"eigenvector":0,"hub":1.470290924790812e-7,"authority":1.0771362149860417e-7,"critical_path":4,"in_degree":1,"out_degree":5,"core_number":2,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-0zk6","title":"E2E: Robot command matrix - comprehensive coverage","description":"Create E2E tests for all robot commands with full parameter coverage.\n\n## Robot Commands to Test\n1. --robot-triage (mega command)\n2. --robot-next (minimal triage)\n3. --robot-insights (graph metrics)\n4. --robot-plan (execution plan)\n5. --robot-priority (recommendations)\n6. --robot-suggest (hygiene suggestions)\n7. --robot-diff (snapshot comparison)\n8. --robot-history (git correlation)\n9. --robot-search (semantic search)\n10. --robot-forecast (ETA prediction)\n11. --robot-label-health\n12. --robot-label-flow\n13. --robot-label-attention\n14. --robot-recipes\n15. --robot-help\n\n## Test Matrix Per Command\n- Default invocation\n- With --label filter\n- With --recipe filter  \n- With various --robot-* options\n- Empty data edge case\n- Large data (1000+ issues)\n- Error handling (invalid options)\n\n## Contract Validation\n- JSON schema compliance\n- Required fields present\n- data_hash consistency\n- Deterministic output\n\n## Implementation\n- Create test_robot_matrix.go\n- Table-driven test for each command\n- Shared fixtures for consistency\n- Golden file outputs for regression","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-16 20:08","updated_at":"2025-12-16 22:25","closed_at":"2025-12-16 22:25","blocked_by":["bv-cwzm"],"blocks":["bv-syeo"],"pagerank":0.0017054007352105605,"betweenness":0,"eigenvector":0,"hub":7.799479570458926e-12,"authority":3.263220574971611e-11,"critical_path":3,"in_degree":1,"out_degree":1,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-100","title":"Define LabelHealth type and core structures","description":"Create pkg/analysis/label_health.go with LabelHealth, VelocityMetrics, FreshnessMetrics, FlowMetrics, CriticalityMetrics, LabelDependency, CrossLabelFlow types. Foundation for all label analysis.","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-1"],"created_at":"2025-12-15 15:52","updated_at":"2025-12-15 22:34","closed_at":"2025-12-15 22:34","blocked_by":["bv-99"],"blocks":["bv-103"],"pagerank":0.002697656722909056,"betweenness":0,"eigenvector":0,"hub":0.15030829775646837,"authority":0.031208624574365938,"critical_path":5,"in_degree":1,"out_degree":1,"core_number":2,"slack":9,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-101","title":"Implement label extraction from issues","description":"Create function to extract unique labels from bead.Bead slice, with counts and basic statistics. Handle edge cases (no labels, duplicate labels).","notes":"Implemented label extraction stats: ExtractLabels/LabelExtractionResult with counts, top labels; go tests passing","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-1"],"created_at":"2025-12-15 15:53","updated_at":"2025-12-15 23:04","closed_at":"2025-12-15 23:04","blocked_by":["bv-99"],"blocks":["bv-102","bv-103","bv-110","bv-113"],"pagerank":0.00914642158894412,"betweenness":0,"eigenvector":0,"hub":0.15030829775646837,"authority":0.11493879015397561,"critical_path":6,"in_degree":4,"out_degree":1,"core_number":3,"slack":8,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-102","title":"Implement basic velocity calculation","description":"Calculate issues closed per time period for a label. Handle cases where modified dates aren't available. Return VelocityMetrics with history, average, and trend.","notes":"Basic velocity calc wired into label health; deterministic label ordering; tests pass","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-1"],"created_at":"2025-12-15 15:53","updated_at":"2025-12-15 23:10","closed_at":"2025-12-15 23:10","blocked_by":["bv-101","bv-99"],"blocks":["bv-103","bv-123","bv-157","bv-164"],"pagerank":0.00626157998986326,"betweenness":14,"eigenvector":0,"hub":0.16926097889610162,"authority":0.09010726577652653,"critical_path":5,"in_degree":4,"out_degree":2,"core_number":3,"slack":8,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-103","title":"Implement composite health score algorithm","description":"ComputeLabelHealth function: combine velocity (30%), freshness (25%), flow (25%), criticality (20%) into 0-100 score. Include component breakdown for debugging.","notes":"Composite label health scoring stabilized (clamp, rounding); velocity/freshness integrated; tests pass","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-1"],"created_at":"2025-12-15 15:53","updated_at":"2025-12-15 23:08","closed_at":"2025-12-15 23:08","blocked_by":["bv-100","bv-101","bv-102","bv-99"],"blocks":["bv-104","bv-116","bv-119","bv-122","bv-127"],"pagerank":0.005746724470232591,"betweenness":40.333333333333336,"eigenvector":0,"hub":0.1892652036135448,"authority":0.16662132362887866,"critical_path":4,"in_degree":5,"out_degree":4,"core_number":3,"slack":8,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-104","title":"Create LabelDashboard view component","description":"New Bubble Tea component in pkg/ui/label_dashboard.go. Table layout showing all labels with health score, open count, blocked count, velocity, stalest issue age. j/k navigation, enter for drilldown.","notes":"Label health cache now invalidates on file change; keeps dashboard fast but fresh. Footer hint remains.","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-2"],"created_at":"2025-12-15 15:53","updated_at":"2025-12-16 03:04","closed_at":"2025-12-16 03:04","blocked_by":["bv-103","bv-99"],"blocks":["bv-105","bv-106","bv-107","bv-126"],"pagerank":0.004239584360226127,"betweenness":22,"eigenvector":0,"hub":0.17778310250751306,"authority":0.11211055578485081,"critical_path":3,"in_degree":4,"out_degree":2,"core_number":3,"slack":8,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-105","title":"Implement health score rendering with visual indicators","description":"Render health as colored bar (green/yellow/red gradient). Add attention indicator for low-health labels. Support adaptive colors for light/dark terminals.","notes":"Added label health detail modal (open from dashboard with 'h'); close on esc/q/enter. Health bar and indicators remain. Tests passing.","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-2"],"created_at":"2025-12-15 15:53","updated_at":"2025-12-16 03:03","closed_at":"2025-12-16 03:03","blocked_by":["bv-104","bv-99"],"blocks":["bv-106"],"pagerank":0.0018948137854436062,"betweenness":0,"eigenvector":0,"hub":0.16879462089707997,"authority":0.02861108879148807,"critical_path":2,"in_degree":1,"out_degree":2,"core_number":3,"slack":8,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-106","title":"Implement health detail popup overlay","description":"Modal overlay showing health score breakdown: velocity component, freshness component, flow component, criticality component. Each with progress bar and explanation. Triggered by 'h' key.","notes":"Modal now shows incoming \u0026 outgoing cross-label deps; footer hint for label hotkeys added. All tests passing.","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-2"],"created_at":"2025-12-15 15:53","updated_at":"2025-12-16 03:03","closed_at":"2025-12-16 03:03","blocked_by":["bv-104","bv-105","bv-99"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.17351240887967825,"authority":0,"critical_path":1,"in_degree":0,"out_degree":3,"core_number":3,"slack":8,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-107","title":"Create LabelDrilldown view component","description":"Filtered issue list for single label. Header showing label metrics (health, velocity, blocked count, critical path length). Reuse existing list component with label filter applied.","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-3"],"created_at":"2025-12-15 15:53","updated_at":"2025-12-16 03:03","closed_at":"2025-12-16 03:03","blocked_by":["bv-104","bv-99"],"blocks":["bv-108","bv-109"],"pagerank":0.002145815116933821,"betweenness":8,"eigenvector":0,"hub":0.16879462089707997,"authority":0.06587274387297806,"critical_path":2,"in_degree":2,"out_degree":2,"core_number":3,"slack":8,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-108","title":"Implement cross-label dependency display in drilldown","description":"Show 'Depends on: backend(3), database(2)' and 'Blocks: testing(4), docs(1)' in drilldown header. Compute from issue dependencies crossing label boundaries.","notes":"Detail modal now shows incoming \u0026 outgoing cross-label deps with top-6 lists. Label health cache persists across opens; invalidates on file change. Missing beads message aligned with tests.","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-3"],"created_at":"2025-12-15 15:53","updated_at":"2025-12-16 01:54","closed_at":"2025-12-16 01:54","blocked_by":["bv-107","bv-110","bv-99"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.1940580024342254,"authority":0,"critical_path":1,"in_degree":0,"out_degree":3,"core_number":3,"slack":8,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-109","title":"Implement label-specific graph analysis sub-view","description":"Press 'g' in drilldown to show PageRank/betweenness/critical-path computed on label's subgraph only. Reuse existing insights rendering with filtered data.","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-3"],"created_at":"2025-12-15 15:53","updated_at":"2025-12-16 12:39","closed_at":"2025-12-16 12:39","blocked_by":["bv-107","bv-113","bv-114","bv-115","bv-99"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.2054283177564155,"authority":0,"critical_path":1,"in_degree":0,"out_degree":5,"core_number":3,"slack":8,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-10g","title":"Implement interactive deployment wizard (--pages flag)","description":"# Implement Interactive Deployment Wizard (--pages flag)\n\n## Context\nThe deployment wizard is an interactive CLI experience (like mcp_agent_mail's share wizard) that guides users through exporting and deploying their static site.\n\n## Requirements\n\n### New CLI Flag\n```go\npagesWizard := flag.Bool(\"pages\", false, \"Launch interactive Pages deployment wizard\")\n```\n\n### Wizard Flow\n```\n$ bv --pages\n\n‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\n‚ïë           bv ‚Üí Static Site Deployment Wizard                     ‚ïë\n‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£\n‚ïë  This wizard will:                                               ‚ïë\n‚ïë    1. Export your issues to a static HTML bundle                 ‚ïë\n‚ïë    2. Preview it locally                                         ‚ïë\n‚ïë    3. Deploy to GitHub Pages or Cloudflare Pages                 ‚ïë\n‚ïë                                                                   ‚ïë\n‚ïë  Press Ctrl+C anytime to cancel                                  ‚ïë\n‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n\nStep 1: Export Configuration\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nInclude closed issues? [y/N]: n\nCustom site title (default: \"Project Issues\"): My Project Dashboard\nCustom subtitle: Sprint 42 Status\n\nStep 2: Deployment Target\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nWhere do you want to deploy?\n  1. GitHub Pages (create new repository)\n  2. Cloudflare Pages (fast global CDN)\n  3. Export locally only\n\nChoice [1]: 1\n\nStep 3: GitHub Configuration\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nRepository name: my-project-status\nMake repository private? [y/N]: n\nRepository description: Issue tracker dashboard\n\nStep 4: Prerequisites Check\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n‚úì gh CLI installed and authenticated\n‚úì git configured (user: John Doe \u003cjohn@example.com\u003e)\n\nStep 5: Export\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nExporting static site...\n  ‚Üí Loading issues from .beads/beads.jsonl\n  ‚Üí Found 178 issues (85 open, 93 closed)\n  ‚Üí Running graph analysis...\n  ‚Üí Generating triage data...\n  ‚Üí Writing JSON files...\n  ‚Üí Copying viewer assets...\n‚úì Bundle created: /tmp/bv-pages-abc123\n\nStep 6: Preview\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nPreview the site before deploying? [Y/n]: y\nStarting preview server at http://localhost:9000...\nPress 'r' to refresh, 'd' to deploy, 'q' to quit\n\n[Browser opens]\n\nStep 7: Deploy\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nCreating GitHub repository...\n‚úì Created: johnsmith/my-project-status\nPushing to GitHub...\n‚úì Files pushed to main branch\nEnabling GitHub Pages...\n‚úì Pages enabled\n\n‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\n‚ïë                    Deployment Complete! üéâ                       ‚ïë\n‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£\n‚ïë  Repository: https://github.com/johnsmith/my-project-status      ‚ïë\n‚ïë  Live site:  https://johnsmith.github.io/my-project-status/      ‚ïë\n‚ïë                                                                   ‚ïë\n‚ïë  Note: GitHub Pages may take 1-2 minutes to become available     ‚ïë\n‚ïë                                                                   ‚ïë\n‚ïë  To update later:                                                 ‚ïë\n‚ïë    bv --export-pages ./update-bundle                             ‚ïë\n‚ïë    cd ./update-bundle \u0026\u0026 git add . \u0026\u0026 git commit \u0026\u0026 git push     ‚ïë\n‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n```\n\n### Implementation Structure\n```go\n// pkg/export/wizard.go\n\ntype WizardConfig struct {\n    IncludeClosed   bool\n    Title           string\n    Subtitle        string\n    DeployTarget    string // \"github\", \"cloudflare\", \"local\"\n    RepoName        string\n    RepoPrivate     bool\n    RepoDescription string\n    OutputPath      string\n}\n\nfunc RunWizard(beadsPath string) error {\n    config := \u0026WizardConfig{}\n    \n    // Step 1: Collect export options\n    if err := collectExportOptions(config); err != nil {\n        return err\n    }\n    \n    // Step 2: Collect deployment target\n    if err := collectDeployTarget(config); err != nil {\n        return err\n    }\n    \n    // Step 3: Check prerequisites\n    if err := checkPrerequisites(config); err != nil {\n        return err\n    }\n    \n    // Step 4: Export bundle\n    bundlePath, err := exportBundle(beadsPath, config)\n    if err != nil {\n        return err\n    }\n    \n    // Step 5: Preview\n    if shouldPreview() {\n        action := runPreview(bundlePath)\n        if action == \"quit\" {\n            return nil\n        }\n    }\n    \n    // Step 6: Deploy\n    return deploy(bundlePath, config)\n}\n```\n\n### Terminal UI\nUse Go packages for nice TUI:\n- `github.com/charmbracelet/huh` for forms (consistent with bubbletea)\n- `github.com/charmbracelet/lipgloss` for styling\n- Or simpler: `bufio.Scanner` + ANSI colors\n\n### State Persistence\nSave wizard config for future runs:\n```\n~/.config/bv/pages-wizard.json\n{\n  \"last_repo_name\": \"my-project-status\",\n  \"last_deploy_target\": \"github\",\n  \"include_closed\": false\n}\n```\n\n## Acceptance Criteria\n- [ ] --pages flag launches wizard\n- [ ] All steps work interactively\n- [ ] Prerequisites check validates tools\n- [ ] Preview server works with key controls\n- [ ] GitHub deployment creates/updates repo\n- [ ] Success message shows correct URLs\n- [ ] Config saved for next run\n- [ ] Ctrl+C cleanly exits at any step\n- [ ] Works in non-TTY with sensible defaults\n\n## Error Handling\n- gh not installed: Offer to install (brew) or show manual instructions\n- gh not authenticated: Run `gh auth login` inline\n- Repo exists: Option to update or choose new name\n- Network errors: Clear message with retry option","status":"closed","priority":2,"type":"task","labels":["phase-3","static-pages"],"created_at":"2025-12-15 23:07","updated_at":"2025-12-16 03:29","closed_at":"2025-12-16 03:29","blocked_by":["bv-73f","bv-50r","bv-kdn"],"blocks":["bv-7pu","bv-y5i"],"pagerank":0.0022381103562082207,"betweenness":2,"eigenvector":0,"hub":0.00012401537910330072,"authority":0.00021793808902526062,"critical_path":4,"in_degree":2,"out_degree":3,"core_number":3,"slack":7,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-110","title":"Implement CrossLabelFlow computation","description":"ComputeCrossLabelFlows function: analyze all dependencies, group by (from_label, to_label) pairs, return counts. Handle issues with multiple labels (count each pairing).","notes":"Implemented ComputeCrossLabelFlow with matrix/dep list/bottlenecks; tests added; deterministic ordering","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-4"],"created_at":"2025-12-15 15:53","updated_at":"2025-12-15 23:10","closed_at":"2025-12-15 23:10","blocked_by":["bv-101","bv-99"],"blocks":["bv-108","bv-111","bv-112","bv-118","bv-120","bv-127"],"pagerank":0.004553336176041639,"betweenness":5.583333333333334,"eigenvector":0,"hub":0.16926097889610162,"authority":0.19944792966168096,"critical_path":3,"in_degree":6,"out_degree":2,"core_number":3,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-111","title":"Create flow matrix view component","description":"Matrix visualization showing label-to-label dependencies. Rows = dependents, Cols = dependencies. Numbers show count of cross-label edges. Color intensity by count.","notes":"Key F shows cross-label flow matrix (rows=from, cols=to, counts). Uses ComputeCrossLabelFlow + FlowMatrixView text table.","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-4"],"created_at":"2025-12-15 15:53","updated_at":"2025-12-16 03:03","closed_at":"2025-12-16 03:03","blocked_by":["bv-110","bv-99"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.18319600267987965,"authority":0,"critical_path":1,"in_degree":0,"out_degree":2,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-112","title":"Implement blockage impact cascade analysis","description":"When a label has blocked issues, compute transitive downstream impact. Show tree: database(4 blocked) -\u003e backend: 3 waiting -\u003e testing: 2 waiting. Include recommendations for which issues to unblock first.","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-4"],"created_at":"2025-12-15 15:53","updated_at":"2025-12-16 12:58","closed_at":"2025-12-16 12:58","blocked_by":["bv-110","bv-99"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.18319600267987965,"authority":0,"critical_path":1,"in_degree":0,"out_degree":2,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-113","title":"Implement label subgraph extraction","description":"ComputeLabelSubgraph function: extract issues with given label plus their direct dependencies (even if outside label). Build adjacency for label-scoped graph analysis.","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-5"],"created_at":"2025-12-15 15:53","updated_at":"2025-12-15 23:35","closed_at":"2025-12-15 23:35","blocked_by":["bv-101","bv-99"],"blocks":["bv-109","bv-114","bv-115","bv-122","bv-127"],"pagerank":0.004358651902976122,"betweenness":4.083333333333333,"eigenvector":0,"hub":0.16926097889610162,"authority":0.16957429755777512,"critical_path":5,"in_degree":5,"out_degree":2,"core_number":3,"slack":8,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-114","title":"Implement label-specific PageRank","description":"Run PageRank on label subgraph. Return map[string]float64 with issue IDs. Normalize scores within label context. Reuse existing PageRank algorithm with filtered adjacency.","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-5"],"created_at":"2025-12-15 15:53","updated_at":"2025-12-15 23:38","closed_at":"2025-12-15 23:38","blocked_by":["bv-113","bv-99"],"blocks":["bv-109","bv-116"],"pagerank":0.0027212702526442055,"betweenness":4,"eigenvector":0,"hub":0.1782700292727335,"authority":0.06495524448194051,"critical_path":4,"in_degree":2,"out_degree":2,"core_number":3,"slack":8,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-115","title":"Implement label-specific critical path","description":"Find longest dependency chain within label's subgraph. Return path as []string issue IDs. Shows label's internal bottleneck structure.","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-5"],"created_at":"2025-12-15 15:53","updated_at":"2025-12-16 11:51","closed_at":"2025-12-16 11:51","blocked_by":["bv-113","bv-99"],"blocks":["bv-109"],"pagerank":0.00172747956445013,"betweenness":0,"eigenvector":0,"hub":0.1782700292727335,"authority":0.03387381810556118,"critical_path":2,"in_degree":1,"out_degree":2,"core_number":3,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-116","title":"Implement attention score algorithm","description":"attention = (pagerank_sum * staleness_factor * block_impact) / velocity. Compute for all labels, rank by attention needed. Higher = needs more attention.","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-6"],"created_at":"2025-12-15 15:54","updated_at":"2025-12-15 23:41","closed_at":"2025-12-15 23:41","blocked_by":["bv-103","bv-114","bv-99"],"blocks":["bv-117","bv-118","bv-121","bv-127"],"pagerank":0.003507497294832411,"betweenness":19,"eigenvector":0,"hub":0.18849381240244018,"authority":0.13366382387873074,"critical_path":3,"in_degree":4,"out_degree":3,"core_number":3,"slack":8,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-117","title":"Create attention ranking view component","description":"Dashboard showing labels sorted by attention score. Each row: rank, label name, attention score, brief reason (e.g., 'High PageRank, 4 blocked, low velocity'). Quick jump via number keys.","notes":"Added footer/help hints for label intelligence keys: L labels, A attention, F flow.","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-6"],"created_at":"2025-12-15 15:54","updated_at":"2025-12-16 02:27","closed_at":"2025-12-16 02:27","blocked_by":["bv-116","bv-99"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.1723486187872014,"authority":0,"critical_path":1,"in_degree":0,"out_degree":2,"core_number":2,"slack":9,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-118","title":"Integrate label intelligence into Insights view","description":"Add 'Label Intelligence' section to existing Insights: labels needing attention, velocity trends, cross-label bottlenecks, recommendations. Computed on demand, shown alongside graph metrics.","notes":"Insights view now accepts extraText/labelAttention/labelFlow; keys A/F render attention table or flow matrix inside insights pane.","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-6"],"created_at":"2025-12-15 15:54","updated_at":"2025-12-16 03:04","closed_at":"2025-12-16 03:04","blocked_by":["bv-116","bv-110","bv-99"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.20523632371061268,"authority":0,"critical_path":1,"in_degree":0,"out_degree":3,"core_number":3,"slack":9,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-119","title":"Implement --robot-label-health command","description":"New robot flag: bv --robot-label-health [label]. Without arg: all labels' health. With arg: deep analysis of single label. JSON output with health, components, recommendations.","notes":"Implemented --robot-label-health command with JSON output and help text.","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-7"],"created_at":"2025-12-15 15:54","updated_at":"2025-12-15 23:13","closed_at":"2025-12-15 23:13","blocked_by":["bv-103","bv-99"],"blocks":["bv-128"],"pagerank":0.00172747956445013,"betweenness":1.75,"eigenvector":0,"hub":0.17778310250751306,"authority":0.027809422518357437,"critical_path":2,"in_degree":1,"out_degree":2,"core_number":3,"slack":9,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-120","title":"Implement --robot-label-flow command","description":"New robot flag: bv --robot-label-flow. JSON output with cross-label flows array, source/sink label classifications, flow insights.","notes":"Implemented --robot-label-flow command (JSON output for cross-label dependencies), CLI help and usage hints; leverages existing ComputeCrossLabelFlow","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-7"],"created_at":"2025-12-15 15:54","updated_at":"2025-12-15 23:15","closed_at":"2025-12-15 23:15","blocked_by":["bv-110","bv-99"],"blocks":["bv-128"],"pagerank":0.00172747956445013,"betweenness":1.25,"eigenvector":0,"hub":0.18319600267987965,"authority":0.027809422518357437,"critical_path":2,"in_degree":1,"out_degree":2,"core_number":3,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-121","title":"Implement --robot-label-attention command","description":"New robot flag: bv --robot-label-attention --limit=N. JSON output with attention-ranked labels, scores, and reasons. Default limit 5.","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-7"],"created_at":"2025-12-15 15:54","updated_at":"2025-12-15 23:49","closed_at":"2025-12-15 23:49","blocked_by":["bv-116","bv-99"],"blocks":["bv-128"],"pagerank":0.00172747956445013,"betweenness":2,"eigenvector":0,"hub":0.1723486187872014,"authority":0.027809422518357437,"critical_path":2,"in_degree":1,"out_degree":2,"core_number":3,"slack":8,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-122","title":"Add --label filter to existing robot commands","description":"Add --label=X flag to --robot-insights, --robot-plan, --robot-priority. When set, analysis scoped to label's subgraph. Include label health context in output.","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-7"],"created_at":"2025-12-15 15:54","updated_at":"2025-12-16 03:11","closed_at":"2025-12-16 03:11","blocked_by":["bv-113","bv-103","bv-99"],"blocks":["bv-128"],"pagerank":0.00172747956445013,"betweenness":3,"eigenvector":0,"hub":0.2057448340237782,"authority":0.027809422518357437,"critical_path":2,"in_degree":1,"out_degree":3,"core_number":3,"slack":9,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-123","title":"Implement historical velocity computation","description":"Calculate velocity per week for past N weeks. Requires bead history feature (bv-62) for accurate historical data. Without history, use current snapshot to estimate.","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-8"],"created_at":"2025-12-15 15:54","updated_at":"2025-12-16 11:03","closed_at":"2025-12-16 11:03","blocked_by":["bv-102","bv-99"],"blocks":["bv-124"],"pagerank":0.002370670362804247,"betweenness":4,"eigenvector":0,"hub":0.16516641723326908,"authority":0.025477613152377718,"critical_path":3,"in_degree":1,"out_degree":2,"core_number":2,"slack":9,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-124","title":"Implement velocity trend detection","description":"Analyze velocity history to classify trend: increasing, decreasing, stable, volatile. Use simple linear regression or moving average comparison. Include in VelocityMetrics.","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-8"],"created_at":"2025-12-15 15:54","updated_at":"2025-12-16 11:27","closed_at":"2025-12-16 11:27","blocked_by":["bv-123","bv-99"],"blocks":["bv-125"],"pagerank":0.0021039815616854516,"betweenness":3,"eigenvector":0,"hub":0.15450939538094374,"authority":0.025477613152377718,"critical_path":2,"in_degree":1,"out_degree":2,"core_number":2,"slack":9,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-125","title":"Create velocity comparison view component","description":"Side-by-side velocity comparison for all labels. Columns: label, W-4, W-3, W-2, W-1, Avg, Trend indicator. Sparkline-style mini bar chart per row.","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-8"],"created_at":"2025-12-15 15:54","updated_at":"2025-12-16 14:26","closed_at":"2025-12-16 14:26","blocked_by":["bv-124","bv-99"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.15450939538094374,"authority":0,"critical_path":1,"in_degree":0,"out_degree":2,"core_number":2,"slack":9,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-126","title":"Add keyboard shortcuts for label navigation","description":"Main view: 'L' opens label dashboard, 'l' opens quick label filter popup with fuzzy search. Implement fuzzy search with fzf-style scoring. Integrate with existing keybinding system.","status":"closed","priority":2,"type":"task","labels":["labels-view","phase-2"],"created_at":"2025-12-15 15:54","updated_at":"2025-12-16 13:06","closed_at":"2025-12-16 13:06","blocked_by":["bv-104","bv-99"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.16879462089707997,"authority":0,"critical_path":1,"in_degree":0,"out_degree":2,"core_number":2,"slack":9,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-127","title":"Write comprehensive tests for label analysis functions","description":"Unit tests for: LabelHealth computation, CrossLabelFlow, subgraph extraction, label PageRank, attention score. Include edge cases: no labels, single label, circular dependencies.","status":"closed","priority":2,"type":"task","labels":["labels-view","testing"],"created_at":"2025-12-15 15:54","updated_at":"2025-12-15 23:56","closed_at":"2025-12-15 23:56","blocked_by":["bv-103","bv-110","bv-113","bv-116","bv-99"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.2606728599779225,"authority":0,"critical_path":1,"in_degree":0,"out_degree":5,"core_number":3,"slack":9,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-128","title":"Document label analysis in robot-help output","description":"Update AGENTS.md and --robot-help with label commands: --robot-label-health, --robot-label-flow, --robot-label-attention, --label filter. Include usage examples.","status":"closed","priority":2,"type":"task","labels":["docs","labels-view"],"created_at":"2025-12-15 15:54","updated_at":"2025-12-16 13:09","closed_at":"2025-12-16 13:09","blocked_by":["bv-119","bv-120","bv-121","bv-122","bv-99"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.1686506908497555,"authority":0,"critical_path":1,"in_degree":0,"out_degree":5,"core_number":3,"slack":8,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-129","title":"Parallelization gain metric","description":"Add parallelization_gain signal shown only for top-N recommendations (respect caps). Compute via simulated removal (condensed DAG), deterministic, status-flagged. Integrate into advanced_insights.metrics with a single-line 'how to use' in output footer.","status":"closed","priority":2,"type":"task","labels":["ai-agent,advanced-insights"],"created_at":"2025-12-15 15:58","updated_at":"2025-12-15 21:43","closed_at":"2025-12-15 21:43","blocked_by":["bv-81","bv-82"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.0000033763562657725555,"authority":0,"critical_path":1,"in_degree":0,"out_degree":2,"core_number":2,"slack":13,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-12tz","title":"Fix staticcheck warnings across analysis/export/ui","description":"Run staticcheck and fix obvious findings: remove dead code/unused fields, fix minor style warnings, update deprecated viewport scroll calls, and address potential nil deref in export tests.","notes":"Fixed staticcheck ./... findings: removed dead/unused helpers and fields (analysis/ui/cmd), cleaned up minor style issues (error strings, unnecessary fmt.Sprintf), updated viewport scroll calls to ScrollUp/Down, and tightened nil-safety in export tests. go test ./... and staticcheck clean.","status":"closed","priority":2,"type":"chore","labels":["cleanup","staticcheck"],"created_at":"2025-12-16 19:23","updated_at":"2025-12-16 19:36","closed_at":"2025-12-16 19:36","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-130","title":"Cycle break suggestions for high-impact beads","description":"For beads inside cycles, compute minimal edge removals ranked by collateral impact (dependents lost). Use condensed SCCs + heuristics; cap count/runtime; deterministic ordering. Output suggestions[] kind='cycle_break' with rationale/status; include explicit advisory: 'Structural fix‚Äîapply before executing dependents.' Integrate with advanced_insights and reuse hash/config.","status":"closed","priority":2,"type":"task","labels":["ai-agent,advanced-insights"],"created_at":"2025-12-15 15:58","updated_at":"2025-12-15 21:50","closed_at":"2025-12-15 21:50","blocked_by":["bv-54","bv-85"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":7.422933394252896e-8,"authority":0,"critical_path":1,"in_degree":0,"out_degree":2,"core_number":2,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-131","title":"Agent brief export bundle","description":"Agent brief export bundle: single command emits priorities JSON, insights JSON, priority brief PNG, graph snapshot PNG/SVG, jq helper snippets, and hash/config. Caps respected; concise readme/help entry; designed for CI bots to post to chat with clear legend links.","status":"closed","priority":2,"type":"task","labels":["export,ai-agent,advanced-insights"],"created_at":"2025-12-15 15:58","updated_at":"2025-12-16 16:44","closed_at":"2025-12-16 16:44","blocked_by":["bv-84","bv-94","bv-96","bv-89"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.0000034766147611194113,"authority":0,"critical_path":1,"in_degree":0,"out_degree":4,"core_number":2,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-132","title":"Agent Swarm Protocol: Multi-Agent Coordination","description":"Enable multiple AI agents to work on the same project without conflicts.\n\n## INTEGRATION PRINCIPLES FOR AI AGENTS\n\n### Problem This Solves\nWithout coordination, multiple agents (Claude Code, Cursor, Codex) will:\n- Work on the same issues simultaneously\n- Edit the same files causing merge conflicts\n- Duplicate effort or produce conflicting changes\n\n### How It Integrates With Existing Commands\nThis feature AUGMENTS existing commands, doesn't replace them:\n\n1. **--robot-plan** will include a new field:\n   ```json\n   {\n     \"tracks\": [...],\n     \"agent_claims\": {\n       \"bv-42\": {\"agent\": \"claude-opus-1\", \"claimed_at\": \"...\", \"expires_at\": \"...\"}\n     },\n     \"available_for_claim\": [\"bv-43\", \"bv-44\"]  // Excludes claimed work\n   }\n   ```\n\n2. **--robot-priority** will filter out claimed items by default:\n   ```json\n   {\n     \"recommendations\": [...],  // Only unclaimed items\n     \"claimed_by_others\": 3     // How many filtered out\n   }\n   ```\n\n### Self-Documenting Output Pattern\nEvery agent-related robot command MUST include an 'explanation' field:\n```json\n{\n  \"command\": \"--robot-agents\",\n  \"result\": {...},\n  \"explanation\": {\n    \"what\": \"Shows all agents currently registered on this project\",\n    \"when_to_use\": \"Before starting work to see who else is active\",\n    \"action\": \"If you see other agents, use --robot-claim to reserve your work\"\n  }\n}\n```\n\n### Claim Expiration\nClaims auto-expire after 30 minutes of no heartbeat. This prevents orphaned claims from blocking work.\n\n### File Hints Are Advisory\nFile reservation hints are NOT locks - they're signals to other agents. An agent seeing a conflict should:\n1. Check if the other agent is still active (recent heartbeat)\n2. If inactive \u003e 30min, proceed with work\n3. If active, choose different work or coordinate\n\nLabels: [agent-swarm coordination]","status":"closed","priority":1,"type":"epic","labels":["agent-swarm","coordination"],"created_at":"2025-12-15 16:02","updated_at":"2025-12-15 19:26","closed_at":"2025-12-15 19:26","blocks":["bv-138","bv-139","bv-140","bv-141","bv-142","bv-143","bv-144"],"pagerank":0.009361996629768672,"betweenness":0,"eigenvector":0,"hub":0,"authority":0.00007183203350218329,"critical_path":5,"in_degree":7,"out_degree":0,"core_number":3,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-133","title":"Unified Triage Intelligence","description":"# Unified Triage Intelligence: The Mega Command\n\n**This is THE primary entry point for AI agents using bv.**\n\n## Vision\n\nInstead of agents calling 5-10 different robot commands and mentally merging results, `--robot-triage` provides EVERYTHING an agent needs in ONE call:\n\n- What should I work on? (recommendations)\n- Are there fires to put out? (alerts)\n- Who else is working? (team awareness)\n- Will I conflict with anyone? (file conflicts)\n- What's the project health? (stats, graph, labels)\n- Any handoffs waiting for me? (collaboration)\n\n## Design Principles\n\n1. **One call = full context** - Agent calls triage once, has everything\n2. **Critical first** - Alerts before recommendations\n3. **Actionable throughout** - Every section says what to DO\n4. **Self-documenting** - Output explains itself\n5. **Team-aware** - Multi-agent coordination built-in\n6. **Progressive detail** - Summaries by default, deep-dive commands available\n\n## Output Structure (Priority Order)\n\n```\n1. meta           - Command info, timestamp, data hash\n2. quick_ref      - One-line summary for fast parsing\n3. alerts         - Critical issues FIRST (fires before features)\n4. top_pick       - THE #1 recommendation with full reasoning\n5. your_session   - Your claims, handoffs, context\n6. team           - Other agents, conflicts, available tracks\n7. recommendations- Next 5 items after top_pick\n8. quick_wins     - Low-effort high-impact items\n9. blockers       - Items that unblock the most work\n10. project_health- Stats, graph health, label health, drift\n11. suggestions   - Hygiene hints (missing deps, stale claims)\n12. commands      - Exact commands for next steps\n```\n\n## Relationship to Other Commands\n\n`--robot-triage` INCLUDES summaries from:\n- Agent Swarm (team, your_session, conflicts)\n- Proactive Alerts (alerts section)\n- Priority scoring (recommendations, top_pick)\n- Labels View (project_health.labels)\n- Execution Plan (available tracks)\n- History (your_session context)\n- Drift (project_health.drift)\n- Suggestions (suggestions section)\n\nIndividual commands remain for DEEP DIVES:\n- `--robot-plan` for full execution tracks\n- `--robot-insights` for complete graph metrics\n- `--robot-agents` for detailed agent activity\n- `--robot-alerts` for full alert details\n- `--robot-history` for commit correlation\n\n## Companion: --robot-next\n\nFor agents that just want ONE answer:\n```bash\nbv --robot-next  # Returns ONLY top_pick, nothing else\n```\n\n## Success Criteria\n\nAn AI agent should be able to:\n1. Call `--robot-triage` at session start\n2. Immediately understand what to work on\n3. Know if there are any critical issues\n4. See team context without additional calls\n5. Get exact commands for next actions","status":"closed","priority":1,"type":"epic","labels":["intelligence","triage"],"created_at":"2025-12-15 16:02","updated_at":"2025-12-15 23:15","closed_at":"2025-12-15 23:15","blocks":["bv-146","bv-147","bv-148","bv-149","bv-150","bv-151"],"pagerank":0.007076149068029694,"betweenness":0,"eigenvector":0,"hub":0,"authority":0.032593863307319865,"critical_path":5,"in_degree":6,"out_degree":0,"core_number":3,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-134","title":"Sprint \u0026 Forecast System","description":"Add time dimension for planning and projections. Sprint/milestone definitions, ETA estimation per bead based on velocity and complexity, burndown tracking, capacity modeling. Enables realistic project planning and deadline management.","status":"closed","priority":2,"type":"epic","labels":["forecast","planning"],"created_at":"2025-12-15 16:02","updated_at":"2025-12-16 14:27","closed_at":"2025-12-16 14:27","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-135","title":"Proactive Alerts Engine","description":"Background analysis that surfaces issues PROACTIVELY (not just when asked).\n\n## RELATIONSHIP TO EXISTING DRIFT SYSTEM\n\npkg/drift/drift.go ALREADY implements drift detection with:\n- Alert types: new_cycle, pagerank_change, density_growth, blocked_increase\n- Severity levels: critical, warning, info\n- --check-drift and --robot-drift CLI\n\nTHIS FEATURE EXTENDS drift to add:\n1. **Velocity anomaly detection** (new - not in drift.go)\n2. **Individual issue staleness** (priority.go has staleness but per-issue, not alerting)\n3. **Integration with triage** (alerts feed into --robot-triage)\n\n## WHAT'S NEW vs WHAT EXISTS\n\n| Alert Type | Exists? | Location |\n|------------|---------|----------|\n| new_cycle | YES | pkg/drift/drift.go |\n| pagerank_change | YES | pkg/drift/drift.go |\n| density_growth | YES | pkg/drift/drift.go |\n| blocked_increase | YES | pkg/drift/drift.go |\n| velocity_drop | NEW | This feature |\n| stale_issue | NEW | This feature (per-issue, not aggregate) |\n| abandoned_claim | NEW | Needs agent swarm |\n\n## INTEGRATION PATTERN\n\nAlerts should be INCLUDED in triage output, not a separate command agents must call:\n\n```json\n{\n  \"recommendation\": {...},\n  \"alerts\": [\n    {\n      \"type\": \"velocity_drop\",\n      \"severity\": \"warning\", \n      \"label\": \"database\",\n      \"message\": \"Velocity dropped 40% this week (was 4/wk, now 2.4/wk)\",\n      \"action\": \"Consider prioritizing database work or checking for blockers\"\n    }\n  ]\n}\n```\n\n## CONFIGURATION REUSE\n\nUse existing .bv/drift.yaml for thresholds:\n```yaml\n# Existing drift thresholds\ndensity_warning_pct: 50\nblocked_increase_threshold: 3\n\n# NEW alert thresholds (add to same file)\nvelocity_drop_threshold: 0.3  # 30% drop triggers warning\nstale_days_warning: 14\nstale_days_critical: 30\n```\n\n## DO NOT CREATE ALERT FATIGUE\n\nOnly surface alerts that are ACTIONABLE:\n- Don't alert on everything\n- Group related alerts\n- Provide clear action steps\n\nLabels: [alerts proactive]","notes":"Completed --robot-alerts CLI integration and proactive alerts (stale/blocking cascades); thresholds in drift config; tests passing.","status":"closed","priority":2,"type":"epic","labels":["alerts","proactive"],"created_at":"2025-12-15 16:02","updated_at":"2025-12-15 22:47","closed_at":"2025-12-15 22:47","blocks":["bv-162","bv-163","bv-164","bv-165","bv-166","bv-167","bv-168"],"pagerank":0.008337979221094353,"betweenness":0,"eigenvector":0,"hub":0,"authority":0.03717457635030012,"critical_path":5,"in_degree":7,"out_degree":0,"core_number":3,"slack":10,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-136","title":"Dependency Graph Visualization","description":"Make the computed dependency graph visible in exportable formats.\n\n## WHAT ALREADY EXISTS vs WHAT'S NEW\n\n| Feature | Exists? | Location |\n|---------|---------|----------|\n| Mermaid diagram | YES | pkg/export/markdown.go (in markdown export) |\n| ASCII art TUI | YES | pkg/ui/graph.go (full GraphModel with navigation) |\n| DOT format | NEW | This feature |\n| --robot-graph CLI | NEW | This feature |\n| Standalone Mermaid export | NEW | Mermaid exists but only in markdown bundle |\n\n## WHAT THIS FEATURE ACTUALLY ADDS\n\n1. **--robot-graph command**: Dedicated CLI for graph export\n   ```bash\n   bv --robot-graph                      # Default: JSON adjacency\n   bv --robot-graph --format=dot         # Graphviz DOT\n   bv --robot-graph --format=mermaid     # Standalone Mermaid\n   bv --robot-graph --label=backend      # Filter to label\n   bv --robot-graph --root=bv-42         # Subgraph from root\n   ```\n\n2. **DOT format** (NEW): For Graphviz rendering\n   ```dot\n   digraph G {\n     rankdir=LR;\n     node [shape=box];\n     \"bv-42\" [label=\"API schema\\nP1 open\" color=\"green\"];\n     \"bv-31\" -\u003e \"bv-42\" [style=bold];  // blocks\n   }\n   ```\n\n3. **Subgraph extraction**: Already partially in graph.go but expose as reusable function\n\n## ROBOT OUTPUT PATTERN\n\n```json\n{\n  \"format\": \"dot\",\n  \"graph\": \"digraph G {...}\",\n  \"nodes\": 12,\n  \"edges\": 8,\n  \"filters_applied\": {\"label\": \"backend\", \"depth\": 2},\n  \"explanation\": {\n    \"what\": \"Dependency graph in Graphviz DOT format\",\n    \"how_to_render\": \"Save to file.dot, run: dot -Tpng file.dot -o graph.png\",\n    \"when_to_use\": \"When you need a visual overview of dependencies for documentation or debugging\"\n  }\n}\n```\n\n## INTEGRATION: DO NOT DUPLICATE EXISTING\n\n- Reuse sanitizeMermaidID/sanitizeMermaidText from pkg/export/markdown.go\n- Reuse GraphModel structure from pkg/ui/graph.go for subgraph logic\n- Just add the CLI flag and DOT format renderer\n\nLabels: [graph visualization]","status":"closed","priority":2,"type":"epic","labels":["graph","visualization"],"created_at":"2025-12-15 16:02","updated_at":"2025-12-16 10:33","closed_at":"2025-12-16 10:33","blocks":["bv-169","bv-170","bv-171","bv-172","bv-173","bv-174"],"pagerank":0.006677891489611685,"betweenness":0,"eigenvector":0,"hub":0,"authority":0.0000010515559788432888,"critical_path":4,"in_degree":6,"out_degree":0,"core_number":3,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-137","title":"Smart Suggestions Engine","description":"Intelligent recommendations to improve project hygiene. Missing dependency detection, duplicate detection (with semantic search when available), label suggestions from content, stale cleanup recommendations, cycle prevention warnings.","status":"closed","priority":3,"type":"epic","labels":["hygiene","suggestions"],"created_at":"2025-12-15 16:02","updated_at":"2025-12-16 16:55","closed_at":"2025-12-16 16:55","blocks":["bv-176","bv-177","bv-178","bv-179","bv-180"],"pagerank":0.004419468678084663,"betweenness":0,"eigenvector":0,"hub":0,"authority":9.006307058771386e-9,"critical_path":3,"in_degree":5,"out_degree":0,"core_number":3,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-138","title":"Define AgentRegistration and WorkClaim data types","description":"Core data types for Agent Swarm Protocol\n\n## Data Model\n```go\n// .beads/agents.jsonl storage format\ntype AgentRegistration struct {\n    Name        string    `json:\"name\"`         // \"claude-opus-1\"\n    Model       string    `json:\"model\"`        // \"claude-opus-4\"\n    Program     string    `json:\"program\"`      // \"claude-code\", \"cursor\", \"devin\"\n    StartedAt   time.Time `json:\"started_at\"`\n    LastSeen    time.Time `json:\"last_seen\"`\n    ClaimedWork []string  `json:\"claimed_work\"` // bead IDs\n    FileHints   []string  `json:\"file_hints\"`   // files being touched\n}\n\ntype WorkClaim struct {\n    BeadID    string    `json:\"bead_id\"`\n    Agent     string    `json:\"agent\"`\n    ClaimedAt time.Time `json:\"claimed_at\"`\n    ExpiresAt time.Time `json:\"expires_at\"`  // auto-release after inactivity\n    Reason    string    `json:\"reason\"`      // \"implementing\", \"reviewing\", \"testing\"\n}\n```\n\n## Storage\n- Store in `.beads/agents.jsonl` (same pattern as issues.jsonl)\n- One line per agent registration\n- WorkClaims embedded in AgentRegistration.ClaimedWork\n\n## Heartbeat Logic\n- Agent updates LastSeen on each operation\n- Claims auto-expire after 30 minutes of inactivity (configurable)\n- Stale agents (LastSeen \u003e 1 hour) marked inactive\n\n## Integration Points\n- Triage considers claims (bv-147 ClaimPenalty)\n- Graph viz can show claim status\n- Alerts when claims conflict or expire","status":"closed","priority":1,"type":"task","labels":["agent-swarm","types"],"created_at":"2025-12-15 16:02","updated_at":"2025-12-15 19:08","closed_at":"2025-12-15 19:08","blocked_by":["bv-132"],"blocks":["bv-139"],"pagerank":0.0032062949437169806,"betweenness":0,"eigenvector":0,"hub":0.000011844649006262776,"authority":0.0000020098792839896207,"critical_path":4,"in_degree":1,"out_degree":1,"core_number":2,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-139","title":"Implement agent registry and heartbeat system","description":"Agent registry management and heartbeat system\n\n## Commands\n```bash\nbv --robot-agents          # List all agents (active + inactive)\nbv --robot-agent-register  # Register this agent (reads from env)\nbv --robot-agent-heartbeat # Update LastSeen timestamp\n```\n\n## Registration Flow\n1. Agent starts session\n2. Calls --robot-agent-register with name, model, program\n3. System assigns unique name if collision (claude-opus-1, claude-opus-2)\n4. Returns agent ID for subsequent operations\n\n## Heartbeat Flow\n1. Agent calls --robot-agent-heartbeat periodically (every 5 min recommended)\n2. System updates LastSeen\n3. Returns current claims and any conflicts\n\n## Environment Variables (for auto-detection)\n```\nBV_AGENT_NAME=claude-opus-1\nBV_AGENT_MODEL=claude-opus-4\nBV_AGENT_PROGRAM=claude-code\n```\n\n## Output Format\n```json\n{\n  \"explanation\": {\n    \"what\": \"Active agent registry\",\n    \"when_to_use\": \"Before claiming work, to see who else is active\",\n    \"action\": \"Coordinate with listed agents to avoid conflicts\"\n  },\n  \"agents\": [\n    {\n      \"name\": \"claude-opus-1\",\n      \"model\": \"claude-opus-4\",\n      \"program\": \"claude-code\",\n      \"active\": true,\n      \"claims\": [\"bv-42\", \"bv-43\"],\n      \"last_seen\": \"2025-01-15T10:30:00Z\"\n    }\n  ],\n  \"total_active\": 2,\n  \"total_claims\": 5\n}\n```","status":"closed","priority":1,"type":"task","labels":["agent-swarm","registry"],"created_at":"2025-12-15 16:03","updated_at":"2025-12-15 19:15","closed_at":"2025-12-15 19:15","blocked_by":["bv-132","bv-138"],"blocks":["bv-140","bv-141","bv-144"],"pagerank":0.004070158355453312,"betweenness":6,"eigenvector":0,"hub":0.000012176065416228286,"authority":0.000006388714975684768,"critical_path":3,"in_degree":3,"out_degree":2,"core_number":3,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-140","title":"Implement work claiming and releasing","description":"Work claiming and releasing mechanism\n\n## Commands\n```bash\nbv --robot-claim bv-42              # Claim a bead\nbv --robot-claim bv-42 bv-43        # Claim multiple beads\nbv --robot-release bv-42            # Release a claim\nbv --robot-release --all            # Release all claims for this agent\n```\n\n## Claim Semantics\n- Soft lock (advisory, not enforced)\n- Auto-expires after 30 min inactivity (configurable)\n- Renewed by heartbeat or explicit --robot-claim\n- Other agents see claim but can override with --force\n\n## Conflict Handling\n- If already claimed by another agent: return warning, not error\n- Include claim holder info so agents can coordinate\n- --force flag allows override (for emergencies)\n\n## Output Format (claim)\n```json\n{\n  \"explanation\": {\n    \"what\": \"Work claim result\",\n    \"when_to_use\": \"Before starting work on an issue\",\n    \"action\": \"Proceed with work if granted, coordinate if conflict\"\n  },\n  \"granted\": [\"bv-42\"],\n  \"conflicts\": [\n    {\n      \"bead_id\": \"bv-43\",\n      \"holder\": \"claude-opus-2\",\n      \"claimed_at\": \"2025-01-15T10:00:00Z\",\n      \"expires_at\": \"2025-01-15T10:30:00Z\"\n    }\n  ],\n  \"message\": \"Claimed 1 of 2 requested beads\"\n}\n```\n\n## Integration with Triage\n- Triage scoring (bv-147) applies ClaimPenalty to claimed items\n- --robot-triage excludes your own claims from recommendations\n- --robot-next never suggests items claimed by others","status":"closed","priority":1,"type":"task","labels":["agent-swarm","claims"],"created_at":"2025-12-15 16:03","updated_at":"2025-12-15 19:26","closed_at":"2025-12-15 19:26","blocked_by":["bv-132","bv-139"],"blocks":["bv-142","bv-143","bv-150"],"pagerank":0.002731484890410988,"betweenness":6,"eigenvector":0,"hub":0.000012898107787792896,"authority":0.0010274070553445021,"critical_path":2,"in_degree":3,"out_degree":2,"core_number":3,"slack":10,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-141","title":"Implement file reservation hints","description":"**NOTE: This task covers file hints AND conflict detection (title is legacy)**\n\nFile hints + conflict detection for multi-agent safety\n\n## Commands\n```bash\nbv --robot-file-hints bv-42 pkg/api/*.go  # Declare files you will touch\nbv --robot-conflicts                       # Check for current conflicts\n```\n\n## Part 1: File Hints Declaration\nAgents declare which files they intend to modify when claiming work.\n\n```go\ntype FileHint struct {\n    AgentName  string    `json:\"agent\"`\n    BeadID     string    `json:\"bead_id\"`\n    Paths      []string  `json:\"paths\"`       // exact paths or globs\n    DeclaredAt time.Time `json:\"declared_at\"`\n}\n```\n\n## Part 2: Conflict Detection\nSystem checks for overlapping file hints between agents.\n\n```go\ntype FileConflict struct {\n    Path     string   `json:\"path\"`\n    Agents   []string `json:\"agents\"`\n    BeadIDs  []string `json:\"bead_ids\"`\n    Severity string   `json:\"severity\"`  // \"warning\" or \"error\"\n}\n```\n\n## Output Format (--robot-conflicts)\n```json\n{\n  \"explanation\": {\n    \"what\": \"File conflict analysis\",\n    \"when_to_use\": \"Before making changes, or when git conflicts occur\",\n    \"action\": \"Coordinate with conflicting agents before proceeding\"\n  },\n  \"conflicts\": [{\n    \"path\": \"pkg/api/handlers.go\",\n    \"agents\": [\"claude-opus-1\", \"cursor-agent\"],\n    \"bead_ids\": [\"bv-42\", \"bv-55\"],\n    \"severity\": \"warning\"\n  }],\n  \"clean_paths\": 42,\n  \"conflict_count\": 1\n}\n```","status":"closed","priority":1,"type":"task","labels":["agent-swarm","files"],"created_at":"2025-12-15 16:03","updated_at":"2025-12-15 19:26","closed_at":"2025-12-15 19:26","blocked_by":["bv-132","bv-139"],"blocks":["bv-142"],"pagerank":0.0018948137854436062,"betweenness":1,"eigenvector":0,"hub":0.000012898107787792896,"authority":0.00003072670305469078,"critical_path":2,"in_degree":1,"out_degree":2,"core_number":3,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-142","title":"Implement conflict detection","description":"**NOTE: This task is about HANDOFF MESSAGING (title \"conflict detection\" is legacy)**\n\nAgent-to-agent handoff messaging for work transitions\n\n## Commands\n```bash\nbv --robot-handoff bv-42 \"Finished API, needs frontend integration\"\nbv --robot-messages                 # View handoff messages\n```\n\n## Purpose\nWhen an agent finishes part of a task or needs to pass context to another agent:\n- Send structured handoff message attached to a bead\n- Other agents see pending handoffs when claiming work\n- Enables smooth multi-agent collaboration\n\n## Data Model\n```go\ntype HandoffMessage struct {\n    ID        string    `json:\"id\"`\n    BeadID    string    `json:\"bead_id\"`\n    FromAgent string    `json:\"from_agent\"`\n    ToAgent   string    `json:\"to_agent\"`     // specific agent or \"*\" for any\n    Message   string    `json:\"message\"`\n    Timestamp time.Time `json:\"timestamp\"`\n    Read      bool      `json:\"read\"`\n}\n```\n\n## Storage\nPersisted in `.beads/handoffs.jsonl` (same pattern as issues.jsonl)\n\n## Integration Points\n- Triage surfaces unread handoffs in recommendations\n- --robot-next prioritizes items with pending handoffs\n- Claiming a bead shows any pending handoffs\n\n## Output Format (receiving)\n```json\n{\n  \"explanation\": {\n    \"what\": \"Pending handoff messages\",\n    \"when_to_use\": \"Before starting work on a claimed bead\",\n    \"action\": \"Read context from previous agent before proceeding\"\n  },\n  \"pending_handoffs\": [{\n    \"bead_id\": \"bv-42\",\n    \"from_agent\": \"claude-opus-1\",\n    \"message\": \"Finished API changes, needs frontend integration\",\n    \"timestamp\": \"2025-01-15T11:00:00Z\"\n  }],\n  \"count\": 1\n}\n```","status":"closed","priority":1,"type":"task","labels":["agent-swarm","conflicts"],"created_at":"2025-12-15 16:03","updated_at":"2025-12-15 19:26","closed_at":"2025-12-15 19:26","blocked_by":["bv-132","bv-140","bv-141"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.000186324228086189,"authority":0,"critical_path":1,"in_degree":0,"out_degree":3,"core_number":3,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-143","title":"Implement intelligent work partitioning","description":"INCREMENTAL ENHANCEMENT on existing partitioning\n\n## What Already Exists (DO NOT DUPLICATE)\n- `pkg/analysis/plan.go:findConnectedComponents()` - groups related issues via union-find\n- `pkg/analysis/plan.go:buildTracks()` - creates ExecutionTrack[] from components\n- `--robot-plan` already outputs parallel tracks\n\n## What This Adds (NEW VALUE)\nGiven N agents, recommend OPTIMAL assignment strategy:\n1. Agent skill/label matching (assign backend track to backend-skilled agent)\n2. Component sizing (balance work across agents fairly)\n3. Conflict minimization (avoid file overlap between agents)\n4. Priority sequencing (highest impact tracks assigned first)\n\n## Implementation Approach\n1. REUSE: Call `GetExecutionPlan()` to get existing tracks\n2. ADD: Score each track by total priority, PageRank sum, estimated effort\n3. ADD: Match tracks to agent capabilities (if provided)\n4. ADD: Output assignment recommendations with rationale\n\n## Robot Output Format\n```json\n{\n  \"explanation\": {\n    \"what\": \"Agent work partitioning recommendations\",\n    \"when_to_use\": \"Starting multi-agent work session\",\n    \"action\": \"Assign tracks to agents as recommended\"\n  },\n  \"assignments\": [\n    {\n      \"agent_slot\": 1,\n      \"tracks\": [\"track-1\", \"track-3\"],\n      \"total_items\": 8,\n      \"rationale\": \"Database-focused work, highest combined priority\"\n    }\n  ]\n}\n```","status":"closed","priority":2,"type":"task","labels":["agent-swarm","partitioning"],"created_at":"2025-12-15 16:03","updated_at":"2025-12-15 19:26","closed_at":"2025-12-15 19:26","blocked_by":["bv-132","bv-140","bv-53"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.00018647512327893949,"authority":0,"critical_path":1,"in_degree":0,"out_degree":3,"core_number":2,"slack":10,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-144","title":"Add agent context to robot outputs","description":"Include current agent claims in --robot-insights, --robot-plan, --robot-priority outputs. Show which work is claimed by whom. Filter available work.","status":"closed","priority":2,"type":"task","labels":["agent-swarm","integration"],"created_at":"2025-12-15 16:03","updated_at":"2025-12-15 19:26","closed_at":"2025-12-15 19:26","blocked_by":["bv-132","bv-139"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.000012898107787792896,"authority":0,"critical_path":1,"in_degree":0,"out_degree":2,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-145","title":"Top-k unlock set (submodular selection)","description":"Provide a robot flag that returns the best *set* of k beads (not just a rank list) maximizing downstream unlocks via greedy submodular selection. Guardrails: cap iterations by k (default k=3); deterministic tie-breaks (ID); reuse analyzer/cache hash; accept filters/recipes; output includes marginal gains per pick, final gain, data_hash/config. Keep JSON concise; optional --topk-table for human-friendly view. Integrate into advanced_insights sets[] with kind='topk_set' and one-line usage hint.","status":"closed","priority":2,"type":"task","labels":["ai-agent,advanced-insights"],"created_at":"2025-12-15 16:03","updated_at":"2025-12-15 21:54","closed_at":"2025-12-15 21:54","blocked_by":["bv-81","bv-82"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.0000033763562657725555,"authority":0,"critical_path":1,"in_degree":0,"out_degree":2,"core_number":2,"slack":13,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-146","title":"Define TriageRecommendation and TriageAlert types","description":"# Triage Types: Complete Data Model\n\n## Core Result Type\n\n```go\ntype TriageResult struct {\n    Meta           TriageMeta           `json:\"meta\"`\n    QuickRef       QuickRef             `json:\"quick_ref\"`\n    Alerts         AlertsByLevel        `json:\"alerts\"`\n    TopPick        *TopPick             `json:\"top_pick\"`        // nil if nothing to work on\n    YourSession    *SessionContext      `json:\"your_session\"`    // nil if no agent identity\n    Team           TeamStatus           `json:\"team\"`\n    Recommendations []Recommendation    `json:\"recommendations\"`\n    QuickWins      []QuickWin           `json:\"quick_wins\"`\n    BlockersToClear []BlockerItem       `json:\"blockers_to_clear\"`\n    ProjectHealth  ProjectHealth        `json:\"project_health\"`\n    Suggestions    []Suggestion         `json:\"suggestions\"`\n    Commands       CommandHelpers       `json:\"commands\"`\n}\n```\n\n## Supporting Types\n\n```go\ntype TriageMeta struct {\n    Command       string    `json:\"command\"`\n    GeneratedAt   time.Time `json:\"generated_at\"`\n    DataHash      string    `json:\"data_hash\"`\n    AgentIdentity string    `json:\"agent_identity,omitempty\"`\n}\n\ntype QuickRef struct {\n    TopPick        string `json:\"top_pick\"`         // \"bv-43: Title\"\n    CriticalAlerts int    `json:\"critical_alerts\"`\n    Warnings       int    `json:\"warnings\"`\n    YourClaims     int    `json:\"your_claims\"`\n    TeamActive     int    `json:\"team_active\"`\n    ActionableItems int   `json:\"actionable_items\"`\n    Status         string `json:\"status\"`           // \"ready_to_work\", \"alerts_pending\", \"all_claimed\"\n}\n\ntype AlertsByLevel struct {\n    Critical []TriageAlert `json:\"critical\"`\n    Warning  []TriageAlert `json:\"warning\"`\n    Info     []TriageAlert `json:\"info\"`\n}\n\ntype TriageAlert struct {\n    Type    string   `json:\"type\"`              // Uses drift.AlertType + new types\n    BeadID  string   `json:\"bead_id,omitempty\"`\n    BeadIDs []string `json:\"bead_ids,omitempty\"` // For multi-bead alerts\n    Message string   `json:\"message\"`\n    Action  string   `json:\"action\"`            // What to do about it\n}\n\ntype TopPick struct {\n    BeadID         string   `json:\"bead_id\"`\n    Title          string   `json:\"title\"`\n    Type           string   `json:\"type\"`\n    Priority       string   `json:\"priority\"`\n    Score          float64  `json:\"score\"`\n    Why            []string `json:\"why\"`            // Human-readable reasons with emoji\n    Labels         []string `json:\"labels\"`\n    EstimatedImpact string  `json:\"estimated_impact\"`\n    FilesLikely    []string `json:\"files_likely,omitempty\"`\n    ClaimCommand   string   `json:\"claim_command\"`\n}\n\ntype SessionContext struct {\n    AgentName       string         `json:\"agent_name\"`\n    Claims          []ClaimInfo    `json:\"claims\"`\n    PendingHandoffs []HandoffInfo  `json:\"pending_handoffs\"`\n    RecentActivity  string         `json:\"recent_activity\"`\n}\n\ntype ClaimInfo struct {\n    BeadID    string    `json:\"bead_id\"`\n    Title     string    `json:\"title\"`\n    ClaimedAt time.Time `json:\"claimed_at\"`\n    Files     []string  `json:\"files,omitempty\"`\n}\n\ntype HandoffInfo struct {\n    FromAgent  string    `json:\"from_agent\"`\n    BeadID     string    `json:\"bead_id\"`\n    Message    string    `json:\"message\"`\n    ReceivedAt time.Time `json:\"received_at\"`\n}\n\ntype TeamStatus struct {\n    ActiveAgents     []AgentSummary `json:\"active_agents\"`\n    TotalClaimed     int            `json:\"total_claimed\"`\n    FileConflicts    []FileConflict `json:\"file_conflicts\"`\n    AvailableTracks  []string       `json:\"available_tracks\"`\n    CoordinationHint string         `json:\"coordination_hint,omitempty\"`\n}\n\ntype AgentSummary struct {\n    Name     string   `json:\"name\"`\n    Claims   []string `json:\"claims\"`\n    LastSeen string   `json:\"last_seen\"`\n    Track    string   `json:\"track,omitempty\"`\n}\n\ntype Recommendation struct {\n    Rank   int     `json:\"rank\"`\n    BeadID string  `json:\"bead_id\"`\n    Score  float64 `json:\"score\"`\n    Title  string  `json:\"title\"`\n    Why    string  `json:\"why\"`\n}\n\ntype QuickWin struct {\n    BeadID string `json:\"bead_id\"`\n    Title  string `json:\"title\"`\n    Effort string `json:\"effort\"` // \"low\", \"medium\"\n    Impact string `json:\"impact\"` // \"low\", \"medium\", \"high\"\n}\n\ntype BlockerItem struct {\n    BeadID      string `json:\"bead_id\"`\n    Title       string `json:\"title\"`\n    Unblocks    int    `json:\"unblocks\"`\n    PrioritySum int    `json:\"priority_sum\"`\n}\n\ntype ProjectHealth struct {\n    Counts          HealthCounts     `json:\"counts\"`\n    Graph           GraphHealth      `json:\"graph\"`\n    LabelsAttention []LabelAttention `json:\"labels_attention\"`\n    Velocity        VelocityInfo     `json:\"velocity\"`\n    Drift           DriftSummary     `json:\"drift\"`\n}\n\ntype HealthCounts struct {\n    Total      int `json:\"total\"`\n    Open       int `json:\"open\"`\n    InProgress int `json:\"in_progress\"`\n    Blocked    int `json:\"blocked\"`\n    ClosedWeek int `json:\"closed_week\"`\n}\n\ntype GraphHealth struct {\n    Cycles       int    `json:\"cycles\"`\n    Density      float64 `json:\"density\"`\n    LongestChain int    `json:\"longest_chain\"`\n    Health       string `json:\"health\"` // \"good\", \"warning\", \"critical\"\n}\n\ntype LabelAttention struct {\n    Label  string `json:\"label\"`\n    Health int    `json:\"health\"` // 0-100\n    Issue  string `json:\"issue\"`\n}\n\ntype VelocityInfo struct {\n    ClosedPerWeek int    `json:\"closed_per_week\"`\n    Trend         string `json:\"trend\"` // \"improving\", \"stable\", \"declining\"\n}\n\ntype DriftSummary struct {\n    BaselineAge        string `json:\"baseline_age\"`\n    SignificantChanges bool   `json:\"significant_changes\"`\n}\n\ntype Suggestion struct {\n    Type  string `json:\"type\"`  // \"missing_dep\", \"stale_claim\", \"duplicate\"\n    Bead  string `json:\"bead,omitempty\"`\n    Agent string `json:\"agent,omitempty\"`\n    Hint  string `json:\"hint\"`\n}\n\ntype CommandHelpers struct {\n    ClaimTopPick     string `json:\"claim_top_pick\"`\n    ShowTopPick      string `json:\"show_top_pick\"`\n    ContinueYourWork string `json:\"continue_your_work,omitempty\"`\n    SeeFullPlan      string `json:\"see_full_plan\"`\n    ReleaseClaims    string `json:\"release_claims\"`\n    SendHandoff      string `json:\"send_handoff\"`\n}\n```\n\n## Implementation Location\n`pkg/analysis/triage.go` (new file)\n\n## Integration Points\n- Reuses `drift.Alert` for alert types\n- Reuses `AgentRegistration`, `WorkClaim` from agent swarm\n- Reuses `ImpactScore` from priority.go\n- Reuses `ExecutionPlan` from plan.go","status":"closed","priority":1,"type":"task","labels":["triage","types"],"created_at":"2025-12-15 16:03","updated_at":"2025-12-15 18:55","closed_at":"2025-12-15 18:55","blocked_by":["bv-133"],"blocks":["bv-147","bv-148"],"pagerank":0.002873326388838979,"betweenness":0,"eigenvector":0,"hub":0.005374522365729446,"authority":0.028866527647594713,"critical_path":4,"in_degree":2,"out_degree":1,"core_number":3,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-147","title":"Implement unified scoring algorithm","description":"INCREMENTAL ENHANCEMENT on existing scoring\n\n## What Already Exists (DO NOT DUPLICATE)\n- `pkg/analysis/priority.go:ComputeImpactScores()` - composite scoring\n- Existing weights: PageRank(30%), Betweenness(30%), BlockerRatio(20%), Staleness(10%), PriorityBoost(10%)\n- `pkg/analysis/priority.go:ScoreBreakdown` - individual component tracking\n\n## What This Adds (NEW VALUE)\nTRIAGE-specific scoring that EXTENDS base scoring with:\n1. Label health factor (from bv-99 labels view) - boost items in unhealthy labels\n2. Agent claim factor (from bv-132) - reduce score for claimed items\n3. Unblock impact factor - boost items that unblock many others\n4. Quick-win factor - boost small items with high impact ratio\n\n## Incremental Implementation (Graceful Degradation)\n\n**Phase 1 (MVP):** Works with existing scoring only\n```go\nTriageScore = ComputeImpactScores() // 100% weight\n```\n\n**Phase 2 (Labels ready):** Add label health\n```go\nTriageScore = BaseScore*0.7 + LabelHealthBoost*0.15 + UnblockBoost*0.15\n```\n\n**Phase 3 (Agent Swarm ready):** Add claim penalty\n```go\nif claimedByOther { TriageScore *= 0.1 } // Heavily penalize claimed items\n```\n\n**Phase 4 (Attention scores ready):** Refine label factor\n```go\n// Replace simple label health with attention-weighted health\nLabelHealthBoost = labelAttentionScore * 0.15\n```\n\n## Key Principle\nStart simple, enhance incrementally. Never block triage on optional features.\n\n## Output Format\n```json\n{\n  \"triage_scores\": [{\n    \"issue_id\": \"bv-42\",\n    \"base_score\": 0.72,\n    \"triage_score\": 0.85,\n    \"factors_applied\": [\"base\", \"label_health\", \"unblock\"],\n    \"factors_pending\": [\"claim_penalty\", \"attention_score\"]\n  }]\n}\n```","status":"closed","priority":1,"type":"task","labels":["scoring","triage"],"created_at":"2025-12-15 16:03","updated_at":"2025-12-15 18:59","closed_at":"2025-12-15 18:59","blocked_by":["bv-133","bv-146","bv-80","bv-99"],"blocks":["bv-149"],"pagerank":0.0021911346755756006,"betweenness":7.5,"eigenvector":0,"hub":0.1649270821542633,"authority":0.0009371893378907967,"critical_path":3,"in_degree":1,"out_degree":4,"core_number":3,"slack":10,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-148","title":"Implement reason generation","description":"INCREMENTAL ENHANCEMENT on existing reason generation\n\n## What Already Exists (DO NOT DUPLICATE)\n- `pkg/analysis/priority.go:generateRecommendation()` - creates PriorityRecommendation\n- `pkg/analysis/priority.go:Reasoning[]` field - list of human-readable explanations\n- Existing reasons: PageRank commentary, betweenness commentary, staleness notes, unblocks count\n\n## What This Adds (NEW VALUE)\nTRIAGE-specific reasons that supplement priority reasons:\n1. Label attention context: \"Label 'backend' needs attention (health: 45/100)\"\n2. Unblock cascade detail: \"Completing this unblocks bv-43, bv-44, bv-51 (3 items)\"\n3. Agent claim status: \"Currently unclaimed - available for work\"\n4. Staleness alert phrasing: \"No activity in 12 days - consider reviewing\"\n5. Quick-win identification: \"Low effort, high impact - good starting point\"\n\n## Implementation Approach\n1. REUSE: Call `GenerateRecommendations()` to get base reasons\n2. ADD: generateTriageReasons() that adds triage-specific context\n3. ADD: Merge base reasons + triage reasons into unified list\n4. ADD: Priority ordering of reasons (most actionable first)\n\n## Key Principle\nTriageReasons = BaseReasons + TriageSpecificReasons\nTriage reasons should be ACTIONABLE (tell agent what to DO, not just what IS)\n\n## Output Format Example\n```json\n{\n  \"reasons\": [\n    \"üéØ Completing this unblocks 5 downstream issues (highest impact in backlog)\",\n    \"‚ö†Ô∏è Label 'database' needs attention (health: 32/100)\",\n    \"üìä High graph centrality (PageRank: 0.82, betweenness: 0.65)\",\n    \"üïê No activity in 14 days - may be stuck or forgotten\",\n    \"‚úÖ Currently unclaimed - available for immediate work\"\n  ],\n  \"action\": \"Start work on this issue\"\n}\n```","status":"closed","priority":1,"type":"task","labels":["reasons","triage"],"created_at":"2025-12-15 16:03","updated_at":"2025-12-15 19:03","closed_at":"2025-12-15 19:03","blocked_by":["bv-133","bv-146"],"blocks":["bv-149"],"pagerank":0.0021911346755756006,"betweenness":1.5,"eigenvector":0,"hub":0.010134430603673838,"authority":0.0009371893378907967,"critical_path":3,"in_degree":1,"out_degree":2,"core_number":3,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-149","title":"Implement --robot-triage command","description":"# --robot-triage: The Mega Command (Incremental Implementation)\n\n**THE primary entry point for AI agents. One call = everything available.**\n\n## Key Design Principle: Graceful Degradation\n\nThe mega-command works with WHATEVER features are available. Sections are included only when their underlying systems are ready:\n\n| Section | Requires | Phase |\n|---------|----------|-------|\n| meta, quick_ref | Nothing | 1 (MVP) |\n| recommendations | ComputeImpactScores() | 1 (MVP) |\n| project_health.counts | Basic stats | 1 (MVP) |\n| project_health.graph | Analyzer | 1 (MVP) |\n| alerts | Proactive Alerts (bv-135) | 2 |\n| your_session, team | Agent Swarm (bv-132) | 2 |\n| project_health.labels | Labels View (bv-99) | 2 |\n| history_hints | History (bv-62) | 3 |\n| suggestions | Smart Suggestions (bv-137) | 3 |\n\n**Missing sections return `null` or are omitted entirely.**\n\n## Phase 1 MVP Output (Works Today)\n\n```json\n{\n  \"meta\": {\"command\": \"--robot-triage\", \"generated_at\": \"...\", \"data_hash\": \"...\"},\n  \"quick_ref\": {\n    \"top_pick\": \"bv-43: Implement auth middleware\",\n    \"actionable_items\": 33,\n    \"status\": \"ready_to_work\"\n  },\n  \"alerts\": null,\n  \"top_pick\": {\n    \"bead_id\": \"bv-43\",\n    \"title\": \"Implement auth middleware\",\n    \"score\": 94.2,\n    \"why\": [\"Highest impact score\", \"Unblocks 5 items\"],\n    \"claim_command\": \"bv --robot-claim bv-43\"\n  },\n  \"your_session\": null,\n  \"team\": null,\n  \"recommendations\": [...],\n  \"quick_wins\": [...],\n  \"blockers_to_clear\": [...],\n  \"project_health\": {\n    \"counts\": {\"total\": 169, \"open\": 131, \"blocked\": 12},\n    \"graph\": {\"cycles\": 0, \"density\": 0.15, \"health\": \"good\"},\n    \"labels_attention\": null,\n    \"drift\": null\n  },\n  \"suggestions\": null,\n  \"commands\": {\"claim_top_pick\": \"bv --robot-claim bv-43\", \"see_full_plan\": \"bv --robot-plan\"}\n}\n```\n\n## Full Output (All Features Enabled)\n\n[Previous full specification remains valid - all 12 sections populated]\n\n## Implementation Approach\n\n```go\nfunc ComputeTriage(agentName string) TriageResult {\n    result := TriageResult{\n        Meta: buildMeta(),\n    }\n    \n    // Phase 1: Always available\n    result.Recommendations = computeRecommendations()\n    result.TopPick = result.Recommendations[0]\n    result.ProjectHealth.Counts = computeCounts()\n    result.ProjectHealth.Graph = computeGraphHealth()\n    result.QuickWins = findQuickWins()\n    result.BlockersToClear = findBlockers()\n    \n    // Phase 2: If agent swarm available\n    if agentSwarmEnabled() {\n        result.YourSession = getSessionContext(agentName)\n        result.Team = getTeamStatus()\n    }\n    \n    // Phase 2: If alerts available  \n    if alertsEnabled() {\n        result.Alerts = getAlerts()\n    }\n    \n    // Phase 2: If labels view available\n    if labelsEnabled() {\n        result.ProjectHealth.LabelsAttention = getLabelHealth()\n    }\n    \n    // Phase 3: If history available\n    if historyEnabled() {\n        result.HistoryHints = getHistoryHints()\n    }\n    \n    // Phase 3: If suggestions available\n    if suggestionsEnabled() {\n        result.Suggestions = getSuggestions()\n    }\n    \n    result.QuickRef = buildQuickRef(result)\n    result.Commands = buildCommands(result)\n    \n    return result\n}\n```\n\n## Usage\n\n```bash\nbv --robot-triage                    # Full output (whatever is available)\nbv --robot-triage --compact          # Minimal: quick_ref + top_pick + alerts\nbv --robot-triage --agent=claude-1   # Include agent-specific context\n```\n\n## Companion Command\n\n`bv --robot-next` - Returns ONLY top_pick (~10 lines). Same incremental approach.","status":"closed","priority":1,"type":"task","labels":["cli","triage"],"created_at":"2025-12-15 16:03","updated_at":"2025-12-15 17:06","closed_at":"2025-12-15 17:06","blocked_by":["bv-133","bv-147","bv-148"],"blocks":["bv-150","bv-151"],"pagerank":0.0025223171141691425,"betweenness":10,"eigenvector":0,"hub":0.005683595580519917,"authority":0.001903921334552521,"critical_path":2,"in_degree":2,"out_degree":3,"core_number":3,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-150","title":"Implement --robot-next command","description":"# --robot-next: The One-Answer Command\n\n**For when you just need ONE thing to work on. No context, no analysis, just an answer.**\n\n## Usage\n```bash\nbv --robot-next                    # What should I do next?\nbv --robot-next --skip=bv-42       # Skip specific bead\nbv --robot-next --agent=claude-1   # Respect agent claims\n```\n\n## Output (Minimal by Design)\n\n```json\n{\n  \"next\": {\n    \"bead_id\": \"bv-43\",\n    \"title\": \"Implement auth middleware\",\n    \"score\": 94.2,\n    \"why\": \"Unblocks 5 items, label needs attention\",\n    \"claim\": \"bv --robot-claim bv-43\"\n  },\n  \"alerts\": 2,\n  \"your_claims\": 1\n}\n```\n\nThat's it. ~10 lines of JSON.\n\n## When to Use\n\n| Scenario | Use |\n|----------|-----|\n| Starting fresh session | `--robot-triage` (full context) |\n| Mid-session, need quick direction | `--robot-next` |\n| Polling frequently | `--robot-next` |\n| First time on project | `--robot-triage` |\n| Debugging/investigating | `--robot-triage` |\n\n## Behavior\n\n1. Computes full triage internally (same as --robot-triage)\n2. Returns ONLY the top_pick + minimal metadata\n3. Respects agent claims (excludes items claimed by others)\n4. Excludes your own claims (you already have work)\n5. Applies --skip filters\n\n## Edge Cases\n\n**No work available:**\n```json\n{\n  \"next\": null,\n  \"reason\": \"all_claimed\",\n  \"suggestion\": \"Wait for claims to release or help with bv-42 (claimed by cursor-agent)\"\n}\n```\n\n**Critical alerts pending:**\n```json\n{\n  \"next\": {\n    \"bead_id\": \"bv-43\",\n    \"title\": \"Implement auth middleware\",\n    \"claim\": \"bv --robot-claim bv-43\"\n  },\n  \"alerts\": 1,\n  \"alert_preview\": \"CRITICAL: Dependency cycle detected\",\n  \"suggestion\": \"Run bv --robot-triage to see full alert details\"\n}\n```\n\n## Implementation\n\nInternally calls the same triage computation as --robot-triage, then:\n```go\nfunc RobotNext(agentName string, skip []string) NextResult {\n    full := ComputeTriage(agentName)\n    \n    if len(full.Alerts.Critical) \u003e 0 {\n        return NextResult{\n            Next: full.TopPick,\n            Alerts: len(full.Alerts.Critical) + len(full.Alerts.Warning),\n            AlertPreview: full.Alerts.Critical[0].Message,\n            Suggestion: \"Run bv --robot-triage to see full alert details\",\n        }\n    }\n    \n    return NextResult{\n        Next: full.TopPick,\n        Alerts: len(full.Alerts.Warning),\n        YourClaims: len(full.YourSession.Claims),\n    }\n}\n```\n\n## Relationship to --robot-triage\n\n```\n--robot-triage  = Full meal (everything you need)\n--robot-next    = Snack (just the answer)\n```\n\nBoth compute the same underlying triage. --robot-next just returns less.","status":"closed","priority":1,"type":"task","labels":["cli","triage"],"created_at":"2025-12-15 16:03","updated_at":"2025-12-15 17:06","closed_at":"2025-12-15 17:06","blocked_by":["bv-133","bv-149","bv-140"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.0058578799181697285,"authority":0,"critical_path":1,"in_degree":0,"out_degree":3,"core_number":3,"slack":10,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-151","title":"Add triage insights to TUI","description":"Show triage score and top reason in list view. Add triage panel to detail view. Highlight quick wins and blockers. Keybinding 't' to sort by triage score.","status":"closed","priority":2,"type":"task","labels":["triage","tui"],"created_at":"2025-12-15 16:03","updated_at":"2025-12-16 01:03","closed_at":"2025-12-16 01:03","blocked_by":["bv-133","bv-149"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.005688466978513165,"authority":0,"critical_path":1,"in_degree":0,"out_degree":2,"core_number":2,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-152","title":"Coverage set recommendations","description":"Robot output for a small coverage set (vertex-cover-ish): greedy 2-approx to choose a minimal bead set that touches all dependency edges or all clusters. Guardrails: run on SCC-condensed graph, timeout-capped, deterministic tie-breaks. Output: sets[] entry with kind='coverage_set', members, coverage %, rationale, data_hash/config. Default cap size=5; optional size cap flag. Include one-line 'when to use' hint (breadth coverage) to avoid agent confusion.","status":"closed","priority":2,"type":"task","labels":["ai-agent,advanced-insights"],"created_at":"2025-12-15 16:03","updated_at":"2025-12-15 23:03","closed_at":"2025-12-15 23:03","blocked_by":["bv-85"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":7.250554815431066e-9,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-153","title":"K-shortest critical paths","description":"Expose top M longest/most-constraining paths (DAG or SCC-condensed). Guardrails: cap M=3 default and path_len\u003c=40; deterministic ordering; respect timeouts. Output paths[] with length, members, slack (if available), data_hash/config, status. Integrate into advanced_insights with kind='k_paths' and a one-line guidance so agents know it's alternative critical chains.","status":"closed","priority":2,"type":"task","labels":["ai-agent,advanced-insights"],"created_at":"2025-12-15 16:03","updated_at":"2025-12-16 01:49","closed_at":"2025-12-16 01:49","blocked_by":["bv-85"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":7.250554815431066e-9,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-154","title":"Max-parallel cut suggestions","description":"Compute min-cut-inspired suggestions on the SCC-condensed DAG to maximize ready-set width: propose edges (or nodes) whose completion/removal most increases parallelizable items. Guardrails: run on condensed graph; bounded runtime; deterministic tie-breaks; emit only if projected ready gain \u003e 0; cap to top 3. Output cuts[] with kind='parallel_cut', gain, members, data_hash/config. Include one-line 'use to widen parallel work' hint.","status":"closed","priority":2,"type":"task","labels":["ai-agent,advanced-insights"],"created_at":"2025-12-15 16:04","updated_at":"2025-12-16 01:58","closed_at":"2025-12-16 01:58","blocked_by":["bv-85"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":7.250554815431066e-9,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-155","title":"Define Sprint and Forecast data types","description":"Types: Sprint (id, name, start_date, end_date, bead_ids[], velocity_target), Forecast (bead_id, eta_date, confidence, factors[]), BurndownPoint (date, remaining, completed). Store sprints in .beads/sprints.jsonl.","status":"closed","priority":2,"type":"task","labels":["forecast","types"],"created_at":"2025-12-15 16:04","updated_at":"2025-12-16 12:41","closed_at":"2025-12-16 12:41","blocks":["bv-156","bv-157"],"pagerank":0.0070126243005747815,"betweenness":0,"eigenvector":0,"hub":0,"authority":0.002590902354844869,"critical_path":4,"in_degree":2,"out_degree":0,"core_number":1,"slack":11,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-156","title":"Implement sprint CRUD operations","description":"Commands: bd sprint create, bd sprint add \u003cbead\u003e, bd sprint remove \u003cbead\u003e, bd sprint list, bd sprint show \u003cid\u003e. TUI sprint assignment in bead detail.","status":"closed","priority":2,"type":"task","labels":["forecast","sprints"],"created_at":"2025-12-15 16:04","updated_at":"2025-12-16 12:50","closed_at":"2025-12-16 12:50","blocked_by":["bv-155"],"blocks":["bv-159","bv-161"],"pagerank":0.00398649154786206,"betweenness":2,"eigenvector":0,"hub":0.0004272234476238852,"authority":3.920237383997754e-17,"critical_path":2,"in_degree":2,"out_degree":1,"core_number":1,"slack":12,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-157","title":"Implement ETA estimation algorithm","description":"ETA = complexity / (velocity * agents). Complexity from: dependency depth, description length, type weights. Velocity from label history. Output includes confidence interval.","status":"closed","priority":2,"type":"task","labels":["eta","forecast"],"created_at":"2025-12-15 16:04","updated_at":"2025-12-16 13:00","closed_at":"2025-12-16 13:00","blocked_by":["bv-155","bv-102"],"blocks":["bv-158","bv-160"],"pagerank":0.005053246752337241,"betweenness":12,"eigenvector":0,"hub":0.015285342924424598,"authority":3.920237383997754e-17,"critical_path":3,"in_degree":2,"out_degree":2,"core_number":1,"slack":9,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-158","title":"Implement --robot-forecast command","description":"Per-bead forecasts: --robot-forecast \u003cid\u003e. Per-label: --robot-forecast --label=X. Per-sprint: --robot-forecast --sprint=Y. Returns ETA, confidence, blockers that could delay.","status":"closed","priority":2,"type":"task","labels":["cli","forecast"],"created_at":"2025-12-15 16:04","updated_at":"2025-12-16 12:58","closed_at":"2025-12-16 12:58","blocked_by":["bv-157"],"blocks":["bv-40bw"],"pagerank":0.002731484890410988,"betweenness":5,"eigenvector":0,"hub":6.464224047516608e-18,"authority":4.7854460253878835e-21,"critical_path":2,"in_degree":1,"out_degree":1,"core_number":1,"slack":9,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-159","title":"Implement --robot-burndown command","description":"Burndown data for current or specified sprint. Returns: daily remaining/completed counts, ideal line, projected completion date, scope change events.","status":"closed","priority":2,"type":"task","labels":["burndown","forecast"],"created_at":"2025-12-15 16:04","updated_at":"2025-12-17 04:00","closed_at":"2025-12-17 04:00","blocked_by":["bv-156"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":6.464224047516608e-18,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-160","title":"Implement capacity simulation","description":"--robot-capacity --agents=N projects completion dates given N parallel agents. Shows: total work remaining, parallelizable percentage, estimated completion, bottleneck analysis.","status":"closed","priority":2,"type":"task","labels":["capacity","forecast"],"created_at":"2025-12-15 16:04","updated_at":"2025-12-16 13:03","closed_at":"2025-12-16 13:03","blocked_by":["bv-157"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":6.464224047516608e-18,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-161","title":"Add sprint view to TUI","description":"Sprint dashboard showing: progress bar, burndown mini-chart, days remaining, at-risk items. Keybinding 'S' for sprint view. Filter main list by sprint.","status":"closed","priority":2,"type":"task","labels":["forecast","tui"],"created_at":"2025-12-15 16:04","updated_at":"2025-12-16 14:24","closed_at":"2025-12-16 14:24","blocked_by":["bv-156"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":6.464224047516608e-18,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-162","title":"Define Alert types and severity levels","description":"**CONSOLIDATE WITH EXISTING DRIFT ALERTS**\n\n## What Already Exists (pkg/drift/drift.go)\n```go\ntype Alert struct {\n    Type     AlertType `json:\"type\"`\n    Severity Severity  `json:\"severity\"`\n    Message  string    `json:\"message\"`\n    Details  string    `json:\"details\"`\n}\n\ntype AlertType string  // cycle_introduced, density_change, blocked_ratio, pagerank_drift\ntype Severity string   // critical, warning, info\n```\n\n## What This Adds (EXTEND existing types)\nAdd new AlertType values for proactive alerts:\n- stale_issue: Individual issue has been inactive too long\n- velocity_drop: Label velocity decreased significantly\n- blocking_cascade: Issue blocks many downstream items (opportunity)\n- high_impact_unblock: Completing this unblocks high-value work\n- abandoned_claim: Agent claim expired without completion\n- potential_duplicate: Two issues appear similar (when semantic search available)\n\nREMOVE cycle_risk - already covered by cycle_introduced\n\n## Implementation Approach\n1. REUSE: pkg/drift/drift.go Alert and Severity types\n2. ADD: New AlertType constants to existing enum\n3. ADD: Optional fields to Alert struct:\n   - IssueID string (for issue-specific alerts)\n   - Label string (for label-specific alerts)\n   - DetectedAt time.Time\n\n## Key Principle\nONE alert system, not two parallel systems. Drift alerts and proactive alerts share infrastructure.\n\n## Extended Alert Struct\n```go\ntype Alert struct {\n    Type      AlertType `json:\"type\"`\n    Severity  Severity  `json:\"severity\"`\n    Message   string    `json:\"message\"`\n    Details   string    `json:\"details,omitempty\"`\n    // New fields for proactive alerts:\n    IssueID   string    `json:\"issue_id,omitempty\"`\n    Label     string    `json:\"label,omitempty\"`\n    DetectedAt time.Time `json:\"detected_at\"`\n}\n```","notes":"Extended AlertType enum with proactive variants + added issue/label/detected_at fields and timestamped drift alerts; groundwork for proactive engine","status":"closed","priority":2,"type":"task","labels":["alerts","types"],"created_at":"2025-12-15 16:04","updated_at":"2025-12-15 22:32","closed_at":"2025-12-15 22:32","blocked_by":["bv-135"],"blocks":["bv-163","bv-164","bv-165"],"pagerank":0.003247769481497382,"betweenness":0,"eigenvector":0,"hub":0.006129853038511555,"authority":0.03301345397825437,"critical_path":4,"in_degree":3,"out_degree":1,"core_number":3,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-163","title":"Implement staleness detection","description":"INCREMENTAL ENHANCEMENT on existing staleness calculation\n\n## What Already Exists (DO NOT DUPLICATE)\n- `pkg/analysis/priority.go:computeStaleness()` - returns 0-1 score\n- Already normalizes to 30 days (items \u003e30 days = 1.0 staleness)\n- Already included in ImpactScore breakdown as StalenessNorm\n\n## What This Adds (NEW VALUE)\nALERT GENERATION with configurable thresholds:\n1. Configurable threshold (default: 14 days for warning, 30 days for critical)\n2. Alert struct with severity levels: info, warning, critical\n3. Status-aware staleness (in_progress items stale after 7 days is worse than open items)\n4. Per-label staleness tracking (alert if entire label is stale)\n\n## Implementation Approach\n1. REUSE: `computeStaleness()` for base calculation\n2. ADD: StalenessAlert struct { Type, Severity, IssueID, DaysSinceUpdate, Message }\n3. ADD: CheckStaleness(thresholds) that generates alerts\n4. ADD: Status multiplier (in_progress has lower threshold than open)\n\n## Configuration (in .beads/config.yaml)\n```yaml\nalerts:\n  staleness:\n    warning_days: 14\n    critical_days: 30\n    in_progress_multiplier: 0.5  # in_progress warns at 7 days\n```\n\n## Output Format Example\n```json\n{\n  \"staleness_alerts\": [\n    {\n      \"type\": \"stale_issue\",\n      \"severity\": \"warning\",\n      \"issue_id\": \"bv-29\",\n      \"days_inactive\": 18,\n      \"status\": \"in_progress\",\n      \"message\": \"Issue in_progress for 18 days with no commits - may be stuck\"\n    }\n  ]\n}\n```\n\n## Key Principle\nCalculation exists; this adds THRESHOLD CHECKING and ALERT EMISSION.","notes":"Implemented staleness alerts: config thresholds, in-progress multiplier, detected_at; added drift tests and default backfill.","status":"closed","priority":2,"type":"task","labels":["alerts","staleness"],"created_at":"2025-12-15 16:04","updated_at":"2025-12-15 22:42","closed_at":"2025-12-15 22:42","blocked_by":["bv-135","bv-162","bv-62"],"blocks":["bv-166"],"pagerank":0.0019235742978820811,"betweenness":2.6666666666666665,"eigenvector":0,"hub":0.011897043209133438,"authority":0.0011005466962949934,"critical_path":3,"in_degree":1,"out_degree":3,"core_number":3,"slack":10,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-164","title":"Implement velocity anomaly detection","description":"Detect label velocity drops \u003e threshold (default 30%). Compare current week to rolling average. Also detect sudden spikes (might indicate bulk closes). Uses labels view velocity data.","notes":"Implemented velocity/blocking cascade alerts: config thresholds, cascade detection via computeUnblocks; added tests","status":"closed","priority":2,"type":"task","labels":["alerts","velocity"],"created_at":"2025-12-15 16:04","updated_at":"2025-12-15 22:44","closed_at":"2025-12-15 22:44","blocked_by":["bv-135","bv-162","bv-102","bv-99"],"blocks":["bv-166"],"pagerank":0.0019235742978820811,"betweenness":6.666666666666667,"eigenvector":0,"hub":0.17673998049119058,"authority":0.0011005466962949934,"critical_path":3,"in_degree":1,"out_degree":4,"core_number":3,"slack":9,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-165","title":"Implement blocking cascade alerts","description":"INCREMENTAL ENHANCEMENT on existing unblock calculation\n\n## What Already Exists (DO NOT DUPLICATE)\n- `pkg/analysis/plan.go:computeUnblocks()` - finds issues unblocked by completing an item\n- `pkg/analysis/priority.go:unblocksMap` - tracks unblock counts per issue\n- `pkg/analysis/plan.go:PlanSummary.HighestImpact` - already identifies highest-impact item\n\n## What This Adds (NEW VALUE)\nALERT GENERATION when unblock count exceeds threshold:\n1. Configurable threshold (default: 5 downstream items)\n2. High-impact opportunity alerts: \"Completing bv-42 unblocks 8 items\"\n3. Cascade visualization: list all items that would be unblocked\n4. Urgency scoring based on downstream priority sum\n\n## Implementation Approach\n1. REUSE: `computeUnblocks()` for base calculation\n2. REUSE: `GetExecutionPlan().Summary.HighestImpact` for top impact\n3. ADD: BlockingCascadeAlert struct { Type, Severity, IssueID, UnblocksCount, UnblocksIDs, Message }\n4. ADD: CheckBlockingCascades(threshold) that generates alerts\n\n## Configuration (in .beads/config.yaml)\n```yaml\nalerts:\n  blocking_cascade:\n    info_threshold: 3    # info alert if blocks 3+ items\n    warning_threshold: 5 # warning alert if blocks 5+ items\n```\n\n## Output Format Example\n```json\n{\n  \"cascade_alerts\": [\n    {\n      \"type\": \"blocking_cascade\",\n      \"severity\": \"info\",\n      \"issue_id\": \"bv-31\",\n      \"unblocks_count\": 8,\n      \"unblocks_ids\": [\"bv-42\", \"bv-43\", \"bv-51\", \"bv-52\", \"bv-53\", \"bv-54\", \"bv-55\", \"bv-56\"],\n      \"downstream_priority_sum\": 12,\n      \"message\": \"High-impact opportunity: completing bv-31 unblocks 8 downstream issues\"\n    }\n  ]\n}\n```\n\n## Key Principle\nCalculation exists; this adds THRESHOLD CHECKING and OPPORTUNITY ALERTS.","status":"closed","priority":2,"type":"task","labels":["alerts","blocking"],"created_at":"2025-12-15 16:04","updated_at":"2025-12-16 01:49","closed_at":"2025-12-16 01:49","blocked_by":["bv-135","bv-162"],"blocks":["bv-166"],"pagerank":0.0019235742978820811,"betweenness":0.6666666666666666,"eigenvector":0,"hub":0.011573563257921499,"authority":0.0011005466962949934,"critical_path":3,"in_degree":1,"out_degree":2,"core_number":3,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-166","title":"Implement --robot-alerts command","description":"Returns all current alerts. Filters: --severity=warning, --type=stale, --label=backend. Include alert count summary. Sorted by severity then recency.","notes":"Added --robot-alerts CLI: emits drift+proactive alerts with severity/type/label filters; uses current analysis, data_hash; config-driven thresholds.","status":"closed","priority":2,"type":"task","labels":["alerts","cli"],"created_at":"2025-12-15 16:04","updated_at":"2025-12-15 22:46","closed_at":"2025-12-15 22:46","blocked_by":["bv-135","bv-163","bv-164","bv-165"],"blocks":["bv-168"],"pagerank":0.0021039815616854516,"betweenness":8,"eigenvector":0,"hub":0.006674272653148529,"authority":0.0010390260047317536,"critical_path":2,"in_degree":1,"out_degree":4,"core_number":3,"slack":9,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-167","title":"Add alert configuration to config.yaml","description":"Configurable thresholds: stale_threshold_days, velocity_drop_threshold, blocking_cascade_threshold, duplicate_similarity. Per-label overrides. Enable/disable alert types.","status":"closed","priority":2,"type":"task","labels":["alerts","config"],"created_at":"2025-12-15 16:04","updated_at":"2025-12-16 02:18","closed_at":"2025-12-16 02:18","blocked_by":["bv-135"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.006129853038511555,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":13,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-168","title":"Add alerts panel to TUI","description":"Alert indicator in status bar (count by severity). Alerts panel showing active alerts. Jump to affected bead from alert. Dismiss/snooze alerts.","status":"closed","priority":2,"type":"task","labels":["alerts","tui"],"created_at":"2025-12-15 16:04","updated_at":"2025-12-16 02:11","closed_at":"2025-12-16 02:11","blocked_by":["bv-135","bv-166"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.006301181869597106,"authority":0,"critical_path":1,"in_degree":0,"out_degree":2,"core_number":2,"slack":9,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-169","title":"Implement DOT format graph export","description":"Export dependency graph as Graphviz DOT format. Node attributes: shape by type, color by status, size by PageRank. Edge attributes: style by dependency type. Subgraph clustering by label.","status":"closed","priority":2,"type":"task","labels":["dot","graph"],"created_at":"2025-12-15 16:05","updated_at":"2025-12-16 10:33","closed_at":"2025-12-16 10:33","blocked_by":["bv-136","bv-174"],"blocks":["bv-172"],"pagerank":0.0017902298973226836,"betweenness":0.6666666666666666,"eigenvector":0,"hub":1.8935952365508735e-7,"authority":3.336577428298788e-8,"critical_path":2,"in_degree":1,"out_degree":2,"core_number":3,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-170","title":"Implement Mermaid format graph export","description":"Export as Mermaid diagram syntax for markdown embedding. Flowchart LR layout. Status-based styling. Good for README/docs embedding.","status":"closed","priority":2,"type":"task","labels":["graph","mermaid"],"created_at":"2025-12-15 16:05","updated_at":"2025-12-15 16:10","closed_at":"2025-12-15 16:10","blocked_by":["bv-136","bv-174"],"blocks":["bv-172"],"pagerank":0.0017902298973226836,"betweenness":0.6666666666666666,"eigenvector":0,"hub":1.8935952365508735e-7,"authority":3.336577428298788e-8,"critical_path":2,"in_degree":1,"out_degree":2,"core_number":3,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-171","title":"Implement ASCII art graph visualization","description":"Text-based tree visualization for terminal. Shows dependency chains with box-drawing characters. Legend for status symbols. Respects terminal width. Truncates deep trees with +N more indicator.","status":"closed","priority":2,"type":"task","labels":["ascii","graph"],"created_at":"2025-12-15 16:05","updated_at":"2025-12-15 16:10","closed_at":"2025-12-15 16:10","blocked_by":["bv-136","bv-174"],"blocks":["bv-172","bv-173"],"pagerank":0.00241773322604822,"betweenness":2.6666666666666665,"eigenvector":0,"hub":1.8935952365508735e-7,"authority":6.465357306083276e-8,"critical_path":2,"in_degree":2,"out_degree":2,"core_number":3,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-172","title":"Implement --robot-graph command","description":"Main command: --robot-graph [--format=dot|mermaid|ascii|json]. Filters: --label=X, --root=bv-42, --depth=N, --status=open. Highlight options: --highlight=critical-path|blockers.","status":"closed","priority":2,"type":"task","labels":["cli","graph"],"created_at":"2025-12-15 16:05","updated_at":"2025-12-16 10:33","closed_at":"2025-12-16 10:33","blocked_by":["bv-136","bv-169","bv-170","bv-171"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":1.9505952215211424e-7,"authority":0,"critical_path":1,"in_degree":0,"out_degree":4,"core_number":3,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-173","title":"Add graph explorer view to TUI","description":"Interactive ASCII graph in TUI. Navigate with hjkl. Enter to jump to bead detail. Expand/collapse nodes. Filter by label. Highlight critical path. Keybinding 'G' for graph view.","status":"closed","priority":2,"type":"task","labels":["graph","tui"],"created_at":"2025-12-15 16:05","updated_at":"2025-12-15 16:10","closed_at":"2025-12-15 16:10","blocked_by":["bv-136","bv-171"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":1.8405591092364558e-7,"authority":0,"critical_path":1,"in_degree":0,"out_degree":2,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-174","title":"Implement subgraph extraction for visualization","description":"Extract connected subgraph from root node to specified depth. Handle cycles gracefully (mark as visited). Support multiple roots. Used by all graph formats.","status":"closed","priority":2,"type":"task","labels":["extraction","graph"],"created_at":"2025-12-15 16:05","updated_at":"2025-12-16 10:51","closed_at":"2025-12-16 10:51","blocked_by":["bv-136","bv-53"],"blocks":["bv-169","bv-170","bv-171"],"pagerank":0.004025710221933512,"betweenness":5,"eigenvector":0,"hub":0.000005390929560855526,"authority":9.681740393552529e-8,"critical_path":3,"in_degree":3,"out_degree":2,"core_number":3,"slack":11,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-175","title":"Define Suggestion types and confidence model","description":"Types: Suggestion (type, target_bead, suggestion, confidence, reason). Types: missing_dependency, potential_duplicate, label_suggestion, stale_cleanup, cycle_warning. Confidence 0.0-1.0 based on signal strength.","status":"closed","priority":3,"type":"task","labels":["suggestions","types"],"created_at":"2025-12-15 16:05","updated_at":"2025-12-16 16:46","closed_at":"2025-12-16 16:46","blocks":["bv-176","bv-177","bv-178","bv-179"],"pagerank":0.004168467346594449,"betweenness":0,"eigenvector":0,"hub":0,"authority":7.280957519124061e-9,"critical_path":3,"in_degree":4,"out_degree":0,"core_number":3,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-176","title":"Implement keyword-based dependency suggestions","description":"Analyze title/description for keywords matching other beads. 'mentions auth' + bead about 'auth system' = suggest dependency. Weight by: exact match, partial match, label overlap.","status":"closed","priority":3,"type":"task","labels":["dependencies","suggestions"],"created_at":"2025-12-15 16:05","updated_at":"2025-12-16 16:53","closed_at":"2025-12-16 16:53","blocked_by":["bv-137","bv-175"],"blocks":["bv-180"],"pagerank":0.00172747956445013,"betweenness":0.25,"eigenvector":0,"hub":2.6856671430782294e-9,"authority":1.7253495396473242e-9,"critical_path":2,"in_degree":1,"out_degree":2,"core_number":3,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-177","title":"Implement duplicate detection (keyword-based)","description":"Jaccard similarity on title words + description keywords. Threshold default 0.7. Exclude closed vs open pairs. Falls back when semantic search unavailable. Integrates with bv-9gf when available.","status":"closed","priority":3,"type":"task","labels":["duplicates","suggestions"],"created_at":"2025-12-15 16:05","updated_at":"2025-12-16 16:48","closed_at":"2025-12-16 16:48","blocked_by":["bv-137","bv-175","bv-9gf"],"blocks":["bv-180"],"pagerank":0.00172747956445013,"betweenness":1.25,"eigenvector":0,"hub":3.0123903658533345e-9,"authority":1.7253495396473242e-9,"critical_path":2,"in_degree":1,"out_degree":3,"core_number":3,"slack":12,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-178","title":"Implement label auto-suggestion","description":"Suggest labels based on title/description keywords. 'database migration' suggests 'database' label. Learn from existing labeled beads. Configurable keyword-to-label mappings.","status":"closed","priority":3,"type":"task","labels":["labels","suggestions"],"created_at":"2025-12-15 16:05","updated_at":"2025-12-16 16:54","closed_at":"2025-12-16 16:54","blocked_by":["bv-137","bv-175"],"blocks":["bv-180"],"pagerank":0.00172747956445013,"betweenness":0.25,"eigenvector":0,"hub":2.6856671430782294e-9,"authority":1.7253495396473242e-9,"critical_path":2,"in_degree":1,"out_degree":2,"core_number":3,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-179","title":"Implement cycle prevention warnings","description":"When adding dependency via bd dep add, check if it would create cycle. Warn with cycle path. --force to override. Also surface in --robot-suggest for existing near-cycles.","status":"closed","priority":3,"type":"task","labels":["cycles","suggestions"],"created_at":"2025-12-15 16:05","updated_at":"2025-12-16 16:50","closed_at":"2025-12-16 16:50","blocked_by":["bv-137","bv-175"],"blocks":["bv-180"],"pagerank":0.00172747956445013,"betweenness":0.25,"eigenvector":0,"hub":2.6856671430782294e-9,"authority":1.7253495396473242e-9,"critical_path":2,"in_degree":1,"out_degree":2,"core_number":3,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-180","title":"Implement --robot-suggest command","description":"Returns suggestions for project or specific bead. Filters: --type=dependency|duplicate|label, --confidence=0.8 (minimum). Sorted by confidence. Includes apply commands.","status":"closed","priority":3,"type":"task","labels":["cli","suggestions"],"created_at":"2025-12-15 16:05","updated_at":"2025-12-16 16:55","closed_at":"2025-12-16 16:55","blocked_by":["bv-137","bv-176","bv-177","bv-178","bv-179"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":2.6230801998526945e-9,"authority":0,"critical_path":1,"in_degree":0,"out_degree":5,"core_number":3,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-181","title":"Advanced insights integration guardrail","description":"Define one canonical 'advanced_insights' section in robot JSON and matching TUI panels. Include: list of features (topk_set, coverage_set, k_paths, parallel_cut, parallel_gain, cycle_break), per-feature fields, status, limits, and usage text. Add default caps (e.g., topk\u003c=5, paths\u003c=5, path_len\u003c=50, coverage_set\u003c=5) and deterministic ordering. Add help/README entries and inline footers in outputs. Run duplication audit vs closed/legacy features before enabling any advanced feature; block release if overlap found.","notes":"Fixed go vet issues: added parseTimeRef helper, moved data_hash earlier; correlation extractor now uses --follow safely by narrowing to primary beads file; deterministic tie-breaks retained; go vet and go test ./... clean.","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-15 16:12","updated_at":"2025-12-15 21:42","closed_at":"2025-12-15 21:42","blocked_by":["bv-84","bv-58"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.0000025785990931680045,"authority":0,"critical_path":1,"in_degree":0,"out_degree":2,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-182","title":"Auto-update mechanism with user confirmation","description":"Implement true auto-update for bv binary\n\n## Current State\n- Version check exists (notifies user when new version available)\n- User must manually download and install\n\n## Desired Behavior\n\n### Interactive Mode\n```\n$ bv\nNew version available: v0.12.0 (current: v0.11.3)\nUpdate now? [Y/n]: y\nDownloading v0.12.0... done\nReplacing binary... done  \nRestarting... \n```\n\n### Auto-Update Mode (opt-in)\n```yaml\n# .beads/config.yaml or ~/.config/bv/config.yaml\nauto_update: true\nauto_update_channel: stable  # stable | beta | nightly\n```\n\nWhen enabled, updates happen silently on startup (with brief notification).\n\n### CLI Flags\n```bash\nbv --update              # Update now (interactive)\nbv --update --yes        # Update now (non-interactive)\nbv --check-update        # Just check, dont update\nbv --set-auto-update     # Enable auto-updates\n```\n\n## Implementation Approach\n\n1. **Download mechanism**\n   - Fetch release info from GitHub API\n   - Download appropriate binary for OS/arch\n   - Verify checksum (SHA256)\n   \n2. **Safe replacement**\n   - Download to temp location first\n   - Verify binary runs (`bv --version`)\n   - Atomic rename to replace current binary\n   - Handle permission issues gracefully\n\n3. **Rollback capability**\n   - Keep previous version as `bv.backup`\n   - `bv --rollback` to restore if issues\n\n4. **Platform considerations**\n   - Linux/macOS: Direct binary replacement\n   - Windows: May need wrapper script for in-use binary\n   - Homebrew users: Warn that brew manages updates\n\n## Security Considerations\n- Always verify checksums\n- Download only from official GitHub releases\n- Consider code signing for binaries\n- Warn if running as root\n\n## Edge Cases\n- No internet connection: Skip gracefully\n- Rate limited by GitHub API: Cache check results\n- Binary in read-only location: Prompt for sudo or suggest manual update\n- Running in CI: Never auto-update, just notify","status":"closed","priority":2,"type":"feature","labels":null,"created_at":"2025-12-15 16:43","updated_at":"2025-12-16 10:57","closed_at":"2025-12-16 10:57","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-183","title":"Testing completeness push","description":"Epic to tighten coverage across unit (no mocks where avoidable) and e2e integration with detailed logging for robot/TUI paths.","status":"closed","priority":1,"type":"epic","labels":null,"created_at":"2025-12-15 18:02","updated_at":"2025-12-15 23:11","closed_at":"2025-12-15 23:11","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-184","title":"Unit tests: analysis status \u0026 metric maps (no mocks)","description":"Add coverage for MetricStatus capture and full_stats map limits in robot-insights flow using real analyzer data (small graphs). Assert status states (computed/timeout/skip) and map caps obey env/defaults. Avoid mocks; use real Analyzer.","notes":"Unit tests for metric status/full_stats cap using real analyzer (no mocks).","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-15 18:02","updated_at":"2025-12-15 19:17","closed_at":"2025-12-16 00:15","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-185","title":"Unit tests: robot plan/priority metadata","description":"Add tests that robot plan/priority outputs include data_hash, analysis_config, MetricStatus; verify hashes stable after recipe filters; use real issues, no mocks.","notes":"Added unit test (builds real binary) ensuring robot plan/priority outputs include data_hash, analysis_config, status. Fixed joinStrings redecl clash by relying on diff.go helper. go test ./... clean.","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-15 18:02","updated_at":"2025-12-15 19:06","closed_at":"2025-12-15 19:04","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-186","title":"Unit tests: correlation path hints and explicit matcher ordering","description":"Strengthen correlation tests: path hint extraction (include 'tests'), ExtractIDsFromMessage ordering/stability, --follow primary file handling. Avoid mocks; build temporary repos where needed.","notes":"Added correlation tests: path hints include 'tests'; ExtractIDsFromMessage ordering stable for mixed formats. go test ./... clean.","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-15 18:02","updated_at":"2025-12-15 19:15","closed_at":"2025-12-15 19:12","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-187","title":"Integration tests: robot diff/insights/plan/priority end-to-end","description":"Add e2e scripts (bash + fixtures) that run robot-diff/insights/plan/priority against sample repo and assert JSON schemas, status flags, hashes. Capture logs for debugging.","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-15 18:02","updated_at":"2025-12-15 20:09","closed_at":"2025-12-15 20:09","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-188","title":"Integration tests: robot-history + git correlation","description":"End-to-end test that runs --robot-history and correlation extractor on a temp git repo with beads changes; asserts events, path hints, and rename handling (--follow primary file). Produce structured logs.","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-15 18:02","updated_at":"2025-12-15 23:11","closed_at":"2025-12-15 23:11","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-189","title":"Integration tests: TUI snapshots with insights/priority","description":"Add scripted TUI runs (using expect or term recorder) to render insights/priority panels and verify no panics plus stable footer/hints. Capture logs/snapshots for debugging.","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-15 18:02","updated_at":"2025-12-15 19:51","closed_at":"2025-12-16 00:38","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-190","title":"Logging harness for e2e scripts","description":"Provide shared logging helpers for e2e bash scripts to timestamp commands, capture stdout/stderr, and emit jq snippets for failures; keep concise and CI-friendly.","status":"closed","priority":3,"type":"task","labels":null,"created_at":"2025-12-15 18:02","updated_at":"2025-12-15 19:25","closed_at":"2025-12-16 00:26","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-1hnb","title":"Port Coverage Set (vertex cover) to Rust WASM","description":"# Port Coverage Set (Vertex Cover)\n\n## Context\nCoverage set finds a minimal set of nodes that \"covers\" all edges - useful for understanding which issues touch the most dependency relationships.\n\n## Go Implementation Reference\n```go\n// generateCoverageSet in advanced_insights.go\n// Greedy 2-approximation vertex cover\n```\n\n## Rust Implementation (advanced/coverage.rs)\n```rust\nuse crate::graph::DiGraph;\n\npub struct CoverageItem {\n    pub node: usize,\n    pub edges_added: usize,\n}\n\npub struct CoverageResult {\n    pub items: Vec\u003cCoverageItem\u003e,\n    pub edges_covered: usize,\n    pub total_edges: usize,\n}\n\n/// Greedy vertex cover - 2-approximation algorithm.\npub fn coverage_set(graph: \u0026DiGraph, limit: usize) -\u003e CoverageResult {\n    let n = graph.node_count();\n    let total_edges = graph.edge_count();\n    \n    // Track covered edges\n    let mut covered = vec![vec![false; n]; n];\n    let mut edges_covered = 0;\n    let mut selected = Vec::new();\n    \n    for _ in 0..limit {\n        // Find node covering most uncovered edges\n        let mut best_node = None;\n        let mut best_count = 0;\n        \n        for v in 0..n {\n            let mut count = 0;\n            // Count uncovered outgoing edges\n            for \u0026w in graph.successors(v) {\n                if !covered[v][w] { count += 1; }\n            }\n            // Count uncovered incoming edges\n            for \u0026u in graph.predecessors(v) {\n                if !covered[u][v] { count += 1; }\n            }\n            \n            if count \u003e best_count {\n                best_count = count;\n                best_node = Some(v);\n            }\n        }\n        \n        match best_node {\n            Some(node) if best_count \u003e 0 =\u003e {\n                // Mark edges as covered\n                for \u0026w in graph.successors(node) {\n                    covered[node][w] = true;\n                }\n                for \u0026u in graph.predecessors(node) {\n                    covered[u][node] = true;\n                }\n                \n                selected.push(CoverageItem {\n                    node,\n                    edges_added: best_count,\n                });\n                edges_covered += best_count;\n            }\n            _ =\u003e break,\n        }\n    }\n    \n    CoverageResult {\n        items: selected,\n        edges_covered,\n        total_edges,\n    }\n}\n```\n\n## Acceptance Criteria\n- [ ] Greedy covers edges efficiently\n- [ ] Returns coverage ratio\n- [ ] Respects limit parameter","notes":"CRITICAL FIX: Replace O(n¬≤) memory vec![vec![false; n]; n] with HashSet\u003c(usize, usize)\u003e. For 1000-node graph, matrix = 1MB vs HashSet = O(E) bytes. Updated implementation:\n\nlet mut covered: HashSet\u003c(usize, usize)\u003e = HashSet::new();\n// Check: if !covered.contains(\u0026(u, v))\n// Mark: covered.insert((u, v));","status":"closed","priority":2,"type":"task","labels":["advanced","phase-3","wasm"],"created_at":"2025-12-15 23:36","updated_at":"2025-12-16 01:30","closed_at":"2025-12-16 01:30","blocked_by":["bv-bxoe"],"blocks":["bv-y7a0"],"pagerank":0.0018889407873369957,"betweenness":0,"eigenvector":0,"hub":0.000008837350028490512,"authority":0.000010677870334373396,"critical_path":4,"in_degree":1,"out_degree":1,"core_number":2,"slack":9,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-1opc","title":"Implement vim-style keyboard navigation and shortcuts","description":"# Vim-Style Keyboard Navigation\n\n## Context\nPower users expect keyboard-driven navigation. Implement vim-style shortcuts for efficient exploration.\n\n## Keybindings\n\n### Graph Navigation\n| Key | Action |\n|-----|--------|\n| j/k | Move to next/prev node (by PageRank order) |\n| h/l | Navigate dependency chain (predecessors/successors) |\n| Enter | Focus/expand selected node |\n| Esc | Deselect, exit focus mode |\n| f | Focus mode (zoom to selection) |\n| 0 | Reset zoom to fit all |\n\n### Filtering\n| Key | Action |\n|-----|--------|\n| / | Open search/filter |\n| :o | Filter to open issues |\n| :c | Filter to closed issues |\n| :b | Filter to blocked issues |\n| :p0-4 | Filter by priority |\n| :l \u003cname\u003e | Filter by label |\n\n### Actions\n| Key | Action |\n|-----|--------|\n| w | What-if mode (click simulates close) |\n| c | Toggle critical path |\n| g | Toggle clustering/galaxy view |\n| m | Toggle mini-map |\n| ? | Show keyboard shortcuts help |\n\n### Implementation\n```javascript\ndocument.addEventListener('keydown', (e) =\u003e {\n    if (e.target.tagName === 'INPUT') return;\n    \n    switch (e.key) {\n        case 'j': selectNextNode(); break;\n        case 'k': selectPrevNode(); break;\n        case 'h': navigateToPredecessor(); break;\n        case 'l': navigateToSuccessor(); break;\n        case 'Enter': focusSelectedNode(); break;\n        case 'Escape': deselectAll(); break;\n        case 'f': toggleFocusMode(); break;\n        case '/': openSearch(); e.preventDefault(); break;\n        case 'w': toggleWhatIfMode(); break;\n        case 'c': toggleCriticalPath(); break;\n        case '?': showShortcutsHelp(); break;\n    }\n});\n```\n\n## Visual Feedback\n- Selected node: thick border, glow effect\n- Navigation shows path taken\n- Mode indicators in status bar\n\n## Acceptance Criteria\n- [ ] All keybindings work\n- [ ] Visual selection feedback\n- [ ] Search modal opens on /\n- [ ] Help modal shows shortcuts\n- [ ] Works across views (graph, table, charts)","status":"closed","priority":2,"type":"task","labels":["accessibility","phase-2","ux","visualization"],"created_at":"2025-12-15 23:57","updated_at":"2025-12-16 11:39","closed_at":"2025-12-16 11:39","blocked_by":["bv-jndd"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":6.571979899005031e-7,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":13,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-21qx","title":"Unit test: graph_cycles.go - Detailed cycle analysis","description":"Create comprehensive unit tests for pkg/analysis/graph_cycles.go\n\n## File Overview\ngraph_cycles.go provides detailed cycle analysis:\n- Enumerate all cycles in the graph\n- Classify cycle types (self-loop, simple, complex)\n- Calculate cycle metrics (length, participants)\n- Find strongly connected components\n\n## Test Cases to Implement\n1. **Cycle Enumeration**\n   - No cycles (DAG) returns empty\n   - Single self-loop\n   - Single simple cycle\n   - Multiple independent cycles\n   - Overlapping cycles (shared nodes)\n\n2. **Cycle Classification**\n   - Self-loop detection\n   - 2-node mutual dependency\n   - Simple cycle (3+ nodes, no shortcuts)\n   - Complex cycle (with internal edges)\n\n3. **SCC Analysis**\n   - Graph with 1 SCC (fully connected)\n   - Graph with multiple SCCs\n   - DAG (each node is own SCC)\n   - Mix of SCCs and DAG portions\n\n4. **Metrics Calculation**\n   - Shortest cycle in graph\n   - Longest cycle in graph\n   - Average cycle length\n   - Node participation count\n\n5. **Performance \u0026 Limits**\n   - Timeout behavior on large cycles\n   - Maximum cycle enumeration limit\n   - Memory usage on pathological graphs\n\n## Implementation Notes\n- Use gonum graph library patterns\n- Test Tarjan's algorithm edge cases\n- Create pathological test cases\n- Benchmark with known complexity","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-16 20:05","updated_at":"2025-12-16 22:00","closed_at":"2025-12-16 22:00","blocks":["bv-3bhq"],"pagerank":0.0016968161178715197,"betweenness":0,"eigenvector":0,"hub":0,"authority":1.0771362149860417e-7,"critical_path":4,"in_degree":1,"out_degree":0,"core_number":1,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-2a4","title":"Time-Travel Graph Diffing","description":"Compare graph structure across git commits to understand how the project evolved and detect structural regressions.\n\n## Background \u0026 Motivation\nSince beads are stored in git, we have full history available. Questions like 'What changed since last week?' or 'Did my changes introduce a bottleneck?' are answerable but not currently exposed.\n\n## Value Proposition\n- For Humans: Visualize progress, understand what changed during a sprint, postmortem analysis\n- For AI Agents: Structural regression detection - validate changes before committing\n\n## Technical Approach\n1. Add git history loader (read files at specific commit)\n2. Create snapshot comparison logic\n3. Generate diff report (new/closed issues, metric changes, new cycles)\n4. CLI: --diff-since \u003ccommit|date\u003e and --as-of \u003ccommit|date\u003e\n5. TUI: Highlight changed items\n\n## Key Features\n- Load historical state without checking out\n- Compare metrics (PageRank, betweenness) between snapshots\n- Detect new cycles or bottlenecks\n- 'What would change if I close these issues?' simulation","status":"closed","priority":1,"type":"epic","labels":["analysis","git-integration","history"],"created_at":"2025-11-26 23:36","updated_at":"2025-11-27 00:52","closed_at":"2025-11-27 00:52","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-2a4.1","title":"Implement git history loader for beads files","description":"Load beads JSONL from specific git commit via 'git show \u003ccommit\u003e:.beads/beads.base.jsonl'. Beads tracks JSONL in git (SQLite is gitignored), so historical states are accessible. Support SHA, branch, tag, date resolution. Cache results for repeated access.","status":"closed","priority":1,"type":"task","labels":["git","loader"],"created_at":"2025-11-26 23:40","updated_at":"2025-11-27 00:38","closed_at":"2025-11-27 00:38","blocks":["bv-2a4.2"],"pagerank":0.0048649952993613495,"betweenness":0,"eigenvector":0,"hub":0,"authority":4.7854460253878835e-21,"critical_path":3,"in_degree":1,"out_degree":0,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-2a4.2","title":"Create snapshot comparison and diff generation","description":"Compare two graph snapshots: NewIssues, ClosedIssues, RemovedIssues, ModifiedIssues, NewCycles, ResolvedCycles, MetricDelta.","status":"closed","priority":1,"type":"task","labels":["analysis","diff"],"created_at":"2025-11-26 23:40","updated_at":"2025-11-27 00:44","closed_at":"2025-11-27 00:44","blocked_by":["bv-2a4.1"],"blocks":["bv-2a4.3","bv-2a4.4"],"pagerank":0.00398649154786206,"betweenness":2,"eigenvector":0,"hub":7.890898495503672e-22,"authority":3.920237383997754e-17,"critical_path":2,"in_degree":2,"out_degree":1,"core_number":1,"slack":12,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-2a4.3","title":"Add --diff-since and --as-of CLI flags","description":"--diff-since \u003ccommit|date\u003e: Show changes since historical point. --as-of \u003ccommit|date\u003e: View state at point in time. --robot-diff for JSON output.","status":"closed","priority":1,"type":"task","labels":["cli","git"],"created_at":"2025-11-26 23:40","updated_at":"2025-11-27 00:46","closed_at":"2025-11-27 00:46","blocked_by":["bv-2a4.2"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":6.464224047516608e-18,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-2a4.4","title":"Add TUI diff highlighting and history mode","description":"'T' enters time-travel mode. üÜï badge on new issues, ‚úÖ on newly closed. Diff summary in footer. Optional side panel.","status":"closed","priority":2,"type":"task","labels":["tui","visualization"],"created_at":"2025-11-26 23:40","updated_at":"2025-11-27 00:51","closed_at":"2025-11-27 00:51","blocked_by":["bv-2a4.2"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":6.464224047516608e-18,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-2ino","title":"E2E: Export incremental updates","description":"Test updating an existing static export.\n\n## Update Scenarios\n1. **Add New Issues**\n   - Add issues to beads.jsonl\n   - Re-run export\n   - Verify new issues appear\n   - Verify existing issues preserved\n\n2. **Close Issues**\n   - Close some issues\n   - Re-run export\n   - Verify status updated\n   - Verify closed section accurate\n\n3. **Modify Dependencies**\n   - Add/remove dependencies\n   - Re-run export\n   - Verify graph updates\n   - Verify metrics recalculated\n\n4. **Delete Issues**\n   - Remove issues from source\n   - Re-run export\n   - Verify removed from output\n   - Verify no orphan references\n\n## Optimization Tests\n- Only changed files regenerated\n- Unchanged assets preserved\n- Incremental search index update\n- Cache utilization\n\n## Implementation\n- Create baseline export\n- Make incremental changes\n- Re-export and diff\n- Verify correctness","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-16 20:09","updated_at":"2025-12-17 00:55","closed_at":"2025-12-17 00:55","blocks":["bv-hdu4"],"pagerank":0.0016726975206033255,"betweenness":0,"eigenvector":0,"hub":0,"authority":3.1573158850443083e-10,"critical_path":3,"in_degree":1,"out_degree":0,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-2nyt","title":"Port Slack Computation to Rust WASM","description":"# Port Slack Computation to Rust WASM\n\n## Context\nSlack measures how much an issue can be delayed without affecting the critical path. Zero slack = on critical path.\n\n## Go Implementation Reference\n```go\n// computeSlack in graph.go\n// Longest-path slack: 0 on critical path\n```\n\n## Rust Implementation (slack.rs)\n```rust\nuse crate::graph::DiGraph;\nuse crate::algorithms::topo::topological_sort;\n\n/// Compute slack for each node.\n/// Slack = (longest path through graph) - (longest path through this node)\npub fn slack(graph: \u0026DiGraph) -\u003e Vec\u003cf64\u003e {\n    let n = graph.node_count();\n    if n == 0 {\n        return Vec::new();\n    }\n    \n    let order = match topological_sort(graph) {\n        Some(o) =\u003e o,\n        None =\u003e return vec![0.0; n],\n    };\n    \n    // Forward pass: longest distance from any start\n    let mut dist_from_start = vec![0; n];\n    for \u0026v in \u0026order {\n        for \u0026u in graph.predecessors(v) {\n            dist_from_start[v] = dist_from_start[v].max(dist_from_start[u] + 1);\n        }\n    }\n    \n    // Backward pass: longest distance to any end\n    let mut dist_to_end = vec![0; n];\n    for \u0026v in order.iter().rev() {\n        for \u0026w in graph.successors(v) {\n            dist_to_end[v] = dist_to_end[v].max(dist_to_end[w] + 1);\n        }\n    }\n    \n    // Longest path in graph\n    let longest = (0..n)\n        .map(|i| dist_from_start[i] + dist_to_end[i])\n        .max()\n        .unwrap_or(0);\n    \n    // Slack = longest - (dist_from_start + dist_to_end)\n    (0..n)\n        .map(|i| (longest - dist_from_start[i] - dist_to_end[i]) as f64)\n        .collect()\n}\n```\n\n## Acceptance Criteria\n- [ ] Nodes on critical path have slack 0\n- [ ] Slack values non-negative\n- [ ] Results match Go implementation","status":"closed","priority":2,"type":"task","labels":["algorithm","phase-2","wasm"],"created_at":"2025-12-15 23:35","updated_at":"2025-12-16 00:36","closed_at":"2025-12-16 00:36","blocked_by":["bv-bikt"],"blocks":["bv-y7a0"],"pagerank":0.0018889407873369957,"betweenness":0,"eigenvector":0,"hub":0.00000218772078142756,"authority":0.000010677870334373396,"critical_path":4,"in_degree":1,"out_degree":1,"core_number":2,"slack":7,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-3bez","title":"Unit test: workspace_repos.go - Repository selection UI","description":"Create unit tests for pkg/ui/workspace_repos.go\n\n## File Overview\nworkspace_repos.go handles multi-repo workspace selection and filtering UI.\n\n## Test Cases to Implement\n1. **Repository List Display**\n   - No repos (single repo mode)\n   - Multiple repos with prefixes\n   - Repo health indicators\n   - Issue counts per repo\n\n2. **Selection Behavior**\n   - Single repo selection\n   - All repos selection\n   - Selection persistence\n   - Filter application\n\n3. **Interactive Features**\n   - Repo navigation (j/k)\n   - Toggle selection (space/enter)\n   - Select all (a)\n   - Clear selection (c)\n\n4. **Integration**\n   - Selection updates main view filter\n   - Repo prefix applied to IDs\n   - Cross-repo dependencies shown\n\n## Implementation Notes\n- Create WorkspaceConfig fixtures\n- Test with various repo counts\n- Verify filter propagation","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-16 20:06","updated_at":"2025-12-16 23:31","closed_at":"2025-12-16 23:31","blocks":["bv-ul1l"],"pagerank":0.0017282929585731776,"betweenness":0,"eigenvector":0,"hub":0,"authority":6.623673282227765e-11,"critical_path":4,"in_degree":1,"out_degree":0,"core_number":1,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-3bhq","title":"[SUB-EPIC] Unit Tests Without Mocks - pkg/analysis Suggestion Logic","description":"Add comprehensive unit tests for the 7 untested suggestion-related files in pkg/analysis.\n\n## Files to Test (all currently have 0% coverage)\n1. suggestions.go - Core suggestion logic and types\n2. suggest_all.go - Orchestrates all suggestion types\n3. dependency_suggest.go - Suggests dependency fixes\n4. duplicates.go - Detects duplicate issues\n5. cycle_warnings.go - Generates cycle warnings\n6. graph_cycles.go - Detailed cycle analysis\n7. label_suggest.go - Label suggestions based on content\n\n## Testing Approach\n- Use concrete test data, NO mocks or fakes\n- Table-driven tests for all public functions\n- Test edge cases: empty graphs, single node, cycles, disconnected components\n- Golden file tests for complex outputs\n- Benchmark tests for performance-sensitive functions\n\n## Success Criteria\n- 100% line coverage for all 7 files\n- All edge cases documented and tested\n- Golden files for expected outputs\n- No use of mock frameworks","status":"closed","priority":1,"type":"epic","labels":null,"created_at":"2025-12-16 20:04","updated_at":"2025-12-16 22:58","closed_at":"2025-12-16 22:58","blocked_by":["bv-xcf1","bv-0kll","bv-otc5","bv-75ds","bv-ixzo","bv-21qx","bv-tm6c","bv-m2cg"],"blocks":["bv-gv9v","bv-q923"],"pagerank":0.002073768421622436,"betweenness":15,"eigenvector":0,"hub":2.2389318473534325e-7,"authority":9.342886875136574e-8,"critical_path":3,"in_degree":2,"out_degree":8,"core_number":2,"slack":10,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-3fcg","title":"Light Mode Terminal: Low Color Contrast Makes Text Unreadable","description":"## Problem Statement\n\nThe bv color scheme is very hard to read on light terminal backgrounds. The 'dimmed' text (Subtext, Muted colors) is nearly invisible on white backgrounds, making the application unusable for users with light terminal themes.\n\n## User Impact\n\n**Severity: High (P1)**\n- Effectively blocks users with light terminal themes\n- Affects readability of secondary information (dimmed text, hints)\n- Reported by @mikker in GitHub Issue #17\n\n## Root Cause Analysis\n\n**Location:** `pkg/ui/theme.go:41-64`\n\nThe theme uses `lipgloss.AdaptiveColor` which provides Light/Dark values:\n\n```go\nSubtext: lipgloss.AdaptiveColor{Light: \"#999999\", Dark: \"#BFBFBF\"}\nMuted:   lipgloss.AdaptiveColor{Light: \"#888888\", Dark: \"#6272A4\"}\n```\n\nThe Light values are too light for white backgrounds:\n- `#999999` on white = contrast ratio ~2.8:1 (WCAG AA requires 4.5:1 for normal text)\n- `#888888` on white = contrast ratio ~3.5:1 (still fails WCAG AA)\n\nWhile lipgloss attempts auto-detection of terminal background color, the chosen Light values are simply too faint regardless.\n\n## Proposed Solution\n\n### Fix 1: Improve Light mode color contrast\n\n```go\n// Improved light mode colors (WCAG AA compliant)\nSubtext: lipgloss.AdaptiveColor{Light: \"#666666\", Dark: \"#BFBFBF\"} // ~6:1 contrast\nMuted:   lipgloss.AdaptiveColor{Light: \"#555555\", Dark: \"#6272A4\"} // ~7:1 contrast\n```\n\nAll colors need review:\n- Primary: #7D56F4 on white = ~4.6:1 (barely passes)\n- Secondary: #555555 is good\n- Status colors need verification\n\n### Fix 2 (Optional): Add explicit theme flag\n\n```bash\nbv --theme=light   # Force light mode colors\nbv --theme=dark    # Force dark mode colors\nbv --theme=auto    # Default: auto-detect (current behavior)\n```\n\nThis helps when auto-detection fails or user preference differs.\n\n## Color Audit Required\n\nAll AdaptiveColor values need contrast verification:\n\n| Color | Current Light | Contrast | Suggested Light | New Contrast |\n|-------|--------------|----------|-----------------|--------------|\n| Subtext | #999999 | 2.8:1 ‚ùå | #666666 | 6:1 ‚úì |\n| Muted | #888888 | 3.5:1 ‚ùå | #555555 | 7:1 ‚úì |\n| Secondary | #555555 | 7:1 ‚úì | Keep | - |\n| Open | #00A800 | 2.7:1 ‚ùå | #007700 | 4.6:1 ‚úì |\n| Closed | #555555 | 7:1 ‚úì | Keep | - |\n| Border | #DDDDDD | 1.4:1 ‚ùå | #AAAAAA | 2.3:1 (border OK) |\n\n## Test Plan\n\n1. Manual test on iTerm2 with Solarized Light theme\n2. Manual test on macOS Terminal with default light theme\n3. Verify all text elements are readable\n4. Verify status colors are distinguishable\n5. Consider adding screenshot tests\n\n## Acceptance Criteria\n\n- [ ] All text readable on white terminal background\n- [ ] Status colors visually distinguishable on light background\n- [ ] Existing dark mode appearance unchanged\n- [ ] Optional: --theme flag for explicit control\n- [ ] No WCAG AA violations for text colors (4.5:1 minimum)\n\n## References\n\n- GitHub Issue #17: https://github.com/Dicklesworthstone/beads_viewer/issues/17\n- WCAG Color Contrast Guidelines: https://www.w3.org/WAI/WCAG21/Understanding/contrast-minimum.html\n- lipgloss AdaptiveColor: https://github.com/charmbracelet/lipgloss#adaptive-colors","status":"closed","priority":1,"type":"bug","labels":["accessibility","gh-issue-17"],"created_at":"2025-12-15 23:52","updated_at":"2025-12-16 00:22","closed_at":"2025-12-16 00:22","blocks":["bv-uqoh"],"pagerank":0.0016019788987050227,"betweenness":0,"eigenvector":0,"hub":0,"authority":9.324854925833239e-9,"critical_path":2,"in_degree":1,"out_degree":0,"core_number":1,"slack":13,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-3ht4","title":"openInEditor Uses Hardcoded Path Instead of Configured beadsPath","description":"## Problem Statement\n\nThe 'O' keybinding to open the beads file in editor fails when the file isn't named exactly `beads.jsonl`. The `openInEditor()` function hardcodes the path instead of using the `beadsPath` field already stored in the Model.\n\n## User Impact\n\n**Severity: High (P1)**\n- Fails silently or shows error for projects using `issues.jsonl`\n- beads upstream uses `issues.jsonl` as canonical, not `beads.jsonl`\n- Reported by @qmx in GitHub PR #18\n\n## Root Cause Analysis\n\n**Location:** `pkg/ui/model.go:2945-2955`\n\n```go\nfunc (m *Model) openInEditor() {\n    cwd, err := os.Getwd()\n    // ...\n    beadsFile := filepath.Join(cwd, \".beads\", \"beads.jsonl\")  // HARDCODED!\n    if _, err := os.Stat(beadsFile); os.IsNotExist(err) {\n        m.statusMsg = \"No .beads/beads.jsonl file found\"  // Wrong error message\n        // ...\n    }\n}\n```\n\nThe Model already has a `beadsPath` field (line 138) that's set during initialization and used for file watching. This function ignores it.\n\n## Why This Matters\n\nThe beads project documentation (pre-commit hook) states:\n\u003e Stage all tracked JSONL files (issues.jsonl is canonical, beads.jsonl for backward compat)\n\nSo the hardcoded `beads.jsonl` path is wrong for the canonical case.\n\n## Proposed Solution\n\n```go\nfunc (m *Model) openInEditor() {\n    if m.beadsPath == \"\" {\n        m.statusMsg = \"No beads file configured\"\n        m.statusIsError = true\n        return\n    }\n\n    if _, err := os.Stat(m.beadsPath); os.IsNotExist(err) {\n        m.statusMsg = fmt.Sprintf(\"Beads file not found: %s\", m.beadsPath)\n        m.statusIsError = true\n        return\n    }\n    \n    // Continue with m.beadsPath instead of hardcoded path...\n}\n```\n\n## Test Plan\n\n1. Test: openInEditor with beadsPath set to issues.jsonl - should work\n2. Test: openInEditor with beadsPath empty - should show \"No beads file configured\"\n3. Test: openInEditor with beadsPath pointing to non-existent file - should show path in error\n4. Manual test: 'O' key works for both beads.jsonl and issues.jsonl projects\n\n## Acceptance Criteria\n\n- [ ] Uses m.beadsPath instead of hardcoded path\n- [ ] Error messages include actual file path for debugging\n- [ ] Works for issues.jsonl, beads.jsonl, and any other valid jsonl file\n- [ ] Tests cover all error paths\n\n## Dependencies\n\n**Blocked by:** bv-mvvu (Data Integrity: Merge Artifact Files)\n- The beadsPath value depends on correct file selection\n- Fix the loader first, then this will use the correct path\n\n## References\n\n- GitHub PR #18: https://github.com/Dicklesworthstone/beads_viewer/pull/18\n- beads pre-commit hook documentation on canonical file names","status":"closed","priority":1,"type":"bug","labels":["gh-pr-18","ux"],"created_at":"2025-12-15 23:52","updated_at":"2025-12-16 00:20","closed_at":"2025-12-16 00:20","blocked_by":["bv-mvvu"],"blocks":["bv-uqoh"],"pagerank":0.0016019788987050227,"betweenness":0,"eigenvector":0,"hub":1.9060491153113305e-9,"authority":9.324854925833239e-9,"critical_path":2,"in_degree":1,"out_degree":1,"core_number":2,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-3ita","title":"Add sort-by-created-date keyboard shortcut to list view","status":"closed","priority":2,"type":"feature","labels":null,"created_at":"2025-12-17 10:11","updated_at":"2025-12-17 10:15","closed_at":"2025-12-17 10:15","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-3krz","title":"Visual regression: Graph rendering golden tests","description":"Golden file tests for graph rendering consistency.\n\n## Golden Files to Create\n1. **ASCII Rendering**\n   - chain_10_ascii.golden\n   - star_10_ascii.golden\n   - diamond_5_ascii.golden\n   - complex_20_ascii.golden\n\n2. **SVG Rendering**\n   - chain_10.svg.golden\n   - star_10.svg.golden\n   - diamond_5.svg.golden\n   - complex_20.svg.golden\n\n3. **Mermaid Output**\n   - chain_10.mermaid.golden\n   - star_10.mermaid.golden\n   - diamond_5.mermaid.golden\n\n## Test Scenarios\n- Exact match for deterministic output\n- Regenerate with GENERATE_GOLDEN=1\n- Diff on mismatch for debugging\n- Document expected format\n\n## Graph Fixtures\n- Reuse existing testdata/graphs/\n- Add new topologies as needed\n- Include edge cases\n\n## Implementation\n- compareGolden() helper function\n- Generate or compare mode\n- Clear diff output on failure\n- CI integration","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-16 20:10","updated_at":"2025-12-16 23:55","closed_at":"2025-12-16 23:55","blocked_by":["bv-7bob","bv-6jyn"],"blocks":["bv-evyl"],"pagerank":0.0016290932344603455,"betweenness":0,"eigenvector":0,"hub":3.285491594334759e-8,"authority":7.205652148943102e-8,"critical_path":3,"in_degree":1,"out_degree":2,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-3m20","title":"Port K-Shortest Paths and Parallel Cut analysis to Rust WASM","description":"# Port K-Shortest Paths and Parallel Cut\n\n## Context\nK-Shortest Paths finds multiple critical paths through the graph. Parallel Cut analyzes opportunities for parallel work.\n\n## Go Implementation Reference\n```go\n// KPathsResult, ParallelCutResult in advanced_insights.go\n```\n\n## Rust Implementation\n\n### advanced/k_paths.rs\n```rust\nuse crate::graph::DiGraph;\nuse crate::algorithms::topo::topological_sort;\n\npub struct CriticalPath {\n    pub nodes: Vec\u003cusize\u003e,\n    pub length: usize,\n}\n\n/// Find k longest paths in DAG.\npub fn k_critical_paths(graph: \u0026DiGraph, k: usize) -\u003e Vec\u003cCriticalPath\u003e {\n    let n = graph.node_count();\n    if n == 0 { return Vec::new(); }\n    \n    let order = match topological_sort(graph) {\n        Some(o) =\u003e o,\n        None =\u003e return Vec::new(),\n    };\n    \n    // Compute distances and track predecessors\n    let mut dist = vec![0usize; n];\n    let mut pred = vec![None; n];\n    \n    for \u0026v in \u0026order {\n        for \u0026u in graph.predecessors(v) {\n            if dist[u] + 1 \u003e dist[v] {\n                dist[v] = dist[u] + 1;\n                pred[v] = Some(u);\n            }\n        }\n    }\n    \n    // Find k sinks with longest paths\n    let mut sinks: Vec\u003c(usize, usize)\u003e = (0..n)\n        .filter(|\u0026v| graph.out_degree(v) == 0 || dist[v] \u003e 0)\n        .map(|v| (v, dist[v]))\n        .collect();\n    sinks.sort_by(|a, b| b.1.cmp(\u0026a.1));\n    sinks.truncate(k);\n    \n    // Reconstruct paths\n    sinks.iter().map(|\u0026(sink, len)| {\n        let mut path = vec![sink];\n        let mut curr = sink;\n        while let Some(p) = pred[curr] {\n            path.push(p);\n            curr = p;\n        }\n        path.reverse();\n        CriticalPath { nodes: path, length: len + 1 }\n    }).collect()\n}\n```\n\n### advanced/parallel_cut.rs\n```rust\nuse crate::graph::DiGraph;\n\npub struct ParallelCutItem {\n    pub node: usize,\n    pub parallel_gain: i32,\n}\n\n/// Find issues that increase parallelization when completed.\npub fn parallel_cut_suggestions(graph: \u0026DiGraph, closed_set: \u0026[bool], limit: usize) -\u003e Vec\u003cParallelCutItem\u003e {\n    let n = graph.node_count();\n    let mut suggestions: Vec\u003cParallelCutItem\u003e = (0..n)\n        .filter(|\u0026v| !closed_set.get(v).copied().unwrap_or(false))\n        .map(|v| {\n            // Count how many dependents become actionable\n            let gain = graph.successors(v).iter()\n                .filter(|\u0026\u0026w| {\n                    !closed_set.get(w).copied().unwrap_or(false) \u0026\u0026\n                    graph.predecessors(w).iter()\n                        .filter(|\u0026\u0026p| p != v)\n                        .all(|\u0026p| closed_set.get(p).copied().unwrap_or(false))\n                })\n                .count();\n            ParallelCutItem { node: v, parallel_gain: gain as i32 - 1 }\n        })\n        .filter(|item| item.parallel_gain \u003e 0)\n        .collect();\n    \n    suggestions.sort_by(|a, b| b.parallel_gain.cmp(\u0026a.parallel_gain));\n    suggestions.truncate(limit);\n    suggestions\n}\n```\n\n## Acceptance Criteria\n- [ ] K paths returned in length order\n- [ ] Parallel cut identifies bottleneck removals\n- [ ] Results match Go advanced_insights","notes":"BUG FIX NEEDED: Current implementation stores only ONE predecessor per node (pred = vec![None; n]), so it can only reconstruct ONE path per endpoint. To get truly distinct k paths:\n\nOPTION A (Simple): Find k distinct sinks by longest distance, reconstruct one path each. This gives k paths ending at different nodes.\n\nOPTION B (Correct): Use Yen's k-shortest paths algorithm or track ALL predecessors per node and enumerate paths.\n\nFor v1, Option A is acceptable since we want paths to k DIFFERENT high-priority issues. Document this limitation in the return type.","status":"closed","priority":2,"type":"task","labels":["advanced","phase-3","wasm"],"created_at":"2025-12-15 23:36","updated_at":"2025-12-16 01:33","closed_at":"2025-12-16 01:33","blocked_by":["bv-bxoe","bv-yi6k"],"blocks":["bv-y7a0"],"pagerank":0.0018889407873369957,"betweenness":2.5,"eigenvector":0,"hub":0.000009405179577044484,"authority":0.000010677870334373396,"critical_path":4,"in_degree":1,"out_degree":2,"core_number":2,"slack":8,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-3qi5","title":"Toggleable Keyboard Shortcuts Sidebar","description":"## Feature Request\n\nAdd a toggleable sidebar panel that displays keyboard shortcuts while using the application. Unlike the current help overlay (which is modal and blocks interaction), this would be a persistent panel that can be shown/hidden while continuing to work.\n\n## User Request\n\nFrom @austinm911 in GitHub Issue #8:\n\u003e Not sure if anyone would find this helpful but there are a lot of shortcuts here so I am always using ? to view them (unable to scroll this view on Warp terminal). It would be nice to have a keyboard shortcuts panel that could be toggled on/off so we can see the rest of the panels.\n\n## Why This Matters\n\nbv has 60+ keyboard shortcuts across multiple contexts. Learning these shortcuts improves efficiency, but the current modal help overlay:\n1. Blocks the main view while open\n2. Cannot be scrolled on some terminals (separate bug: bv-43js)\n3. Must be reopened each time you forget a shortcut\n\n## Proposed Approaches\n\n### Option A: Persistent Sidebar (Recommended)\n\nA right-side panel that can be toggled on/off. Toggle with a key like F2 or Shift+?. Shows shortcuts organized by category, scrollable within the sidebar.\n\n### Option B: Context-Sensitive Status Bar\n\nShow relevant shortcuts in the footer based on current view/focus. Less intrusive but shows fewer shortcuts.\n\n### Option C: Compact Floating Panel\n\nA smaller overlay that does not cover the entire screen.\n\n## Design Considerations\n\n1. Width impact: Sidebar reduces main content width\n2. Context awareness: Show shortcuts relevant to current view/focus\n3. Persistence: Remember toggle state across sessions?\n4. Customization: Allow users to choose which shortcuts to show?\n\n## Priority Justification\n\nP4 (Backlog) because:\n- Nice-to-have, not critical functionality\n- Help overlay serves the basic need (once scroll bug is fixed)\n- Requires significant UI work\n- Should implement after help overlay scroll (bv-43js)\n\n## Dependencies\n\nBlocked by: bv-43js (Help Overlay Scroll)\n- Fix the existing help system first\n- Learn from help scroll implementation patterns\n- Sidebar might reuse scroll logic\n\n## Test Plan\n\n1. Toggle sidebar on/off with key\n2. Layout adjusts correctly with sidebar\n3. Shortcuts update based on context\n4. Works in all views\n\n## Acceptance Criteria\n\n- Toggleable sidebar or alternative implementation\n- Shows relevant keyboard shortcuts\n- Does not block main interaction\n- Scrollable if content exceeds height\n- Adapts to terminal size\n- Works across all views\n\n## References\n\n- GitHub Issue #8: https://github.com/Dicklesworthstone/beads_viewer/issues/8\n- Related: bv-43js (help overlay scroll) - should fix first","status":"closed","priority":4,"type":"feature","labels":["enhancement","gh-issue-8","ux"],"created_at":"2025-12-15 23:55","updated_at":"2025-12-16 16:17","closed_at":"2025-12-16 16:17","blocked_by":["bv-43js"],"blocks":["bv-uqoh"],"pagerank":0.0016019788987050227,"betweenness":0,"eigenvector":0,"hub":1.7021196326230639e-9,"authority":9.324854925833239e-9,"critical_path":2,"in_degree":1,"out_degree":1,"core_number":2,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-406","title":"Implement hash-based routing for SPA navigation","description":"# Implement Hash-Based Routing for SPA Navigation\n\n## Context\nThe static viewer needs client-side routing to navigate between views (dashboard, issues list, issue detail, insights) without page reloads. Hash-based routing works perfectly for static hosting.\n\n## Requirements\n\n### URL Structure\n```\n#/                      ‚Üí Dashboard\n#/issues                ‚Üí Issues list\n#/issues?status=open    ‚Üí Filtered issues list\n#/issue/bv-123          ‚Üí Issue detail\n#/insights              ‚Üí Insights view\n```\n\n### Router Implementation\n```javascript\n// viewer.js\n\nconst routes = {\n    '/': 'dashboard',\n    '/issues': 'issues',\n    '/issue/:id': 'issue',\n    '/insights': 'insights'\n};\n\nfunction initRouter() {\n    // Parse current hash and navigate\n    window.addEventListener('hashchange', handleRoute);\n    handleRoute(); // Handle initial route\n}\n\nfunction handleRoute() {\n    const hash = window.location.hash.slice(1) || '/';\n    const [path, query] = hash.split('?');\n    \n    // Parse query params\n    const params = new URLSearchParams(query);\n    \n    // Match route\n    for (const [pattern, view] of Object.entries(routes)) {\n        const match = matchRoute(pattern, path);\n        if (match) {\n            navigateTo(view, match.params, params);\n            return;\n        }\n    }\n    \n    // Default to dashboard\n    navigateTo('dashboard', {}, params);\n}\n\nfunction matchRoute(pattern, path) {\n    const patternParts = pattern.split('/');\n    const pathParts = path.split('/');\n    \n    if (patternParts.length !== pathParts.length) return null;\n    \n    const params = {};\n    for (let i = 0; i \u003c patternParts.length; i++) {\n        if (patternParts[i].startsWith(':')) {\n            params[patternParts[i].slice(1)] = pathParts[i];\n        } else if (patternParts[i] !== pathParts[i]) {\n            return null;\n        }\n    }\n    \n    return { params };\n}\n\nfunction navigateTo(view, routeParams, queryParams) {\n    const store = Alpine.store('app');\n    \n    // Update view state\n    store.currentView = view;\n    store.routeParams = routeParams;\n    \n    // Handle view-specific logic\n    switch (view) {\n        case 'issue':\n            store.selectedIssueId = routeParams.id;\n            break;\n        case 'issues':\n            // Apply query params to filters\n            if (queryParams.has('status')) {\n                store.filters.status = queryParams.get('status').split(',');\n            }\n            if (queryParams.has('type')) {\n                store.filters.type = queryParams.get('type').split(',');\n            }\n            if (queryParams.has('search')) {\n                store.filters.search = queryParams.get('search');\n            }\n            break;\n    }\n}\n```\n\n### Navigation Helpers\n```javascript\nfunction navigate(path) {\n    window.location.hash = path;\n}\n\nfunction navigateToIssue(id) {\n    navigate(`/issue/${id}`);\n}\n\nfunction navigateToIssues(filters = {}) {\n    const params = new URLSearchParams();\n    if (filters.status?.length) params.set('status', filters.status.join(','));\n    if (filters.type?.length) params.set('type', filters.type.join(','));\n    if (filters.search) params.set('search', filters.search);\n    \n    const query = params.toString();\n    navigate(`/issues${query ? '?' + query : ''}`);\n}\n\nfunction goBack() {\n    window.history.back();\n}\n```\n\n### Alpine.js Integration\n```javascript\nAlpine.store('app', {\n    currentView: 'dashboard',\n    routeParams: {},\n    selectedIssueId: null,\n    \n    // Computed\n    get currentIssue() {\n        if (!this.selectedIssueId) return null;\n        return this.issues.find(i =\u003e i.id === this.selectedIssueId);\n    }\n});\n```\n\n### View Rendering\n```html\n\u003cmain\u003e\n    \u003c!-- Dashboard --\u003e\n    \u003cdiv x-show=\"$store.app.currentView === 'dashboard'\" x-cloak\u003e\n        \u003cdiv x-data=\"dashboardView()\"\u003e\n            \u003c!-- Dashboard content --\u003e\n        \u003c/div\u003e\n    \u003c/div\u003e\n    \n    \u003c!-- Issues List --\u003e\n    \u003cdiv x-show=\"$store.app.currentView === 'issues'\" x-cloak\u003e\n        \u003cdiv x-data=\"issuesView()\"\u003e\n            \u003c!-- Issues list content --\u003e\n        \u003c/div\u003e\n    \u003c/div\u003e\n    \n    \u003c!-- Issue Detail --\u003e\n    \u003cdiv x-show=\"$store.app.currentView === 'issue'\" x-cloak\u003e\n        \u003cdiv x-data=\"issueDetailView()\"\u003e\n            \u003c!-- Issue detail content --\u003e\n        \u003c/div\u003e\n    \u003c/div\u003e\n    \n    \u003c!-- Insights --\u003e\n    \u003cdiv x-show=\"$store.app.currentView === 'insights'\" x-cloak\u003e\n        \u003cdiv x-data=\"insightsView()\"\u003e\n            \u003c!-- Insights content --\u003e\n        \u003c/div\u003e\n    \u003c/div\u003e\n\u003c/main\u003e\n```\n\n### Browser History\nHash-based routing automatically works with browser back/forward buttons via the `hashchange` event.\n\n## Acceptance Criteria\n- [ ] Direct URL access works (refresh preserves state)\n- [ ] Browser back/forward buttons work\n- [ ] Filters preserved in URL\n- [ ] Issue detail links shareable\n- [ ] Default route is dashboard\n- [ ] Invalid routes redirect to dashboard\n- [ ] No flash of wrong content on navigation\n\n## Notes\n- Hash routing chosen over History API because it works without server config\n- URL remains readable and bookmarkable\n- Query params allow sharing filtered views","status":"closed","priority":2,"type":"task","labels":["phase-2","static-pages"],"created_at":"2025-12-15 23:09","updated_at":"2025-12-16 03:26","closed_at":"2025-12-16 03:26","blocked_by":["bv-jdl"],"blocks":["bv-y5i"],"pagerank":0.0015706037203119501,"betweenness":0,"eigenvector":0,"hub":0.00006846157171641059,"authority":0.0001967059030531822,"critical_path":3,"in_degree":1,"out_degree":1,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-40bw","title":"E2E tests: Forecast/ETA workflow with logging","description":"Create E2E tests for the forecast/ETA workflow when --robot-forecast is implemented.\n\n**Test workflow:**\n1. Create test issues with various complexities\n2. Add historical closure data for velocity calculation\n3. Run forecast command\n4. Validate ETA predictions are reasonable\n5. Test confidence intervals\n6. Log all intermediate calculations\n\n**Dependencies:** Requires bv-158 (robot-forecast command) to be complete.\n\n**Location:** tests/e2e/forecast_test.go","status":"closed","priority":2,"type":"task","labels":["e2e","forecast","logging","testing"],"created_at":"2025-12-16 13:02","updated_at":"2025-12-16 13:35","closed_at":"2025-12-16 13:35","blocked_by":["bv-158"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":7.890898495503672e-22,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":9,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-43js","title":"Help Overlay Cannot Be Scrolled on Small Terminals","description":"## Problem Statement\n\nThe help overlay (triggered by '?' or F1) displays all keyboard shortcuts in a fixed box. On terminals smaller than the content height, the help content is cut off with no way to scroll and see the remaining shortcuts.\n\n## User Impact\n\n**Severity: Medium (P2)**\n- Affects discoverability of keyboard shortcuts\n- Particularly problematic on smaller screens or split terminal panes\n- User @austinm911 mentioned this in GitHub Issue #8\n- Identified during PR #16 review from @kraitsura\n\n## Root Cause Analysis\n\n**Location:** `pkg/ui/model.go:1731-1889` (`renderHelpOverlay` function)\n\nThe function builds a string with all shortcuts and renders it in a fixed box:\n\n```go\nhelpBox := t.Renderer.NewStyle().\n    Border(lipgloss.RoundedBorder()).\n    BorderForeground(t.Primary).\n    Padding(1, 3).\n    Render(helpContent)  // All content, no scroll\n\nreturn lipgloss.Place(m.width, m.height-1, lipgloss.Center, lipgloss.Center, helpBox)\n```\n\nThere's no scroll state, no key handlers for navigation, and no visual indicator of content overflow.\n\n## Why This Matters\n\nThe help overlay shows 60+ lines of keyboard shortcuts across multiple sections:\n- Navigation (9 items)\n- Views (7 items)\n- Graph View (4 items)\n- Insights Panel (5 items)\n- History View (7 items)\n- Filters (5 items)\n- General (7 items)\n\nEven on a 40-line terminal, much of this content is hidden.\n\n## Proposed Solution\n\n### Add scroll support to help overlay\n\n1. **Add scroll state to Model:**\n   ```go\n   helpScroll int // Current scroll offset for help overlay\n   ```\n\n2. **Handle navigation keys when help focused:**\n   ```go\n   case focusHelp:\n       switch msg.String() {\n       case \"j\", \"down\":\n           m.helpScroll++\n       case \"k\", \"up\":\n           if m.helpScroll \u003e 0 { m.helpScroll-- }\n       case \"ctrl+d\":\n           m.helpScroll += 10\n       case \"ctrl+u\":\n           m.helpScroll = max(0, m.helpScroll-10)\n       case \"home\", \"g\":\n           m.helpScroll = 0\n       default:\n           // Any other key dismisses help\n           m.showHelp = false\n           m.helpScroll = 0\n       }\n   ```\n\n3. **Render visible portion with scroll indicator:**\n   - Calculate visible lines based on terminal height\n   - Clamp scroll position to valid range\n   - Show scroll position indicator (e.g., scrollbar or percentage)\n\n4. **Add navigation hint in help footer:**\n   ```\n   ‚Üë‚Üì scroll ‚îÇ q close ‚îÇ ‚óè‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ (scroll indicator)\n   ```\n\n## Design Considerations\n\n1. **Fixed width rendering**: Prevent box resize as content scrolls\n2. **Scroll indicator**: Show position in content (scrollbar or percentage)\n3. **Graceful degradation**: On very small terminals, show most important shortcuts first\n4. **Reset scroll on open**: Always start at top when reopening help\n\n## Test Plan\n\n1. Test: j/k keys scroll content up/down\n2. Test: Ctrl+d/u for page navigation\n3. Test: Home/g goes to top\n4. Test: Any non-navigation key closes help\n5. Test: Scroll resets to 0 on reopen\n6. Test: Scroll indicator updates correctly\n7. Manual test: Various terminal sizes\n\n## Acceptance Criteria\n\n- [ ] Help overlay scrollable with j/k, arrows, Ctrl+d/u\n- [ ] Visual scroll indicator shows position\n- [ ] Non-navigation keys still dismiss help\n- [ ] Scroll position resets when reopened\n- [ ] Works correctly at edge cases (top/bottom of content)\n- [ ] Fixed width prevents layout shift during scroll\n\n## References\n\n- GitHub PR #16: https://github.com/Dicklesworthstone/beads_viewer/pull/16\n- GitHub Issue #8: https://github.com/Dicklesworthstone/beads_viewer/issues/8 (related)\n- Related: Help content is extensive and growing with each feature","status":"closed","priority":2,"type":"bug","labels":["accessibility","gh-pr-16","ux"],"created_at":"2025-12-15 23:53","updated_at":"2025-12-16 10:43","closed_at":"2025-12-16 10:43","blocks":["bv-3qi5","bv-uqoh"],"pagerank":0.0029636610766036135,"betweenness":0,"eigenvector":0,"hub":0,"authority":1.0322527447681747e-8,"critical_path":3,"in_degree":2,"out_degree":0,"core_number":2,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-46eg","title":"workspace loader: avoid stderr log noise (keep robot JSON clean)","description":"pkg/workspace/NewAggregateLoader currently defaults to log.Default() and prints a completion log line for parallel loading. This can pollute stderr and break callers/tests that capture CombinedOutput for robot JSON. Make workspace loading silent by default and add an E2E test ensuring --robot-triage --workspace emits clean JSON with empty stderr.","acceptance_criteria":"- Running bv --robot-triage --workspace \u003cconfig\u003e emits valid JSON on stdout with empty stderr in tests\n- No behavioral regression for workspace loading\n- go test ./... passes","status":"closed","priority":2,"type":"bug","labels":["robot","workspace"],"assignee":"BrownBear","created_at":"2025-12-17 04:45","updated_at":"2025-12-17 04:47","closed_at":"2025-12-17 04:47","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-470n","title":"Implement visual what-if simulation with cascade animations","description":"# Visual What-If Simulation\n\n## Context\nWhen user clicks an open issue in the graph, animate the cascade of unblocks.\n\n## Requirements\n\n### 1. Click Handler for What-If\n```javascript\nfunction handleWhatIfClick(node) {\n    if (node.status !== 'open') return;\n    \n    // Call WASM what-if\n    const result = JSON.parse(GRAPH.what_if_close(\n        NODE_MAP.get(node.id), \n        buildClosedSet()\n    ));\n    \n    // Animate the unblocks\n    animateUnblockCascade(node.id, result.unblocked_ids);\n}\n```\n\n### 2. Cascade Animation\n```javascript\nfunction animateUnblockCascade(sourceId, unblockedIds) {\n    // Phase 1: Highlight the source (pulse green)\n    highlightNode(sourceId, 'closing');\n    \n    // Phase 2: Ripple out to direct unblocks (delay 200ms)\n    setTimeout(() =\u003e {\n        unblockedIds.forEach((id, i) =\u003e {\n            setTimeout(() =\u003e {\n                highlightNode(id, 'unblocked');\n                // Animate the edge\n                animateEdge(sourceId, id);\n            }, i * 100); // Stagger for ripple effect\n        });\n    }, 200);\n    \n    // Phase 3: Show summary popup\n    setTimeout(() =\u003e {\n        showWhatIfSummary(sourceId, unblockedIds);\n    }, unblockedIds.length * 100 + 500);\n}\n```\n\n### 3. Visual Feedback\n- Source node: pulses, shrinks, turns green\n- Unblocked nodes: glow effect, color shift orange‚Üíblue\n- Edges: animate with particle flow\n- Summary tooltip with stats\n\n### 4. Reset Mechanism\n- 'Reset' button restores original colors\n- Click elsewhere to dismiss\n- Escape key to cancel\n\n## Acceptance Criteria\n- [ ] Click open node triggers what-if\n- [ ] Cascade animation is smooth and clear\n- [ ] Direct unblocks highlighted distinctly\n- [ ] Summary shows impact stats\n- [ ] Reset works correctly","status":"closed","priority":2,"type":"task","labels":["phase-2","ux","visualization","wasm"],"created_at":"2025-12-15 23:55","updated_at":"2025-12-16 11:40","closed_at":"2025-12-16 11:40","blocked_by":["bv-jndd","bv-njah"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.0000026863447015114748,"authority":0,"critical_path":1,"in_degree":0,"out_degree":2,"core_number":2,"slack":9,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-4jow","title":"robot-next output should include data_hash and be consistent","description":"`bv --robot-next` currently outputs only `{generated_at,message}` when there are no actionable items and omits `data_hash` (and other shared robot metadata). This makes automation harder because you can't correlate a \"no work\" response to a specific beads snapshot.\n\nAcceptance:\n- `bv --robot-next` always includes `data_hash` (even when no top pick exists)\n- Keep backward compatibility (existing fields remain)\n- Add/extend an e2e contract test for `--robot-next` (both with and without actionable items)\n","notes":"Implemented: `--robot-next` now includes `data_hash` in both the no-actionable and top-pick JSON payloads (backward compatible).\n\nTests: added e2e contract coverage in `tests/e2e/robot_contract_test.go` and ran `go test ./...`.","status":"closed","priority":2,"type":"task","labels":["robot"],"created_at":"2025-12-16 18:16","updated_at":"2025-12-16 18:20","closed_at":"2025-12-16 18:20","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-50r","title":"Implement local preview server with hot reload","description":"# Implement Local Preview Server with Hot Reload\n\n## Context\nUsers need to preview their static site locally before deploying. This requires a simple HTTP server with some nice-to-have features like watching for changes.\n\n## Requirements\n\n### Basic Server\n```go\n// pkg/export/preview.go\n\ntype PreviewServer struct {\n    bundlePath string\n    port       int\n    server     *http.Server\n    watcher    *fsnotify.Watcher\n    clients    map[chan bool]bool // SSE clients for hot reload\n    mu         sync.Mutex\n}\n\nfunc NewPreviewServer(bundlePath string, port int) *PreviewServer {\n    return \u0026PreviewServer{\n        bundlePath: bundlePath,\n        port:       port,\n        clients:    make(map[chan bool]bool),\n    }\n}\n\nfunc (p *PreviewServer) Start() error {\n    mux := http.NewServeMux()\n    \n    // Static file server\n    fs := http.FileServer(http.Dir(p.bundlePath))\n    mux.Handle(\"/\", noCache(fs))\n    \n    // SSE endpoint for hot reload\n    mux.HandleFunc(\"/__preview__/events\", p.sseHandler)\n    \n    // Status endpoint\n    mux.HandleFunc(\"/__preview__/status\", p.statusHandler)\n    \n    p.server = \u0026http.Server{\n        Addr:    fmt.Sprintf(\":%d\", p.port),\n        Handler: mux,\n    }\n    \n    return p.server.ListenAndServe()\n}\n```\n\n### No-Cache Middleware\nEnsure browsers always get fresh content during preview:\n```go\nfunc noCache(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        w.Header().Set(\"Cache-Control\", \"no-store, no-cache, must-revalidate\")\n        w.Header().Set(\"Pragma\", \"no-cache\")\n        w.Header().Set(\"Expires\", \"0\")\n        next.ServeHTTP(w, r)\n    })\n}\n```\n\n### Hot Reload via SSE\n```go\nfunc (p *PreviewServer) sseHandler(w http.ResponseWriter, r *http.Request) {\n    w.Header().Set(\"Content-Type\", \"text/event-stream\")\n    w.Header().Set(\"Cache-Control\", \"no-cache\")\n    w.Header().Set(\"Connection\", \"keep-alive\")\n    \n    notify := make(chan bool)\n    p.mu.Lock()\n    p.clients[notify] = true\n    p.mu.Unlock()\n    \n    defer func() {\n        p.mu.Lock()\n        delete(p.clients, notify)\n        p.mu.Unlock()\n    }()\n    \n    for {\n        select {\n        case \u003c-notify:\n            fmt.Fprintf(w, \"data: reload\\n\\n\")\n            w.(http.Flusher).Flush()\n        case \u003c-r.Context().Done():\n            return\n        }\n    }\n}\n\nfunc (p *PreviewServer) notifyClients() {\n    p.mu.Lock()\n    defer p.mu.Unlock()\n    for ch := range p.clients {\n        select {\n        case ch \u003c- true:\n        default:\n        }\n    }\n}\n```\n\n### File Watcher\n```go\nfunc (p *PreviewServer) StartWatcher() error {\n    watcher, err := fsnotify.NewWatcher()\n    if err != nil {\n        return err\n    }\n    p.watcher = watcher\n    \n    go func() {\n        for {\n            select {\n            case event := \u003c-watcher.Events:\n                if event.Op\u0026(fsnotify.Write|fsnotify.Create) != 0 {\n                    p.notifyClients()\n                }\n            case err := \u003c-watcher.Errors:\n                log.Printf(\"watcher error: %v\", err)\n            }\n        }\n    }()\n    \n    // Watch data directory\n    return watcher.Add(filepath.Join(p.bundlePath, \"data\"))\n}\n```\n\n### Viewer Integration\nAdd SSE client to viewer.js:\n```javascript\n// Only in preview mode (detect via /__preview__/status)\nif (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {\n    const eventSource = new EventSource('/__preview__/events');\n    eventSource.onmessage = (event) =\u003e {\n        if (event.data === 'reload') {\n            window.location.reload();\n        }\n    };\n}\n```\n\n### Interactive Controls\nWhen running preview from wizard:\n```\nPreview server running at http://localhost:9000\n\nKeyboard controls:\n  r - Force refresh (regenerate export)\n  d - Deploy to GitHub Pages\n  q - Quit preview\n\nPress 'r' to regenerate, 'd' to deploy, or 'q' to quit...\n```\n\n### Port Selection\n```go\nfunc findAvailablePort(start, end int) (int, error) {\n    for port := start; port \u003c= end; port++ {\n        listener, err := net.Listen(\"tcp\", fmt.Sprintf(\":%d\", port))\n        if err == nil {\n            listener.Close()\n            return port, nil\n        }\n    }\n    return 0, fmt.Errorf(\"no available port in range %d-%d\", start, end)\n}\n```\n\n## Acceptance Criteria\n- [ ] Server starts and serves bundle\n- [ ] No-cache headers prevent stale content\n- [ ] Browser auto-opens on start\n- [ ] SSE hot reload works when files change\n- [ ] 'r' key regenerates export\n- [ ] 'd' key triggers deployment flow\n- [ ] 'q' key cleanly exits\n- [ ] Auto-selects available port if default in use\n- [ ] Works on macOS, Linux, Windows\n\n## Notes\n- Keep dependencies minimal (just std lib + fsnotify)\n- SSE is simpler than WebSocket for this use case\n- Hot reload is nice-to-have, not critical for MVP","notes":"REVISION (2025-12-16): Clarified MVP vs nice-to-have features.\n\n**MVP (Required):**\n- Static file server with no-cache headers\n- Auto-opens browser on start\n- Ctrl+C to stop\n- Port auto-selection if default in use\n\n**NICE-TO-HAVE (Phase 4):**\n- Hot reload via SSE\n- File watcher with fsnotify\n- 'r' to regenerate, 'd' to deploy, 'q' to quit controls\n- Manifest status endpoint\n\n**MVP Implementation:**\n```go\nfunc (p *PreviewServer) Start() error {\n    mux := http.NewServeMux()\n    \n    // Static file server with no-cache\n    fs := http.FileServer(http.Dir(p.bundlePath))\n    mux.Handle(\"/\", noCacheMiddleware(fs))\n    \n    p.server = \u0026http.Server{\n        Addr:    fmt.Sprintf(\":%d\", p.port),\n        Handler: mux,\n    }\n    \n    // Open browser\n    go func() {\n        time.Sleep(500 * time.Millisecond)\n        browser.OpenURL(fmt.Sprintf(\"http://localhost:%d\", p.port))\n    }()\n    \n    fmt.Printf(\"Preview server at http://localhost:%d\\n\", p.port)\n    fmt.Println(\"Press Ctrl+C to stop\")\n    \n    return p.server.ListenAndServe()\n}\n```\n\nThis simplification removes:\n- fsnotify dependency\n- SSE complexity\n- Interactive key handling\n\nThese can be added later as enhancements.","status":"closed","priority":2,"type":"task","labels":["phase-3","static-pages"],"created_at":"2025-12-15 23:09","updated_at":"2025-12-16 03:25","closed_at":"2025-12-16 03:25","blocked_by":["bv-73f"],"blocks":["bv-10g","bv-y5i"],"pagerank":0.002204734947456645,"betweenness":0,"eigenvector":0,"hub":0.00004332804225588155,"authority":0.00022992528340604315,"critical_path":5,"in_degree":2,"out_degree":1,"core_number":3,"slack":7,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-52t","title":"Impact Radar \u0026 Drift Alerts","description":"Detect significant changes in graph metrics and alert when structure degrades.\n\n## Background \u0026 Motivation\nGraph metrics (PageRank, betweenness, cycles) can degrade over time without anyone noticing. A new cycle might be introduced, or a bottleneck might emerge. Proactive detection prevents issues from compounding.\n\n## Value Proposition\n- For Humans: Early warning when project health degrades\n- For AI Agents: Validate changes before committing - 'did I introduce a cycle?'\n\n## Technical Approach\n1. Baseline storage (snapshot of metrics at a point in time)\n2. Drift calculator (compare current to baseline)\n3. Threshold configuration (when to alert)\n4. CLI: --check-drift for CI integration\n\n## Alert Types\n- New cycles detected (critical)\n- Significant PageRank changes (potential new bottleneck)\n- Betweenness spike (new critical path node)\n- Density increase (complexity growing)\n\n## Success Criteria\n- CI can run --check-drift and fail on regressions\n- Clear exit codes: 0=OK, 1=critical, 2=warning\n- Human-readable and JSON output available","status":"closed","priority":3,"type":"epic","labels":["ci","monitoring","quality"],"created_at":"2025-11-26 23:37","updated_at":"2025-12-15 16:09","closed_at":"2025-12-15 16:09","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-52t.1","title":"Implement baseline storage and management","description":".bv/baseline.json stores metrics snapshot. --save-baseline creates. --baseline-info shows. Includes commit annotation.","status":"closed","priority":3,"type":"task","labels":["drift","storage"],"created_at":"2025-11-26 23:41","updated_at":"2025-12-15 16:09","closed_at":"2025-12-15 16:09","blocks":["bv-52t.2"],"pagerank":0.003798240094886169,"betweenness":0,"eigenvector":0,"hub":0,"authority":4.7854460253878835e-21,"critical_path":3,"in_degree":1,"out_degree":0,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-52t.2","title":"Create drift calculator with thresholds","description":"Compare current to baseline. Detect: new cycles (critical), PageRank changes (warning), density growth (info). Configurable thresholds in .bv/drift.yaml.","status":"closed","priority":3,"type":"task","labels":["analysis","drift"],"created_at":"2025-11-26 23:41","updated_at":"2025-12-15 16:09","closed_at":"2025-12-15 16:09","blocked_by":["bv-52t.1"],"blocks":["bv-52t.3"],"pagerank":0.002731484890410988,"betweenness":1,"eigenvector":0,"hub":7.890898495503672e-22,"authority":4.7854460253878835e-21,"critical_path":2,"in_degree":1,"out_degree":1,"core_number":1,"slack":12,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-52t.3","title":"Add --check-drift CLI for CI integration","description":"Exit codes: 0=OK, 1=critical, 2=warning. Human-readable and --robot-drift JSON output. CI example in docs.","status":"closed","priority":3,"type":"task","labels":["ci","cli","drift"],"created_at":"2025-11-26 23:41","updated_at":"2025-12-15 16:09","closed_at":"2025-12-15 16:09","blocked_by":["bv-52t.2"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":7.890898495503672e-22,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-53","title":"Robot UX hardening for agents","description":"Epic to make bv robot commands deterministic, complete, and agent-friendly: expose full metrics, surface status/timeout info, reuse analysis across commands, deterministic ordering, safer diff defaults, clear schemas/docs, payload modes, hash/config metadata, and robust contract tests.","status":"closed","priority":1,"type":"epic","labels":null,"created_at":"2025-12-15 15:29","updated_at":"2025-12-15 23:15","closed_at":"2025-12-15 23:15","blocks":["bv-143","bv-174"],"pagerank":0.0036057400600334752,"betweenness":0,"eigenvector":0,"hub":0,"authority":0.00003164180898440157,"critical_path":4,"in_degree":2,"out_degree":0,"core_number":2,"slack":11,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-53.1","title":"Expose full robot-insights metric maps with schema controls","description":"Problem: robot-insights JSON only includes top lists because GraphStats stores metrics in unexported maps; agents can‚Äôt look up per-issue scores. Deliverables: export or copy metric maps into an exported struct; include optional size controls (e.g., --insights-maps=all|topK|none, --insights-limit N); keep defaults safe; document field names/units. Consider payload size on large graphs and offer opt-in for full maps.","notes":"Robot insights now includes full metric maps (capped, env-tunable) plus status/config/hash; added strconv import. Tests pass.","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-15 15:29","updated_at":"2025-12-15 17:56","closed_at":"2025-12-15 17:53","blocks":["bv-58","bv-59","bv-61"],"pagerank":0.0027684626921175987,"betweenness":0,"eigenvector":0,"hub":0,"authority":3.307916831340306e-7,"critical_path":3,"in_degree":3,"out_degree":0,"core_number":2,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-54","title":"Surface metric status/timeouts in robot outputs","description":"Problem: timeouts/approximations are hidden from robot outputs; agents can‚Äôt tell if PageRank/Betweenness/HITS/cycles are partial. Deliverables: add exported MetricsStatus per metric (state=computed|approx|timeout|skipped, elapsed ms, sample size, skip reason), include in robot-insights and headers of plan/priority/diff where relevant; document semantics. Keep payload small (enums).","notes":"Robot plan/priority now include MetricStatus; correlation path hints recognize 'tests' keyword to satisfy expectations. All tests/vet green.","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-15 15:30","updated_at":"2025-12-15 19:17","closed_at":"2025-12-16 00:15","blocks":["bv-130","bv-58","bv-59","bv-60","bv-61"],"pagerank":0.004305873661378339,"betweenness":0,"eigenvector":0,"hub":0,"authority":4.061937085386938e-7,"critical_path":4,"in_degree":5,"out_degree":0,"core_number":3,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-55","title":"Reuse analysis/cache across robot commands","description":"Problem: each robot flag builds a new Analyzer; sequential calls recompute metrics and can diverge on timeouts. Deliverables: shared cached analyzer for robot invocations keyed by issues hash; optional --force-recompute; include hash in outputs; tests to ensure consistency across robot-insights/plan/priority calls.","notes":"Robot outputs now share cached analyzer across insights/plan/priority; status and metrics reuse same run; go test ./... clean.","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-15 15:30","updated_at":"2025-12-15 18:17","closed_at":"2025-12-15 18:17","blocks":["bv-60","bv-61"],"pagerank":0.0025656725388452733,"betweenness":0,"eigenvector":0,"hub":0,"authority":2.3475602804196125e-7,"critical_path":4,"in_degree":2,"out_degree":0,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-56","title":"Deterministic ordering for tied metric outputs","description":"Problem: getTopItems and other sorts reorder equal-valued items nondeterministically, causing flaky robot outputs. Deliverables: apply secondary key (ID lexicographic) for all metric sorts (insights, recommendations, plan lists where applicable); add regression tests for determinism on equal scores.","notes":"Added deterministic tie-breaks (ID) for metric orderings: insights getTopItems and priority recommendations now stable on equal scores. gofmt + go test ./... clean.","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-15 15:30","updated_at":"2025-12-15 17:15","closed_at":"2025-12-15 17:14","blocks":["bv-61"],"pagerank":0.0016557648983100686,"betweenness":0,"eigenvector":0,"hub":0,"authority":1.906450204055936e-7,"critical_path":2,"in_degree":1,"out_degree":0,"core_number":1,"slack":13,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-57","title":"Safer robot diff defaults","description":"Problem: agents often run --diff-since without --robot-diff and receive human-readable text. Deliverables: auto-select JSON when stdout is non-TTY or BV_ROBOT=1; otherwise emit clear hint/error; include resolved revision info in JSON header; document behavior in help/README.","notes":"Implemented auto JSON diff for non-interactive/BV_ROBOT, added resolved_revision to robot diff output, added stderr notice for TTY; gofmt + tests all pass.","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-15 15:30","updated_at":"2025-12-15 17:01","closed_at":"2025-12-15 17:01","blocks":["bv-58","bv-61"],"pagerank":0.0021409593633920625,"betweenness":0,"eigenvector":0,"hub":0,"authority":2.79892438065606e-7,"critical_path":3,"in_degree":2,"out_degree":0,"core_number":2,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-58","title":"Robot schema and help updates","description":"Problem: robot consumers lack concise, accurate schema docs and jq examples. Deliverables: README robot section + --robot-help additions describing fields, status semantics, payload modes/limits, hashes/config metadata, diff behavior; include sample jq snippets for common agent queries.","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-15 15:31","updated_at":"2025-12-15 19:51","closed_at":"2025-12-16 00:44","blocked_by":["bv-53.1","bv-54","bv-57","bv-60"],"blocks":["bv-181","bv-61"],"pagerank":0.002283268227035605,"betweenness":5,"eigenvector":0,"hub":2.1382923349132472e-7,"authority":0.0000011562296095421299,"critical_path":2,"in_degree":2,"out_degree":4,"core_number":3,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-59","title":"Lightweight vs full robot-insights modes","description":"Goal: keep robot outputs fast on large graphs while preserving detail when requested. Deliverables: --robot-insights mode flag (summary|full) or similar; summary returns top lists + status, full includes metric maps; warn/estimate payload when full on XL graphs; honor size-based config; document behavior.","notes":"Cancelled: insights already performant; no split summary/full mode needed.","status":"closed","priority":3,"type":"task","labels":null,"created_at":"2025-12-15 15:31","updated_at":"2025-12-15 15:33","closed_at":"2025-12-15 15:33","blocked_by":["bv-53.1","bv-54"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":1.215242401127513e-7,"authority":0,"critical_path":1,"in_degree":0,"out_degree":2,"core_number":2,"slack":13,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-5dl","title":"Add Cloudflare Pages deployment support via wrangler","description":"# Add Cloudflare Pages Deployment Support via wrangler\n\n## Context\nCloudflare Pages offers fast global CDN deployment. This task adds support for deploying via the `wrangler` CLI tool, mirroring mcp_agent_mail's approach.\n\n## Requirements\n\n### Advantages of Cloudflare Pages\n- Faster global CDN than GitHub Pages\n- Native _headers file support (no service worker needed)\n- Larger file limits (25MB vs GitHub's soft limits)\n- Preview deployments for branches\n\n### wrangler CLI Operations\n```go\n// pkg/export/cloudflare.go\n\nfunc CheckWranglerInstalled() (bool, error) {\n    _, err := exec.LookPath(\"wrangler\")\n    return err == nil, nil\n}\n\nfunc InstallWrangler() error {\n    // Check npm available\n    if _, err := exec.LookPath(\"npm\"); err != nil {\n        return fmt.Errorf(\"npm required - install Node.js from https://nodejs.org/\")\n    }\n    \n    cmd := exec.Command(\"npm\", \"install\", \"-g\", \"wrangler\")\n    cmd.Stdout = os.Stdout\n    cmd.Stderr = os.Stderr\n    return cmd.Run()\n}\n\nfunc CheckWranglerAuthenticated() (bool, error) {\n    cmd := exec.Command(\"wrangler\", \"whoami\")\n    return cmd.Run() == nil, nil\n}\n\nfunc AuthenticateWrangler() error {\n    cmd := exec.Command(\"wrangler\", \"login\")\n    cmd.Stdin = os.Stdin\n    cmd.Stdout = os.Stdout\n    cmd.Stderr = os.Stderr\n    return cmd.Run()\n}\n```\n\n### Deployment\n```go\nfunc DeployToCloudflarePages(bundlePath string, projectName string) (string, error) {\n    cmd := exec.Command(\"wrangler\", \"pages\", \"deploy\",\n        bundlePath,\n        \"--project-name\", projectName,\n        \"--branch\", \"main\",\n    )\n    \n    output, err := cmd.CombinedOutput()\n    if err != nil {\n        return \"\", fmt.Errorf(\"deployment failed: %s\", output)\n    }\n    \n    // Parse URL from output\n    return parseCloudflareURL(string(output)), nil\n}\n\nfunc parseCloudflareURL(output string) string {\n    // Look for pattern: https://xxx.pages.dev\n    re := regexp.MustCompile(`https://[^\\s]+\\.pages\\.dev[^\\s]*`)\n    match := re.FindString(output)\n    if match != \"\" {\n        return match\n    }\n    return \"\"\n}\n```\n\n### _headers File Generation\nAdd to bundle for COOP/COEP (not needed for our use case, but good practice):\n```\n/*\n  X-Frame-Options: DENY\n  X-Content-Type-Options: nosniff\n  Referrer-Policy: strict-origin-when-cross-origin\n```\n\n### Wizard Integration\nAdd option in deployment target selection:\n```\nWhere do you want to deploy?\n  1. GitHub Pages (create new repository)\n  2. Cloudflare Pages (fast global CDN)  ‚Üê NEW\n  3. Export locally only\n```\n\n## Acceptance Criteria\n- [ ] Detects wrangler installation\n- [ ] Offers npm install if missing\n- [ ] Checks and triggers authentication\n- [ ] Deploys bundle to Cloudflare Pages\n- [ ] Parses and returns deployment URL\n- [ ] Generates _headers file in bundle\n- [ ] Works in wizard flow\n- [ ] Clear error messages for failures\n\n## Notes\n- Priority P3 since GitHub Pages is the primary target\n- Cloudflare requires a Cloudflare account (free tier works)\n- First deploy creates the project automatically","status":"closed","priority":3,"type":"task","labels":["phase-3","static-pages"],"created_at":"2025-12-15 23:08","updated_at":"2025-12-16 11:33","closed_at":"2025-12-16 11:33","blocks":["bv-y5i"],"pagerank":0.0015706037203119501,"betweenness":0,"eigenvector":0,"hub":0,"authority":0.0001967059030531822,"critical_path":3,"in_degree":1,"out_degree":0,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-5fah","title":"Robustness: fix git log header parsing + guard vector index SearchTopK","description":"Two small robustness fixes:\n\n1) Correlation/history parser: git log headers used `|` as a delimiter (e.g. `%H|%aI|...|%s`), which can break if a commit subject contains `|`. Switch to NUL separators (`%x00`) and update header parsing accordingly.\n\n2) Semantic search: `VectorIndex.SearchTopK` can race with entry removal between computing sorted IDs and reading the entries map; guard missing keys.\n\nAcceptance:\n- Correlation extractor/stream use NUL-delimited `--format` and parse accordingly\n- `VectorIndex.SearchTopK` skips missing entries safely\n- `go test ./...` passes\n","notes":"Implemented robustness fixes:\n- Correlation/history git log parsing now uses NUL separators (`%x00`) in `--format` and splits on `","status":"closed","priority":2,"type":"bug","labels":["correlation","robustness","search"],"created_at":"2025-12-16 18:38","updated_at":"2025-12-16 18:39","closed_at":"2025-12-16 18:39","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-5h6q","title":"Epic Emoji Inconsistent Across Codebase (VS-16 Issues)","description":"## Problem Statement\n\nThe epic issue type uses inconsistent emoji across the codebase. Some files use the mountain emoji with VS-16 variation selector (causes terminal width issues), while others were updated to use the rocket emoji. This inconsistency causes column misalignment in some terminal emulators.\n\n## User Impact\n\n**Severity: Medium (P2)**\n- Visual glitch causes column misalignment\n- Affects WezTerm, Alacritty, and other terminals with limited VS-16 support\n- Reported by @ghillb in GitHub Issue #6 with excellent technical analysis\n- Also affects keyboard emoji in help overlay per @rbergman\n\n## Root Cause Analysis\n\n### The VS-16 Problem\n\nUnicode Variation Selector-16 (U+FE0F) requests emoji presentation. The mountain emoji:\n- With VS-16: U+1F3D4 U+FE0F renders as 3 cells in many terminals\n- Without VS-16: U+1F3D4 renders as 2 cells consistently\n\nWezTerm has documented 0% VS-16 support, causing the emoji to occupy incorrect width.\n\n### Current Inconsistency\n\n**Already fixed (uses rocket):**\n- `pkg/ui/theme.go:108-110`: Returns \"rocket\" with comment explaining VS-16 issue\n\n**Still broken (uses mountain with VS-16):**\n- `pkg/ui/model.go:2596`: GetTypeIconMD() returns \"mountain\"\n- `pkg/export/markdown.go:323`: getTypeEmoji() returns \"mountain\"\n- Various tests reference the old emoji\n\n```\n  üìã P1 OPEN proj-abc Task item...\n  üìã P1 OPEN proj-def Another task...\n  üèîÔ∏è  P1 OPEN proj-ghi Epic item...  ‚Üê misaligned (3 cells)\n  ‚ú® P2 OPEN proj-jkl Feature...\n```\n\n## Proposed Solution\n\n### 1. Audit all emoji usage\n\nSearch for problematic emojis across codebase:\n- Mountain: U+1F3D4 (üèîÔ∏è with or without VS-16)\n- Keyboard: U+2328 U+FE0F (‚å®Ô∏è in help overlay)\n- Any other emojis with VS-16\n\n### 2. Standardize to VS-16-free versions\n\n```go\n// theme.go already does this:\ncase \"epic\":\n    return \"rocket\", t.Epic  // No VS-16\n\n// Update model.go GetTypeIconMD():\nfunc GetTypeIconMD(typ string) string {\n    switch typ {\n    case \"epic\":\n        return \"rocket\"  // Changed from mountain\n    // ...\n    }\n}\n\n// Update export/markdown.go getTypeEmoji():\nfunc getTypeEmoji(typ string) string {\n    switch typ {\n    case \"epic\":\n        return \"rocket\"  // Changed from mountain\n    // ...\n    }\n}\n```\n\n### 3. Update tests\n\nEnsure all test expectations use the new emoji.\n\n### 4. Document emoji choices\n\nAdd comment in theme.go explaining why certain emojis are chosen and what to avoid.\n\n## Design Considerations\n\n1. **Which emoji for epic?**\n   - Current fix uses rocket (no VS-16 issues)\n   - Could use books (üìö) as suggested in issue\n   - Rocket makes sense: launch, major milestone\n   - **Decision**: Stick with rocket for consistency with theme.go fix\n\n2. **Should we strip VS-16 programmatically?**\n   - Could filter emojis at render time\n   - Adds complexity for edge case\n   - **Decision**: Use VS-16-free emojis directly (simpler)\n\n## Test Plan\n\n1. Verify all emoji definitions use VS-16-free versions\n2. Run grep/search for U+FE0F patterns\n3. Manual test in WezTerm (0% VS-16 support)\n4. Verify column alignment with mixed issue types\n\n## Acceptance Criteria\n\n- [ ] All epic emojis use rocket (or chosen alternative)\n- [ ] No VS-16 (U+FE0F) in any emoji definitions\n- [ ] Columns align correctly in WezTerm\n- [ ] Tests updated to expect new emojis\n- [ ] Documentation added explaining emoji guidelines\n\n## References\n\n- GitHub Issue #6: https://github.com/Dicklesworthstone/beads_viewer/issues/6\n- WezTerm VS-16 issue: https://github.com/wezterm/wezterm/issues/3923\n- Unicode VS-16 terminal support: https://www.jeffquast.com/post/ucs-detect-test-results/\n- WezTerm UCS detection results (0% VS-16): https://ucs-detect.readthedocs.io/sw_results/wezterm.html","status":"closed","priority":2,"type":"bug","labels":["display","gh-issue-6"],"created_at":"2025-12-15 23:53","updated_at":"2025-12-16 10:46","closed_at":"2025-12-16 10:46","blocks":["bv-uqoh"],"pagerank":0.0016019788987050227,"betweenness":0,"eigenvector":0,"hub":0,"authority":9.324854925833239e-9,"critical_path":2,"in_degree":1,"out_degree":0,"core_number":1,"slack":13,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-5mgw","title":"Rust WASM Graph Engine for Static Viewer","description":"# Rust WASM Graph Engine for Static Viewer\n\n## Overview\nAdd a Rust-compiled WASM module to the static viewer that enables **live graph calculations** on filtered data. Since we're already shipping sql.js WASM for database queries, adding a graph WASM module is a natural extension that unlocks powerful interactive features impossible with pre-computed data.\n\n## Motivation: Why WASM for Graph Calculations?\n\n### The Limitation of Pre-Computed Metrics\nThe current static export computes all graph metrics (PageRank, betweenness, etc.) at export time and stores them in SQLite. This works well for full-dataset views, but falls short when users:\n\n1. **Filter to a subset**: PageRank of issues in the \"auth\" label ‚â† pre-computed PageRank\n2. **Ask \"what-if\" questions**: \"If I close bv-123, what unblocks?\"\n3. **Explore dependencies**: \"Show me the critical path for just P1 issues\"\n4. **Analyze subgraphs**: \"Are there cycles within just the API work?\"\n\n### What Rust WASM Enables\nWith client-side graph computation, the static viewer can:\n\n- **Live PageRank**: Recompute centrality on any filtered subset\n- **What-If Simulation**: Preview cascade effects before closing issues\n- **Subgraph Analysis**: Detect cycles, critical paths within filtered views\n- **Impact Preview**: Hover to see downstream effects\n- **Dynamic Exploration**: \"What gets unblocked if I close these 3 issues?\"\n\n### Performance Comparison (estimated on 1000-node graph)\n| Algorithm | JavaScript | Rust WASM | Speedup |\n|-----------|-----------|-----------|---------|\n| PageRank | ~200ms | ~5ms | 40x |\n| Betweenness | ~2000ms | ~50ms | 40x |\n| Cycle Detection | ~500ms | ~10ms | 50x |\n| Critical Path | ~100ms | ~3ms | 33x |\n| Topological Sort | ~50ms | ~2ms | 25x |\n\n### Bundle Size Impact\n- **bv_graph_bg.wasm**: ~80-120KB (wasm-opt optimized)\n- **bv_graph.js**: ~15KB (wasm-bindgen glue)\n- **Total**: ~100-135KB (acceptable; sql-wasm.wasm is ~1MB)\n\n## Technical Architecture\n\n### Rust Crate Structure\n```\nbv-graph-wasm/\n  Cargo.toml\n  src/\n    lib.rs              # WASM bindings via wasm-bindgen\n    graph.rs            # Core DiGraph structure with adjacency lists\n    algorithms/\n      mod.rs\n      pagerank.rs       # PageRank with damping factor\n      betweenness.rs    # Exact + approximate (Brandes sampling)\n      eigenvector.rs    # Power iteration\n      hits.rs           # Hub/Authority scores\n      topo.rs           # Topological sort, Kahn's algorithm\n      cycles.rs         # Tarjan SCC + cycle enumeration\n      critical_path.rs  # Heights/depths in DAG\n      kcore.rs          # K-core decomposition\n      articulation.rs   # Tarjan's cut vertices\n      slack.rs          # Critical path slack\n    whatif.rs           # What-if simulation API\n    subgraph.rs         # Subgraph extraction, reachability\n  tests/\n    integration_test.rs # Cross-algorithm tests\n```\n\n### WASM Interface Design\n```rust\n#[wasm_bindgen]\npub struct DiGraph {\n    nodes: Vec\u003cString\u003e,           // Node ID strings\n    node_index: HashMap\u003cString, usize\u003e,\n    adj: Vec\u003cVec\u003cusize\u003e\u003e,         // Forward adjacency\n    rev_adj: Vec\u003cVec\u003cusize\u003e\u003e,     // Reverse adjacency\n}\n\n#[wasm_bindgen]\nimpl DiGraph {\n    #[wasm_bindgen(constructor)]\n    pub fn new() -\u003e DiGraph;\n    \n    // Graph construction\n    pub fn add_node(\u0026mut self, id: \u0026str) -\u003e usize;\n    pub fn add_edge(\u0026mut self, from: usize, to: usize);\n    pub fn node_count(\u0026self) -\u003e usize;\n    pub fn edge_count(\u0026self) -\u003e usize;\n    \n    // Algorithms (return JSON for complex types)\n    pub fn pagerank(\u0026self, damping: f64, iterations: u32) -\u003e Vec\u003cf64\u003e;\n    pub fn betweenness(\u0026self) -\u003e Vec\u003cf64\u003e;\n    pub fn betweenness_approx(\u0026self, sample_size: usize) -\u003e Vec\u003cf64\u003e;\n    pub fn eigenvector(\u0026self, iterations: u32) -\u003e Vec\u003cf64\u003e;\n    pub fn hits(\u0026self, iterations: u32) -\u003e JsValue; // {hubs: [], authorities: []}\n    pub fn topological_sort(\u0026self) -\u003e Vec\u003cusize\u003e;\n    pub fn detect_cycles(\u0026self) -\u003e JsValue; // [[cycle1], [cycle2], ...]\n    pub fn critical_path_heights(\u0026self) -\u003e Vec\u003cf64\u003e;\n    pub fn kcore(\u0026self) -\u003e Vec\u003cu32\u003e;\n    pub fn articulation_points(\u0026self) -\u003e Vec\u003cusize\u003e;\n    pub fn slack(\u0026self) -\u003e Vec\u003cf64\u003e;\n    \n    // Subgraph operations\n    pub fn subgraph(\u0026self, node_indices: \u0026[usize]) -\u003e DiGraph;\n    pub fn reachable_from(\u0026self, node: usize) -\u003e Vec\u003cusize\u003e;\n    pub fn reachable_to(\u0026self, node: usize) -\u003e Vec\u003cusize\u003e;\n    \n    // What-if simulation\n    pub fn what_if_close(\u0026self, node: usize) -\u003e JsValue; // {direct, transitive, ids}\n}\n```\n\n### JavaScript Integration\n```javascript\nimport init, { DiGraph } from './vendor/bv_graph.js';\n\nlet GRAPH_ENGINE = null;\n\nasync function initGraphEngine() {\n    await init();\n    GRAPH_ENGINE = new DiGraph();\n    \n    // Load edges from SQLite\n    const deps = db.exec('SELECT issue_id, depends_on_id FROM dependencies');\n    const nodeMap = new Map();\n    \n    for (const [from, to] of deps[0].values) {\n        if (!nodeMap.has(from)) nodeMap.set(from, GRAPH_ENGINE.add_node(from));\n        if (!nodeMap.has(to)) nodeMap.set(to, GRAPH_ENGINE.add_node(to));\n        GRAPH_ENGINE.add_edge(nodeMap.get(from), nodeMap.get(to));\n    }\n    \n    return nodeMap;\n}\n\n// Live recalculation example\nfunction recalculateForFilter(filteredIds) {\n    const indices = filteredIds.map(id =\u003e NODE_MAP.get(id)).filter(Boolean);\n    const subgraph = GRAPH_ENGINE.subgraph(indices);\n    \n    return {\n        pagerank: subgraph.pagerank(0.85, 100),\n        cycles: JSON.parse(subgraph.detect_cycles()),\n        criticalPath: subgraph.critical_path_heights(),\n    };\n}\n```\n\n## Implementation Phases\n\n### Phase 1: Core Infrastructure\n- Set up Rust workspace with wasm-bindgen\n- Implement DiGraph structure with adjacency lists\n- Add wasm-pack build pipeline\n- Integrate into bv build system\n\n### Phase 2: Algorithm Porting (from pkg/analysis/graph.go)\n- Port PageRank (power iteration)\n- Port Betweenness (exact + approximate)\n- Port Eigenvector centrality\n- Port HITS algorithm\n- Port Topological sort\n- Port Cycle detection (Tarjan SCC + enumeration)\n- Port Critical path heights\n- Port K-core decomposition\n- Port Articulation points\n- Port Slack computation\n\n### Phase 3: Advanced Operations\n- Subgraph extraction\n- Reachability queries (from/to)\n- What-if simulation API\n\n### Phase 4: JavaScript Integration\n- Initialize from SQLite data\n- Live recalculation hooks\n- Fallback for WASM failures\n- Performance monitoring\n\n### Phase 5: UI Features\n- \"Recalculate\" button for filtered views\n- \"What-If\" panel for impact analysis\n- Live metrics updates on filter change\n- Subgraph highlighting\n\n### Phase 6: Testing \u0026 Optimization\n- Port Go tests to Rust\n- Cross-validate with Go implementation\n- JavaScript integration tests\n- wasm-opt size optimization\n- Benchmarks\n\n## Fallback Strategy\nIf WASM fails to load (old browser, security policy, etc.):\n1. Use pre-computed values from SQLite\n2. Disable live recalculation features\n3. Show \"Limited Mode\" indicator\n4. Graceful degradation - everything still works, just no live updates\n\n## Success Criteria\n1. WASM module loads reliably across browsers\n2. PageRank on 1000 nodes completes in \u003c50ms\n3. All algorithms match Go implementation results\n4. Bundle size increase \u003c150KB\n5. Fallback works when WASM unavailable\n6. Live recalculation enabled in filtered views\n\n## References\n- bv pkg/analysis/graph.go: Go implementations to port\n- bv pkg/analysis/betweenness_approx.go: Approximate betweenness\n- bv pkg/analysis/whatif.go: What-if simulation patterns\n- wasm-bindgen: https://rustwasm.github.io/wasm-bindgen/\n- wasm-pack: https://rustwasm.github.io/wasm-pack/","status":"closed","priority":1,"type":"epic","labels":["graph","static-pages","wasm"],"created_at":"2025-12-15 23:31","updated_at":"2025-12-16 10:32","closed_at":"2025-12-16 10:32","blocks":["bv-b23i","bv-y5i"],"pagerank":0.0021981070490374862,"betweenness":0,"eigenvector":0,"hub":0,"authority":0.00020623614688033466,"critical_path":3,"in_degree":2,"out_degree":0,"core_number":2,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-5yb","title":"Implement issues list view with filtering and sorting","description":"# Implement Issues List with SQL-Powered Filtering\n\n## Context\nThe issues list queries the SQLite database using sql.js, enabling powerful filtering and sorting without loading all data into memory.\n\n## Requirements\n\n### SQL-Powered Filtering\n```javascript\nfunction buildIssueQuery(filters, sort, limit, offset) {\n  let sql = `SELECT * FROM issue_overview_mv WHERE 1=1`;\n  const params = [];\n  \n  // Status filter\n  if (filters.status?.length) {\n    sql += ` AND status IN (${filters.status.map(() =\u003e '?').join(',')})`;\n    params.push(...filters.status);\n  }\n  \n  // Type filter\n  if (filters.type?.length) {\n    sql += ` AND issue_type IN (${filters.type.map(() =\u003e '?').join(',')})`;\n    params.push(...filters.type);\n  }\n  \n  // Priority filter\n  if (filters.priority?.length) {\n    sql += ` AND priority IN (${filters.priority.map(() =\u003e '?').join(',')})`;\n    params.push(...filters.priority);\n  }\n  \n  // Label filter (JSON array contains)\n  if (filters.labels?.length) {\n    const labelClauses = filters.labels.map(() =\u003e `labels LIKE ?`);\n    sql += ` AND (${labelClauses.join(' OR ')})`;\n    params.push(...filters.labels.map(l =\u003e `%\"${l}\"%`));\n  }\n  \n  // Assignee filter\n  if (filters.assignee) {\n    sql += ` AND assignee = ?`;\n    params.push(filters.assignee);\n  }\n  \n  // Blocked/blocking filter\n  if (filters.hasBlockers === true) {\n    sql += ` AND blocked_by_count \u003e 0`;\n  } else if (filters.hasBlockers === false) {\n    sql += ` AND blocked_by_count = 0`;\n  }\n  \n  // Full-text search\n  if (filters.search) {\n    sql += ` AND id IN (SELECT id FROM issues_fts WHERE issues_fts MATCH ?)`;\n    params.push(filters.search + '*');\n  }\n  \n  // Sorting\n  sql += ` ORDER BY ${getSortClause(sort)}`;\n  \n  // Pagination\n  sql += ` LIMIT ? OFFSET ?`;\n  params.push(limit, offset);\n  \n  return { sql, params };\n}\n\nfunction getSortClause(sort) {\n  const clauses = {\n    'priority': 'priority ASC, triage_score DESC',\n    'updated': 'updated_at DESC',\n    'created': 'created_at DESC',\n    'score': 'triage_score DESC',\n    'blocks': 'blocks_count DESC',\n    'title': 'title ASC'\n  };\n  return clauses[sort] || clauses.priority;\n}\n```\n\n### FTS5 Search with Snippets\n```javascript\nfunction searchWithSnippets(term) {\n  return db.exec(`\n    SELECT \n      i.*,\n      snippet(issues_fts, 1, '\u003cmark\u003e', '\u003c/mark\u003e', '...', 32) as title_snippet,\n      snippet(issues_fts, 2, '\u003cmark\u003e', '\u003c/mark\u003e', '...', 64) as desc_snippet,\n      bm25(issues_fts, 1.0, 5.0, 2.0, 1.0, 0.5) as relevance\n    FROM issues_fts fts\n    JOIN issue_overview_mv i ON fts.id = i.id\n    WHERE issues_fts MATCH ?\n    ORDER BY relevance\n    LIMIT 100\n  `, [term + '*']);\n}\n```\n\n### Pagination (not virtual scroll)\n```javascript\nfunction issuesList() {\n  return {\n    page: 1,\n    pageSize: 50,\n    totalCount: 0,\n    \n    get offset() { return (this.page - 1) * this.pageSize; },\n    get totalPages() { return Math.ceil(this.totalCount / this.pageSize); },\n    \n    async loadPage() {\n      const { sql, params } = buildIssueQuery(\n        Alpine.store('app').filters,\n        Alpine.store('app').sort,\n        this.pageSize,\n        this.offset\n      );\n      \n      const results = db.exec(sql, params);\n      this.issues = results[0]?.values || [];\n      \n      // Get total count for pagination\n      const countSql = sql.replace(/SELECT \\*/, 'SELECT COUNT(*)').replace(/LIMIT.*/, '');\n      this.totalCount = db.exec(countSql, params.slice(0, -2))[0]?.values[0][0] || 0;\n    },\n    \n    nextPage() {\n      if (this.page \u003c this.totalPages) {\n        this.page++;\n        this.loadPage();\n      }\n    },\n    \n    prevPage() {\n      if (this.page \u003e 1) {\n        this.page--;\n        this.loadPage();\n      }\n    }\n  };\n}\n```\n\n### Stats Query\n```javascript\nfunction getStats() {\n  const results = db.exec(`\n    SELECT \n      COUNT(*) as total,\n      SUM(CASE WHEN status = 'open' THEN 1 ELSE 0 END) as open,\n      SUM(CASE WHEN status = 'in_progress' THEN 1 ELSE 0 END) as in_progress,\n      SUM(CASE WHEN status = 'blocked' THEN 1 ELSE 0 END) as blocked,\n      SUM(CASE WHEN status = 'closed' THEN 1 ELSE 0 END) as closed,\n      SUM(CASE WHEN blocked_by_count = 0 AND status != 'closed' THEN 1 ELSE 0 END) as actionable\n    FROM issue_overview_mv\n  `);\n  return results[0]?.values[0] || [];\n}\n```\n\n### URL State Sync\n```javascript\nfunction syncFiltersToURL(filters) {\n  const params = new URLSearchParams();\n  if (filters.status?.length) params.set('status', filters.status.join(','));\n  if (filters.type?.length) params.set('type', filters.type.join(','));\n  if (filters.priority?.length) params.set('priority', filters.priority.join(','));\n  if (filters.labels?.length) params.set('labels', filters.labels.join(','));\n  if (filters.search) params.set('q', filters.search);\n  \n  const hash = `#/issues${params.toString() ? '?' + params : ''}`;\n  history.replaceState(null, '', hash);\n}\n\nfunction loadFiltersFromURL() {\n  const hash = window.location.hash.slice(1);\n  const [path, query] = hash.split('?');\n  if (!query) return {};\n  \n  const params = new URLSearchParams(query);\n  return {\n    status: params.get('status')?.split(',').filter(Boolean) || [],\n    type: params.get('type')?.split(',').filter(Boolean) || [],\n    priority: params.get('priority')?.split(',').map(Number).filter(n =\u003e !isNaN(n)) || [],\n    labels: params.get('labels')?.split(',').filter(Boolean) || [],\n    search: params.get('q') || ''\n  };\n}\n```\n\n## UI Layout (same as before but simpler)\nFilter controls at top, paginated list below, no virtual scrolling complexity.\n\n## Acceptance Criteria\n- [ ] SQL queries return filtered results correctly\n- [ ] FTS5 search works with highlighting\n- [ ] All filter types work (status, type, priority, labels, assignee)\n- [ ] Sorting by all options works\n- [ ] Pagination works smoothly\n- [ ] URL reflects filter state\n- [ ] Filters restore from URL on load\n- [ ] Clear filters button\n- [ ] Shows \"X of Y issues\" count\n- [ ] Mobile: collapsible filter panel\n\n## Performance\n- Query execution: \u003c50ms for any filter combination\n- Page load: \u003c100ms after database cached\n- No need for virtual scroll - pagination handles scale","status":"closed","priority":2,"type":"task","labels":["phase-2","static-pages"],"created_at":"2025-12-15 23:06","updated_at":"2025-12-16 03:23","closed_at":"2025-12-16 03:23","blocked_by":["bv-jdl","bv-w97"],"blocks":["bv-awl","bv-gv7","bv-y5i"],"pagerank":0.002905616992104491,"betweenness":3,"eigenvector":0,"hub":0.00013573598174365005,"authority":0.0002389169371777134,"critical_path":4,"in_degree":3,"out_degree":2,"core_number":3,"slack":9,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-60","title":"Include data hash \u0026 analysis config in robot responses","description":"Goal: let agents correlate multiple robot calls and detect cache reuse or config changes. Deliverables: add data_hash, computed_at, and analysis config (size tier, approximations, timeouts) to robot outputs (insights/plan/priority/diff). Ensure hash matches cache reuse path; keep fields compact.","notes":"Added data_hash + analysis_config to robot outputs (insights/plan/priority); robot insights now embeds fields without breaking prior keys. Robot diff JSON includes resolved_revision and hashes for from/to. Added blocking-edge count helper. Tests: go test ./...","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-15 15:31","updated_at":"2025-12-15 17:40","closed_at":"2025-12-15 17:39","blocked_by":["bv-55","bv-54"],"blocks":["bv-58","bv-61"],"pagerank":0.0021409593633920625,"betweenness":2,"eigenvector":0,"hub":1.0568856665075053e-7,"authority":2.79892438065606e-7,"critical_path":3,"in_degree":2,"out_degree":2,"core_number":3,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-61","title":"Robot contract test suite","description":"Goal: lock in robot behavior and prevent regressions. Deliverables: snapshot JSON tests for robot-insights/plan/priority/diff on small fixtures; large-graph smoke to assert modes/limits/timeouts and status flags; deterministic ordering tests; cache reuse/hash consistency tests. Ensure fixtures minimal and updated alongside schema changes.","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-15 15:31","updated_at":"2025-12-15 20:03","closed_at":"2025-12-16 00:55","blocked_by":["bv-53.1","bv-54","bv-55","bv-56","bv-57","bv-58","bv-60"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":4.746301476247504e-7,"authority":0,"critical_path":1,"in_degree":0,"out_degree":7,"core_number":3,"slack":11,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-61hu","title":"Performance: Large graph rendering benchmarks","description":"Performance testing for graph visualization at scale.\n\n## Benchmark Scenarios\n1. **Layout Performance**\n   - 100 nodes, sparse\n   - 100 nodes, dense\n   - 500 nodes, sparse\n   - 1000 nodes (stress)\n\n2. **Rendering Performance**\n   - ASCII rendering time\n   - SVG generation time\n   - Initial layout time\n   - Re-layout on change\n\n3. **Memory Usage**\n   - Peak during layout\n   - Steady state\n   - Per-node overhead\n\n4. **Interactive Performance**\n   - Frame rate during pan\n   - Selection latency\n   - Resize handling\n\n## Success Criteria\n- 100 nodes: \u003c100ms layout\n- 500 nodes: \u003c500ms layout\n- 1000 nodes: \u003c2s layout (or fail gracefully)\n- 60fps pan on \u003c200 nodes\n\n## Implementation\n- Extend benchmark.sh\n- Add graph-specific benchmarks\n- Track trends over time\n- Alert on regression","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-16 20:10","updated_at":"2025-12-17 01:51","closed_at":"2025-12-17 01:51","blocked_by":["bv-7bob"],"blocks":["bv-evyl"],"pagerank":0.0016290932344603455,"betweenness":0,"eigenvector":0,"hub":1.5796797762123116e-8,"authority":7.205652148943102e-8,"critical_path":3,"in_degree":1,"out_degree":1,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-62","title":"Bead History \u0026 Code Correlation System","description":"# Bead History \u0026 Code Correlation System\n\n## Overview\nImplement a system to track the full lifecycle of beads (creation, claim, modification, closure) and correlate them with the git commits that implemented the work. This enables traceability from issue to code without requiring LLM inference.\n\n## User Stories\n- As a project lead, I want to see what code changes were made for each bead\n- As a developer, I want to know which bead drove a particular commit\n- As an AI agent, I want structured JSON data about bead-to-commit relationships\n- As a code reviewer, I want to understand the context behind changes\n\n## The Core Insight\nThe git history of beads.jsonl IS the source of truth:\n1. **Exact timestamps** - when each bead was created, modified, closed\n2. **Git author** - the agent/person who made each change  \n3. **Commit SHA** - links to all other files changed in that commit\n\nThis creates a direct, mechanical correlation chain with no LLM needed.\n\n## Correlation Methods (by confidence)\n| Method | Confidence | Description |\n|--------|------------|-------------|\n| co_committed | 95-99% | Code changed in same commit as bead status change |\n| explicit_id | 90-95% | Commit message contains bead ID |\n| temporal_author | 40-70% | Same author, within bead's active window |\n\n## Success Criteria\n- [ ] \\`bv --robot-history\\` outputs structured JSON of all correlations\n- [ ] \\`bv --bead-history \u003cid\u003e\\` shows history for a specific bead\n- [ ] TUI shows history in detail pane and dedicated view\n- [ ] Co-committed correlations have \u003e95% accuracy\n- [ ] Performance: \u003c2s for repos with 1000 commits\n\n## Non-Goals (for initial release)\n- Real-time commit watching (future enhancement)\n- GitHub/GitLab PR integration (future enhancement)\n- Automatic bead creation from commits (different feature)\n\n## Implementation Phases\n1. **Phase 1 (MVP)**: Core extraction + robot-history flag\n2. **Phase 2**: Additional correlation methods + confidence scoring\n3. **Phase 3**: TUI integration\n4. **Phase 4**: Performance optimization\n5. **Phase 5**: Testing and documentation\n\nSee docs/bead-history-feature-plan.md for complete specification.","status":"closed","priority":1,"type":"epic","labels":["epic","feature","history","v0.11"],"created_at":"2025-12-15 15:36","updated_at":"2025-12-15 23:15","closed_at":"2025-12-15 23:15","blocks":["bv-163"],"pagerank":0.0020214909248175974,"betweenness":0,"eigenvector":0,"hub":0,"authority":0.0019617485229367713,"critical_path":4,"in_degree":1,"out_degree":0,"core_number":1,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-63","title":"Define data types for bead history correlation","description":"# Data Types for Bead History Correlation\n\n## Context\nThis is the foundational task - all other history features depend on these types being well-designed. Getting this right is critical.\n\n## Types to Define\n\n### BeadEvent\nRepresents a single lifecycle event for a bead, extracted from git history.\n\n\\`\\`\\`go\ntype BeadEvent struct {\n    BeadID      string    \\`json:\"bead_id\"\\`\n    EventType   EventType \\`json:\"event_type\"\\`\n    Timestamp   time.Time \\`json:\"timestamp\"\\`\n    CommitSHA   string    \\`json:\"commit_sha\"\\`\n    CommitMsg   string    \\`json:\"commit_message\"\\`\n    Author      string    \\`json:\"author\"\\`       // Git author name\n    AuthorEmail string    \\`json:\"author_email\"\\` // Git author email\n}\n\ntype EventType string\nconst (\n    EventCreated  EventType = \"created\"      // Bead first appears in file\n    EventClaimed  EventType = \"claimed\"      // Status changed to in_progress\n    EventClosed   EventType = \"closed\"       // Status changed to closed\n    EventReopened EventType = \"reopened\"     // Status changed FROM closed\n    EventModified EventType = \"modified\"     // Other significant changes\n)\n\\`\\`\\`\n\n### CorrelatedCommit\nA code commit linked to a bead with confidence metadata.\n\n\\`\\`\\`go\ntype CorrelatedCommit struct {\n    SHA           string            \\`json:\"sha\"\\`\n    ShortSHA      string            \\`json:\"short_sha\"\\`\n    Message       string            \\`json:\"message\"\\`\n    Author        string            \\`json:\"author\"\\`\n    AuthorEmail   string            \\`json:\"author_email\"\\`\n    Timestamp     time.Time         \\`json:\"timestamp\"\\`\n    Files         []FileChange      \\`json:\"files\"\\`\n    Method        CorrelationMethod \\`json:\"method\"\\`\n    Confidence    float64           \\`json:\"confidence\"\\`\n    Reason        string            \\`json:\"reason\"\\`\n}\n\ntype FileChange struct {\n    Path       string \\`json:\"path\"\\`\n    Action     string \\`json:\"action\"\\`     // A=added, M=modified, D=deleted\n    Insertions int    \\`json:\"insertions\"\\`\n    Deletions  int    \\`json:\"deletions\"\\`\n}\n\ntype CorrelationMethod string\nconst (\n    MethodCoCommitted    CorrelationMethod = \"co_committed\"\n    MethodExplicitID     CorrelationMethod = \"explicit_id\"\n    MethodTemporalAuthor CorrelationMethod = \"temporal_author\"\n)\n\\`\\`\\`\n\n### BeadHistory\nThe complete correlation record for a single bead.\n\n### HistoryReport\nThe top-level output structure for --robot-history.\n\n## Design Decisions\n- Separate Events from milestones (Created/Claimed/Closed) for quick access\n- Include CommitIndex in HistoryReport for O(1) reverse lookup\n- CycleTime as pointer since not all beads have been closed\n\n## File Location\n\\`pkg/correlation/types.go\\`\n\n## Acceptance Criteria\n1. All types compile without errors\n2. JSON tags are consistent and documented\n3. String methods implemented for enum types\n4. Unit tests for serialization roundtrips\n5. Go doc comments on all exported types","status":"closed","priority":1,"type":"task","labels":["foundation","history","phase-1","types"],"created_at":"2025-12-15 15:36","updated_at":"2025-12-15 17:16","closed_at":"2025-12-15 17:16","blocks":["bv-64"],"pagerank":0.010310900804918229,"betweenness":0,"eigenvector":1,"hub":0,"authority":4.7854460253878835e-21,"critical_path":15,"in_degree":1,"out_degree":0,"core_number":1,"slack":0,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-64","title":"Implement git history parser for beads.jsonl","description":"# Git History Parser for beads.jsonl\n\n## Context\nThis is the core extraction logic. We parse \\`git log -p -- .beads/beads.jsonl\\` to extract bead lifecycle events.\n\n## Git Command\n\\`\\`\\`bash\ngit log -p --follow --format=\"%H|%aI|%an|%ae|%s\" -- .beads/beads.jsonl\n\\`\\`\\`\n\n## Parsing Algorithm\n1. Run git log command\n2. Parse output commit by commit\n3. For each commit:\n   a. Parse commit metadata (SHA, timestamp, author, message)\n   b. Parse the diff section\n   c. For each changed line in diff:\n      - Parse old JSON (lines starting with -)\n      - Parse new JSON (lines starting with +)\n      - Detect what changed (new bead, status change, other)\n      - Create BeadEvent records\n4. Return chronologically sorted events\n\n## Diff Parsing Details\n\n### Detecting Bead Creation\n\\`\\`\\`diff\n+{\"id\":\"AUTH-123\",\"title\":\"Fix login\",\"status\":\"open\",...}\n\\`\\`\\`\nA line starting with \\`+\\` containing valid JSON = EventCreated\n\n### Detecting Status Changes\n\\`\\`\\`diff\n-{\"id\":\"AUTH-123\",...,\"status\":\"open\",...}\n+{\"id\":\"AUTH-123\",...,\"status\":\"in_progress\",...}\n\\`\\`\\`\nSame bead ID, different status = appropriate event type\n\n## Edge Cases to Handle\n1. Malformed JSON lines: Skip with warning\n2. Multiple beads changed in one commit: Generate event for each\n3. Empty commits: No events generated\n4. Merge commits: Parse like regular commits\n\n## Options Structure\n\\`\\`\\`go\ntype ExtractOptions struct {\n    Since     time.Time  // Only commits after this time\n    Until     time.Time  // Only commits before this time\n    Limit     int        // Max commits to process\n    BeadID    string     // Filter to single bead ID\n}\n\\`\\`\\`\n\n## File Location\n\\`pkg/correlation/extractor.go\\`\n\n## Acceptance Criteria\n1. Correctly parses sample git log output\n2. Handles all edge cases without panic\n3. Returns chronologically sorted events\n4. Supports filtering options\n5. Unit tests with mock git output","status":"closed","priority":1,"type":"task","labels":["extraction","git","history","phase-1"],"created_at":"2025-12-15 15:37","updated_at":"2025-12-15 17:20","closed_at":"2025-12-15 17:20","blocked_by":["bv-63"],"blocks":["bv-65"],"pagerank":0.010393222573241184,"betweenness":15,"eigenvector":0,"hub":7.890898495503672e-22,"authority":4.7854460253878835e-21,"critical_path":14,"in_degree":1,"out_degree":1,"core_number":1,"slack":0,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-65","title":"Implement co-committed file extraction","description":"# Co-Committed File Extraction\n\n## Context\nThis is the highest-confidence correlation method (95-99%). When a bead status changes and code files change in THE SAME COMMIT, that's a direct causal link.\n\n## Why This Works\nDeveloper workflow:\n1. Write code to implement feature\n2. Mark bead as closed\n3. Commit both changes together\n\nThe code files in that commit ARE the implementation of the bead.\n\n## Git Command\n\\`\\`\\`bash\ngit show --name-status --format=\"\" \u003csha\u003e\n\\`\\`\\`\n\nOutput:\n\\`\\`\\`\nM       pkg/auth/login.go\nM       pkg/auth/session.go\nM       .beads/beads.jsonl\n\\`\\`\\`\n\n## Algorithm\n1. For each BeadEvent with status change (claimed/closed)\n2. Run \\`git show --name-status\\` for that commit\n3. Filter OUT bead files (.beads/*)\n4. Return code files only as CorrelatedCommit records\n\n## What Counts as \"Code Files\"?\nInclude: .go, .py, .js, .ts, .rs, .java, .yaml, .json, .md\nExclude: .beads/*, .bv/*, .git/*, node_modules/, vendor/\n\n## Getting Line Stats\n\\`\\`\\`bash\ngit show --numstat --format=\"\" \u003csha\u003e\n\\`\\`\\`\n\n## Confidence Scoring\nBase: 0.95\n\nAdjustments:\n- Commit message mentions bead ID: +0.04 ‚Üí 0.99\n- \u003e20 files changed (shotgun commit): -0.10 ‚Üí 0.85\n- Only test files changed: -0.05 ‚Üí 0.90\n\n## File Location\n\\`pkg/correlation/cocommit.go\\`\n\n## Acceptance Criteria\n1. Correctly extracts co-committed files for any commit\n2. Filters out bead files and non-code files\n3. Includes insertion/deletion stats\n4. Applies confidence adjustments correctly\n5. Handles commits with no code files gracefully","status":"closed","priority":1,"type":"task","labels":["correlation","high-confidence","history","phase-1"],"created_at":"2025-12-15 15:37","updated_at":"2025-12-15 17:23","closed_at":"2025-12-15 17:23","blocked_by":["bv-64"],"blocks":["bv-66"],"pagerank":0.010490243906621358,"betweenness":28,"eigenvector":0,"hub":7.890898495503672e-22,"authority":4.7854460253878835e-21,"critical_path":13,"in_degree":1,"out_degree":1,"core_number":1,"slack":0,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-66","title":"Add --robot-history CLI flag (MVP)","description":"# Robot History CLI Flag (MVP)\n\n## Context\nThis completes the MVP. With this flag, AI agents can get structured JSON output of bead-to-commit correlations.\n\n## New Flags\n\\`\\`\\`go\nrobotHistory := flag.Bool(\"robot-history\", false,\n    \"Output bead-to-commit correlations as JSON\")\nbeadHistory := flag.String(\"bead-history\", \"\",\n    \"Show history for specific bead ID\")\nhistorySince := flag.String(\"history-since\", \"\",\n    \"Limit history to commits after this date/ref\")\nhistoryLimit := flag.Int(\"history-limit\", 500,\n    \"Max commits to analyze (0 = unlimited)\")\n\\`\\`\\`\n\n## Usage Examples\n\\`\\`\\`bash\n# All bead correlations\nbv --robot-history\n\n# Specific bead\nbv --bead-history AUTH-123\n\n# Last 30 days\nbv --robot-history --history-since \"30 days ago\"\n\\`\\`\\`\n\n## Output Format (HistoryReport JSON)\n\\`\\`\\`json\n{\n  \"generated_at\": \"2025-01-15T10:30:00Z\",\n  \"repo_path\": \"/path/to/repo\",\n  \"correlations\": [\n    {\n      \"bead_id\": \"AUTH-123\",\n      \"bead_title\": \"Fix login race condition\",\n      \"lifecycle\": {...},\n      \"code_commits\": [...]\n    }\n  ],\n  \"commit_index\": {\"ghi9012\": [\"AUTH-123\"]},\n  \"summary\": {\n    \"total_beads\": 58,\n    \"beads_with_correlation\": 45,\n    \"orphan_commits\": 15,\n    \"avg_confidence\": 0.87\n  }\n}\n\\`\\`\\`\n\n## Error Handling\n- If not in git repo: Error with helpful message\n- If beads.jsonl doesn't exist: Error message\n- If git history is empty: Return empty correlations array\n- If specific bead not found: Error with \"bead not found\" message\n\n## Update --robot-help\nAdd documentation for new flags in the robot help output.\n\n## File Location\n- Main logic: \\`cmd/bv/main.go\\` (add flag handling)\n- Correlator: \\`pkg/correlation/correlator.go\\` (orchestration)\n\n## Acceptance Criteria\n1. \\`bv --robot-history\\` outputs valid JSON\n2. \\`bv --bead-history \u003cid\u003e\\` filters to single bead\n3. \\`--history-since\\` and \\`--history-limit\\` work correctly\n4. Error messages are helpful and actionable\n5. \\`--robot-help\\` documents new flags\n6. Integration test with real repo\n\n## Note\nThis completes Phase 1 MVP - AI agents can now get bead-to-commit correlations!","status":"closed","priority":1,"type":"task","labels":["cli","history","mvp","phase-1"],"created_at":"2025-12-15 15:37","updated_at":"2025-12-15 17:46","closed_at":"2025-12-15 17:46","blocked_by":["bv-65"],"blocks":["bv-67","bv-68"],"pagerank":0.010604480095414516,"betweenness":39,"eigenvector":0,"hub":7.890898495503672e-22,"authority":3.920237383997754e-17,"critical_path":12,"in_degree":2,"out_degree":1,"core_number":2,"slack":0,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-67","title":"Implement explicit bead ID matching in commit messages","description":"# Explicit Bead ID Matching\n\n## Context\nMany developers include bead/issue IDs in commit messages:\n- \"fix(auth): resolve login bug [AUTH-123]\"\n- \"Closes AUTH-123\"\n- \"Refs: beads-456, beads-789\"\n\nThis is high-confidence (90-95%) because the developer explicitly linked them.\n\n## Pattern Matching\n\\`\\`\\`go\nvar beadIDPatterns = []*regexp.Regexp{\n    // [ID] format\n    regexp.MustCompile(\\`\\\\[([A-Z]+-\\\\d+)\\\\]\\`),\n    \n    // Closes/Fixes/Refs keywords\n    regexp.MustCompile(\\`(?i)closes?\\\\s+#?([A-Z]+-\\\\d+)\\`),\n    regexp.MustCompile(\\`(?i)fix(?:es|ed)?\\\\s+#?([A-Z]+-\\\\d+)\\`),\n    regexp.MustCompile(\\`(?i)refs?\\\\s+#?([A-Z]+-\\\\d+)\\`),\n    \n    // beads-123 format\n    regexp.MustCompile(\\`(?i)beads?[-_](\\\\d+)\\`),\n    \n    // Generic ID at word boundary\n    regexp.MustCompile(\\`\\\\b([A-Z]{2,10}-\\\\d+)\\\\b\\`),\n}\n\\`\\`\\`\n\n## Finding Commits with Explicit References\n\\`\\`\\`bash\ngit log --grep=\"AUTH-123\" --format=\"%H|%aI|%an|%ae|%s\" --all\n\\`\\`\\`\n\n## Confidence Scoring\nBase: 0.90\n\nAdjustments:\n- \"Closes\" or \"Fixes\" keyword: +0.05 ‚Üí 0.95\n- Multiple IDs in message: -0.02 per extra ID\n- ID in brackets [AUTH-123]: +0.02\n\n## Avoiding Duplicates\nIf already correlated via co-committed, don't add explicit-id duplicate.\nIf both methods apply, keep co-committed (higher confidence).\n\n## Configurable Patterns\nAllow users to add custom patterns in .bv/config.yaml:\n\\`\\`\\`yaml\nhistory:\n  id_patterns:\n    - '\\\\bJIRA-\\\\d+\\\\b'\n    - '\\\\bGH-\\\\d+\\\\b'\n\\`\\`\\`\n\n## File Location\n\\`pkg/correlation/explicit.go\\`\n\n## Acceptance Criteria\n1. Extracts bead IDs from various message formats\n2. Uses git --grep for efficient searching\n3. Avoids duplicate correlations\n4. Supports custom patterns from config\n5. Unit tests for pattern matching","status":"closed","priority":2,"type":"task","labels":["correlation","history","pattern-matching","phase-2"],"created_at":"2025-12-15 15:38","updated_at":"2025-12-15 17:50","closed_at":"2025-12-15 17:50","blocked_by":["bv-66"],"blocks":["bv-69"],"pagerank":0.005369478277268624,"betweenness":22,"eigenvector":0,"hub":6.464224047516608e-18,"authority":1.960118691998877e-17,"critical_path":11,"in_degree":1,"out_degree":1,"core_number":2,"slack":0,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-68","title":"Implement temporal correlation with author matching","description":"# Temporal Correlation\n\n## Context\nWhen a bead was \"in progress\" from T1 to T2 by author \"bob@dev\", commits by bob@dev between T1 and T2 are LIKELY related to that bead.\n\nThis is lower confidence (40-70%) because:\n- Bob might have multiple beads in progress\n- The commit might be unrelated refactoring\n\nBut it's still useful as a fallback when other methods don't apply.\n\n## Algorithm\n1. Find bead's claimed timestamp (T1) and closed timestamp (T2)\n2. Find all commits by the claiming author between T1 and T2\n3. Filter out commits already correlated via higher-confidence methods\n4. Calculate dynamic confidence based on context\n\n## Dynamic Confidence Calculation\n\\`\\`\\`go\nfunc calculateTemporalConfidence(bead, commit, context) float64 {\n    base := 0.50\n    \n    // Factor 1: How many beads was this author working on?\n    if activeBeads == 1 {\n        base += 0.20  // Only one bead = higher confidence\n    } else if activeBeads \u003e 3 {\n        base -= 0.10  // Many beads = lower confidence\n    }\n    \n    // Factor 2: How long is the time window?\n    if window \u003c 4*time.Hour {\n        base += 0.10  // Short window = more focused\n    } else if window \u003e 7*24*time.Hour {\n        base -= 0.15  // Week+ window = lots of potential commits\n    }\n    \n    // Factor 3: Does commit touch files related to bead?\n    if pathsMatchBeadHints(commit.Files, bead.Title) {\n        base += 0.15  // File paths match keywords in title\n    }\n    \n    return clamp(base, 0.20, 0.85)\n}\n\\`\\`\\`\n\n## Path Hint Extraction\nExtract potential file paths from bead title/description:\n- File paths: path/to/file.go\n- Package names: pkg/auth, src/components\n- Keywords: auth, login, user, api, db, config\n\n## File Location\n\\`pkg/correlation/temporal.go\\`\n\n## Acceptance Criteria\n1. Finds commits within bead's active window\n2. Matches by author/email\n3. Dynamic confidence based on context\n4. Extracts and uses path hints\n5. Never overwrites higher-confidence correlations","status":"closed","priority":2,"type":"task","labels":["correlation","heuristic","history","phase-2"],"created_at":"2025-12-15 15:38","updated_at":"2025-12-15 17:53","closed_at":"2025-12-15 17:53","blocked_by":["bv-66"],"blocks":["bv-69"],"pagerank":0.005369478277268624,"betweenness":22,"eigenvector":0,"hub":6.464224047516608e-18,"authority":1.960118691998877e-17,"critical_path":11,"in_degree":1,"out_degree":1,"core_number":2,"slack":0,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-69","title":"Implement confidence scoring model","description":"# Confidence Scoring Model\n\n## Context\nDifferent correlation methods have different reliability. We need a consistent model for expressing and combining confidence scores.\n\n## Confidence Ranges by Method\n| Method | Range | Description |\n|--------|-------|-------------|\n| co_committed | 0.90-0.99 | Direct causation |\n| explicit_id | 0.85-0.95 | Developer intent |\n| temporal_author | 0.40-0.75 | Same person, right time |\n\n## Combining Multiple Signals\nIf a commit matches multiple methods:\n\\`\\`\\`go\nfunc CombineConfidence(scores []float64) float64 {\n    // Use highest as base\n    sort.Float64s(scores)\n    base := scores[len(scores)-1]\n    \n    // Boost slightly for each additional signal\n    for i := 0; i \u003c len(scores)-1; i++ {\n        boost := (1.0 - base) * 0.1 * scores[i]\n        base += boost\n    }\n    \n    return min(base, 0.99)\n}\n\\`\\`\\`\n\n## Filtering by Confidence\nSupport \\`--min-confidence\\` flag:\n\\`\\`\\`bash\nbv --robot-history --min-confidence 0.7\n\\`\\`\\`\n\n## Confidence Explanation\nGenerate human-readable explanations:\n- \"Changed in same commit as bead update\"\n- \"Commit message mentions AUTH-123\"\n- \"By bob@dev during active window\"\n\n## File Location\n\\`pkg/correlation/scorer.go\\`\n\n## Acceptance Criteria\n1. Each method has defined confidence range\n2. Multiple signals combine correctly\n3. \\`--min-confidence\\` filter works\n4. Explanations are human-readable\n5. Scores are deterministic (same input = same output)","status":"closed","priority":2,"type":"task","labels":["history","phase-2","reliability","scoring"],"created_at":"2025-12-15 15:38","updated_at":"2025-12-15 17:59","closed_at":"2025-12-15 17:59","blocked_by":["bv-67","bv-68"],"blocks":["bv-70","bv-71"],"pagerank":0.009160157916707401,"betweenness":60,"eigenvector":0,"hub":6.464224047516608e-18,"authority":3.920237383997754e-17,"critical_path":10,"in_degree":2,"out_degree":2,"core_number":2,"slack":0,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-6h1l","title":"Fix per-instance regex compilation in StreamExtractor","status":"closed","priority":3,"type":"bug","labels":null,"created_at":"2025-12-16 20:13","updated_at":"2025-12-16 20:13","closed_at":"2025-12-16 20:13","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-6hl","title":"Define static export data structures and JSON schema","description":"# Define SQLite Export Schema and Materialized Views\n\n## Context\nFollowing mcp_agent_mail's proven architecture, we'll export to SQLite and query it client-side using sql.js WASM. This is more sophisticated than JSON but provides:\n- Real full-text search via FTS5\n- Complex queries (dependencies, blocked chains)\n- Materialized views for fast common operations\n- Chunked loading for large datasets\n- OPFS caching for offline support\n\n## Database Schema\n\n### Core Tables (exported from beads)\n```sql\nCREATE TABLE issues (\n    id TEXT PRIMARY KEY,\n    title TEXT NOT NULL,\n    description TEXT,\n    status TEXT NOT NULL,\n    priority INTEGER NOT NULL,\n    issue_type TEXT NOT NULL,\n    assignee TEXT,\n    labels TEXT, -- JSON array, indexed via FTS\n    created_at TEXT NOT NULL,\n    updated_at TEXT NOT NULL,\n    closed_at TEXT\n);\n\nCREATE TABLE dependencies (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    issue_id TEXT NOT NULL,\n    depends_on_id TEXT NOT NULL,\n    type TEXT NOT NULL, -- 'blocks', 'related', 'parent-child'\n    FOREIGN KEY (issue_id) REFERENCES issues(id),\n    FOREIGN KEY (depends_on_id) REFERENCES issues(id)\n);\n\n-- Graph metrics (computed by bv analysis)\nCREATE TABLE issue_metrics (\n    issue_id TEXT PRIMARY KEY,\n    pagerank REAL,\n    betweenness REAL,\n    critical_path_depth INTEGER,\n    triage_score REAL,\n    blocks_count INTEGER,\n    blocked_by_count INTEGER,\n    FOREIGN KEY (issue_id) REFERENCES issues(id)\n);\n```\n\n### FTS5 Full-Text Search\n```sql\nCREATE VIRTUAL TABLE issues_fts USING fts5(\n    id,\n    title,\n    description,\n    labels,\n    assignee,\n    content='issues',\n    content_rowid='rowid'\n);\n\n-- Triggers to keep FTS in sync (export-time only)\n```\n\n### Materialized Views\n```sql\n-- Denormalized issue overview (like mcp_agent_mail's message_overview_mv)\nCREATE TABLE issue_overview_mv AS\nSELECT \n    i.id,\n    i.title,\n    i.description,\n    i.status,\n    i.priority,\n    i.issue_type,\n    i.assignee,\n    i.labels,\n    i.created_at,\n    i.updated_at,\n    i.closed_at,\n    m.pagerank,\n    m.betweenness,\n    m.critical_path_depth,\n    m.triage_score,\n    m.blocks_count,\n    m.blocked_by_count,\n    (SELECT GROUP_CONCAT(depends_on_id) FROM dependencies WHERE issue_id = i.id AND type = 'blocks') as blocks_ids,\n    (SELECT GROUP_CONCAT(issue_id) FROM dependencies WHERE depends_on_id = i.id AND type = 'blocks') as blocked_by_ids\nFROM issues i\nLEFT JOIN issue_metrics m ON i.id = m.issue_id;\n\n-- Pre-computed triage recommendations\nCREATE TABLE triage_recommendations_mv AS\nSELECT \n    id,\n    title,\n    issue_type,\n    status,\n    priority,\n    triage_score,\n    blocks_count,\n    -- reasoning computed from analysis\n    json_group_array(reason) as reasons\nFROM (\n    SELECT ... -- populated from --robot-triage output\n);\n```\n\n### Performance Indexes\n```sql\n-- Covering indexes for common queries\nCREATE INDEX idx_issues_status ON issues(status);\nCREATE INDEX idx_issues_priority ON issues(priority, status);\nCREATE INDEX idx_issues_updated ON issues(updated_at DESC);\nCREATE INDEX idx_issues_type_status ON issues(issue_type, status);\nCREATE INDEX idx_deps_issue ON dependencies(issue_id);\nCREATE INDEX idx_deps_depends ON dependencies(depends_on_id);\nCREATE INDEX idx_metrics_score ON issue_metrics(triage_score DESC);\n```\n\n### Export Metadata Table\n```sql\nCREATE TABLE export_meta (\n    key TEXT PRIMARY KEY,\n    value TEXT\n);\n-- Contains: version, generated_at, git_commit, issue_count, etc.\n```\n\n## Export Optimization (from mcp_agent_mail)\n```sql\n-- Optimize for httpvfs streaming\nPRAGMA journal_mode=DELETE;  -- Single file, no WAL\nPRAGMA page_size=1024;       -- Optimal for range requests\nINSERT INTO issues_fts(issues_fts) VALUES('optimize');\nVACUUM;\nANALYZE;\nPRAGMA optimize;\n```\n\n## File Output\n```\noutputDir/\n  beads.sqlite3              # Main database\n  beads.sqlite3.config.json  # Chunk config (if chunked)\n  chunks/                    # Optional chunks for large DBs\n  data/\n    triage.json              # Full robot-triage output\n    insights.json            # Full robot-insights output\n    plan.json                # Full robot-plan output\n```\n\n## Acceptance Criteria\n- [ ] SQLite schema defined with all tables\n- [ ] FTS5 virtual table created and populated\n- [ ] Materialized views pre-computed\n- [ ] Performance indexes in place\n- [ ] Export metadata table populated\n- [ ] Database optimized for httpvfs (page_size, VACUUM)\n- [ ] Unit tests verify schema and query patterns\n- [ ] Integration test with real bv data\n\n## Why SQLite over JSON\n1. **Search**: FTS5 provides real full-text search with ranking\n2. **Queries**: Can express complex dependency queries in SQL\n3. **Scale**: Same approach works for 50 or 50,000 issues\n4. **Performance**: Client queries only what it needs, not full load\n5. **Caching**: OPFS support for offline use\n6. **Proven**: mcp_agent_mail demonstrates this works well","notes":"REVISION (2025-12-16): Removed SearchText field from ExportIssue.\n\nRationale: Pre-computing search text wastes JSON bytes. The client can build search text on load by concatenating title + description + labels. This is a one-time O(n) operation that's fast enough for \u003c1000 issues.\n\nUpdated ExportIssue struct:\n```go\ntype ExportIssue struct {\n    model.Issue\n    PageRank        float64   `json:\"pagerank\"`\n    Betweenness     float64   `json:\"betweenness,omitempty\"`\n    CriticalPath    int       `json:\"critical_path_depth\"`\n    BlocksCount     int       `json:\"blocks_count\"`\n    BlockedByCount  int       `json:\"blocked_by_count\"`\n    BlocksIDs       []string  `json:\"blocks_ids,omitempty\"`\n    BlockedByIDs    []string  `json:\"blocked_by_ids,omitempty\"`\n    // SearchText removed - client computes on load\n}\n```\n\nClient-side search text generation:\n```javascript\nfunction buildSearchText(issue) {\n  return [\n    issue.id,\n    issue.title,\n    issue.description || '',\n    (issue.labels || []).join(' '),\n    issue.assignee || ''\n  ].join(' ').toLowerCase();\n}\n```","status":"closed","priority":2,"type":"task","labels":["phase-1","static-pages"],"created_at":"2025-12-15 23:05","updated_at":"2025-12-16 01:46","closed_at":"2025-12-16 01:46","blocks":["bv-w97","bv-y5i"],"pagerank":0.008421650373176496,"betweenness":0,"eigenvector":0,"hub":0,"authority":0.0002057957592643467,"critical_path":8,"in_degree":2,"out_degree":0,"core_number":2,"slack":7,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-6jyn","title":"Unit test: graph_snapshot_svg.go - SVG rendering","description":"Unit tests for SVG graph rendering.\n\n## File Overview\ngraph_snapshot_svg.go renders dependency graphs as SVG images.\n\n## Test Cases to Implement\n1. **SVG Structure**\n   - Valid SVG XML\n   - Correct viewBox\n   - Proper namespaces\n   - Title/description tags\n\n2. **Node Rendering**\n   - Rectangle for each node\n   - Text labels centered\n   - Status colors applied\n   - Hover titles\n\n3. **Edge Rendering**\n   - Path elements for edges\n   - Arrow markers\n   - Correct source/target\n   - No overlapping edges\n\n4. **Styling**\n   - CSS classes embedded\n   - Status-based coloring\n   - Legend included\n   - Consistent spacing\n\n5. **Layout**\n   - Automatic sizing\n   - Spacing presets (compact/roomy)\n   - Margin handling\n   - Viewport dimensions\n\n6. **Special Cases**\n   - Cycle highlighting\n   - Critical path emphasis\n   - Selected node highlight\n\n## Implementation Notes\n- Parse generated SVG and validate\n- Test with XML parser\n- Visual regression with snapshots\n- Test browser rendering","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-16 20:10","updated_at":"2025-12-16 22:16","closed_at":"2025-12-16 22:16","blocks":["bv-3krz","bv-evyl","bv-yc2v"],"pagerank":0.0030138225805077393,"betweenness":0,"eigenvector":0,"hub":0,"authority":1.0344918756394041e-7,"critical_path":4,"in_degree":3,"out_degree":0,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-6tqt","title":"Documentation: Test writing guide for contributors","description":"Create documentation for writing tests in this codebase.\n\n## Guide Contents\n1. **Testing Philosophy**\n   - No mocks/fakes preference\n   - Table-driven tests\n   - Golden files usage\n   - Benchmark conventions\n\n2. **Test Organization**\n   - File naming (*_test.go)\n   - Package naming (pkg_test)\n   - Test function naming\n   - Subtest organization\n\n3. **Test Helpers**\n   - Available helpers\n   - When to create new helpers\n   - Fixture generators\n   - Assertion patterns\n\n4. **Running Tests**\n   - go test commands\n   - Race detection\n   - Coverage reports\n   - Benchmarks\n\n5. **E2E Tests**\n   - Harness usage\n   - Robot command testing\n   - Logging conventions\n   - CI integration\n\n## Location\n- docs/testing.md\n- Links from README\n- Examples in comments","status":"closed","priority":3,"type":"task","labels":null,"created_at":"2025-12-16 20:10","updated_at":"2025-12-17 02:08","closed_at":"2025-12-17 02:08","blocks":["bv-q923"],"pagerank":0.0016159234171211456,"betweenness":0,"eigenvector":0,"hub":0,"authority":7.094593722740486e-8,"critical_path":2,"in_degree":1,"out_degree":0,"core_number":1,"slack":13,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-70","title":"Implement reverse lookup (commit ‚Üí bead)","description":"# Reverse Lookup: Commit ‚Üí Bead\n\n## Context\nSometimes you're looking at a commit and want to know which bead it relates to.\n\"Why was this change made? What bead drove it?\"\n\n## Two Access Patterns\n1. Via commit_index in HistoryReport (already built into structure)\n2. Direct CLI query: \\`bv --commit-bead \u003csha\u003e\\`\n\n## New CLI Flag\n\\`\\`\\`bash\n# Which bead(s) relate to this commit?\nbv --commit-bead abc1234\n\n# Output:\n{\n  \"commit\": \"abc1234\",\n  \"message\": \"fix(auth): resolve race condition\",\n  \"related_beads\": [\n    {\n      \"bead_id\": \"AUTH-123\",\n      \"bead_title\": \"Fix login race condition\",\n      \"method\": \"co_committed\",\n      \"confidence\": 0.95\n    }\n  ]\n}\n\\`\\`\\`\n\n## Orphan Commit Detection\nCommits that don't correlate to ANY bead:\n\\`\\`\\`go\nfunc FindOrphanCommits(report *HistoryReport) []CommitInfo {\n    correlated := make(map[string]bool)\n    for sha := range report.CommitIndex {\n        correlated[sha] = true\n    }\n    \n    var orphans []CommitInfo\n    for _, commit := range getAllCodeCommits() {\n        if !correlated[commit.SHA] {\n            orphans = append(orphans, commit)\n        }\n    }\n    return orphans\n}\n\\`\\`\\`\n\nThis is useful for code hygiene: \"These commits have no associated bead!\"\n\n## Summary Stats Update\nAdd to HistorySummary:\n- orphan_commits: Count of commits with no bead\n- orphan_ratio: orphan_commits / total_commits\n\n## File Location\n- \\`cmd/bv/main.go\\` (new flag)\n- \\`pkg/correlation/reverse.go\\` (lookup logic)\n\n## Acceptance Criteria\n1. \\`--commit-bead \u003csha\u003e\\` outputs correct JSON\n2. commit_index in report is accurate\n3. Orphan detection works\n4. Handles commits with multiple related beads\n5. Handles commits with no related beads gracefully","status":"closed","priority":2,"type":"task","labels":["code-hygiene","history","phase-2","reverse-lookup"],"created_at":"2025-12-15 15:38","updated_at":"2025-12-15 17:59","closed_at":"2025-12-15 17:59","blocked_by":["bv-69"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":6.464224047516608e-18,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":8,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-71","title":"Create dedicated TUI history view","description":"# TUI History View\n\n## Context\nA dedicated view (accessible via 'H' key) showing all bead correlations in a browsable interface.\n\n## Layout\n\\`\\`\\`\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ  üìú BEAD HISTORY                                       [H] to close ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ  Filter: [All ‚ñæ] Author: [All ‚ñæ] Confidence: [‚â•50% ‚ñæ]              ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ  BEADS WITH HISTORY (45/58)            ‚îÇ  COMMIT DETAILS             ‚îÇ\n‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ        ‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ             ‚îÇ\n‚îÇ  ‚ñ∏ AUTH-123 Fix login race   2 commits ‚îÇ  SHA: ghi9012               ‚îÇ\n‚îÇ    AUTH-456 Add OAuth        4 commits ‚îÇ  Author: bob@dev            ‚îÇ\n‚îÇ    DB-789   Schema migration 1 commit  ‚îÇ  Date: 2025-01-11           ‚îÇ\n‚îÇ    ...                                 ‚îÇ                             ‚îÇ\n‚îÇ                                        ‚îÇ  fix(auth): resolve         ‚îÇ\n‚îÇ                                        ‚îÇ  race condition             ‚îÇ\n‚îÇ                                        ‚îÇ                             ‚îÇ\n‚îÇ                                        ‚îÇ  Files:                     ‚îÇ\n‚îÇ                                        ‚îÇ  M pkg/auth/login.go        ‚îÇ\n‚îÇ                                        ‚îÇ  M pkg/auth/session.go      ‚îÇ\n‚îÇ                                        ‚îÇ                             ‚îÇ\n‚îÇ                                        ‚îÇ  Correlation: 95%           ‚îÇ\n‚îÇ                                        ‚îÇ  (co-committed)             ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n\\`\\`\\`\n\n## Model Structure\n\\`\\`\\`go\ntype HistoryViewModel struct {\n    report      *correlation.HistoryReport\n    histories   []correlation.BeadHistory  // Filtered list\n    selected    int                         // Selected bead index\n    commitIdx   int                         // Selected commit within bead\n    \n    // Filters\n    authorFilter     string\n    minConfidence    float64\n    \n    // UI state\n    width, height    int\n    focused          historyFocus  // list or detail\n}\n\\`\\`\\`\n\n## Key Bindings\n| Key | Action |\n|-----|--------|\n| j/k | Navigate bead list |\n| Tab | Switch focus (list ‚Üî detail) |\n| Enter | Expand/collapse bead commits |\n| f | Open filter menu |\n| / | Search beads |\n| H | Close history view |\n\n## Integration Points\n- Add HistoryViewModel to main Model\n- Toggle with 'H' key in main view\n- Load correlation data lazily on first access\n\n## File Location\n\\`pkg/ui/history.go\\`\n\n## Acceptance Criteria\n1. 'H' key opens history view\n2. Bead list is navigable with j/k\n3. Commit details shown for selected bead\n4. Filters work correctly\n5. Responsive layout at different terminal sizes","status":"closed","priority":2,"type":"task","labels":["history","phase-3","tui","view"],"created_at":"2025-12-15 15:39","updated_at":"2025-12-15 18:11","closed_at":"2025-12-15 18:11","blocked_by":["bv-69"],"blocks":["bv-72"],"pagerank":0.007563281301717603,"betweenness":56,"eigenvector":0,"hub":6.464224047516608e-18,"authority":4.7854460253878835e-21,"critical_path":9,"in_degree":1,"out_degree":1,"core_number":1,"slack":0,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-72","title":"Integrate history into bead detail pane","description":"# History in Detail Pane\n\n## Context\nWhen viewing a bead's details (right pane in split view), show its history and correlated commits at the bottom.\n\n## Layout Addition\n\\`\\`\\`\n‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ     ‚îÇ\n‚îÇ  üìú HISTORY                                                         ‚îÇ\n‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ     ‚îÇ\n‚îÇ  üü¢ Created    Jan 10, 14:32    alice@dev                          ‚îÇ\n‚îÇ  üîµ Claimed    Jan 11, 09:15    bob@dev                            ‚îÇ\n‚îÇ  ‚ö´ Closed     Jan 11, 16:42    bob@dev    (7h 27m cycle time)     ‚îÇ\n‚îÇ                                                                     ‚îÇ\n‚îÇ  Related Commits:                                                   ‚îÇ\n‚îÇ  ‚ñà‚ñà‚ñà‚ñà 95% ghi9012 fix(auth): resolve race condition                ‚îÇ\n‚îÇ            ‚îî‚îÄ‚îÄ pkg/auth/login.go (+45, -12)                        ‚îÇ\n‚îÇ            ‚îî‚îÄ‚îÄ pkg/auth/session.go (+8, -3)                        ‚îÇ\n\\`\\`\\`\n\n## Implementation\n- Add renderBeadHistory() function\n- Lazy load history when bead is selected\n- Cache loaded history in model\n- Show confidence as visual bar\n\n## File Location\n\\`pkg/ui/detail.go\\` or extend \\`pkg/ui/view.go\\`\n\n## Acceptance Criteria\n1. History section appears in detail pane\n2. Lifecycle events displayed chronologically\n3. Commits shown with confidence bars\n4. Lazy loading prevents startup slowdown\n5. Works in both split and full-width modes","status":"closed","priority":2,"type":"task","labels":["detail-pane","history","phase-3","tui"],"created_at":"2025-12-15 15:39","updated_at":"2025-12-15 18:16","closed_at":"2025-12-15 18:16","blocked_by":["bv-71"],"blocks":["bv-73"],"pagerank":0.007161014100166473,"betweenness":56,"eigenvector":0,"hub":7.890898495503672e-22,"authority":4.7854460253878835e-21,"critical_path":8,"in_degree":1,"out_degree":1,"core_number":1,"slack":0,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-73","title":"Add keybindings for history navigation","description":"# History Keybindings\n\n## New Global Keys\n| Key | Action |\n|-----|--------|\n| H | Toggle dedicated history view |\n| h | (on selected bead) Jump to history in detail pane |\n\n## History View Keys\n| Key | Action |\n|-----|--------|\n| j/k | Navigate bead list |\n| J/K | Navigate commits within selected bead |\n| Tab | Toggle focus: bead list ‚Üî commit detail |\n| Enter | Open commit in browser (if remote configured) |\n| y | Copy commit SHA to clipboard |\n| f | Open filter menu |\n| / | Search beads by title/ID |\n| c | Toggle confidence threshold |\n| H or Esc | Close history view |\n\n## Update Help Overlay\nAdd history keys to the '?' help overlay.\n\n## File Location\n- \\`pkg/ui/update.go\\` (key handling)\n- \\`pkg/ui/help.go\\` (help text)\n\n## Acceptance Criteria\n1. H toggles history view\n2. All history-specific keys work\n3. Help overlay updated\n4. Keys don't conflict with existing bindings\n5. Intuitive navigation flow","status":"closed","priority":2,"type":"task","labels":["history","keybindings","phase-3","tui"],"created_at":"2025-12-15 15:39","updated_at":"2025-12-15 18:25","closed_at":"2025-12-15 18:25","blocked_by":["bv-72"],"blocks":["bv-74"],"pagerank":0.006687646104799937,"betweenness":54,"eigenvector":0,"hub":7.890898495503672e-22,"authority":4.7854460253878835e-21,"critical_path":7,"in_degree":1,"out_degree":1,"core_number":1,"slack":0,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-73f","title":"Add --export-pages CLI flag and command handler","description":"# Add --export-pages CLI Flag and Command Handler\n\n## Context\nAdd the core CLI interface for exporting static pages. This is the non-interactive version that can be used in CI/CD pipelines.\n\n## Requirements\n\n### New CLI Flags (cmd/bv/main.go)\n```go\nexportPages := flag.String(\"export-pages\", \"\", \"Export static site to directory (e.g., ./bv-pages)\")\npagesTitle := flag.String(\"pages-title\", \"\", \"Custom title for static site\")\npagesIncludeClosed := flag.Bool(\"pages-include-closed\", false, \"Include closed issues in export\")\npagesMinify := flag.Bool(\"pages-minify\", false, \"Minify JSON output\")\npreviewPages := flag.String(\"preview-pages\", \"\", \"Preview existing static site bundle\")\n```\n\n### Command Flow\n```go\nif *exportPages != \"\" {\n    config := export.ExportConfig{\n        Title:         *pagesTitle,\n        IncludeClosed: *pagesIncludeClosed,\n        Minify:        *pagesMinify,\n    }\n    \n    // Load issues (reuse existing loader)\n    issues, err := loader.LoadFromPath(beadsPath)\n    if err != nil {\n        return err\n    }\n    \n    // Build graph (reuse existing analysis)\n    graph := analysis.BuildGraph(issues)\n    \n    // Create exporter and run\n    exporter := export.NewStaticExporter(issues, graph, config)\n    if err := exporter.Export(*exportPages); err != nil {\n        return err\n    }\n    \n    fmt.Printf(\"‚úì Static site exported to: %s\\n\", *exportPages)\n    fmt.Printf(\"  Open %s/index.html in a browser to view\\n\", *exportPages)\n    os.Exit(0)\n}\n```\n\n### Preview Mode\n```go\nif *previewPages != \"\" {\n    // Start local HTTP server\n    server := export.NewPreviewServer(*previewPages, 9000)\n    fmt.Printf(\"Preview server running at http://localhost:%d\\n\", server.Port)\n    fmt.Println(\"Press Ctrl+C to stop\")\n    \n    // Open browser\n    browser.Open(fmt.Sprintf(\"http://localhost:%d\", server.Port))\n    \n    // Block until interrupted\n    server.ListenAndServe()\n    os.Exit(0)\n}\n```\n\n### Output Messages\n```\n$ bv --export-pages ./bv-pages\n\nExporting static site...\n  ‚Üí Loading issues from .beads/beads.jsonl\n  ‚Üí Found 178 issues (85 open, 93 closed)\n  ‚Üí Running graph analysis...\n  ‚Üí Generating triage data...\n  ‚Üí Writing JSON files...\n  ‚Üí Copying viewer assets...\n\n‚úì Static site exported to: ./bv-pages\n  Files: 5 JSON data files, 4 viewer assets\n  Total size: 245 KB\n\nTo preview locally:\n  bv --preview-pages ./bv-pages\n\nTo deploy to GitHub Pages:\n  bv --pages (interactive wizard)\n```\n\n### Error Handling\n- Output directory exists: Prompt to overwrite or fail with --force\n- No issues found: Warn but create empty site\n- Graph analysis timeout: Use partial data with warning\n- Write errors: Clean up partial output\n\n## Acceptance Criteria\n- [ ] --export-pages flag creates complete static site\n- [ ] --preview-pages starts local server\n- [ ] Output shows progress and summary\n- [ ] Works in non-TTY environments (CI)\n- [ ] --help shows new flags with descriptions\n- [ ] Exit code 0 on success, 1 on error\n\n## Integration Points\n- Reuses existing loader, analysis, and graph code\n- Hooks into robot output generation (triage, insights, plan)\n- Respects BV_DATA_PATH environment variable","status":"closed","priority":2,"type":"task","labels":["phase-1","static-pages"],"created_at":"2025-12-15 23:06","updated_at":"2025-12-16 03:16","closed_at":"2025-12-16 03:16","blocked_by":["bv-w97","bv-jdl"],"blocks":["bv-10g","bv-50r","bv-7pu","bv-y5i"],"pagerank":0.004746266039289926,"betweenness":9,"eigenvector":0,"hub":0.00013573598174365005,"authority":0.00026276349609539865,"critical_path":6,"in_degree":4,"out_degree":2,"core_number":3,"slack":7,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-74","title":"Implement caching layer for history data","description":"# History Caching Layer\n\n## Context\nParsing git history is expensive. We need to cache results to avoid re-parsing on every access.\n\n## Cache Key\n\\`\\`\\`go\ntype CacheKey struct {\n    HeadSHA       string  // Current git HEAD\n    BeadsHash     string  // Hash of beads.jsonl content\n    Options       string  // Serialized filter options\n}\n\\`\\`\\`\n\n## Cache Structure\n\\`\\`\\`go\ntype HistoryCache struct {\n    mu      sync.RWMutex\n    entries map[string]*CacheEntry\n    maxAge  time.Duration\n    maxSize int  // Max entries\n}\n\\`\\`\\`\n\n## Invalidation Strategy\nCache is invalid when:\n- git HEAD changed (new commits)\n- beads.jsonl content changed\n- Cache entry older than maxAge (default: 5 minutes)\n\n## Memory Management\n- Default max entries: 10\n- LRU eviction when full\n\n## File Location\n\\`pkg/correlation/cache.go\\`\n\n## Acceptance Criteria\n1. Cache hit returns data without git calls\n2. Cache invalidates on HEAD change\n3. Cache invalidates on beads.jsonl change\n4. LRU eviction works correctly\n5. Thread-safe for concurrent access\n6. Significant speedup on repeated access","status":"closed","priority":3,"type":"task","labels":["caching","history","performance","phase-4"],"created_at":"2025-12-15 15:40","updated_at":"2025-12-15 19:06","closed_at":"2025-12-15 19:06","blocked_by":["bv-73"],"blocks":["bv-75"],"pagerank":0.006130821690720193,"betweenness":50,"eigenvector":0,"hub":7.890898495503672e-22,"authority":4.7854460253878835e-21,"critical_path":6,"in_degree":1,"out_degree":1,"core_number":1,"slack":0,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-75","title":"Support incremental history updates","description":"# Incremental History Updates\n\n## Context\nWhen only a few new commits exist since last cache, we shouldn't re-parse the entire history. Parse only new commits and merge.\n\n## Algorithm\n1. Find new commits since cached report (using LatestCommitSHA)\n2. If few new commits (\u003c100), parse only those\n3. Merge new events with existing correlations\n4. If too many new commits, full refresh is more efficient\n\n## Track Latest Commit\nAdd to HistoryReport: LatestCommitSHA string\n\n## Merge Logic\n- New beads: Add to correlations\n- Updated beads: Merge events, re-correlate if needed\n- Existing correlations: Keep if still valid\n\n## File Location\n\\`pkg/correlation/incremental.go\\`\n\n## Acceptance Criteria\n1. Detects when incremental update is possible\n2. Only parses new commits\n3. Correctly merges with existing data\n4. Falls back to full refresh when appropriate\n5. Performance improvement measurable","status":"closed","priority":3,"type":"task","labels":["history","incremental","performance","phase-4"],"created_at":"2025-12-15 15:40","updated_at":"2025-12-15 19:17","closed_at":"2025-12-15 19:17","blocked_by":["bv-74"],"blocks":["bv-76"],"pagerank":0.005475712521561136,"betweenness":44,"eigenvector":0,"hub":7.890898495503672e-22,"authority":4.7854460253878835e-21,"critical_path":5,"in_degree":1,"out_degree":1,"core_number":1,"slack":0,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-75ds","title":"Unit test: duplicates.go - Duplicate issue detection","description":"Create comprehensive unit tests for pkg/analysis/duplicates.go\n\n## File Overview\nduplicates.go detects potential duplicate issues using:\n- Title similarity (Levenshtein, Jaccard, etc.)\n- Description content overlap\n- Label/type matching\n\n## Test Cases to Implement\n1. **Exact Duplicates**\n   - Identical titles\n   - Identical descriptions\n   - Same labels and type\n\n2. **Near Duplicates**\n   - Titles with typos (1-2 character difference)\n   - Reworded titles (same meaning)\n   - Descriptions with minor variations\n   - Different case (UPPERCASE vs lowercase)\n\n3. **False Positive Prevention**\n   - Short generic titles ('Fix bug', 'Update docs')\n   - Common prefixes ('[WIP]', '[DRAFT]')\n   - Issue IDs in titles\n   - Completely different content\n\n4. **Similarity Scoring**\n   - Test exact match = 1.0 confidence\n   - Test partial match scoring\n   - Test threshold filtering\n   - Verify score distribution\n\n5. **Performance Tests**\n   - 100 issues (n^2 comparisons = 10,000)\n   - 500 issues (250,000 comparisons)\n   - Verify timeout/early-exit behavior\n\n## Implementation Notes\n- Create pairs of issues with known similarity\n- Test each similarity metric independently\n- Benchmark comparison performance\n- Consider using golden files for expected pairs","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-16 20:05","updated_at":"2025-12-16 22:26","closed_at":"2025-12-16 22:26","blocks":["bv-0kll","bv-3bhq"],"pagerank":0.001985274869031905,"betweenness":0,"eigenvector":0,"hub":0,"authority":1.7833198250397624e-7,"critical_path":5,"in_degree":2,"out_degree":0,"core_number":2,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-76","title":"Optimize for large repositories","description":"# Large Repository Optimization\n\n## Context\nFor repos with 10,000+ commits, naive parsing is too slow. Need smarter strategies.\n\n## Strategies\n\n### 1. Default Commit Limit\n\\`\\`\\`go\nconst DefaultHistoryLimit = 500\n\\`\\`\\`\n\n### 2. Streaming Parser\nDon't load all git output into memory. Stream and parse line-by-line.\n\n### 3. Parallel File Stats\nBatch git show requests for multiple SHAs.\n\n### 4. Skip Old Beads\n\\`--history-closed-since \"90 days\"\\` - Only beads closed in last 90 days.\n\n### 5. Progress Indicator\nFor TUI, show progress while loading:\n\\`\\`\\`\nLoading history... 234/500 commits\n\\`\\`\\`\n\n## Benchmarking Targets\n- 100 commits: instant (\u003c100ms)\n- 1,000 commits: fast (\u003c1s)\n- 10,000 commits: acceptable (\u003c5s)\n\n## File Location\n- \\`pkg/correlation/stream.go\\` (streaming parser)\n- \\`pkg/correlation/batch.go\\` (batched git calls)\n\n## Acceptance Criteria\n1. 500 commit default limit\n2. Streaming parser doesn't OOM\n3. Batch file stats is faster than sequential\n4. Progress indicator in TUI\n5. Meets benchmark targets","status":"closed","priority":3,"type":"task","labels":["history","performance","phase-4","scale"],"created_at":"2025-12-15 15:40","updated_at":"2025-12-15 19:22","closed_at":"2025-12-15 19:22","blocked_by":["bv-75"],"blocks":["bv-77"],"pagerank":0.004704981030911598,"betweenness":36,"eigenvector":0,"hub":7.890898495503672e-22,"authority":4.7854460253878835e-21,"critical_path":4,"in_degree":1,"out_degree":1,"core_number":1,"slack":0,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-77","title":"Comprehensive test suite for history feature","description":"# History Feature Test Suite\n\n## Test Categories\n\n### Unit Tests\n- Type serialization roundtrips\n- Git output parsing\n- Confidence scoring\n- Pattern matching for explicit IDs\n- Temporal window calculations\n\n### Integration Tests\n- Real git repo with sample history\n- End-to-end --robot-history\n- Cache invalidation\n- Incremental updates\n\n### Edge Case Tests\n- Empty git history\n- No beads.jsonl in history\n- Malformed JSON in old commits\n- Merge commits\n- Rebased history\n\n## Test Fixtures\nCreate fixtures in \\`tests/testdata/history/\\`:\n- sample_git_log.txt\n- sample_diff.txt\n- edge_cases/\n\n## Coverage Target\nAim for \u003e80% coverage on new correlation package.\n\n## File Location\n- \\`pkg/correlation/*_test.go\\`\n- \\`tests/testdata/history/\\`\n\n## Acceptance Criteria\n1. Unit tests for all public functions\n2. Integration tests with real git operations\n3. Edge cases documented and tested\n4. Coverage \u003e80%\n5. Tests run in CI","status":"closed","priority":2,"type":"task","labels":["history","phase-5","quality","testing"],"created_at":"2025-12-15 15:40","updated_at":"2025-12-15 23:14","closed_at":"2025-12-15 23:14","blocked_by":["bv-76"],"blocks":["bv-78"],"pagerank":0.003798240094886169,"betweenness":26,"eigenvector":0,"hub":7.890898495503672e-22,"authority":4.7854460253878835e-21,"critical_path":3,"in_degree":1,"out_degree":1,"core_number":1,"slack":0,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-78","title":"Update README with history feature documentation","description":"# README Documentation Update\n\n## Sections to Add\n\n### Bead History \u0026 Code Correlation\n- What the feature does\n- How to use CLI flags\n- How to use TUI view\n- Confidence scoring explained\n- Example output\n\n## Example Content\n\\`\\`\\`markdown\n## üìú Bead History \u0026 Code Correlation\n\nbv can correlate beads with the git commits that implemented them,\nproviding full traceability from issue to code.\n\n### CLI Usage\n\\\\\\`\\\\\\`\\\\\\`bash\nbv --robot-history              # See all correlations\nbv --bead-history AUTH-123      # History for specific bead\n\\\\\\`\\\\\\`\\\\\\`\n\n### How It Works\nbv parses the git history of your beads.jsonl file to extract\nlifecycle events and correlate with code commits.\nNo LLM or AI inference is used - correlations are purely mechanical.\n\\`\\`\\`\n\n## Acceptance Criteria\n1. Clear explanation of feature\n2. CLI examples with expected output\n3. TUI instructions with screenshots\n4. Confidence model explained","status":"closed","priority":3,"type":"task","labels":["documentation","history","phase-5","readme"],"created_at":"2025-12-15 15:40","updated_at":"2025-12-16 11:58","closed_at":"2025-12-16 11:58","blocked_by":["bv-77"],"blocks":["bv-79"],"pagerank":0.002731484890410988,"betweenness":14,"eigenvector":0,"hub":7.890898495503672e-22,"authority":4.7854460253878835e-21,"critical_path":2,"in_degree":1,"out_degree":1,"core_number":1,"slack":0,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-79","title":"Update AGENTS.md with robot-history documentation","description":"# AGENTS.md Update for Robot History\n\n## Add to AGENTS.md\n\n### Bead-to-Commit Correlation\n- \\`bv --robot-history\\` ‚Äî JSON output of all bead-to-commit correlations\n- \\`bv --bead-history \u003cid\u003e\\` ‚Äî History for a specific bead\n- \\`bv --commit-bead \u003csha\u003e\\` ‚Äî Which bead(s) relate to a commit\n\n### Correlation Methods (by confidence)\n| Method | Confidence | Description |\n|--------|------------|-------------|\n| co_committed | 95% | Code changed in same commit as bead |\n| explicit_id | 90% | Commit message contains bead ID |\n| temporal_author | 50-70% | Same author, in bead's active window |\n\n### Example Queries\n\\`\\`\\`bash\nbv --bead-history AUTH-123 | jq '.code_commits[].sha'\nbv --robot-history | jq '.summary.orphan_commits'\n\\`\\`\\`\n\n## Acceptance Criteria\n1. All history flags documented\n2. Example jq queries\n3. Confidence model explained\n4. Consistent with existing AGENTS.md style","status":"closed","priority":3,"type":"task","labels":["agents","documentation","history","phase-5"],"created_at":"2025-12-15 15:40","updated_at":"2025-12-16 11:58","closed_at":"2025-12-16 11:58","blocked_by":["bv-78"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":7.890898495503672e-22,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":0,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-7bob","title":"Unit test: pkg/ui/graph.go - Interactive graph view","description":"Comprehensive unit tests for the interactive graph visualization.\n\n## File Overview\ngraph.go implements the TUI graph view with:\n- ASCII/Unicode rendering on a virtual canvas\n- Node layout with topological layering\n- Edge routing with Manhattan paths\n- Interactive navigation (pan, zoom, select)\n\n## Test Cases to Implement\n1. **Canvas Rendering**\n   - Empty canvas initialization\n   - Single node placement\n   - Multiple node layout\n   - Edge path rendering\n   - Unicode box characters\n\n2. **Layout Algorithm**\n   - Topological layer assignment\n   - Horizontal spacing\n   - Vertical spacing\n   - Layer balancing\n   - Crossing minimization\n\n3. **Edge Routing**\n   - Straight vertical edges\n   - L-shaped routes\n   - S-shaped routes\n   - Edge bundling\n   - No node overlap\n\n4. **Node Rendering**\n   - Status color coding\n   - ID/title display\n   - Selection highlight\n   - Truncation on small nodes\n\n5. **Interactive Features**\n   - Pan with h/j/k/l\n   - Scroll with Ctrl+D/U\n   - Node selection\n   - Focus tracking\n\n6. **View Sizing**\n   - Narrow terminal\n   - Wide terminal\n   - Resize handling\n   - Viewport clipping\n\n## Implementation Notes\n- Create test graphs with known layouts\n- Golden file tests for rendered output\n- Test with various terminal sizes\n- Benchmark rendering performance","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-16 20:10","updated_at":"2025-12-16 21:52","closed_at":"2025-12-16 21:52","blocks":["bv-3krz","bv-61hu","bv-evyl"],"pagerank":0.003706187253531437,"betweenness":0,"eigenvector":0,"hub":0,"authority":9.579989288632093e-8,"critical_path":4,"in_degree":3,"out_degree":0,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-7pu","title":"Document static pages feature in robot-help and README","description":"# Document Static Pages Feature in robot-help and README\n\n## Context\nNew features need documentation so users and AI agents can discover and use them.\n\n## Requirements\n\n### robot-help Output (cmd/bv/main.go)\nAdd to --robot-help output:\n```\n  --export-pages \u003cdir\u003e\n      Export static HTML site to directory.\n      Creates a self-contained bundle viewable in any browser.\n      Output: index.html, data/*.json, viewer assets\n      Example: bv --export-pages ./bv-pages\n      \n  --pages\n      Launch interactive Pages deployment wizard.\n      Guides you through export ‚Üí preview ‚Üí deploy to GitHub/Cloudflare.\n      \n  --preview-pages \u003cdir\u003e\n      Start local server to preview existing export.\n      Opens http://localhost:9000 in your browser.\n      Press 'r' to regenerate, 'd' to deploy, 'q' to quit.\n      \n  --pages-title \u003ctitle\u003e\n      Custom title for the static site (default: \"Project Issues\")\n      \n  --pages-include-closed\n      Include closed issues in export (default: open only)\n```\n\n### README.md Section\nAdd section to existing README:\n```markdown\n## Static Site Export\n\nGenerate a beautiful static website from your beads data and deploy to GitHub Pages:\n\n### Quick Start\n```bash\n# Interactive wizard (recommended)\nbv --pages\n\n# Or export locally\nbv --export-pages ./my-dashboard\nopen ./my-dashboard/index.html\n```\n\n### Features\n- **Dashboard**: Key metrics, recommendations, quick wins\n- **Issues List**: Filter by status, type, priority, labels\n- **Issue Detail**: Full description, dependencies, graph visualization\n- **Insights**: PageRank, bottlenecks, critical paths\n- **Works Offline**: Everything runs in the browser\n\n### Deployment Options\n1. **GitHub Pages** (recommended)\n   - Free hosting\n   - Automatic HTTPS\n   - Wizard handles everything\n   \n2. **Cloudflare Pages**\n   - Global CDN\n   - Faster load times\n   - `bv --pages` ‚Üí select Cloudflare\n   \n3. **Local/Custom**\n   - Export with `--export-pages`\n   - Host anywhere (Netlify, S3, etc.)\n\n### Updating a Deployment\n```bash\n# Re-export and push\nbv --export-pages ./existing-bundle\ncd ./existing-bundle\ngit add . \u0026\u0026 git commit -m \"Update dashboard\" \u0026\u0026 git push\n```\n\n### Customization\n- `--pages-title \"My Project\"` - Custom title\n- `--pages-include-closed` - Show all issues\n- Edit generated CSS for branding\n```\n\n### AGENTS.md Addition\n```markdown\n### Static Site for Stakeholder Reporting\n\nGenerate a static dashboard for non-technical stakeholders:\n```bash\nbv --export-pages ./dashboard --pages-title \"Sprint 42 Status\"\n```\n\nThe output is a self-contained HTML/JS bundle that:\n- Shows triage recommendations (from --robot-triage)\n- Visualizes dependencies\n- Requires no installation to view\n- Can be deployed to GitHub Pages via `bv --pages`\n```\n\n## Acceptance Criteria\n- [ ] --robot-help includes all new flags\n- [ ] README has complete usage section\n- [ ] AGENTS.md updated for AI context\n- [ ] Examples are copy-pasteable\n- [ ] Covers common use cases\n- [ ] Links to any additional docs","status":"closed","priority":3,"type":"task","labels":["documentation","static-pages"],"created_at":"2025-12-15 23:10","updated_at":"2025-12-16 10:25","closed_at":"2025-12-16 10:25","blocked_by":["bv-73f","bv-10g"],"blocks":["bv-y5i"],"pagerank":0.0015706037203119501,"betweenness":0,"eigenvector":0,"hub":0.00007926465777048204,"authority":0.0001967059030531822,"critical_path":3,"in_degree":1,"out_degree":2,"core_number":3,"slack":7,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-80","title":"Agent-first priority intelligence","description":"Epic to make --robot-priority outputs maximally useful for coding agents: richer signals (time-to-impact, urgency, risk), transparent explanations with what-if, deterministic ergonomics, structural hygiene hints, team/label targeting, safety filters, action scripts, lightweight learning loop, and TUI surfaces.","status":"closed","priority":1,"type":"epic","labels":null,"created_at":"2025-12-15 15:45","updated_at":"2025-12-15 23:16","closed_at":"2025-12-15 23:16","blocks":["bv-147"],"pagerank":0.0019420942849196032,"betweenness":0,"eigenvector":0,"hub":0,"authority":0.027195424010000722,"critical_path":4,"in_degree":1,"out_degree":0,"core_number":1,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-81","title":"Augment priority model with time-to-impact \u0026 urgency","description":"Time-to-impact/urgency: combine critical-path depth with estimated_minutes/historical medians; include due/urgent labels with decay. Deterministic, capped. Inline explanation + units; embed in advanced_insights with status. Avoid overload by showing only top fields in tables; full details remain in JSON.","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-15 15:45","updated_at":"2025-12-15 19:37","closed_at":"2025-12-15 19:37","blocks":["bv-129","bv-145","bv-83","bv-87","bv-95","bv-96"],"pagerank":0.009098408938751001,"betweenness":0,"eigenvector":0,"hub":0,"authority":0.000011178891755197484,"critical_path":5,"in_degree":6,"out_degree":0,"core_number":3,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-81ew","title":"Port K-Core Decomposition to Rust WASM","description":"# Port K-Core Decomposition to Rust WASM\n\n## Context\nK-core decomposition finds the maximal subgraph where every node has degree ‚â• k. Core number = highest k for which node is in k-core. High core = densely connected region.\n\n## Go Implementation Reference\n```go\n// computeKCore in graph.go\n// Iterative k-peeling on undirected view\n```\n\n## Rust Implementation (kcore.rs)\n```rust\nuse crate::graph::DiGraph;\n\n/// Compute k-core numbers for all nodes.\n/// Uses undirected view (edge u‚Üív treated as u--v).\npub fn kcore(graph: \u0026DiGraph) -\u003e Vec\u003cu32\u003e {\n    let n = graph.node_count();\n    if n == 0 {\n        return Vec::new();\n    }\n    \n    // Build undirected degree (in + out, deduplicated)\n    let mut degree: Vec\u003cusize\u003e = vec![0; n];\n    let mut neighbors: Vec\u003cVec\u003cusize\u003e\u003e = vec![Vec::new(); n];\n    \n    for u in 0..n {\n        for \u0026v in graph.successors(u) {\n            if !neighbors[u].contains(\u0026v) {\n                neighbors[u].push(v);\n                degree[u] += 1;\n            }\n            if !neighbors[v].contains(\u0026u) {\n                neighbors[v].push(u);\n                degree[v] += 1;\n            }\n        }\n    }\n    \n    let max_deg = degree.iter().cloned().max().unwrap_or(0);\n    let mut core = vec![0u32; n];\n    let mut removed = vec![false; n];\n    \n    for k in 1..=max_deg {\n        // Find nodes with degree \u003c k\n        let mut queue: Vec\u003cusize\u003e = (0..n)\n            .filter(|\u0026i| !removed[i] \u0026\u0026 degree[i] \u003c k)\n            .collect();\n        \n        while let Some(v) = queue.pop() {\n            if removed[v] { continue; }\n            removed[v] = true;\n            core[v] = (k - 1) as u32;\n            \n            for \u0026nbr in \u0026neighbors[v] {\n                if removed[nbr] { continue; }\n                degree[nbr] -= 1;\n                if degree[nbr] \u003c k {\n                    queue.push(nbr);\n                }\n            }\n        }\n    }\n    \n    // Remaining nodes get max_deg\n    for i in 0..n {\n        if !removed[i] {\n            core[i] = max_deg as u32;\n        }\n    }\n    \n    core\n}\n```\n\n## Acceptance Criteria\n- [ ] Core numbers computed correctly\n- [ ] Handles isolated nodes (core 0)\n- [ ] Results match Go implementation","status":"closed","priority":2,"type":"task","labels":["algorithm","phase-2","wasm"],"created_at":"2025-12-15 23:34","updated_at":"2025-12-16 00:32","closed_at":"2025-12-16 00:32","blocked_by":["bv-bxoe"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.000008837350028490512,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-82","title":"Risk and volatility signals in priority scoring","description":"Risk/volatility signals: blocker fan-in/out variance, status churn, comment/edit churn, cross-repo fan-out. Normalize, deterministic, capped. Provide inline explanation text and status flag; integrate into advanced_insights so agents see meaning and trust level.","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-15 15:45","updated_at":"2025-12-15 19:39","closed_at":"2025-12-15 19:39","blocks":["bv-129","bv-145","bv-83","bv-85","bv-87","bv-95"],"pagerank":0.016181672273901663,"betweenness":0,"eigenvector":0,"hub":0,"authority":0.000009297066314142041,"critical_path":5,"in_degree":6,"out_degree":0,"core_number":3,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-83","title":"Priority explanations with what-if deltas","description":"Priority explanations: top-3 reasons, what-if deltas (unblocks, blocked reduction, depth reduction, days saved), status inline; deterministic ordering; concise defaults. Add a footer explaining each field for agents; integrate with advanced_insights schema and enforce caps to prevent overload.","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-15 15:45","updated_at":"2025-12-15 19:50","closed_at":"2025-12-15 19:50","blocked_by":["bv-81","bv-82"],"blocks":["bv-84","bv-86","bv-88","bv-90","bv-93","bv-95","bv-96"],"pagerank":0.0123633316214553,"betweenness":17.666666666666664,"eigenvector":0,"hub":0.0000033763562657725555,"authority":0.000010152351401939487,"critical_path":4,"in_degree":7,"out_degree":2,"core_number":3,"slack":10,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-84","title":"Ergonomic robot outputs for agents","description":"Ergonomic outputs: dual JSON + optional compact table; jq snippets footer; filters (--min-confidence, --max-results, --by-label/assignee). Ensure advanced_insights items respect caps/ordering and reuse hash/config. Add per-feature one-line usage hints to avoid agent confusion.","status":"closed","priority":2,"type":"task","labels":["ai-agent,advanced-insights"],"created_at":"2025-12-15 15:45","updated_at":"2025-12-15 20:03","closed_at":"2025-12-15 20:03","blocked_by":["bv-83"],"blocks":["bv-131","bv-181","bv-87","bv-88","bv-89","bv-91","bv-93","bv-95","bv-96"],"pagerank":0.00756195308100916,"betweenness":10.833333333333332,"eigenvector":0,"hub":0.0000016740586766286952,"authority":0.000014481719336957388,"critical_path":3,"in_degree":9,"out_degree":1,"core_number":3,"slack":10,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-85","title":"Advanced graph signals: k-core, articulation, slack","description":"Compute k-core level, articulation points, and per-node slack (approx via longest-path distances) to identify structural keystones and zero-slack tasks. Surface as supplemental signals in priority reasoning and include status flags; keep computations bounded by timeouts.","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-15 15:45","updated_at":"2025-12-15 20:37","closed_at":"2025-12-15 20:37","blocked_by":["bv-82"],"blocks":["bv-130","bv-152","bv-153","bv-154","bv-94"],"pagerank":0.008780812306704102,"betweenness":6.333333333333333,"eigenvector":0,"hub":0.0000015330275631917705,"authority":4.3971087377606515e-8,"critical_path":4,"in_degree":5,"out_degree":1,"core_number":2,"slack":10,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-86","title":"Hygiene and data-quality hints in priority output","description":"Cycle/structure auto-sanitizer suggestions: For high-impact beads in cycles, rank edges to break (minimal collateral) using SCC heuristics; cap list length; deterministic; add status flag. Embed in advanced_insights suggestions[] (kind='cycle_break') with explicit advisory text: 'Structural fix‚Äîapply before executing dependents.'","status":"closed","priority":2,"type":"task","labels":["ai-agent,advanced-insights"],"created_at":"2025-12-15 15:45","updated_at":"2025-12-15 21:48","closed_at":"2025-12-15 21:48","blocked_by":["bv-83"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.0000016740586766286952,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-87","title":"Track/label-aware recommendation slices","description":"Group recommendations per execution track (connected component) and optionally per label/assignee so multiple agents can grab their own top-N without collision. Provide summary counts per group and preserve deterministic ordering.","status":"closed","priority":3,"type":"task","labels":null,"created_at":"2025-12-15 15:45","updated_at":"2025-12-16 15:16","closed_at":"2025-12-16 15:16","blocked_by":["bv-84","bv-81","bv-82"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.000005764300393071349,"authority":0,"critical_path":1,"in_degree":0,"out_degree":3,"core_number":3,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-88","title":"Safety filters and thresholds for agents","description":"Add CLI flags: --min-confidence, --max-results, and --require-status=computed to let agents control noise. Color/tag low-confidence entries in optional table output; include rejection reasons when items are filtered out.","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-15 15:45","updated_at":"2025-12-15 21:49","closed_at":"2025-12-15 21:49","blocked_by":["bv-83","bv-84"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.000004062002803927489,"authority":0,"critical_path":1,"in_degree":0,"out_degree":2,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-89","title":"Action script emission for top-N","description":"Add --emit-script to produce a shell snippet that opens top-N recommendations (or creates log stubs) for agent workflows. Include hash/config in comment header; keep deterministic ordering.","status":"closed","priority":3,"type":"task","labels":null,"created_at":"2025-12-15 15:46","updated_at":"2025-12-16 14:34","closed_at":"2025-12-16 14:34","blocked_by":["bv-84"],"blocks":["bv-131"],"pagerank":0.0017902298973226836,"betweenness":0,"eigenvector":0,"hub":0.0000023879441272987935,"authority":0.0000013001694461813288,"critical_path":2,"in_degree":1,"out_degree":1,"core_number":2,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-8f0b","title":"Add actionable_nodes() and blocker query functions to DiGraph","description":"# Add Actionable Nodes and Blocker Queries\n\n## Context\nThe Go implementation has GetActionableIssues(), GetBlockers(), and GetOpenBlockers() which are frequently used but missing from WASM.\n\n## Required Functions\n\n### actionable_nodes()\nReturns indices of nodes with no open blockers (all predecessors satisfied).\n\n### blockers() / open_blockers()\nReturns predecessor node indices, optionally filtered to only open ones.\n\n### dependents()\nReturns successor node indices (issues blocked by this one).\n\n## Acceptance Criteria\n- [ ] actionable_nodes returns nodes with all predecessors closed\n- [ ] blockers/open_blockers match Go behavior\n- [ ] dependents returns successors\n- [ ] WASM bindings expose all functions","status":"closed","priority":2,"type":"task","labels":["algorithm","phase-2","wasm"],"created_at":"2025-12-15 23:46","updated_at":"2025-12-15 23:52","closed_at":"2025-12-15 23:52","blocked_by":["bv-bxoe"],"blocks":["bv-njah"],"pagerank":0.0026443902102538663,"betweenness":3,"eigenvector":0,"hub":0.000008837350028490512,"authority":8.522128708928695e-7,"critical_path":6,"in_degree":1,"out_degree":1,"core_number":2,"slack":7,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-8srm","title":"Standardize git log parsing to NUL delimiter in correlation helpers","notes":"Standardized correlation git-log header format to NUL-delimited across explicit/temporal/reverse + extractor/stream/incremental; added shared constants and bumped scanner buffers; renamed reverse helper to normalizeSHA; go test ./... passes.","status":"closed","priority":2,"type":"bug","labels":["correlation","robustness"],"created_at":"2025-12-16 19:10","updated_at":"2025-12-16 19:16","closed_at":"2025-12-16 19:16","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-90","title":"Lightweight feedback loop for recommendations","description":"Allow optional recording of accept/ignore feedback (e.g., via env or small JSON sidecar) to tune weights over time with simple exponential smoothing per repo. Keep opt-in, local-only, and reversible; expose current weights in robot output for transparency.","status":"closed","priority":3,"type":"task","labels":null,"created_at":"2025-12-15 15:46","updated_at":"2025-12-16 16:52","closed_at":"2025-12-16 16:52","blocked_by":["bv-83"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.0000016740586766286952,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-91","title":"Priority insights panel in TUI","description":"Add a dedicated priority pane in Insights view showing top-N recommendations with reasons, statuses, due-in, unblocks; allow jump-to-issue. Keep consistent with robot ordering and hash/config.","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-15 15:46","updated_at":"2025-12-16 02:20","closed_at":"2025-12-16 02:20","blocked_by":["bv-84"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.0000023879441272987935,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-92","title":"Priority visuals \u0026 exports","description":"Epic to deliver rich visual surfaces for priority intelligence: TUI visualizations (panels, charts), exportable PNG/SVG graph snapshots with summaries, and agent-friendly rendering modes.","status":"closed","priority":2,"type":"epic","labels":null,"created_at":"2025-12-15 15:47","updated_at":"2025-12-16 16:45","closed_at":"2025-12-16 16:45","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-93","title":"TUI priority radar/stacked panel","description":"Add an Insights subpanel showing top-N priority recs with mini-cards: title, PR/BW/impact bars, due-in, unblocks, status flags. Keyboard: toggle from Insights; enter jumps to issue. Keep ordering identical to robot output; include data hash/config in footer.","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-15 15:47","updated_at":"2025-12-16 16:26","closed_at":"2025-12-16 16:26","blocked_by":["bv-83","bv-84"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.000004062002803927489,"authority":0,"critical_path":1,"in_degree":0,"out_degree":2,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-94","title":"Graph snapshot export (PNG/SVG)","description":"Graph snapshot export: PNG/SVG with summary block (hash, node/edge counts, top bottleneck). Respect recipes/workspace scopes. Provide preset selection, keep defaults concise; add legend/title so agents understand meaning without reading README.","notes":"Implemented --export-graph PNG/SVG snapshot export with summary block, legend, preset spacing; recipe-aware; added tests and README docs","status":"closed","priority":2,"type":"task","labels":["tui,export,graph"],"created_at":"2025-12-15 15:47","updated_at":"2025-12-15 21:41","closed_at":"2025-12-15 21:41","blocked_by":["bv-85"],"blocks":["bv-131","bv-96","bv-97"],"pagerank":0.0034256604194162236,"betweenness":4.333333333333333,"eigenvector":0,"hub":7.250554815431066e-9,"authority":0.000004001918836008801,"critical_path":3,"in_degree":3,"out_degree":1,"core_number":2,"slack":10,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-95","title":"Priority heatmap / lane view","description":"Add a heatmap/lane visualization that maps priority score vs. critical-path depth vs. due-in days. Allows scrolling and selection; color encoding matches TUI theme. Useful for spotting clusters of urgent deep blockers.","status":"closed","priority":3,"type":"task","labels":null,"created_at":"2025-12-15 15:47","updated_at":"2025-12-16 16:35","closed_at":"2025-12-16 16:35","blocked_by":["bv-84","bv-81","bv-82","bv-83"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.000007438359069700044,"authority":0,"critical_path":1,"in_degree":0,"out_degree":4,"core_number":3,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-96","title":"Printable priority brief (Markdown/PNG)","description":"Printable priority brief: compact Markdown + rendered PNG combining top recs, reasons, what-if deltas, and graph snapshot. Include hash/config, cap list lengths, add short legend so agents know what each metric means.","status":"closed","priority":3,"type":"task","labels":["tui,export,ai-agent"],"created_at":"2025-12-15 15:47","updated_at":"2025-12-16 16:40","closed_at":"2025-12-16 16:40","blocked_by":["bv-84","bv-83","bv-81","bv-94"],"blocks":["bv-131"],"pagerank":0.0017902298973226836,"betweenness":1.8333333333333333,"eigenvector":0,"hub":0.00000656522266722051,"authority":0.0000013001694461813288,"critical_path":2,"in_degree":1,"out_degree":4,"core_number":3,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-97","title":"Aesthetic graph layout presets","description":"Provide layout presets (compact DAG, force-directed, orthogonal) tuned for readability on large graphs; include default preset for exports and allow flag selection. Presets carry font/spacing/colors optimized for the bv theme.","status":"closed","priority":3,"type":"task","labels":null,"created_at":"2025-12-15 15:47","updated_at":"2025-12-16 16:33","closed_at":"2025-12-16 16:33","blocked_by":["bv-94"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":6.598911607122357e-7,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-98","title":"Labels View \u0026 Dashboard System","description":"# Labels View \u0026 Dashboard System\n\n## Overview\nImplement a comprehensive Labels View that turns labels into a first-class organizational mechanism. This enables long-horizon task coordination by providing dashboards for feature areas (feat:auth), work types (fixes, ui), and epic progress tracking.\n\n## Inspiration\nBased on @kraitsura's Labels Viewer concept showing:\n- Label selector with fuzzy search and progress bars\n- Dashboard view grouping by EPICS and LABELS  \n- Completion tracking (X/Y format with visual progress)\n- Dependency depth toggle\n\n## User Stories\n- As a project lead, I want to see progress across feature areas at a glance\n- As a developer, I want to quickly filter to issues with a specific label\n- As a team, we want to track epic completion with roll-up statistics\n- As anyone, I want fuzzy search to find labels quickly\n\n## Key Features\n\n### 1. Label Selector (Overlay)\n- Fuzzy searchable picker accessible via \\`l\\` key from any view\n- Shows all labels and epics with progress bars\n- X/Y format showing completed vs total\n- Checkmarks for 100% complete labels\n\n### 2. Label Dashboard View  \n- Dedicated view showing label statistics\n- Two sections: EPICS (issues with type=epic) and LABELS\n- Progress bars with completion percentages\n- Expandable to drill into issues per label\n- Section cycling: Ready/Blocked/InProgress/Closed\n\n### 3. Dependency Depth Toggle\n- \\`d\\` key cycles through 1/2/3/All depth levels\n- Controls how deeply to show dependency chains\n- Current depth shown in status bar\n\n### 4. Visual Enhancements\n- Distinction between labeled and unlabeled issues\n- Epic progress roll-up from child issues\n- Quick jump from dashboard to filtered list\n\n## Keybindings\n| Key | Action |\n|-----|--------|\n| l | Open label selector (global) |\n| Enter | Select label / Confirm |\n| Esc | Close selector / Back |\n| j/k | Navigate |\n| Tab | Cycle sections |\n| d | Cycle dependency depth |\n\n## Success Criteria\n- [ ] \\`l\\` key opens label selector from any view\n- [ ] Dashboard shows accurate progress for all labels\n- [ ] Fuzzy search finds labels quickly\n- [ ] Epic completion rolls up from children\n- [ ] Dependency depth toggle works smoothly\n\n## Implementation Phases\n1. **Phase 1**: Label statistics extraction and data model\n2. **Phase 2**: Label selector UI with fuzzy search\n3. **Phase 3**: Label dashboard view\n4. **Phase 4**: Integration, depth toggle, polish","status":"closed","priority":1,"type":"epic","labels":["epic","feature","labels-view","tui"],"created_at":"2025-12-15 15:48","updated_at":"2025-12-15 15:55","closed_at":"2025-12-15 15:55","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-99","title":"Labels View: Label-Centric Analysis \u0026 Navigation","description":"Labels as graph overlays enabling label-filtered analysis, cross-label dependency flows, health dashboards, velocity tracking, and attention ranking. Integrates with existing graph metrics (PageRank, betweenness, critical path) to provide label-specific insights. Includes robot protocol extensions for AI agents.","notes":"Added label health computations (velocity, freshness, flow, criticality) + aggregate ComputeAllLabelHealth; next: wire into robot/TUI and tests","status":"closed","priority":1,"type":"epic","labels":["labels-view"],"created_at":"2025-12-15 15:52","updated_at":"2025-12-16 11:43","closed_at":"2025-12-16 11:43","blocks":["bv-100","bv-101","bv-102","bv-103","bv-104","bv-105","bv-106","bv-107","bv-108","bv-109","bv-110","bv-111","bv-112","bv-113","bv-114","bv-115","bv-116","bv-117","bv-118","bv-119","bv-120","bv-121","bv-122","bv-123","bv-124","bv-125","bv-126","bv-127","bv-128","bv-147","bv-164"],"pagerank":0.03623109466534581,"betweenness":0,"eigenvector":0,"hub":0,"authority":0.9115466971110722,"critical_path":7,"in_degree":31,"out_degree":0,"core_number":3,"slack":8,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-9gf","title":"Semantic Vector Search","description":"Add natural language search via vector embeddings, enabling queries like 'memory leak issues' to find relevant results even without exact keyword matches.\n\n## Background \u0026 Motivation\nCurrent search is regex-based, requiring exact matches. Users want to search by meaning, not just keywords. AI agents benefit from semantic retrieval for RAG patterns.\n\n## Value Proposition\n- For Humans: 'that thing about memory leaks' actually finds it\n- For AI Agents: RAG over project history - 'how did we solve similar issues before?'\n\n## Technical Approach\n1. Local embeddings (start simple: sentence-transformers via subprocess or pure Go)\n2. Vector storage (sqlite-vec extension or simple flat file)\n3. Incremental indexing (embed on first access, update when issues change)\n4. Semantic search mode in CLI and TUI\n\n## Scope Control\nStart minimal:\n- Embed title + description only\n- Single embedding model\n- Top-10 results\n- No hybrid search initially\n\n## Dependencies \u0026 Risks\n- Embedding model choice affects quality and size\n- May require external tool (Python) initially\n- Could start with Go-native solution later","status":"closed","priority":3,"type":"epic","labels":["ai-agent","search","semantic"],"created_at":"2025-11-26 23:37","updated_at":"2025-12-16 15:57","closed_at":"2025-12-16 15:57","blocks":["bv-177"],"pagerank":0.001965930799075285,"betweenness":0,"eigenvector":0,"hub":0,"authority":1.9814173870338827e-9,"critical_path":3,"in_degree":1,"out_degree":0,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-9gf.1","title":"Research and select embedding approach","description":"Evaluate: Python subprocess (sentence-transformers), Go-native, API-based, sqlite-vec. Consider quality, complexity, performance, binary size.","status":"closed","priority":3,"type":"task","labels":["embedding","research"],"created_at":"2025-11-26 23:40","updated_at":"2025-12-16 13:18","closed_at":"2025-12-16 13:18","blocks":["bv-9gf.2"],"pagerank":0.003798240094886169,"betweenness":0,"eigenvector":0,"hub":0,"authority":4.7854460253878835e-21,"critical_path":3,"in_degree":1,"out_degree":0,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-9gf.2","title":"Implement vector storage and indexing","description":"sqlite-vec or flat file. Store issue_id, embedding, content_hash. Search returns top-k by similarity. Incremental updates.","status":"closed","priority":3,"type":"task","labels":["search","storage","vectors"],"created_at":"2025-11-26 23:40","updated_at":"2025-12-16 13:24","closed_at":"2025-12-16 13:24","blocked_by":["bv-9gf.1"],"blocks":["bv-9gf.3"],"pagerank":0.002731484890410988,"betweenness":1,"eigenvector":0,"hub":7.890898495503672e-22,"authority":4.7854460253878835e-21,"critical_path":2,"in_degree":1,"out_degree":1,"core_number":1,"slack":12,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-9gf.3","title":"Add semantic search CLI and TUI integration","description":"bv --search 'query' for semantic search. --robot-search outputs JSON. TUI: Ctrl+S toggles semantic/regex mode. First-run index build UX.","status":"closed","priority":3,"type":"task","labels":["cli","search","tui"],"created_at":"2025-11-26 23:40","updated_at":"2025-12-16 15:22","closed_at":"2025-12-16 15:22","blocked_by":["bv-9gf.2"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":7.890898495503672e-22,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-a00v","title":"Port TopK Set (greedy submodular selection) to Rust WASM","description":"# Port TopK Set Algorithm\n\n## Context\nTopK Set finds the k issues that, when completed, maximize the total downstream unlocks. Uses greedy submodular optimization.\n\n## Go Implementation Reference\n```go\n// generateTopKSet in advanced_insights.go\n// Greedy selection maximizing marginal unlocks\n```\n\n## Rust Implementation (advanced/topk_set.rs)\n```rust\nuse crate::graph::DiGraph;\nuse crate::whatif;\n\n#[derive(Debug, Clone)]\npub struct TopKSetItem {\n    pub node: usize,\n    pub marginal_gain: usize,\n}\n\npub struct TopKSetResult {\n    pub items: Vec\u003cTopKSetItem\u003e,\n    pub total_gain: usize,\n}\n\n/// Greedy submodular selection for maximum unlock.\npub fn topk_set(graph: \u0026DiGraph, closed_set: \u0026[bool], k: usize) -\u003e TopKSetResult {\n    let n = graph.node_count();\n    let mut selected = Vec::new();\n    let mut current_closed = closed_set.to_vec();\n    let mut total_gain = 0;\n    \n    for _ in 0..k {\n        // Find node with maximum marginal gain\n        let mut best_node = None;\n        let mut best_gain = 0;\n        \n        for v in 0..n {\n            if current_closed[v] { continue; }\n            \n            let result = whatif::what_if_close(graph, v, \u0026current_closed);\n            if result.transitive_unblocks \u003e best_gain {\n                best_gain = result.transitive_unblocks;\n                best_node = Some(v);\n            }\n        }\n        \n        match best_node {\n            Some(node) =\u003e {\n                selected.push(TopKSetItem {\n                    node,\n                    marginal_gain: best_gain,\n                });\n                current_closed[node] = true;\n                total_gain += best_gain;\n            }\n            None =\u003e break, // No more beneficial nodes\n        }\n    }\n    \n    TopKSetResult {\n        items: selected,\n        total_gain,\n    }\n}\n```\n\n## Acceptance Criteria\n- [ ] Greedy selection maximizes total gain\n- [ ] Returns k items (or fewer if exhausted)\n- [ ] Marginal gains decrease monotonically","notes":"PERFORMANCE NOTE: Current implementation calls what_if_close() for every open node in each iteration. For n nodes and k iterations: O(n*k) calls. Each what_if is O(n), so total is O(n¬≤*k).\n\nFor 1000 nodes, k=10: ~10M operations.\n\nOPTIMIZATION OPPORTUNITY: Memoize/cache what-if results, or use incremental updates as nodes are 'closed' during selection.","status":"closed","priority":2,"type":"task","labels":["advanced","phase-3","wasm"],"created_at":"2025-12-15 23:36","updated_at":"2025-12-16 02:11","closed_at":"2025-12-16 02:11","blocked_by":["bv-njah"],"blocks":["bv-y7a0"],"pagerank":0.0018889407873369957,"betweenness":0,"eigenvector":0,"hub":0.000002029146711610972,"authority":0.000010677870334373396,"critical_path":4,"in_degree":1,"out_degree":1,"core_number":2,"slack":6,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-a276","title":"Port Eigenvector Centrality to Rust WASM","description":"# Port Eigenvector Centrality to Rust WASM\n\n## Context\nEigenvector centrality measures node importance based on connections to other important nodes. Unlike PageRank, it uses the principal eigenvector of the adjacency matrix directly.\n\n## Go Implementation Reference\n```go\n// computeEigenvector in graph.go\n// Power iteration with 50 iterations\n// Deterministic ordering for reproducibility\n```\n\n## Rust Implementation (eigenvector.rs)\n```rust\nuse crate::graph::DiGraph;\n\n/// Compute eigenvector centrality using power iteration.\n/// Uses incoming edges (nodes pointed TO are important).\npub fn eigenvector(graph: \u0026DiGraph, iterations: u32) -\u003e Vec\u003cf64\u003e {\n    let n = graph.node_count();\n    if n == 0 {\n        return Vec::new();\n    }\n    \n    // Initialize with uniform distribution\n    let mut vec = vec![1.0 / n as f64; n];\n    let mut work = vec![0.0; n];\n    \n    for _ in 0..iterations {\n        // Reset work vector\n        for w in \u0026mut work {\n            *w = 0.0;\n        }\n        \n        // Multiply: work = A^T * vec (sum of predecessor scores)\n        for v in 0..n {\n            for \u0026u in graph.predecessors(v) {\n                work[v] += vec[u];\n            }\n        }\n        \n        // Normalize to unit length\n        let norm: f64 = work.iter().map(|x| x * x).sum::\u003cf64\u003e().sqrt();\n        if norm == 0.0 {\n            break;\n        }\n        for w in \u0026mut work {\n            *w /= norm;\n        }\n        \n        std::mem::swap(\u0026mut vec, \u0026mut work);\n    }\n    \n    vec\n}\n```\n\n## Acceptance Criteria\n- [ ] Power iteration converges\n- [ ] Results match Go implementation\n- [ ] Handles disconnected graphs\n- [ ] Performance: \u003c5ms for 1000 nodes","status":"closed","priority":2,"type":"task","labels":["algorithm","phase-2","wasm"],"created_at":"2025-12-15 23:33","updated_at":"2025-12-16 00:29","closed_at":"2025-12-16 00:29","blocked_by":["bv-bxoe"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.000008837350028490512,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-ake","title":"Write comprehensive tests for static export pipeline","description":"# Write Comprehensive Tests for Static Export Pipeline\n\n## Context\nThe static export feature uses SQLite + sql.js architecture. Tests must verify:\n- SQLite schema creation and population\n- FTS5 search functionality\n- Materialized view correctness\n- Chunking for large databases\n- Client-side sql.js queries\n\n## Requirements\n\n### Unit Tests (pkg/export/)\n\n#### sqlite_schema_test.go\n```go\nfunc TestCreateSchema(t *testing.T) {\n    db := setupTestDB(t)\n    defer db.Close()\n    \n    // Create schema\n    err := createSchema(db)\n    require.NoError(t, err)\n    \n    // Verify tables exist\n    tables := []string{\"issues\", \"dependencies\", \"issue_metrics\", \"export_meta\"}\n    for _, table := range tables {\n        var name string\n        err := db.QueryRow(\"SELECT name FROM sqlite_master WHERE type='table' AND name=?\", table).Scan(\u0026name)\n        require.NoError(t, err, \"table %s should exist\", table)\n    }\n    \n    // Verify FTS5 virtual table\n    var ftsName string\n    err = db.QueryRow(\"SELECT name FROM sqlite_master WHERE type='table' AND name='issues_fts'\").Scan(\u0026ftsName)\n    require.NoError(t, err, \"FTS5 table should exist\")\n}\n\nfunc TestFTS5Search(t *testing.T) {\n    db := setupTestDBWithData(t)\n    defer db.Close()\n    \n    // Test prefix search\n    rows, err := db.Query(\"SELECT id FROM issues_fts WHERE issues_fts MATCH 'auth*'\")\n    require.NoError(t, err)\n    \n    var ids []string\n    for rows.Next() {\n        var id string\n        rows.Scan(\u0026id)\n        ids = append(ids, id)\n    }\n    \n    assert.Contains(t, ids, \"bv-auth-001\")\n    assert.Contains(t, ids, \"bv-auth-002\")\n}\n\nfunc TestMaterializedView(t *testing.T) {\n    db := setupTestDBWithData(t)\n    defer db.Close()\n    \n    // Verify issue_overview_mv has correct joins\n    var count int\n    err := db.QueryRow(\"SELECT COUNT(*) FROM issue_overview_mv WHERE pagerank IS NOT NULL\").Scan(\u0026count)\n    require.NoError(t, err)\n    assert.Greater(t, count, 0)\n}\n```\n\n#### sqlite_export_test.go\n```go\nfunc TestSQLiteExporter_Export(t *testing.T) {\n    tmpDir := t.TempDir()\n    issues := generateTestIssues(100)\n    graph := analysis.BuildGraph(issues)\n    \n    exporter := \u0026SQLiteExporter{\n        issues:   issues,\n        graph:    graph,\n        insights: analysis.ComputeInsights(graph),\n    }\n    \n    err := exporter.Export(tmpDir)\n    require.NoError(t, err)\n    \n    // Verify database created\n    dbPath := filepath.Join(tmpDir, \"beads.sqlite3\")\n    assert.FileExists(t, dbPath)\n    \n    // Verify queryable\n    db, _ := sql.Open(\"sqlite3\", dbPath)\n    defer db.Close()\n    \n    var issueCount int\n    db.QueryRow(\"SELECT COUNT(*) FROM issues\").Scan(\u0026issueCount)\n    assert.Equal(t, 100, issueCount)\n}\n\nfunc TestSQLiteExporter_ChunkLargeDB(t *testing.T) {\n    tmpDir := t.TempDir()\n    issues := generateTestIssues(5000) // Large dataset\n    \n    exporter := \u0026SQLiteExporter{issues: issues}\n    err := exporter.Export(tmpDir)\n    require.NoError(t, err)\n    \n    // Verify chunks created for large DB\n    configPath := filepath.Join(tmpDir, \"beads.sqlite3.config.json\")\n    if fileSize(filepath.Join(tmpDir, \"beads.sqlite3\")) \u003e 5*1024*1024 {\n        assert.FileExists(t, configPath)\n        assert.DirExists(t, filepath.Join(tmpDir, \"chunks\"))\n    }\n}\n\nfunc TestSQLiteExporter_Optimization(t *testing.T) {\n    tmpDir := t.TempDir()\n    exporter := \u0026SQLiteExporter{issues: generateTestIssues(10)}\n    exporter.Export(tmpDir)\n    \n    // Verify optimizations applied\n    db, _ := sql.Open(\"sqlite3\", filepath.Join(tmpDir, \"beads.sqlite3\"))\n    defer db.Close()\n    \n    // Check page_size\n    var pageSize int\n    db.QueryRow(\"PRAGMA page_size\").Scan(\u0026pageSize)\n    assert.Equal(t, 1024, pageSize)\n    \n    // Check journal mode\n    var journalMode string\n    db.QueryRow(\"PRAGMA journal_mode\").Scan(\u0026journalMode)\n    assert.Equal(t, \"delete\", journalMode)\n}\n```\n\n#### github_test.go\n```go\nfunc TestCheckGHInstalled(t *testing.T) {\n    // Use exec mock\n    installed, err := CheckGHInstalled()\n    // Result depends on system\n    assert.NoError(t, err)\n}\n\nfunc TestCreateRepository_Mock(t *testing.T) {\n    // Mock gh CLI calls using exectest\n    mockExec := setupMockExec(t, map[string]string{\n        \"gh repo create\": \"\",\n        \"gh repo view\": `{\"nameWithOwner\": \"user/test-repo\"}`,\n    })\n    defer mockExec.Restore()\n    \n    name, err := CreateRepository(\"test-repo\", false, \"Test\")\n    require.NoError(t, err)\n    assert.Equal(t, \"user/test-repo\", name)\n}\n```\n\n### JavaScript Tests (viewer.test.js)\n\n#### sql.js Integration\n```javascript\nimport initSqlJs from 'sql.js';\n\ndescribe('Database Loading', () =\u003e {\n    let SQL, db;\n    \n    beforeAll(async () =\u003e {\n        SQL = await initSqlJs();\n    });\n    \n    beforeEach(() =\u003e {\n        db = new SQL.Database();\n        // Create test schema\n        db.run(`CREATE TABLE issues (id TEXT PRIMARY KEY, title TEXT)`);\n        db.run(`INSERT INTO issues VALUES ('bv-1', 'Test Issue')`);\n    });\n    \n    afterEach(() =\u003e {\n        db.close();\n    });\n    \n    it('queries issues correctly', () =\u003e {\n        const results = db.exec('SELECT * FROM issues');\n        expect(results[0].values.length).toBe(1);\n        expect(results[0].values[0][0]).toBe('bv-1');\n    });\n    \n    it('handles FTS5 search', () =\u003e {\n        db.run(`CREATE VIRTUAL TABLE issues_fts USING fts5(id, title, content='issues')`);\n        db.run(`INSERT INTO issues_fts(issues_fts) VALUES('rebuild')`);\n        \n        const results = db.exec(`SELECT id FROM issues_fts WHERE issues_fts MATCH 'Test'`);\n        expect(results[0].values.length).toBe(1);\n    });\n});\n\ndescribe('Filtering', () =\u003e {\n    it('builds correct SQL for status filter', () =\u003e {\n        const { sql, params } = buildIssueQuery({ status: ['open', 'in_progress'] });\n        expect(sql).toContain('status IN (?,?)');\n        expect(params).toContain('open');\n    });\n    \n    it('builds correct SQL for search', () =\u003e {\n        const { sql, params } = buildIssueQuery({ search: 'auth' });\n        expect(sql).toContain('issues_fts MATCH');\n        expect(params[0]).toBe('auth*');\n    });\n});\n\ndescribe('OPFS Caching', () =\u003e {\n    it('caches to OPFS when available', async () =\u003e {\n        // Mock navigator.storage\n        const mockOPFS = setupMockOPFS();\n        \n        await cacheToOPFS(new Uint8Array([1, 2, 3]));\n        \n        expect(mockOPFS.writeCalledWith).toEqual(new Uint8Array([1, 2, 3]));\n    });\n    \n    it('gracefully handles OPFS unavailable', async () =\u003e {\n        // No mock = OPFS unavailable\n        await expect(cacheToOPFS(new Uint8Array([1, 2, 3]))).resolves.not.toThrow();\n    });\n});\n```\n\n### Integration Tests\n\n#### export_integration_test.go\n```go\nfunc TestExportEndToEnd(t *testing.T) {\n    if testing.Short() {\n        t.Skip(\"skipping integration test\")\n    }\n    \n    // Use real .beads fixture\n    fixturePath := \"testdata/sample_beads\"\n    tmpDir := t.TempDir()\n    \n    // Run export\n    err := RunStaticExport(fixturePath, tmpDir, ExportConfig{\n        IncludeClosed: false,\n        Title:         \"Test Export\",\n    })\n    require.NoError(t, err)\n    \n    // Validate outputs\n    assert.FileExists(t, filepath.Join(tmpDir, \"beads.sqlite3\"))\n    assert.FileExists(t, filepath.Join(tmpDir, \"index.html\"))\n    assert.FileExists(t, filepath.Join(tmpDir, \"vendor/sql-wasm.js\"))\n    assert.FileExists(t, filepath.Join(tmpDir, \"data/triage.json\"))\n    \n    // Verify database is valid\n    db, _ := sql.Open(\"sqlite3\", filepath.Join(tmpDir, \"beads.sqlite3\"))\n    defer db.Close()\n    \n    var count int\n    db.QueryRow(\"SELECT COUNT(*) FROM issues\").Scan(\u0026count)\n    assert.Greater(t, count, 0)\n}\n```\n\n### Test Fixtures\n\n#### testdata/sample_beads/beads.jsonl\nSmall representative dataset with:\n- Mix of statuses, types, priorities\n- Dependencies (blocks/blocked-by)\n- Labels\n- Various edge cases (long titles, markdown descriptions, unicode)\n\n### Coverage Goals\n- SQLite export pipeline: \u003e80%\n- Schema/FTS5 tests: \u003e90%\n- GitHub integration: \u003e70% (mocked)\n- Viewer JS: \u003e60% (unit tests with sql.js)\n\n## Acceptance Criteria\n- [ ] SQLite schema tests pass\n- [ ] FTS5 search tests pass\n- [ ] Materialized view tests pass\n- [ ] Chunking tests pass\n- [ ] Export integration test passes\n- [ ] JavaScript sql.js tests pass\n- [ ] OPFS caching tests pass\n- [ ] Test fixtures committed\n- [ ] Coverage meets goals\n- [ ] Tests run in CI (\u003c60s total)\n- [ ] Mocks do not require external tools","status":"closed","priority":2,"type":"task","labels":["static-pages","testing"],"created_at":"2025-12-15 23:10","updated_at":"2025-12-16 10:42","closed_at":"2025-12-16 10:42","blocked_by":["bv-w97","bv-kdn"],"blocks":["bv-y5i"],"pagerank":0.0015706037203119501,"betweenness":0,"eigenvector":0,"hub":0.0001100485186555619,"authority":0.0001967059030531822,"critical_path":3,"in_degree":1,"out_degree":2,"core_number":3,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-awl","title":"Add dark mode support with system preference detection","description":"# Add Dark Mode Support with System Preference Detection\n\n## Context\nModern web apps should support dark mode. The static viewer should detect system preference and allow manual toggle, persisting the choice.\n\n## Requirements\n\n### Early Theme Detection (No Flash)\nIn \u003chead\u003e before any content renders:\n```html\n\u003cscript\u003e\n(function() {\n    const stored = localStorage.getItem('darkMode');\n    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;\n    \n    if (stored === 'true' || (stored === null \u0026\u0026 prefersDark)) {\n        document.documentElement.classList.add('dark');\n    }\n})();\n\u003c/script\u003e\n```\n\n### Tailwind Dark Mode Config\n```javascript\ntailwind.config = {\n    darkMode: 'class',\n    // ...\n}\n```\n\n### Theme Toggle Component\n```javascript\nfunction themeToggle() {\n    return {\n        darkMode: document.documentElement.classList.contains('dark'),\n        \n        toggle() {\n            this.darkMode = !this.darkMode;\n            document.documentElement.classList.toggle('dark', this.darkMode);\n            localStorage.setItem('darkMode', this.darkMode);\n        },\n        \n        init() {\n            // Listen for system preference changes\n            window.matchMedia('(prefers-color-scheme: dark)')\n                .addEventListener('change', (e) =\u003e {\n                    if (localStorage.getItem('darkMode') === null) {\n                        this.darkMode = e.matches;\n                        document.documentElement.classList.toggle('dark', this.darkMode);\n                    }\n                });\n        }\n    };\n}\n```\n\n### Toggle Button UI\n```html\n\u003cbutton \n    x-data=\"themeToggle()\" \n    @click=\"toggle()\"\n    class=\"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800\"\n    :title=\"darkMode ? 'Switch to light mode' : 'Switch to dark mode'\"\n\u003e\n    \u003c!-- Sun icon (shown in dark mode) --\u003e\n    \u003csvg x-show=\"darkMode\" class=\"w-5 h-5\" ...\u003e\n        \u003cpath d=\"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364...\"/\u003e\n    \u003c/svg\u003e\n    \n    \u003c!-- Moon icon (shown in light mode) --\u003e\n    \u003csvg x-show=\"!darkMode\" class=\"w-5 h-5\" ...\u003e\n        \u003cpath d=\"M20.354 15.354A9 9 0 018.646 3.646...\"/\u003e\n    \u003c/svg\u003e\n\u003c/button\u003e\n```\n\n### Color Scheme\n```css\n/* Light mode defaults via Tailwind */\n/* Dark mode overrides */\n\n:root {\n    --color-bg-primary: #ffffff;\n    --color-bg-secondary: #f9fafb;\n    --color-text-primary: #111827;\n    --color-text-secondary: #6b7280;\n    --color-border: #e5e7eb;\n}\n\n.dark {\n    --color-bg-primary: #111827;\n    --color-bg-secondary: #1f2937;\n    --color-text-primary: #f9fafb;\n    --color-text-secondary: #9ca3af;\n    --color-border: #374151;\n}\n```\n\n### Status Badge Colors\nEnsure good contrast in both modes:\n```\nStatus      Light Mode      Dark Mode\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nOpen        blue-500        blue-400\nIn Progress amber-500       amber-400\nBlocked     red-500         red-400\nClosed      gray-500        gray-400\n\nType        Light Mode      Dark Mode\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nBug         red-100/600     red-900/300\nFeature     purple-100/600  purple-900/300\nTask        blue-100/600    blue-900/300\nEpic        amber-100/600   amber-900/300\n```\n\n### Mermaid Dark Mode\n```javascript\nfunction getMermaidConfig() {\n    const dark = document.documentElement.classList.contains('dark');\n    return {\n        theme: dark ? 'dark' : 'default',\n        themeVariables: dark ? {\n            primaryColor: '#4f46e5',\n            primaryTextColor: '#f9fafb',\n            primaryBorderColor: '#6366f1',\n            lineColor: '#6b7280',\n            secondaryColor: '#1f2937',\n            tertiaryColor: '#374151'\n        } : {}\n    };\n}\n\n// Re-render graphs when theme changes\nfunction onThemeChange() {\n    if (typeof mermaid !== 'undefined') {\n        mermaid.initialize(getMermaidConfig());\n        // Re-render visible graphs\n    }\n}\n```\n\n## Acceptance Criteria\n- [ ] Detects system dark mode preference\n- [ ] Allows manual toggle\n- [ ] Persists choice in localStorage\n- [ ] No flash of wrong theme on load\n- [ ] All UI elements have dark mode styles\n- [ ] Mermaid graphs update with theme\n- [ ] Status badges readable in both modes\n- [ ] Toggle button shows appropriate icon\n\n## Testing\n- Test in Chrome, Firefox, Safari\n- Test system preference changes\n- Test localStorage clear behavior\n- Test with prefers-color-scheme: dark","status":"closed","priority":3,"type":"task","labels":["phase-4","static-pages"],"created_at":"2025-12-15 23:09","updated_at":"2025-12-16 10:46","closed_at":"2025-12-16 10:46","blocked_by":["bv-uun","bv-5yb"],"blocks":["bv-y5i"],"pagerank":0.0015706037203119501,"betweenness":0,"eigenvector":0,"hub":0.00007879179036287026,"authority":0.0001967059030531822,"critical_path":3,"in_degree":1,"out_degree":2,"core_number":3,"slack":9,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-b23i","title":"Interactive Graph Visualization with Force-Graph","description":"# Interactive Graph Visualization with Force-Graph\n\n## Vision\nTransform the static viewer from a simple table into an **immersive, interactive graph exploration experience**. Using [force-graph](https://github.com/vasturiano/force-graph) (WebGL-accelerated), users can explore their dependency graph visually, see patterns at a glance, and perform what-if analysis with beautiful animations.\n\n## Why This Matters\n\n### Current State: Tables Are Limiting\n- Users scroll through lists, mentally reconstructing relationships\n- Hard to see the \"big picture\" of work\n- Bottlenecks and cycles are numbers, not visible patterns\n- No way to explore \"what if I close this?\"\n\n### Future State: Visual Graph Intelligence\n- **See the shape** of your work at a glance\n- **Spot bottlenecks** as large, central nodes\n- **Find cycles** as visual loops\n- **Explore what-if** by clicking nodes and watching cascades\n- **Understand priority** through size, color, position\n\n## Core Features\n\n### 1. Force-Directed Dependency Graph\n- Nodes = issues, sized by impact (PageRank/blocker count)\n- Edges = dependencies with directional arrows\n- Colors: green (closed), blue (open), orange (blocked), red (critical)\n- Smooth WebGL rendering for 1000+ nodes at 60fps\n- Click node to focus, hover for tooltip, drag to reorganize\n\n### 2. Visual What-If Analysis\n- Click any open issue to \"simulate close\"\n- Watch downstream unblocks animate (ripple effect)\n- See parallelization gain visually\n- Color transitions: blocked‚Üíunblocked nodes glow green\n- Reset button to restore original state\n\n### 3. Smart Clustering\n- Automatic grouping by label using force clustering\n- Label \"galaxies\" with distinct colors\n- Cross-label edges show integration points\n- Expand/collapse clusters\n- Mini-map for navigation\n\n### 4. Critical Path Highlighting\n- Toggle to highlight longest dependency chain\n- Animate path traversal\n- Show \"time to completion\" along path\n- Compare multiple paths\n\n### 5. Time Travel Animation\n- Scrubber to move through git history\n- Watch graph grow/shrink over time\n- See issues appear, get worked on, close\n- Playback controls (play, pause, speed)\n\n## Technical Architecture\n\n### Library Choice: force-graph\n- **Why**: WebGL-accelerated, handles 10k+ nodes, excellent API\n- **CDN**: `https://unpkg.com/force-graph`\n- **Alternative**: 3d-force-graph for even cooler 3D view\n- **Fallback**: vis-network if WebGL unavailable\n\n### Data Flow\n```\nSQLite ‚Üí JS ‚Üí WASM (metrics) ‚Üí force-graph (render)\n                ‚Üì\n         User interaction\n                ‚Üì\n         WASM (what-if) ‚Üí Animated update\n```\n\n### Performance Targets\n- Initial render: \u003c500ms for 500 nodes\n- What-if calculation + animation: \u003c100ms\n- Smooth 60fps during interaction\n- Memory: \u003c100MB for 1000-node graph\n\n## Visual Design Principles\n\n1. **Clarity**: Important things are bigger, brighter\n2. **Consistency**: Same colors mean same things everywhere\n3. **Delight**: Smooth animations, satisfying interactions\n4. **Accessibility**: Colorblind-safe palette, keyboard nav\n\n## Success Metrics\n- Users can identify top bottleneck in \u003c5 seconds\n- What-if takes \u003c2 clicks to understand impact\n- 90%+ of users prefer graph view over table for exploration\n- Zero WebGL crashes/freezes\n\n## Dependencies\n- WASM Graph Engine (bv-5mgw) for metrics\n- SQLite viewer infrastructure\n- Static export with dependency data\n\n## References\n- force-graph: https://github.com/vasturiano/force-graph\n- 3d-force-graph: https://github.com/vasturiano/3d-force-graph\n- D3 force simulation: https://d3js.org/d3-force\n- Graph viz inspiration: https://observablehq.com/@d3/force-directed-graph","status":"closed","priority":1,"type":"epic","labels":["static-pages","ux","visualization"],"assignee":"WhiteCastle","created_at":"2025-12-15 23:55","updated_at":"2025-12-16 17:07","closed_at":"2025-12-16 17:07","blocked_by":["bv-5mgw","bv-y5i"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.00003557851616717304,"authority":0,"critical_path":1,"in_degree":0,"out_degree":2,"core_number":2,"slack":7,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-bikt","title":"Port Critical Path Heights to Rust WASM","description":"# Port Critical Path Heights to Rust WASM\n\n## Context\nCritical path heights measure the longest dependency chain from roots to each node. Nodes with high heights are deep in the dependency tree.\n\n## Go Implementation Reference\n```go\n// computeHeights in graph.go\n// DAG depth using topological order\n```\n\n## Rust Implementation (critical_path.rs)\n```rust\nuse crate::graph::DiGraph;\nuse crate::algorithms::topo::topological_sort;\n\n/// Compute critical path heights (depth in DAG).\n/// Height[v] = 1 + max(height of predecessors)\npub fn critical_path_heights(graph: \u0026DiGraph) -\u003e Vec\u003cf64\u003e {\n    let n = graph.node_count();\n    if n == 0 {\n        return Vec::new();\n    }\n    \n    // Topological order (returns None if cyclic)\n    let order = match topological_sort(graph) {\n        Some(o) =\u003e o,\n        None =\u003e return vec![0.0; n], // Return zeros for cyclic graphs\n    };\n    \n    let mut heights = vec![0.0; n];\n    \n    // Process in topological order\n    for \u0026v in \u0026order {\n        let max_pred_height = graph.predecessors(v)\n            .iter()\n            .map(|\u0026u| heights[u])\n            .fold(0.0, f64::max);\n        \n        heights[v] = 1.0 + max_pred_height;\n    }\n    \n    heights\n}\n\n/// Get nodes on the critical path (those with maximum height).\npub fn critical_path_nodes(graph: \u0026DiGraph) -\u003e Vec\u003cusize\u003e {\n    let heights = critical_path_heights(graph);\n    if heights.is_empty() {\n        return Vec::new();\n    }\n    \n    let max_height = heights.iter().cloned().fold(0.0, f64::max);\n    heights.iter()\n        .enumerate()\n        .filter(|(_, \u0026h)| (h - max_height).abs() \u003c 0.001)\n        .map(|(i, _)| i)\n        .collect()\n}\n```\n\n## Acceptance Criteria\n- [ ] Heights computed correctly for DAGs\n- [ ] Returns zeros for cyclic graphs\n- [ ] Critical path nodes identified","status":"closed","priority":2,"type":"task","labels":["algorithm","phase-2","wasm"],"created_at":"2025-12-15 23:34","updated_at":"2025-12-16 00:19","closed_at":"2025-12-16 00:19","blocked_by":["bv-yi6k"],"blocks":["bv-2nyt","bv-gij1","bv-njah","bv-y7a0"],"pagerank":0.005556644590634121,"betweenness":14.5,"eigenvector":0,"hub":5.67829548553972e-7,"authority":0.00001326746215796145,"critical_path":6,"in_degree":4,"out_degree":1,"core_number":2,"slack":6,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-boyo","title":"CI: Run short E2E suite (avoid Go 10m package timeout)","description":"Historically go test ./tests/e2e could exceed Go‚Äôs default 10m per-package timeout due to repeated go build in multiple tests. Fix: build bv once in TestMain and reuse via buildBvBinary(t); full suite now runs in ~35‚Äì40s. CI runs coverage on ./pkg/... ./cmd/bv and runs the E2E suite separately.","status":"closed","priority":3,"type":"chore","labels":["ci","e2e","tests"],"created_at":"2025-12-17 02:50","updated_at":"2025-12-17 03:42","closed_at":"2025-12-17 03:42","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-bw7z","title":"Unit test: sprint_view.go - Sprint view rendering","description":"Create unit tests for pkg/ui/sprint_view.go\n\n## File Overview\nsprint_view.go renders sprint planning views with capacity and workload visualization.\n\n## Test Cases to Implement\n1. **Sprint Display**\n   - No active sprint\n   - Sprint with issues\n   - Sprint capacity progress bar\n   - Sprint burndown visualization\n\n2. **Capacity Visualization**\n   - Under capacity (green)\n   - At capacity (yellow)\n   - Over capacity (red)\n   - Percentage display\n\n3. **Issue Grouping**\n   - Group by assignee\n   - Group by label\n   - Group by priority\n   - Unassigned section\n\n4. **Interactive Features**\n   - Issue selection\n   - Sprint navigation\n   - Capacity adjustment hints\n\n## Implementation Notes\n- Create Sprint test fixtures\n- Test time-based calculations\n- Verify progress bar accuracy","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-16 20:06","updated_at":"2025-12-16 23:28","closed_at":"2025-12-16 23:28","blocks":["bv-ul1l"],"pagerank":0.0017282929585731776,"betweenness":0,"eigenvector":0,"hub":0,"authority":6.623673282227765e-11,"critical_path":4,"in_degree":1,"out_degree":0,"core_number":1,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-bxoe","title":"Implement DiGraph core structure with adjacency lists","description":"# Implement DiGraph Core Structure\n\n## Context\nThe DiGraph struct is the foundation of the WASM graph engine. It needs to efficiently store directed graphs and support fast traversal for all algorithms.\n\n## Requirements\n\n### Core Structure (graph.rs)\n```rust\nuse wasm_bindgen::prelude::*;\nuse std::collections::HashMap;\n\n/// Directed graph optimized for graph algorithms.\n/// Uses adjacency lists for O(1) neighbor access.\n#[wasm_bindgen]\npub struct DiGraph {\n    /// Node ID strings (issue IDs like \"bv-123\")\n    nodes: Vec\u003cString\u003e,\n    \n    /// Reverse lookup: ID string -\u003e index\n    node_index: HashMap\u003cString, usize\u003e,\n    \n    /// Forward adjacency: adj[u] = vec of nodes that u points to\n    /// (u depends on these nodes)\n    adj: Vec\u003cVec\u003cusize\u003e\u003e,\n    \n    /// Reverse adjacency: rev_adj[v] = vec of nodes pointing to v\n    /// (these nodes depend on v)\n    rev_adj: Vec\u003cVec\u003cusize\u003e\u003e,\n    \n    /// Edge count (for density calculation)\n    edge_count: usize,\n}\n\n#[wasm_bindgen]\nimpl DiGraph {\n    /// Create an empty graph\n    #[wasm_bindgen(constructor)]\n    pub fn new() -\u003e DiGraph {\n        DiGraph {\n            nodes: Vec::new(),\n            node_index: HashMap::new(),\n            adj: Vec::new(),\n            rev_adj: Vec::new(),\n            edge_count: 0,\n        }\n    }\n    \n    /// Create a graph with pre-allocated capacity\n    pub fn with_capacity(node_capacity: usize, edge_capacity: usize) -\u003e DiGraph {\n        DiGraph {\n            nodes: Vec::with_capacity(node_capacity),\n            node_index: HashMap::with_capacity(node_capacity),\n            adj: Vec::with_capacity(node_capacity),\n            rev_adj: Vec::with_capacity(node_capacity),\n            edge_count: 0,\n        }\n    }\n    \n    /// Add a node, returns its index. Idempotent - returns existing index if already present.\n    pub fn add_node(\u0026mut self, id: \u0026str) -\u003e usize {\n        if let Some(\u0026idx) = self.node_index.get(id) {\n            return idx;\n        }\n        let idx = self.nodes.len();\n        self.nodes.push(id.to_string());\n        self.node_index.insert(id.to_string(), idx);\n        self.adj.push(Vec::new());\n        self.rev_adj.push(Vec::new());\n        idx\n    }\n    \n    /// Add a directed edge from -\u003e to. Idempotent.\n    pub fn add_edge(\u0026mut self, from: usize, to: usize) {\n        // Check bounds\n        if from \u003e= self.nodes.len() || to \u003e= self.nodes.len() {\n            return; // Silently ignore invalid edges\n        }\n        \n        // Check if edge already exists (linear scan is fine for typical degree)\n        if self.adj[from].contains(\u0026to) {\n            return;\n        }\n        \n        self.adj[from].push(to);\n        self.rev_adj[to].push(from);\n        self.edge_count += 1;\n    }\n    \n    /// Number of nodes\n    pub fn node_count(\u0026self) -\u003e usize {\n        self.nodes.len()\n    }\n    \n    /// Number of edges\n    pub fn edge_count(\u0026self) -\u003e usize {\n        self.edge_count\n    }\n    \n    /// Get node ID by index\n    pub fn node_id(\u0026self, idx: usize) -\u003e Option\u003cString\u003e {\n        self.nodes.get(idx).cloned()\n    }\n    \n    /// Get node index by ID\n    pub fn node_idx(\u0026self, id: \u0026str) -\u003e Option\u003cusize\u003e {\n        self.node_index.get(id).copied()\n    }\n    \n    /// Get all node IDs as JSON array\n    pub fn node_ids(\u0026self) -\u003e JsValue {\n        JsValue::from_serde(\u0026self.nodes).unwrap_or(JsValue::NULL)\n    }\n    \n    /// Out-degree of a node (number of dependencies)\n    pub fn out_degree(\u0026self, node: usize) -\u003e usize {\n        self.adj.get(node).map_or(0, |v| v.len())\n    }\n    \n    /// In-degree of a node (number of dependents)\n    pub fn in_degree(\u0026self, node: usize) -\u003e usize {\n        self.rev_adj.get(node).map_or(0, |v| v.len())\n    }\n    \n    /// All out-degrees as a vector\n    pub fn out_degrees(\u0026self) -\u003e Vec\u003cusize\u003e {\n        self.adj.iter().map(|v| v.len()).collect()\n    }\n    \n    /// All in-degrees as a vector\n    pub fn in_degrees(\u0026self) -\u003e Vec\u003cusize\u003e {\n        self.rev_adj.iter().map(|v| v.len()).collect()\n    }\n}\n\n// Internal methods (not exposed to WASM)\nimpl DiGraph {\n    /// Get successors of a node (internal use)\n    pub(crate) fn successors(\u0026self, node: usize) -\u003e \u0026[usize] {\n        self.adj.get(node).map_or(\u0026[], |v| v.as_slice())\n    }\n    \n    /// Get predecessors of a node (internal use)\n    pub(crate) fn predecessors(\u0026self, node: usize) -\u003e \u0026[usize] {\n        self.rev_adj.get(node).map_or(\u0026[], |v| v.as_slice())\n    }\n    \n    /// Iterate over all edges (internal use)\n    pub(crate) fn edges(\u0026self) -\u003e impl Iterator\u003cItem = (usize, usize)\u003e + '_ {\n        self.adj.iter().enumerate().flat_map(|(from, tos)| {\n            tos.iter().map(move |\u0026to| (from, to))\n        })\n    }\n}\n```\n\n### Memory Layout Considerations\n- **Vec\u003cVec\u003cusize\u003e\u003e**: Good cache locality for typical graphs\n- **HashMap for lookup**: O(1) ID‚Üíindex conversion\n- **Reverse adjacency**: Pre-computed for fast predecessor queries\n- **No edge weights**: All algorithms assume unit weights (suitable for dependencies)\n\n### Serialization Support\n```rust\nuse serde::{Serialize, Deserialize};\n\n#[derive(Serialize, Deserialize)]\npub struct GraphSnapshot {\n    pub nodes: Vec\u003cString\u003e,\n    pub edges: Vec\u003c(usize, usize)\u003e,\n}\n\nimpl DiGraph {\n    /// Export graph as JSON snapshot\n    pub fn to_json(\u0026self) -\u003e String {\n        let snapshot = GraphSnapshot {\n            nodes: self.nodes.clone(),\n            edges: self.edges().collect(),\n        };\n        serde_json::to_string(\u0026snapshot).unwrap_or_default()\n    }\n    \n    /// Import graph from JSON snapshot\n    pub fn from_json(json: \u0026str) -\u003e Result\u003cDiGraph, String\u003e {\n        let snapshot: GraphSnapshot = serde_json::from_str(json)\n            .map_err(|e| e.to_string())?;\n        \n        let mut graph = DiGraph::with_capacity(snapshot.nodes.len(), snapshot.edges.len());\n        for id in snapshot.nodes {\n            graph.add_node(\u0026id);\n        }\n        for (from, to) in snapshot.edges {\n            graph.add_edge(from, to);\n        }\n        Ok(graph)\n    }\n}\n```\n\n## Acceptance Criteria\n- [ ] DiGraph struct compiles with wasm-bindgen\n- [ ] add_node is idempotent\n- [ ] add_edge is idempotent\n- [ ] Degree queries work correctly\n- [ ] Serialization round-trips correctly\n- [ ] Unit tests pass for all methods\n- [ ] Memory usage is reasonable (\u003c10 bytes per edge)\n\n## Why This Design?\n1. **Adjacency lists**: O(degree) neighbor iteration, O(1) edge existence check for small degree\n2. **Reverse adjacency**: Essential for PageRank, reachability, predecessor queries\n3. **String IDs**: Keep issue IDs human-readable, avoid index confusion\n4. **No edge data**: Keeps structure simple, all our algorithms use unit weights\n5. **HashMap lookup**: Fast JS‚ÜíRust ID resolution","notes":"EXPANDED: Now includes density() method from merged bv-pbs6. Add this to DiGraph:\n\npub fn density(\u0026self) -\u003e f64 {\n    let n = self.node_count() as f64;\n    let e = self.edge_count() as f64;\n    if n \u003c= 1.0 { 0.0 } else { e / (n * (n - 1.0)) }\n}","status":"closed","priority":1,"type":"task","labels":["core","phase-1","wasm"],"created_at":"2025-12-15 23:32","updated_at":"2025-12-16 00:12","closed_at":"2025-12-16 00:12","blocked_by":["bv-d4w7"],"blocks":["bv-1hnb","bv-3m20","bv-81ew","bv-8f0b","bv-a276","bv-dvp3","bv-kdug","bv-ktru","bv-pbs6","bv-utky","bv-xg92","bv-y7a0","bv-yi6k","bv-yrcn","bv-ywd5"],"pagerank":0.029691012033373848,"betweenness":28,"eigenvector":0,"hub":7.890898495503672e-22,"authority":0.00005359422832887679,"critical_path":8,"in_degree":15,"out_degree":1,"core_number":2,"slack":6,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-c5lp","title":"Integrate glamour markdown renderer for rich TUI display","description":"Integrate charmbracelet/glamour for rendering markdown content in the TUI.\n\n## Scope\n1. Add glamour dependency to go.mod\n2. Create reusable markdown rendering component in pkg/ui\n3. Integrate with existing Theme system for consistent styling\n4. Apply to:\n   - Issue description in detail view\n   - Comments rendering\n   - Acceptance criteria display\n   - Notes/design docs preview\n\n## Benefits\n- Rich markdown preview (bold, italic, lists, code blocks, links)\n- Consistent with Charm ecosystem (Bubble Tea, Lipgloss)\n- Improved readability for issue content\n\n## Implementation Notes\n- Glamour supports custom styles - align with bv Theme\n- Consider terminal width for word wrapping\n- Handle edge cases (empty content, very long content)","status":"closed","priority":1,"type":"feature","labels":null,"created_at":"2025-12-16 23:43","updated_at":"2025-12-16 23:56","closed_at":"2025-12-16 23:56","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-ct7m","title":"E2E: Static bundle generation validation","description":"Validate the generated static HTML/JS bundle.\n\n## Bundle Components to Test\n1. **HTML Structure**\n   - Valid HTML5 doctype\n   - Meta tags present\n   - Title reflects configuration\n   - No broken internal links\n\n2. **CSS/Styling**\n   - Styles load correctly\n   - Responsive layout works\n   - Dark/light mode if supported\n   - No unstyled content flash\n\n3. **JavaScript**\n   - Scripts execute without errors\n   - Search initialization\n   - Graph rendering\n   - Interactive features\n\n4. **Search Index**\n   - Index file generated\n   - All issues indexed\n   - Search returns results\n   - Ranking correct\n\n5. **Graph Visualization**\n   - SVG/Canvas renders\n   - All nodes present\n   - Edges connect correctly\n   - Interactive navigation\n\n## Validation Tools\n- HTML validator (W3C)\n- CSS validator\n- JS linting (no errors)\n- Accessibility check (a11y)\n\n## Test Data Sizes\n- Empty project\n- 10 issues\n- 100 issues\n- 1000 issues","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-16 20:09","updated_at":"2025-12-16 22:43","closed_at":"2025-12-16 22:43","blocks":["bv-gmka","bv-hdu4","bv-pua7"],"pagerank":0.004516283463324584,"betweenness":0,"eigenvector":0,"hub":0,"authority":4.2648424977410656e-10,"critical_path":4,"in_degree":3,"out_degree":0,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-cwzm","title":"E2E: Enhanced logging infrastructure for test harness","description":"Enhance the tests/e2e/harness.sh with comprehensive logging.\n\n## Current State\n- Basic harness.sh exists with some logging\n- Logs are minimal and lack context\n\n## Enhancements Needed\n1. **Structured Logging**\n   - JSON log format option for CI parsing\n   - Log levels (DEBUG, INFO, WARN, ERROR)\n   - Timestamp with milliseconds\n   - Test name/phase in every log line\n\n2. **Context Capture**\n   - Full command being executed\n   - Working directory\n   - Environment variables (sanitized)\n   - Git state (branch, commit)\n\n3. **Artifact Management**\n   - Create timestamped test run directory\n   - Save stdout/stderr per test\n   - Save generated files (JSON outputs)\n   - Screenshot/snapshot capability\n\n4. **Timing \u0026 Performance**\n   - Start/end timestamps per test\n   - Duration calculation\n   - Timeout warnings\n   - Performance baseline comparison\n\n5. **CI Integration**\n   - Exit codes for different failure types\n   - JUnit XML output option\n   - GitHub Actions annotation format\n   - Summary generation\n\n## Implementation\n- Enhance harness.sh with new functions\n- Create log_* helper functions\n- Add artifact directory management\n- Support both interactive and CI modes","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-16 20:08","updated_at":"2025-12-16 22:18","closed_at":"2025-12-16 22:18","blocks":["bv-0zk6","bv-qfr5","bv-syeo"],"pagerank":0.0046045821159016705,"betweenness":0,"eigenvector":0,"hub":0,"authority":4.7300048951097674e-11,"critical_path":4,"in_degree":3,"out_degree":0,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-d4w7","title":"Set up Rust WASM crate with wasm-bindgen","description":"# Set up Rust WASM Crate with wasm-bindgen\n\n## Context\nThis is the foundational task for the Rust WASM graph engine. We need a properly configured Rust workspace that compiles to WASM and integrates with the bv build system.\n\n## Requirements\n\n### Cargo.toml\n```toml\n[package]\nname = \"bv-graph-wasm\"\nversion = \"0.1.0\"\nedition = \"2021\"\nauthors = [\"bv contributors\"]\ndescription = \"High-performance graph algorithms for bv static viewer\"\nrepository = \"https://github.com/Dicklesworthstone/beads_viewer\"\nlicense = \"MIT\"\n\n[lib]\ncrate-type = [\"cdylib\", \"rlib\"]\n\n[features]\ndefault = [\"console_error_panic_hook\"]\n\n[dependencies]\nwasm-bindgen = \"0.2\"\njs-sys = \"0.3\"\nserde = { version = \"1.0\", features = [\"derive\"] }\nserde_json = \"1.0\"\nconsole_error_panic_hook = { version = \"0.1\", optional = true }\n\n[dev-dependencies]\nwasm-bindgen-test = \"0.3\"\n\n[profile.release]\n# Optimize for size - critical for WASM bundles\nopt-level = \"s\"\nlto = true\ncodegen-units = 1\npanic = \"abort\"\n```\n\n### Directory Structure\n```\nbv-graph-wasm/\n  Cargo.toml\n  Makefile                    # Build commands\n  src/\n    lib.rs                    # WASM entry point, panic hook\n    graph.rs                  # DiGraph struct\n    algorithms/\n      mod.rs                  # Algorithm module exports\n      pagerank.rs\n      betweenness.rs\n      eigenvector.rs\n      hits.rs\n      topo.rs\n      cycles.rs\n      critical_path.rs\n      kcore.rs\n      articulation.rs\n      slack.rs\n      density.rs\n      degree.rs\n    advanced/\n      mod.rs\n      topk_set.rs             # Greedy submodular selection\n      coverage.rs             # Vertex cover\n      k_paths.rs              # K-shortest paths\n      parallel_cut.rs         # Parallelization analysis\n      cycle_break.rs          # Cycle break suggestions\n    whatif.rs                 # Impact simulation\n    subgraph.rs               # Subgraph operations\n    reachability.rs           # Reachability queries\n  tests/\n    web.rs                    # WASM integration tests\n    algorithms/               # Algorithm unit tests\n```\n\n### lib.rs Skeleton\n```rust\nuse wasm_bindgen::prelude::*;\n\nmod graph;\nmod algorithms;\nmod advanced;\nmod whatif;\nmod subgraph;\nmod reachability;\n\npub use graph::DiGraph;\n\n// Initialize panic hook for better error messages in browser console\n#[wasm_bindgen(start)]\npub fn init() {\n    #[cfg(feature = \"console_error_panic_hook\")]\n    console_error_panic_hook::set_once();\n}\n\n// Re-export main types for JavaScript\n#[wasm_bindgen]\npub fn version() -\u003e String {\n    env!(\"CARGO_PKG_VERSION\").to_string()\n}\n```\n\n### Makefile\n```makefile\n.PHONY: build build-release test clean\n\n# Development build (faster, larger)\nbuild:\n\twasm-pack build --target web --dev\n\n# Release build (optimized)\nbuild-release:\n\twasm-pack build --target web --release\n\twasm-opt -Os -o pkg/bv_graph_wasm_bg_opt.wasm pkg/bv_graph_wasm_bg.wasm\n\tmv pkg/bv_graph_wasm_bg_opt.wasm pkg/bv_graph_wasm_bg.wasm\n\n# Run tests (in browser via wasm-pack)\ntest:\n\twasm-pack test --headless --firefox\n\n# Clean build artifacts\nclean:\n\tcargo clean\n\trm -rf pkg/\n\n# Check size\nsize:\n\t@echo \"WASM size:\"\n\t@wc -c pkg/bv_graph_wasm_bg.wasm\n\t@echo \"Gzipped:\"\n\t@gzip -c pkg/bv_graph_wasm_bg.wasm | wc -c\n```\n\n### Integration with bv Build System\nAdd to main Makefile:\n```makefile\nwasm:\n\tcd bv-graph-wasm \u0026\u0026 make build-release\n\tcp bv-graph-wasm/pkg/bv_graph_wasm.js pkg/export/viewer_assets/vendor/bv_graph.js\n\tcp bv-graph-wasm/pkg/bv_graph_wasm_bg.wasm pkg/export/viewer_assets/vendor/bv_graph_bg.wasm\n```\n\n### Prerequisites Check\n```bash\n# Required tools\nrustup --version          # Rust toolchain\ncargo --version           # Rust package manager\nwasm-pack --version       # WASM build tool\nwasm-opt --version        # Binaryen optimizer (optional but recommended)\n```\n\n## Acceptance Criteria\n- [ ] Cargo.toml configured with wasm-bindgen\n- [ ] Directory structure created\n- [ ] lib.rs compiles with `wasm-pack build`\n- [ ] Output files generated in pkg/\n- [ ] Makefile works for build/test/clean\n- [ ] Release build produces \u003c150KB WASM\n- [ ] Integration with bv main Makefile\n- [ ] README.md documents build process\n\n## Why This Structure?\n1. **Separate crate**: Clean boundary, independent testing\n2. **wasm-pack**: Standard Rust‚ÜíWASM tooling\n3. **wasm-opt**: Critical for size reduction (often 30-50% smaller)\n4. **cdylib**: Required for WASM target\n5. **console_error_panic_hook**: Better debugging in browser\n6. **Module organization**: Matches Go pkg/analysis/ structure","notes":"IMPORTANT: Use serde-wasm-bindgen instead of deprecated JsValue::from_serde. Add to Cargo.toml: serde-wasm-bindgen = \"0.6\". Use serde_wasm_bindgen::to_value() for JSON serialization to JS.","status":"closed","priority":1,"type":"task","labels":["infrastructure","phase-1","wasm"],"created_at":"2025-12-15 23:32","updated_at":"2025-12-16 00:12","closed_at":"2025-12-16 00:12","blocks":["bv-bxoe"],"pagerank":0.026713808740269313,"betweenness":0,"eigenvector":0,"hub":0,"authority":4.7854460253878835e-21,"critical_path":9,"in_degree":1,"out_degree":0,"core_number":1,"slack":6,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-dgyb","title":"Optimize WASM bundle size with wasm-opt","description":"# Optimize WASM Bundle Size\n\n## Context\nWASM bundle size directly impacts load time. Target: \u003c120KB gzipped.\n\n## Optimization Steps\n\n### 1. Cargo Profile\n```toml\n[profile.release]\nopt-level = \"s\"     # Optimize for size\nlto = true          # Link-time optimization\ncodegen-units = 1   # Better optimization\npanic = \"abort\"     # Remove panic unwinding\n```\n\n### 2. wasm-opt (Binaryen)\n```bash\nwasm-opt -Os -o optimized.wasm unoptimized.wasm\n```\n\n### 3. Remove Unused Features\n- Only include algorithms actually used\n- Feature flags for optional algorithms\n```toml\n[features]\ndefault = [\"core\"]\ncore = []  # PageRank, Betweenness, etc.\nadvanced = []  # TopK, Coverage, etc.\n```\n\n### 4. Measure and Report\n```bash\n# Before optimization\nwc -c pkg/bv_graph_bg.wasm\ngzip -c pkg/bv_graph_bg.wasm | wc -c\n\n# After wasm-opt\nwc -c pkg/bv_graph_bg_opt.wasm\ngzip -c pkg/bv_graph_bg_opt.wasm | wc -c\n```\n\n### 5. Size Budget\n| Component | Target | Max |\n|-----------|--------|-----|\n| Raw WASM | 100KB | 150KB |\n| Gzipped | 50KB | 80KB |\n| JS glue | 15KB | 25KB |\n\n## Acceptance Criteria\n- [ ] Release build uses size optimizations\n- [ ] wasm-opt applied in build pipeline\n- [ ] Final size \u003c120KB gzipped\n- [ ] Size reported in CI output","status":"closed","priority":2,"type":"task","labels":["optimization","phase-5","wasm"],"created_at":"2025-12-15 23:38","updated_at":"2025-12-16 10:49","closed_at":"2025-12-16 10:49","blocked_by":["bv-psjp"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":7.890898495503672e-22,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":6,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-dvp3","title":"Port PageRank algorithm to Rust WASM","description":"# Port PageRank Algorithm to Rust WASM\n\n## Context\nPageRank is a centrality measure that identifies important nodes based on the structure of incoming links. In bv, high PageRank issues are central bottlenecks that many other issues depend on (directly or indirectly).\n\n## Go Implementation Reference\n```go\n// From gonum: network.PageRank(a.g, 0.85, 1e-6)\n// Damping factor: 0.85 (standard)\n// Tolerance: 1e-6 (convergence threshold)\n```\n\n## Rust Implementation\n\n### pagerank.rs\n```rust\nuse crate::graph::DiGraph;\n\n/// PageRank configuration\npub struct PageRankConfig {\n    /// Damping factor (typically 0.85)\n    pub damping: f64,\n    /// Convergence tolerance\n    pub tolerance: f64,\n    /// Maximum iterations\n    pub max_iterations: u32,\n}\n\nimpl Default for PageRankConfig {\n    fn default() -\u003e Self {\n        PageRankConfig {\n            damping: 0.85,\n            tolerance: 1e-6,\n            max_iterations: 100,\n        }\n    }\n}\n\n/// Compute PageRank scores for all nodes.\n/// \n/// Algorithm: Power iteration method\n/// PR(v) = (1-d)/n + d * Œ£ PR(u)/out_degree(u) for all u ‚Üí v\n///\n/// Returns vector of scores in node index order.\npub fn pagerank(graph: \u0026DiGraph, config: \u0026PageRankConfig) -\u003e Vec\u003cf64\u003e {\n    let n = graph.node_count();\n    if n == 0 {\n        return Vec::new();\n    }\n    \n    let d = config.damping;\n    let base = (1.0 - d) / n as f64;\n    \n    // Initialize with uniform distribution\n    let mut scores = vec![1.0 / n as f64; n];\n    let mut new_scores = vec![0.0; n];\n    \n    // Pre-compute out-degrees\n    let out_degrees: Vec\u003cf64\u003e = (0..n)\n        .map(|i| graph.out_degree(i) as f64)\n        .collect();\n    \n    for _ in 0..config.max_iterations {\n        // Reset new scores\n        for s in \u0026mut new_scores {\n            *s = base;\n        }\n        \n        // Accumulate contributions from predecessors\n        for v in 0..n {\n            for \u0026u in graph.predecessors(v) {\n                if out_degrees[u] \u003e 0.0 {\n                    new_scores[v] += d * scores[u] / out_degrees[u];\n                }\n            }\n        }\n        \n        // Handle dangling nodes (no outgoing edges)\n        // Their rank \"leaks\" and is distributed uniformly\n        let dangling_sum: f64 = (0..n)\n            .filter(|\u0026i| out_degrees[i] == 0.0)\n            .map(|i| scores[i])\n            .sum();\n        let dangling_contrib = d * dangling_sum / n as f64;\n        for s in \u0026mut new_scores {\n            *s += dangling_contrib;\n        }\n        \n        // Check convergence\n        let diff: f64 = scores.iter()\n            .zip(new_scores.iter())\n            .map(|(a, b)| (a - b).abs())\n            .sum();\n        \n        std::mem::swap(\u0026mut scores, \u0026mut new_scores);\n        \n        if diff \u003c config.tolerance {\n            break;\n        }\n    }\n    \n    scores\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    \n    #[test]\n    fn test_pagerank_empty() {\n        let graph = DiGraph::new();\n        let scores = pagerank(\u0026graph, \u0026PageRankConfig::default());\n        assert!(scores.is_empty());\n    }\n    \n    #[test]\n    fn test_pagerank_single_node() {\n        let mut graph = DiGraph::new();\n        graph.add_node(\"a\");\n        let scores = pagerank(\u0026graph, \u0026PageRankConfig::default());\n        assert_eq!(scores.len(), 1);\n        assert!((scores[0] - 1.0).abs() \u003c 1e-6);\n    }\n    \n    #[test]\n    fn test_pagerank_chain() {\n        // a ‚Üí b ‚Üí c\n        // c should have highest rank (sink)\n        let mut graph = DiGraph::new();\n        let a = graph.add_node(\"a\");\n        let b = graph.add_node(\"b\");\n        let c = graph.add_node(\"c\");\n        graph.add_edge(a, b);\n        graph.add_edge(b, c);\n        \n        let scores = pagerank(\u0026graph, \u0026PageRankConfig::default());\n        assert!(scores[c] \u003e scores[b]);\n        assert!(scores[b] \u003e scores[a]);\n    }\n    \n    #[test]\n    fn test_pagerank_cycle() {\n        // a ‚Üí b ‚Üí c ‚Üí a\n        let mut graph = DiGraph::new();\n        let a = graph.add_node(\"a\");\n        let b = graph.add_node(\"b\");\n        let c = graph.add_node(\"c\");\n        graph.add_edge(a, b);\n        graph.add_edge(b, c);\n        graph.add_edge(c, a);\n        \n        let scores = pagerank(\u0026graph, \u0026PageRankConfig::default());\n        // Scores should be roughly equal in a cycle\n        let diff = (scores[a] - scores[b]).abs() + (scores[b] - scores[c]).abs();\n        assert!(diff \u003c 0.01);\n    }\n}\n```\n\n### WASM Binding\n```rust\n// In lib.rs or graph.rs\n#[wasm_bindgen]\nimpl DiGraph {\n    /// Compute PageRank scores.\n    /// Returns array of scores in node index order.\n    pub fn pagerank(\u0026self, damping: f64, max_iterations: u32) -\u003e Vec\u003cf64\u003e {\n        let config = PageRankConfig {\n            damping,\n            max_iterations,\n            tolerance: 1e-6,\n        };\n        algorithms::pagerank::pagerank(self, \u0026config)\n    }\n}\n```\n\n## Acceptance Criteria\n- [ ] PageRank converges for all test cases\n- [ ] Handles dangling nodes correctly\n- [ ] Handles cycles correctly\n- [ ] Results match Go implementation within tolerance\n- [ ] Performance: \u003c10ms for 1000 nodes\n- [ ] Unit tests pass\n\n## Cross-Validation with Go\nCreate test cases that run both Go and Rust implementations and compare:\n```bash\n# Generate test graphs, run both, diff results\ngo test -run TestPageRankGolden -v \u003e go_results.json\ncargo test pagerank_golden -- --nocapture \u003e rust_results.json\ndiff go_results.json rust_results.json\n```","status":"closed","priority":2,"type":"task","labels":["algorithm","phase-2","wasm"],"created_at":"2025-12-15 23:33","updated_at":"2025-12-16 00:23","closed_at":"2025-12-16 00:23","blocked_by":["bv-bxoe"],"blocks":["bv-y7a0"],"pagerank":0.0018889407873369957,"betweenness":0,"eigenvector":0,"hub":0.000008837350028490512,"authority":0.000010677870334373396,"critical_path":4,"in_degree":1,"out_degree":1,"core_number":2,"slack":9,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-dyg","title":"Implement issue detail view with dependency visualization","description":"Issue detail view showing full metadata, markdown description rendered safely with DOMPurify, graph position metrics (PageRank, betweenness, critical path depth, triage score), dependency lists (blocks/blocked-by) with clickable links, and Mermaid.js dependency graph visualization. Graph is lazy-loaded for performance. Includes keyboard navigation (Esc=back, j/k=next/prev, g=toggle graph).","status":"closed","priority":2,"type":"task","labels":["phase-2","static-pages"],"created_at":"2025-12-15 23:08","updated_at":"2025-12-16 10:30","closed_at":"2025-12-16 10:30","blocked_by":["bv-jdl","bv-w97"],"blocks":["bv-y5i"],"pagerank":0.0015706037203119501,"betweenness":0,"eigenvector":0,"hub":0.00013573598174365005,"authority":0.0001967059030531822,"critical_path":3,"in_degree":1,"out_degree":2,"core_number":3,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-ehsl","title":"Unit test: semantic_search.go - Search UI integration","description":"Create unit tests for pkg/ui/semantic_search.go\n\n## File Overview\nsemantic_search.go integrates the vector search with the UI, handling search input and result display.\n\n## Test Cases to Implement\n1. **Search Input Handling**\n   - Empty query\n   - Short query (1-2 chars)\n   - Normal query\n   - Very long query\n   - Special characters in query\n\n2. **Mode Switching**\n   - Ctrl+S toggles fuzzy/semantic\n   - Mode indicator updates\n   - Search re-executes on mode change\n\n3. **Result Display**\n   - No results message\n   - Single result\n   - Multiple results with scores\n   - Score-based sorting\n   - Result highlighting\n\n4. **Integration Tests**\n   - Search triggers index lookup\n   - Results map to issue list\n   - Selection navigates to issue\n\n## Implementation Notes\n- Mock the VectorIndex for unit tests\n- Test async search behavior\n- Verify loading state display","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-16 20:06","updated_at":"2025-12-16 23:23","closed_at":"2025-12-16 23:23","blocks":["bv-ul1l"],"pagerank":0.0017282929585731776,"betweenness":0,"eigenvector":0,"hub":0,"authority":6.623673282227765e-11,"critical_path":4,"in_degree":1,"out_degree":0,"core_number":1,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-ejow","title":"Diff-since auto-JSON should set BV_ROBOT early","description":"When stdout is non-TTY, bv --diff-since REF auto-emits JSON diff (per README). However, issues are loaded before auto-enabling --robot-diff, so malformed JSONL lines can still emit parse warnings to stderr and break JSON consumers.\n\nAcceptance:\n- bv --diff-since REF in non-TTY context produces JSON-only stdout and empty stderr even with malformed JSONL lines.\n- Suppress non-fatal warnings to stderr for robot JSON output paths (e.g., drift config fallback, recipe load errors, empty label scope) when BV_ROBOT=1.\n- Add an E2E test covering auto-JSON diff with malformed issues.","status":"closed","priority":2,"type":"bug","labels":["reliability","robot"],"assignee":"BrownBear","created_at":"2025-12-17 05:16","updated_at":"2025-12-17 05:19","closed_at":"2025-12-17 05:19","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-eli3","title":"Docs: Agent Mail troubleshooting (ulimit -n)","description":"Add a short troubleshooting note to AGENTS.md: if Agent Mail/MCP messaging fails with 'Too many open files' (macOS default ulimit can be low), restart the Agent Mail server with a higher FD limit (e.g., 'ulimit -n 4096').","status":"closed","priority":3,"type":"chore","labels":["agent-mail","ai","docs"],"created_at":"2025-12-17 04:10","updated_at":"2025-12-17 04:11","closed_at":"2025-12-17 04:11","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-epf","title":"Multi-Repo Aggregation View","description":"Unified view across multiple .beads/ directories for monorepos and multi-service projects.\n\n## Background \u0026 Motivation\nOrganizations often have:\n- Monorepos with multiple services\n- Microservices with separate repos\n- Frontend/backend splits\n\nCurrently, bv only shows one project at a time.\n\n## Value Proposition\n- For Humans: Single view of all project issues\n- For AI Agents: Cross-repo dependency visibility, scoped queries\n\n## Technical Approach\n1. Workspace configuration file\n2. Namespaced IDs (repo:issue-id)\n3. Aggregate loader merging multiple sources\n4. Cross-repo dependency support\n5. Repo-scoped filtering\n\n## Key Challenges\n- ID collision handling\n- Performance with many repos\n- Cross-repo dependency semantics\n- Clear provenance in UI","status":"closed","priority":2,"type":"epic","labels":["multi-repo","scalability"],"created_at":"2025-11-26 23:36","updated_at":"2025-12-16 15:58","closed_at":"2025-12-16 15:58","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-epf.1","title":"Design workspace configuration schema","description":".bv/workspace.yaml schema: repos list with name/path/prefix. Auto-discovery mode for common layouts. Validation.","status":"closed","priority":2,"type":"task","labels":["configuration","multi-repo"],"created_at":"2025-11-26 23:40","updated_at":"2025-11-27 00:28","closed_at":"2025-11-27 00:28","blocks":["bv-epf.2"],"pagerank":0.004704981030911598,"betweenness":0,"eigenvector":0,"hub":0,"authority":4.7854460253878835e-21,"critical_path":4,"in_degree":1,"out_degree":0,"core_number":1,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-epf.2","title":"Implement namespaced ID system","description":"Format: \u003cprefix\u003e:\u003coriginal_id\u003e (e.g., BE:AUTH-123). Cross-repo deps use full namespaced IDs. Display adapts to context.","status":"closed","priority":2,"type":"task","labels":["data-model","multi-repo"],"created_at":"2025-11-26 23:40","updated_at":"2025-11-27 00:35","closed_at":"2025-11-27 00:35","blocked_by":["bv-epf.1"],"blocks":["bv-epf.3"],"pagerank":0.003798240094886169,"betweenness":2,"eigenvector":0,"hub":7.890898495503672e-22,"authority":4.7854460253878835e-21,"critical_path":3,"in_degree":1,"out_degree":1,"core_number":1,"slack":11,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-epf.3","title":"Create aggregate loader for multiple repos","description":"LoadAll() merges repos. Namespacing during load. Failed repos logged but don't break. Parallel loading with errgroup.","status":"closed","priority":2,"type":"task","labels":["loader","multi-repo","performance"],"created_at":"2025-11-26 23:40","updated_at":"2025-12-16 11:57","closed_at":"2025-12-16 11:57","blocked_by":["bv-epf.2"],"blocks":["bv-epf.4"],"pagerank":0.002731484890410988,"betweenness":2,"eigenvector":0,"hub":7.890898495503672e-22,"authority":4.7854460253878835e-21,"critical_path":2,"in_degree":1,"out_degree":1,"core_number":1,"slack":11,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-epf.4","title":"Add --workspace CLI flag and TUI repo filter","description":"--workspace \u003cconfig\u003e loads multiple repos. --repo filters. TUI: repo indicator in header, toggle repos, [BE] prefix on items.","status":"closed","priority":2,"type":"task","labels":["cli","multi-repo","tui"],"created_at":"2025-11-26 23:40","updated_at":"2025-12-16 12:24","closed_at":"2025-12-16 12:24","blocked_by":["bv-epf.3"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":7.890898495503672e-22,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-evyl","title":"[SUB-EPIC] Graph Visualization Feature Testing","description":"Dedicated testing for all graph visualization features in bv.\n\n## Components to Test\n1. pkg/ui/graph.go - Interactive graph view\n2. pkg/export/graph_snapshot.go - Static graph export\n3. pkg/export/graph_snapshot_svg.go - SVG rendering\n4. Graph export formats (JSON, DOT, Mermaid)\n5. Graph filtering and scoping\n6. Interactive navigation (pan, zoom, select)\n\n## Visualization Scenarios\n- Empty graph\n- Single node\n- Linear chain (1-\u003e2-\u003e3-\u003e...)\n- Star topology (hub with many spokes)\n- Diamond dependencies\n- Cycles (highlighted correctly)\n- Large graphs (100+ nodes)\n- Disconnected components\n\n## Test Types Needed\n- Unit tests for rendering logic\n- Golden file tests for SVG output\n- E2E tests for interactive features\n- Visual regression tests\n- Performance tests for large graphs\n\n## Success Criteria\n- All graph topologies render correctly\n- SVG output validates\n- Interactive features work\n- Performance acceptable for 500+ nodes","status":"closed","priority":1,"type":"epic","labels":null,"created_at":"2025-12-16 20:04","updated_at":"2025-12-17 00:53","closed_at":"2025-12-17 00:53","blocked_by":["bv-7bob","bv-z5oa","bv-6jyn","bv-yc2v","bv-wzvo","bv-3krz","bv-61hu","bv-f1zg","bv-m2cg"],"blocks":["bv-q923"],"pagerank":0.0016159234171211456,"betweenness":8,"eigenvector":0,"hub":1.4801886857052282e-7,"authority":7.094593722740486e-8,"critical_path":2,"in_degree":1,"out_degree":9,"core_number":2,"slack":11,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-ewhp","title":"Unit test: pkg/search/embedder.go - Embedder interface","description":"Create unit tests for pkg/search/embedder.go\n\n## File Overview\nembedder.go defines the Embedder interface and factory function.\n\n## Test Cases to Implement\n1. **Interface Contract Tests**\n   - Embed() returns correct dimension\n   - EmbedBatch() handles multiple docs\n   - Dimension() returns configured value\n\n2. **Factory Tests**\n   - NewEmbedder('hash') returns HashEmbedder\n   - NewEmbedder('python') returns PythonEmbedder\n   - NewEmbedder('openai') returns OpenAIEmbedder\n   - NewEmbedder('invalid') returns error\n\n3. **Error Handling**\n   - Empty document handling\n   - Nil input handling\n   - Dimension mismatch detection\n\n4. **Batch Processing**\n   - Empty batch\n   - Single item batch\n   - Large batch (100+ items)\n   - Partial failure handling\n\n## Implementation Notes\n- Test all embedder types\n- Verify interface compliance\n- Test batch efficiency","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-16 20:07","updated_at":"2025-12-16 23:36","closed_at":"2025-12-16 23:36","blocks":["bv-ubra"],"pagerank":0.0019171540027831243,"betweenness":0,"eigenvector":0,"hub":0,"authority":8.0286461624274e-14,"critical_path":4,"in_degree":1,"out_degree":0,"core_number":1,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-f103","title":"Labels Missing from Detail View Panel","description":"## Problem Statement\n\nLabels are NOT displayed in the detail view panel, even though they are a critical organizational feature. Users who rely on labels for categorization (e.g., `repo:web`, `area:backend`) cannot see this information when viewing issue details.\n\n## User Impact\n\n**Severity: High (P1)**\n- Labels completely hidden in the most detailed view\n- Users must use list view (width \u003e 140px) to see labels at all\n- Particularly problematic for multi-repo workflows using labels\n- Reported by @neilpoulin in GitHub Issue #14 with screenshot\n\n## Root Cause Analysis\n\n**Location:** `pkg/ui/model.go:2401-2498` (`updateViewportContent` function)\n\nThe detail view renders:\n- Title with type icon ‚úì\n- Meta table (ID, Status, Priority, Assignee, Created) ‚úì\n- Graph Analysis metrics ‚úì\n- Description, Acceptance Criteria, Notes ‚úì\n- Dependency tree ‚úì\n- Comments ‚úì\n- History (if loaded) ‚úì\n\n**Missing:** Labels are never rendered\\!\n\nLabels ARE rendered in other contexts:\n- List view delegate (`pkg/ui/delegate.go:97-99`) - but only when width \u003e 140\n- Copy to clipboard (`pkg/ui/model.go:2909-2910`)\n- Kanban board (`pkg/ui/board.go:469-474`)\n\nBut `updateViewportContent()` simply doesn't include them.\n\n## Proposed Solution\n\nAdd labels after the meta table, around line 2433:\n\n```go\n// After meta table, before Graph Analysis\nif len(item.Labels) \u003e 0 {\n    sb.WriteString(fmt.Sprintf(\"**Labels:** %s\\n\\n\", strings.Join(item.Labels, \", \")))\n}\n```\n\nOr integrate into meta table as an additional row:\n\n```go\n// Extended meta table\nsb.WriteString(\"| ID | Status | Priority | Assignee | Created | Labels |\\n\")\nsb.WriteString(\"|---|---|---|---|---|---|\\n\")\nlabelsStr := strings.Join(item.Labels, \", \")\nif labelsStr == \"\" { labelsStr = \"-\" }\nsb.WriteString(fmt.Sprintf(\"| **%s** | **%s** | %s | @%s | %s | %s |\\n\\n\",\n    item.ID, strings.ToUpper(string(item.Status)), GetPriorityIcon(item.Priority),\n    item.Assignee, item.CreatedAt.Format(\"2006-01-02\"), labelsStr))\n```\n\n## Design Considerations\n\n1. **Placement**: Should labels be in the meta table or as a separate section?\n   - Meta table: Compact, consistent with other metadata\n   - Separate section: More prominent, can be styled differently\n   - **Recommendation**: Separate line after meta table for visibility\n\n2. **Styling**: How should labels be formatted?\n   - Simple comma-separated list (like clipboard function)\n   - Styled tags with background colors\n   - **Recommendation**: Start simple (comma-separated), enhance later if needed\n\n3. **Empty state**: What if issue has no labels?\n   - Don't render anything (current clipboard behavior)\n   - Show \"Labels: None\" explicitly\n   - **Recommendation**: Don't render if empty (cleaner)\n\n## Test Plan\n\n1. Test: Issue with multiple labels - all displayed\n2. Test: Issue with no labels - section not rendered\n3. Test: Issue with very long label list - wraps appropriately\n4. Manual test: Labels visible in detail view for user's screenshot scenario\n\n## Acceptance Criteria\n\n- [ ] Labels displayed in detail view panel\n- [ ] No display when issue has no labels\n- [ ] Markdown renders correctly (no escaping issues)\n- [ ] Test coverage for with/without labels scenarios\n\n## References\n\n- GitHub Issue #14: https://github.com/Dicklesworthstone/beads_viewer/issues/14\n- Screenshot in issue shows labels exist but don't display\n- Related code: delegate.go:97-99, board.go:469-474 (where labels DO render)","status":"closed","priority":1,"type":"bug","labels":["feature-gap","gh-issue-14","ux"],"created_at":"2025-12-15 23:52","updated_at":"2025-12-16 00:21","closed_at":"2025-12-16 00:21","blocks":["bv-uqoh"],"pagerank":0.0016019788987050227,"betweenness":0,"eigenvector":0,"hub":0,"authority":9.324854925833239e-9,"critical_path":2,"in_degree":1,"out_degree":0,"core_number":1,"slack":13,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-f1zg","title":"E2E: Cycle visualization and highlighting","description":"Test cycle detection and visualization in graphs.\n\n## Cycle Visualization Features\n1. **Detection Display**\n   - Cycles detected message\n   - Cycle count in status\n   - List of cycle members\n\n2. **Visual Highlighting**\n   - Cycle edges red/dashed\n   - Cycle nodes highlighted\n   - Non-cycle elements dimmed\n   - Cycle path traced\n\n3. **Interaction**\n   - Navigate to cycle\n   - Select cycle for detail\n   - Cycle breaking suggestions\n\n4. **Export**\n   - SVG shows cycle highlighting\n   - Mermaid has cycle styling\n   - JSON includes cycle data\n\n## Test Scenarios\n- No cycles (clean DAG)\n- Single 2-node cycle\n- Single 3+ node cycle\n- Multiple independent cycles\n- Nested/overlapping cycles\n- Self-loop\n\n## Implementation\n- Create test graphs with cycles\n- Verify visual output\n- Test cycle navigation\n- Golden files for cycle rendering","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-16 20:10","updated_at":"2025-12-16 23:28","closed_at":"2025-12-16 23:28","blocks":["bv-evyl"],"pagerank":0.0016290932344603455,"betweenness":0,"eigenvector":0,"hub":0,"authority":7.205652148943102e-8,"critical_path":3,"in_degree":1,"out_degree":0,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-focq","title":"E2E: Wizard flow complete walkthrough testing","description":"Test the interactive wizard flow for static site deployment.\n\n## Wizard Steps to Test\n1. **Initial Prompt**\n   - Detect existing config\n   - Fresh setup flow\n   - Resume previous config\n\n2. **Platform Selection**\n   - GitHub Pages selection\n   - Cloudflare Pages selection\n   - Local export only\n\n3. **Repository Configuration**\n   - Auto-detect current repo\n   - Manual repo input\n   - Invalid repo handling\n\n4. **Branch Configuration**\n   - gh-pages branch (default)\n   - Custom branch name\n   - Branch creation if needed\n\n5. **Build Configuration**\n   - Output directory selection\n   - Custom title\n   - Include/exclude options\n\n6. **Deployment**\n   - Dry run mode\n   - Actual deployment\n   - Deployment verification\n\n## Test Scenarios\n- First-time setup (no prior config)\n- Re-run with existing config\n- Config migration (old format)\n- Cancellation at each step\n- Invalid input recovery\n\n## Implementation\n- Simulate stdin for interactive prompts\n- Capture wizard output\n- Verify config file creation\n- Test both happy and error paths","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-16 20:09","updated_at":"2025-12-16 22:47","closed_at":"2025-12-16 22:47","blocks":["bv-hdu4","bv-mwlh","bv-ufsr"],"pagerank":0.004516283463324584,"betweenness":0,"eigenvector":0,"hub":0,"authority":4.264842497741066e-10,"critical_path":4,"in_degree":3,"out_degree":0,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-fou9","title":"Unit test: label_dashboard.go - Label dashboard view","description":"Create unit tests for pkg/ui/label_dashboard.go\n\n## File Overview\nlabel_dashboard.go renders the label-focused dashboard showing health metrics per label.\n\n## Test Cases to Implement\n1. **Dashboard Rendering**\n   - No labels -\u003e empty state message\n   - Single label with metrics\n   - Multiple labels sorted by health\n   - Label health indicators (healthy/warning/critical)\n\n2. **Metric Display**\n   - Velocity score formatting\n   - Flow score formatting  \n   - Staleness indicator\n   - Blocked count display\n\n3. **Interactive Features**\n   - Label selection\n   - Drill-down to label detail\n   - Filter to label scope\n   - Back navigation\n\n4. **Layout Adaptation**\n   - Narrow terminal (stacked)\n   - Wide terminal (columns)\n   - Ultra-wide (additional metrics)\n\n## Implementation Notes\n- Create LabelHealth test fixtures\n- Test with various health levels\n- Verify color coding matches health","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-16 20:06","updated_at":"2025-12-16 23:20","closed_at":"2025-12-16 23:20","blocks":["bv-ul1l"],"pagerank":0.0017282929585731776,"betweenness":0,"eigenvector":0,"hub":0,"authority":6.623673282227765e-11,"critical_path":4,"in_degree":1,"out_degree":0,"core_number":1,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-fqpv","title":"E2E: Error scenario and recovery testing","description":"Test error handling and graceful degradation.\n\n## Error Scenarios to Test\n1. **Data Errors**\n   - Corrupted beads.jsonl\n   - Malformed JSON lines\n   - Missing required fields\n   - Invalid UTF-8\n\n2. **File System Errors**\n   - Missing .beads directory\n   - Permission denied\n   - Disk full simulation\n   - Locked files\n\n3. **Git Errors**\n   - Not a git repository\n   - Invalid revision\n   - Detached HEAD\n   - No commits yet\n\n4. **Analysis Errors**\n   - Timeout during analysis\n   - Memory pressure\n   - Pathological graphs (all cycles)\n   - Very large graphs\n\n5. **Export Errors**\n   - Invalid output path\n   - Missing dependencies (gh cli)\n   - Network errors (GitHub API)\n   - Template errors\n\n## Verification\n- Error messages are helpful\n- Partial data handled gracefully\n- Recovery suggestions provided\n- Exit codes are correct\n\n## Implementation\n- Create error injection harness\n- Test each error category\n- Verify stderr output\n- Document recovery steps","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-16 20:08","updated_at":"2025-12-17 00:30","closed_at":"2025-12-17 00:30","blocks":["bv-syeo"],"pagerank":0.0017054007352105605,"betweenness":0,"eigenvector":0,"hub":0,"authority":3.263220574971611e-11,"critical_path":3,"in_degree":1,"out_degree":0,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-g3v6","title":"staticcheck: fix unused code + small test cleanups","description":"Running staticcheck flags a few issues: unused helper funcs in e2e tests, an unused calculateBurndown wrapper in cmd/bv/main.go, an unused assignment in ui graph tests, and a redundant nil+len check in duplicates tests. Clean these up so static analysis stays green.","acceptance_criteria":"- staticcheck ./... returns zero findings\n- go test ./... still passes","status":"closed","priority":3,"type":"chore","labels":["cleanup","staticcheck"],"assignee":"BrownBear","created_at":"2025-12-17 04:32","updated_at":"2025-12-17 04:37","closed_at":"2025-12-17 04:37","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-g4gs","title":"Installer Script: TMP_DIRS Unbound Variable Error with set -u","description":"## Problem Statement\n\nThe install.sh script fails with an unbound variable error after successful installation when run with strict bash settings. The error occurs during cleanup when iterating over the TMP_DIRS array.\n\n## User Impact\n\n**Severity: Medium (P2)**\n- Confusing error message after successful install\n- Only affects new installations\n- Reported by @tonywoode in GitHub Issue #7\n\n## Error Message\n\n```bash\n$ curl -fsSL \"...install.sh\" | bash\n==\u003e Installing bv...\n==\u003e Detected platform: darwin_arm64\n==\u003e Checking for pre-built binary...\n==\u003e Latest release: v0.10.2\n==\u003e Selected asset: bv_0.10.2_darwin_arm64.tar.gz\n==\u003e Downloading...\n==\u003e Extracting...\n==\u003e Installed bv v0.10.2 to /opt/homebrew/bin/bv\n==\u003e Run 'bv' in any beads project to view issues.\nbash: line 10: TMP_DIRS[@]: unbound variable    ‚Üê ERROR HERE\n```\n\n## Root Cause Analysis\n\n**Location:** `install.sh:2,8-14`\n\n```bash\nset -euo pipefail  # -u makes unbound variables an error\n\nTMP_DIRS=()  # Empty array\n\ncleanup_tmp_dirs() {\n    local dir\n    for dir in \"${TMP_DIRS[@]}\"; do  # FAILS when array is empty\\!\n        [ -n \"$dir\" ] \u0026\u0026 rm -rf \"$dir\"\n    done\n}\n\ntrap cleanup_tmp_dirs EXIT\n```\n\nWith `set -u` (nounset), iterating over an empty array using `${TMP_DIRS[@]}` is an error in older bash versions. The array starts empty and if the binary install succeeds on the first try, no temp dirs are created.\n\n## Why Installation Still Works\n\nThe error occurs in the EXIT trap AFTER the main script completes successfully. The binary is already installed when the cleanup function runs and fails.\n\n## Proposed Solution\n\n### Fix: Use array expansion that handles empty arrays\n\n```bash\ncleanup_tmp_dirs() {\n    local dir\n    # Use ${array[@]+\"${array[@]}\"} pattern for empty array safety\n    for dir in \"${TMP_DIRS[@]+\"${TMP_DIRS[@]}\"}\"; do\n        [ -n \"$dir\" ] \u0026\u0026 rm -rf \"$dir\"\n    done\n}\n```\n\nThe `${var+value}` pattern returns nothing if var is unset/empty, avoiding the unbound error.\n\n### Alternative: Check array length first\n\n```bash\ncleanup_tmp_dirs() {\n    if [ ${#TMP_DIRS[@]} -gt 0 ]; then\n        local dir\n        for dir in \"${TMP_DIRS[@]}\"; do\n            [ -n \"$dir\" ] \u0026\u0026 rm -rf \"$dir\"\n        done\n    fi\n}\n```\n\n## Additional Bash Compatibility Considerations\n\nWhile fixing this, audit for other bash compatibility issues:\n- Array operations with set -u\n- Local variable declarations\n- Process substitution\n- Bash version requirements\n\n## Test Plan\n\n1. Test: Fresh install on macOS (binary download path) - no error\n2. Test: Install with fallback to source build - no error\n3. Test: Install with no writable dirs (triggers temp dir creation) - no error\n4. Test: Verify cleanup actually removes temp dirs when they exist\n5. Test: Various bash versions (4.x, 5.x)\n\n## Acceptance Criteria\n\n- [ ] No 'unbound variable' error after successful install\n- [ ] Temp directories still cleaned up when created\n- [ ] Works with bash 4.x and 5.x\n- [ ] No regression in installation success rate\n- [ ] Error handling for actual failures preserved\n\n## Note on Issue #7\n\nThe original issue title mentions a 404 error, but that was a user typo in the URL (they had an extra 'github.com/Dicklesworthstone' in the path). Our README has the correct URL. The TMP_DIRS issue is the actual bug in our code.\n\n## References\n\n- GitHub Issue #7: https://github.com/Dicklesworthstone/beads_viewer/issues/7\n- Bash empty array iteration: https://stackoverflow.com/questions/7577052/\n- set -u documentation: https://www.gnu.org/software/bash/manual/html_node/The-Set-Builtin.html","status":"closed","priority":2,"type":"bug","labels":["gh-issue-7","installation"],"created_at":"2025-12-15 23:53","updated_at":"2025-12-16 10:49","closed_at":"2025-12-16 10:49","blocks":["bv-uqoh"],"pagerank":0.0016019788987050227,"betweenness":0,"eigenvector":0,"hub":0,"authority":9.324854925833239e-9,"critical_path":2,"in_degree":1,"out_degree":0,"core_number":1,"slack":13,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-gdlt","title":"Implement error handling and graceful degradation for viewer","description":"# Implement Error Handling and Graceful Degradation\n\n## Context\nThe static viewer depends on sql.js WASM and optional OPFS caching. These can fail for various reasons:\n- Browser doesn't support WASM\n- Browser blocks cross-origin isolated features\n- OPFS not available (Safari versions, private browsing)\n- Network issues loading database\n- Corrupt or incompatible database version\n\n## Requirements\n\n### sql.js Load Failure\n```javascript\nasync function initDatabase() {\n  try {\n    const SQL = await initSqlJs({\n      locateFile: file =\u003e `./vendor/${file}`\n    });\n    return SQL;\n  } catch (e) {\n    showError({\n      title: \"Browser Compatibility Issue\",\n      message: \"This viewer requires WebAssembly support.\",\n      details: e.message,\n      actions: [\n        { label: \"Check browser support\", url: \"https://caniuse.com/wasm\" },\n        { label: \"Download data as JSON\", action: downloadFallbackJSON }\n      ]\n    });\n    return null;\n  }\n}\n```\n\n### Database Load Failure\n```javascript\nasync function loadDatabase() {\n  const paths = [\"./beads.sqlite3\", \"./data/beads.sqlite3\"];\n  \n  for (const path of paths) {\n    try {\n      const response = await fetch(path);\n      if (!response.ok) continue;\n      \n      const buffer = await response.arrayBuffer();\n      return new SQL.Database(new Uint8Array(buffer));\n    } catch (e) {\n      console.warn(`Failed to load ${path}:`, e);\n    }\n  }\n  \n  showError({\n    title: \"Database Not Found\",\n    message: \"Could not load the issues database.\",\n    details: \"The beads.sqlite3 file may be missing or corrupted.\",\n    actions: [\n      { label: \"Reload page\", action: () =\u003e location.reload() },\n      { label: \"Report issue\", url: \"https://github.com/...\" }\n    ]\n  });\n  return null;\n}\n```\n\n### OPFS Graceful Fallback\n```javascript\nasync function cacheToOPFS(data) {\n  // OPFS may not be available - that's okay\n  if (!(\"storage\" in navigator)) {\n    console.info(\"OPFS not available, skipping cache\");\n    return false;\n  }\n  \n  try {\n    const root = await navigator.storage.getDirectory();\n    const handle = await root.getFileHandle(\"beads.sqlite3\", { create: true });\n    const writable = await handle.createWritable();\n    await writable.write(data);\n    await writable.close();\n    return true;\n  } catch (e) {\n    // Private browsing, permission denied, etc.\n    console.info(\"OPFS cache unavailable:\", e.message);\n    return false;\n  }\n}\n```\n\n### Query Error Handling\n```javascript\nfunction safeQuery(sql, params = []) {\n  try {\n    const results = DB.exec(sql, params);\n    return { success: true, data: results };\n  } catch (e) {\n    console.error(\"Query failed:\", sql, e);\n    return { \n      success: false, \n      error: e.message,\n      fallback: [] \n    };\n  }\n}\n\n// Usage\nfunction loadIssues(filters) {\n  const result = safeQuery(buildFilterQuery(filters));\n  if (!result.success) {\n    showToast(\"Filter query failed, showing all issues\");\n    return safeQuery(\"SELECT * FROM issue_overview_mv LIMIT 100\").data;\n  }\n  return result.data;\n}\n```\n\n### Error UI Component\n```html\n\u003ctemplate x-if=\"$store.app.error\"\u003e\n  \u003cdiv class=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\"\u003e\n    \u003cdiv class=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md p-6\"\u003e\n      \u003ch2 class=\"text-lg font-bold text-red-600\" x-text=\"$store.app.error.title\"\u003e\u003c/h2\u003e\n      \u003cp class=\"mt-2 text-gray-600 dark:text-gray-300\" x-text=\"$store.app.error.message\"\u003e\u003c/p\u003e\n      \u003cpre x-show=\"$store.app.error.details\" \n           class=\"mt-2 text-xs bg-gray-100 dark:bg-gray-900 p-2 rounded overflow-auto max-h-32\"\n           x-text=\"$store.app.error.details\"\u003e\u003c/pre\u003e\n      \u003cdiv class=\"mt-4 flex gap-2\"\u003e\n        \u003ctemplate x-for=\"action in $store.app.error.actions\"\u003e\n          \u003cbutton \n            @click=\"action.action ? action.action() : window.open(action.url)\"\n            class=\"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600\"\n            x-text=\"action.label\"\u003e\n          \u003c/button\u003e\n        \u003c/template\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n\u003c/template\u003e\n```\n\n### Loading States\n```javascript\nAlpine.store(\"app\", {\n  loading: true,\n  loadingMessage: \"Initializing...\",\n  error: null,\n  \n  async init() {\n    try {\n      this.loadingMessage = \"Loading WebAssembly...\";\n      const SQL = await initDatabase();\n      if (!SQL) return; // Error already shown\n      \n      this.loadingMessage = \"Loading database...\";\n      const db = await loadDatabase();\n      if (!db) return; // Error already shown\n      \n      this.loadingMessage = \"Preparing data...\";\n      await warmupQueries(db);\n      \n      this.loading = false;\n    } catch (e) {\n      this.error = {\n        title: \"Initialization Failed\",\n        message: \"An unexpected error occurred.\",\n        details: e.stack\n      };\n    }\n  }\n});\n```\n\n### Diagnostics Panel\n```html\n\u003cdiv x-show=\"showDiagnostics\" class=\"fixed bottom-4 right-4 bg-gray-100 dark:bg-gray-800 p-4 rounded shadow-lg text-xs\"\u003e\n  \u003ch3 class=\"font-bold mb-2\"\u003eDiagnostics\u003c/h3\u003e\n  \u003cdl class=\"grid grid-cols-2 gap-1\"\u003e\n    \u003cdt\u003eWASM:\u003c/dt\u003e\u003cdd x-text=\"diagnostics.wasm ? '‚úì' : '‚úó'\"\u003e\u003c/dd\u003e\n    \u003cdt\u003eOPFS:\u003c/dt\u003e\u003cdd x-text=\"diagnostics.opfs ? '‚úì' : '‚úó (optional)'\"\u003e\u003c/dd\u003e\n    \u003cdt\u003eDB Source:\u003c/dt\u003e\u003cdd x-text=\"diagnostics.dbSource\"\u003e\u003c/dd\u003e\n    \u003cdt\u003eIssues:\u003c/dt\u003e\u003cdd x-text=\"diagnostics.issueCount\"\u003e\u003c/dd\u003e\n    \u003cdt\u003eLoad time:\u003c/dt\u003e\u003cdd x-text=\"diagnostics.loadTimeMs + 'ms'\"\u003e\u003c/dd\u003e\n  \u003c/dl\u003e\n\u003c/div\u003e\n```\n\n## Acceptance Criteria\n- [ ] sql.js load failure shows helpful error with alternatives\n- [ ] Database load failure shows helpful error\n- [ ] OPFS failures are silent (graceful fallback)\n- [ ] Query errors don't crash the app\n- [ ] Loading states show progress\n- [ ] Error modal is dismissible\n- [ ] Diagnostics panel available (hidden by default)\n- [ ] No console errors in normal operation\n- [ ] Works in private browsing mode (without OPFS)\n- [ ] Works on older browsers that support WASM","status":"closed","priority":2,"type":"task","labels":["phase-2","static-pages"],"created_at":"2025-12-15 23:22","updated_at":"2025-12-16 10:42","closed_at":"2025-12-16 10:42","blocked_by":["bv-jdl"],"blocks":["bv-y5i"],"pagerank":0.0015706037203119501,"betweenness":0,"eigenvector":0,"hub":0.00006846157171641059,"authority":0.0001967059030531822,"critical_path":3,"in_degree":1,"out_degree":1,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-gij1","title":"Implement critical path highlighting and animation","description":"# Critical Path Highlighting\n\n## Context\nHighlight the longest dependency chain (critical path) with animated traversal.\n\n## Requirements\n\n### 1. Compute Critical Path via WASM\n```javascript\nfunction getCriticalPath() {\n    const heights = GRAPH.critical_path_heights();\n    const maxHeight = Math.max(...heights);\n    \n    // Find the sink with max height\n    let sink = null;\n    heights.forEach((h, i) =\u003e {\n        if (h === maxHeight) sink = i;\n    });\n    \n    // Backtrack to reconstruct path\n    return reconstructPath(sink, heights);\n}\n```\n\n### 2. Visual Highlighting\n```javascript\nfunction highlightCriticalPath(path) {\n    // Dim all other nodes/edges\n    Graph.nodeColor(node =\u003e \n        path.includes(NODE_MAP.get(node.id)) \n            ? '#ff6b6b' \n            : '#cccccc50'\n    );\n    \n    // Thick red edges for critical path\n    Graph.linkWidth(link =\u003e\n        isOnCriticalPath(link) ? 3 : 0.5\n    );\n    Graph.linkColor(link =\u003e\n        isOnCriticalPath(link) ? '#ff6b6b' : '#cccccc50'\n    );\n}\n```\n\n### 3. Path Traversal Animation\n```javascript\nasync function animatePath(path) {\n    for (let i = 0; i \u003c path.length; i++) {\n        highlightNode(path[i], 'active');\n        if (i \u003e 0) {\n            animateEdge(path[i-1], path[i]);\n        }\n        await sleep(300);\n    }\n}\n```\n\n### 4. Toggle Button\n'Show Critical Path' button in toolbar toggles this view.\n\n## Acceptance Criteria\n- [ ] Critical path computed from WASM heights\n- [ ] Path nodes/edges highlighted distinctly\n- [ ] Animation traverses path smoothly\n- [ ] Toggle on/off works\n- [ ] Shows path length/depth info","status":"closed","priority":2,"type":"task","labels":["phase-2","visualization","wasm"],"created_at":"2025-12-15 23:56","updated_at":"2025-12-16 12:19","closed_at":"2025-12-16 12:19","blocked_by":["bv-jndd","bv-bikt"],"blocks":["bv-z38b"],"pagerank":0.0021039815616854516,"betweenness":4,"eigenvector":0,"hub":0.000002844918771328063,"authority":2.406791235928733e-7,"critical_path":2,"in_degree":1,"out_degree":2,"core_number":2,"slack":9,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-gmka","title":"E2E: Export with various graph topologies","description":"Test static export with different graph structures.\n\n## Topologies to Test\n1. **Empty Graph**\n   - No issues\n   - Appropriate empty state\n   - No errors\n\n2. **Single Node**\n   - One issue, no deps\n   - Renders correctly\n   - No orphan edges\n\n3. **Linear Chain**\n   - A -\u003e B -\u003e C -\u003e D -\u003e E\n   - Chain renders vertically\n   - All edges visible\n\n4. **Star Topology**\n   - Hub with 10 spokes\n   - Hub centered\n   - Spokes distributed evenly\n\n5. **Diamond**\n   - A -\u003e B, A -\u003e C, B -\u003e D, C -\u003e D\n   - Diamond shape apparent\n   - No edge overlap\n\n6. **Cycles Present**\n   - A -\u003e B -\u003e C -\u003e A\n   - Cycle highlighted\n   - Warning displayed\n\n7. **Disconnected Components**\n   - Multiple isolated subgraphs\n   - Each component rendered\n   - Clear separation\n\n8. **Large Scale**\n   - 500+ nodes\n   - Performance acceptable\n   - Zoom/pan required\n\n## Validation\n- SVG validates\n- All nodes visible\n- All edges connect correctly\n- Legend accurate\n- Performance metrics logged","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-16 20:09","updated_at":"2025-12-17 01:01","closed_at":"2025-12-17 01:01","blocked_by":["bv-ct7m"],"blocks":["bv-hdu4"],"pagerank":0.0016726975206033255,"betweenness":0,"eigenvector":0,"hub":7.032456132708617e-11,"authority":3.1573158850443083e-10,"critical_path":3,"in_degree":1,"out_degree":1,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-gv7","title":"Add mobile responsive design to static viewer","description":"# Add Mobile Responsive Design to Static Viewer\n\n## Context\nThe static viewer should work well on mobile devices for checking project status on the go.\n\n## Requirements\n\n### Breakpoints (Tailwind defaults)\n- sm: 640px (phones landscape)\n- md: 768px (tablets)\n- lg: 1024px (laptops)\n- xl: 1280px (desktops)\n\n### Layout Adaptations\n\n#### Header\n- Desktop: Full navigation bar with links\n- Mobile: Hamburger menu with slide-out drawer\n\n#### Dashboard\n- Desktop: 4-column stat cards, 2-column lists\n- Mobile: Stacked cards, single column\n\n#### Issues List\n- Desktop: Sidebar filters + main list\n- Mobile: Collapsible filter panel above list\n\n#### Issue Detail\n- Desktop: Full layout with sidebar graph\n- Mobile: Stacked sections, graph below content\n\n### Touch Optimizations\n- Minimum tap target: 44x44px\n- Swipe gestures (optional): swipe between issues\n- Pull to refresh (optional)\n- No hover-only interactions\n\n### Mobile Navigation\n```html\n\u003c!-- Hamburger button (mobile only) --\u003e\n\u003cbutton \n    @click=\"mobileMenuOpen = !mobileMenuOpen\"\n    class=\"md:hidden p-2\"\n\u003e\n    \u003csvg class=\"w-6 h-6\"\u003e...\u003c/svg\u003e\n\u003c/button\u003e\n\n\u003c!-- Mobile slide-out menu --\u003e\n\u003cdiv \n    x-show=\"mobileMenuOpen\"\n    x-transition:enter=\"transform transition-transform duration-200\"\n    x-transition:enter-start=\"-translate-x-full\"\n    x-transition:enter-end=\"translate-x-0\"\n    class=\"fixed inset-y-0 left-0 w-64 bg-white dark:bg-gray-900 shadow-lg md:hidden z-50\"\n\u003e\n    \u003cnav class=\"p-4\"\u003e\n        \u003ca href=\"#/\" class=\"block py-2\"\u003eDashboard\u003c/a\u003e\n        \u003ca href=\"#/issues\" class=\"block py-2\"\u003eIssues\u003c/a\u003e\n        \u003ca href=\"#/insights\" class=\"block py-2\"\u003eInsights\u003c/a\u003e\n    \u003c/nav\u003e\n\u003c/div\u003e\n\n\u003c!-- Backdrop --\u003e\n\u003cdiv \n    x-show=\"mobileMenuOpen\"\n    @click=\"mobileMenuOpen = false\"\n    class=\"fixed inset-0 bg-black bg-opacity-50 md:hidden z-40\"\n\u003e\u003c/div\u003e\n```\n\n### Responsive Issue Card\n```html\n\u003cdiv class=\"p-4 border-b hover:bg-gray-50 dark:hover:bg-gray-800\"\u003e\n    \u003c!-- Mobile: Stack everything --\u003e\n    \u003cdiv class=\"flex flex-col gap-2 md:flex-row md:items-center md:gap-4\"\u003e\n        \u003cdiv class=\"flex items-center gap-2\"\u003e\n            \u003cspan class=\"status-dot\"\u003e\u003c/span\u003e\n            \u003cspan class=\"font-mono text-sm text-gray-500\"\u003ebv-123\u003c/span\u003e\n        \u003c/div\u003e\n        \u003cdiv class=\"flex-1\"\u003e\n            \u003ch3 class=\"font-medium line-clamp-2\"\u003eIssue title here\u003c/h3\u003e\n        \u003c/div\u003e\n        \u003cdiv class=\"flex items-center gap-2 text-sm\"\u003e\n            \u003cspan class=\"badge\"\u003eP2\u003c/span\u003e\n            \u003cspan class=\"badge\"\u003etask\u003c/span\u003e\n        \u003c/div\u003e\n    \u003c/div\u003e\n\u003c/div\u003e\n```\n\n### Virtual Scroll Mobile Optimization\n- Larger item heights on mobile (easier tap)\n- Reduce visible items for performance\n- Momentum scrolling (-webkit-overflow-scrolling: touch)\n\n### Filter Panel Mobile\n```html\n\u003cdiv class=\"md:hidden\"\u003e\n    \u003cbutton \n        @click=\"filtersOpen = !filtersOpen\"\n        class=\"w-full p-3 flex items-center justify-between bg-gray-100 dark:bg-gray-800\"\n    \u003e\n        \u003cspan\u003eFilters (3 active)\u003c/span\u003e\n        \u003csvg :class=\"filtersOpen \u0026\u0026 'rotate-180'\"\u003e‚ñº\u003c/svg\u003e\n    \u003c/button\u003e\n    \n    \u003cdiv x-show=\"filtersOpen\" x-collapse class=\"p-4 border-b\"\u003e\n        \u003c!-- Filter controls --\u003e\n    \u003c/div\u003e\n\u003c/div\u003e\n```\n\n## Testing\n- Test on real devices (iOS Safari, Android Chrome)\n- Test with Chrome DevTools device emulation\n- Verify touch interactions work\n- Test landscape orientation\n\n## Acceptance Criteria\n- [ ] Works on iPhone SE (smallest common)\n- [ ] Works on iPad\n- [ ] Touch targets 44px+\n- [ ] No horizontal scroll\n- [ ] Navigation accessible on mobile\n- [ ] Filter panel usable\n- [ ] Issue cards readable\n- [ ] Graphs scrollable/zoomable","status":"closed","priority":3,"type":"task","labels":["phase-4","static-pages"],"created_at":"2025-12-15 23:10","updated_at":"2025-12-16 10:50","closed_at":"2025-12-16 10:50","blocked_by":["bv-uun","bv-5yb"],"blocks":["bv-y5i"],"pagerank":0.0015706037203119501,"betweenness":0,"eigenvector":0,"hub":0.00007879179036287026,"authority":0.0001967059030531822,"critical_path":3,"in_degree":1,"out_degree":2,"core_number":3,"slack":9,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-gv9v","title":"Infrastructure: Test coverage reporting and enforcement","description":"Set up comprehensive test coverage reporting.\n\n## Coverage Tooling\n1. **go test -cover**\n   - Per-package coverage\n   - Overall coverage\n   - HTML report generation\n\n2. **CI Integration**\n   - Coverage check in CI\n   - Minimum threshold (80%)\n   - Coverage trend tracking\n   - PR coverage diff\n\n3. **Reporting**\n   - Codecov/Coveralls integration\n   - Badge in README\n   - Per-file coverage\n   - Uncovered lines report\n\n## Configuration\n- Create .coveragerc or equivalent\n- Exclude generated files\n- Exclude test helpers\n- Set thresholds per package\n\n## Implementation\n- Add coverage script\n- Configure CI workflow\n- Set up reporting service\n- Add coverage badge","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-16 20:10","updated_at":"2025-12-17 02:07","closed_at":"2025-12-17 02:07","blocked_by":["bv-3bhq","bv-ul1l","bv-ubra"],"blocks":["bv-q923"],"pagerank":0.0016159234171211456,"betweenness":0,"eigenvector":0,"hub":4.621749253604874e-8,"authority":7.094593722740486e-8,"critical_path":2,"in_degree":1,"out_degree":3,"core_number":2,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-hdu4","title":"[SUB-EPIC] Static GitHub Pages Export Workflow Testing","description":"Comprehensive testing of the static site export workflow for GitHub Pages.\n\n## Components to Test\n1. Wizard flow (wizard.go, wizard_flow_test.go expansion)\n2. GitHub Pages deployment (github.go)\n3. Cloudflare Pages deployment (cloudflare.go)\n4. Preview generation (preview.go)\n5. Static bundle generation\n6. Search index embedding\n7. Graph visualization in export\n\n## Test Scenarios\n- Fresh export to new directory\n- Export with existing files (overwrite handling)\n- Export with various graph sizes (0, 10, 100, 1000 issues)\n- Export with cycles present\n- Export with all status types\n- Cross-browser rendering validation\n- Offline functionality testing\n\n## Success Criteria\n- All export paths have E2E tests\n- Edge cases documented and tested\n- Generated HTML validates\n- Search works offline\n- Graphs render correctly","status":"closed","priority":1,"type":"epic","labels":null,"created_at":"2025-12-16 20:04","updated_at":"2025-12-17 01:10","closed_at":"2025-12-17 01:10","blocked_by":["bv-focq","bv-ufsr","bv-mwlh","bv-ct7m","bv-pua7","bv-gmka","bv-2ino"],"blocks":["bv-q923"],"pagerank":0.0016159234171211456,"betweenness":7,"eigenvector":0,"hub":4.0095985476724193e-10,"authority":7.094593722740486e-8,"critical_path":2,"in_degree":1,"out_degree":7,"core_number":2,"slack":11,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-hmkz","title":"Focus Isolation: List Selection Changes During Detail View Navigation","description":"## Problem Statement\n\nWhen the detail view panel has focus (split view mode), pressing j/k or arrow keys to scroll the detail content ALSO changes the list selection in the left panel. The list visually updates to show a different selected item, even though the detail content being displayed doesn't change.\n\n## User Impact\n\n**Severity: Critical (P0)**\n- Affects ALL users in split view mode\n- Creates confusion about which issue is actually selected\n- Breaks the mental model of focus isolation\n- Reported by @ZainRizvi in GitHub Issue #12 with video evidence\n\n## Root Cause Analysis\n\n**Location:** `pkg/ui/model.go:1116`\n\n```go\n// Update list for filtering input, but NOT for WindowSizeMsg\nif _, isWindowSize := msg.(tea.WindowSizeMsg); !isWindowSize {\n    m.list, cmd = m.list.Update(msg)  // ‚Üê PROBLEM: Called for ALL messages!\n    cmds = append(cmds, cmd)\n}\n```\n\nThe bubbles `list.Model` component internally handles j/k keys for navigation. This code passes ALL keyboard messages to the list, regardless of current focus state. When in `focusDetail` mode:\n\n1. `viewport.Update(msg)` is called (line 986) - correctly scrolls detail content\n2. `list.Update(msg)` is ALSO called (line 1116) - incorrectly moves list selection\n\nThe second call happens because the guard only excludes WindowSizeMsg, not keyboard messages when focus is elsewhere.\n\n## Why Detail Content Doesn't Change\n\nThe detail view shows the issue that was selected when `updateViewportContent()` was last called. Since this function is only triggered by explicit list selection changes (not by internal list.Update navigation), the displayed content stays the same even as the list cursor moves.\n\n## Proposed Solution\n\nGate list updates by focus state. Only forward keyboard messages to the list when `m.focused == focusList` or when the message is a non-navigation type (like filtering input, WindowSizeMsg).\n\n**Option A (Minimal change):**\n```go\n// Only update list selection when list has focus\nif m.focused == focusList {\n    if _, isWindowSize := msg.(tea.WindowSizeMsg); !isWindowSize {\n        m.list, cmd = m.list.Update(msg)\n        cmds = append(cmds, cmd)\n    }\n}\n```\n\n**Option B (More granular):**\nMaintain list.Update for non-navigation messages (filtering, search) while blocking j/k/arrows when unfocused.\n\n## Test Plan\n\n1. Create test: Split view with focusDetail, send j/k keys, verify list index unchanged\n2. Create test: Split view with focusList, send j/k keys, verify list index changes\n3. Create test: Filtering input works regardless of focus\n4. Manual test: Verify scroll in detail pane doesn't affect list selection\n5. Manual test: Verify Tab switching focus works correctly\n\n## Acceptance Criteria\n\n- [ ] j/k in detail view scrolls content, doesn't change list selection\n- [ ] j/k in list view still navigates as expected\n- [ ] Tab correctly switches focus between panels\n- [ ] Filter/search input still works from any focus state\n- [ ] New tests pass with 100% coverage of focus scenarios\n\n## References\n\n- GitHub Issue #12: https://github.com/Dicklesworthstone/beads_viewer/issues/12\n- Video demonstration in issue shows exact behavior\n- Related code: handleListKeys(), focusDetail case at line 985-988","status":"closed","priority":0,"type":"bug","labels":["critical","gh-issue-12","ux"],"created_at":"2025-12-15 23:51","updated_at":"2025-12-16 00:17","closed_at":"2025-12-16 00:17","blocks":["bv-uqoh"],"pagerank":0.0016019788987050227,"betweenness":0,"eigenvector":0,"hub":0,"authority":9.324854925833239e-9,"critical_path":2,"in_degree":1,"out_degree":0,"core_number":1,"slack":13,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-i10k","title":"Unit test: item.go - List item abstraction","description":"Create unit tests for pkg/ui/item.go\n\n## File Overview\nitem.go provides the list item abstraction implementing bubbles/list.Item interface.\n\n## Test Cases to Implement\n1. **Interface Implementation**\n   - FilterValue() returns searchable text\n   - Title() returns display title\n   - Description() returns subtitle\n\n2. **FilterValue Composition**\n   - Includes issue ID\n   - Includes title\n   - Includes status\n   - Includes labels\n   - Includes assignee\n   - Case-insensitive matching works\n\n3. **Display Formatting**\n   - Title truncation\n   - Status emoji mapping\n   - Priority indicator\n   - Label badges\n\n4. **Edge Cases**\n   - Issue with no labels\n   - Issue with no assignee\n   - Very long title\n   - Unicode in title/labels\n\n## Implementation Notes\n- Create test issues with various properties\n- Verify interface contract compliance\n- Test with bubbles/list component","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-16 20:06","updated_at":"2025-12-16 23:14","closed_at":"2025-12-16 23:14","blocks":["bv-ul1l"],"pagerank":0.0017282929585731776,"betweenness":0,"eigenvector":0,"hub":0,"authority":6.623673282227765e-11,"critical_path":4,"in_degree":1,"out_degree":0,"core_number":1,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-i5st","title":"Unit test: pkg/search/config.go - Search configuration","description":"Create unit tests for pkg/search/config.go\n\n## File Overview\nconfig.go handles search configuration including embedder selection and parameters.\n\n## Test Cases to Implement\n1. **Config Loading**\n   - Default config values\n   - Environment variable overrides (BV_SEMANTIC_*)\n   - Invalid config handling\n\n2. **Embedder Selection**\n   - Hash embedder (default)\n   - Python embedder config\n   - OpenAI embedder config\n   - Unknown embedder error\n\n3. **Dimension Configuration**\n   - Default dimension (384)\n   - Custom dimension\n   - Invalid dimension handling\n\n4. **Model Configuration**\n   - Default model per embedder\n   - Custom model override\n   - Model validation\n\n## Implementation Notes\n- Test with various env var combinations\n- Verify config struct population\n- Test error messages are helpful","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-16 20:07","updated_at":"2025-12-16 23:34","closed_at":"2025-12-16 23:34","blocks":["bv-ubra"],"pagerank":0.0019171540027831243,"betweenness":0,"eigenvector":0,"hub":0,"authority":8.0286461624274e-14,"critical_path":4,"in_degree":1,"out_degree":0,"core_number":1,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-iwjb","title":"Add e2e contract tests for robot label + triage grouping outputs","description":"We have strong e2e contract coverage for core robot commands, but label analysis outputs and triage grouping flags (track/label) aren't currently covered.\n\nAdd lightweight e2e tests to ensure these JSON contracts stay stable for automation/agents:\n- `--robot-triage-by-track` includes `triage.recommendations_by_track` with a `top_pick` + `claim_command` when data has multiple tracks\n- `--robot-triage-by-label` includes `triage.recommendations_by_label` with `top_pick` + `claim_command` when data has multiple labels\n- `--robot-label-health`, `--robot-label-flow`, `--robot-label-attention` emit required top-level fields (`generated_at`, `data_hash`, and expected payload shapes)\n\nAcceptance:\n- New e2e tests added (or extended) and pass under `go test ./...`\n- Tests use small synthetic JSONL fixtures and assert key fields non-empty / structurally correct\n","notes":"Implemented e2e contract tests covering triage groupings and label robot outputs.\n\nAlso fixed a real bug uncovered by the tests: `recommendations_by_track[].claim_command` and `recommendations_by_label[].claim_command` were always empty because `Recommendation.Action` moved to human-readable ActionHints. Claim commands are now populated when top picks are selected.\n\nTests: `go test ./...`.","status":"closed","priority":2,"type":"task","labels":["robot","tests"],"created_at":"2025-12-16 18:25","updated_at":"2025-12-16 18:35","closed_at":"2025-12-16 18:35","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-ixzo","title":"Unit test: cycle_warnings.go - Cycle warning generation","description":"Create comprehensive unit tests for pkg/analysis/cycle_warnings.go\n\n## File Overview\ncycle_warnings.go generates human-readable warnings for detected cycles:\n- Formats cycle paths as readable strings\n- Suggests which edge to remove\n- Calculates impact of cycle removal\n- Prioritizes cycle fixes by severity\n\n## Test Cases to Implement\n1. **Simple Cycle Formatting**\n   - 2-node cycle: A -\u003e B -\u003e A\n   - 3-node cycle: A -\u003e B -\u003e C -\u003e A\n   - Self-loop: A -\u003e A\n\n2. **Complex Cycle Formatting**\n   - 10+ node cycle (truncation?)\n   - Multiple overlapping cycles\n   - Nested cycles\n\n3. **Removal Suggestions**\n   - Suggest removing lowest-impact edge\n   - Consider PageRank of involved nodes\n   - Prefer removing edges to closed issues\n\n4. **Impact Calculation**\n   - Calculate downstream impact of each edge\n   - Identify minimum cut to break cycle\n   - Report unblock count after fix\n\n5. **Edge Cases**\n   - No cycles (empty warnings)\n   - All issues in one big cycle\n   - Disconnected cycles\n   - Cycles with same issues in different orders\n\n## Implementation Notes\n- Create test graphs with known cycles\n- Verify warning strings are human-readable\n- Test with real issue titles (not just IDs)\n- Golden file tests for complex formatting","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-16 20:05","updated_at":"2025-12-16 22:00","closed_at":"2025-12-16 22:00","blocks":["bv-0kll","bv-3bhq"],"pagerank":0.001985274869031905,"betweenness":0,"eigenvector":0,"hub":0,"authority":1.7833198250397624e-7,"critical_path":5,"in_degree":2,"out_degree":0,"core_number":2,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-jdl","title":"Create static viewer asset bundle (HTML/JS/CSS templates)","description":"# Create Static Viewer with sql.js WASM\n\n## Context\nThe viewer uses sql.js (SQLite compiled to WASM) to query the exported database client-side. This mirrors mcp_agent_mail's architecture and provides:\n- Real SQL queries instead of array filtering\n- FTS5 full-text search with ranking\n- Complex dependency queries\n- OPFS caching for offline support\n- Chunk reassembly for large databases\n\n## File Structure\n```\npkg/export/viewer_assets/\n  index.html          # SPA entry with CSP, COOP/COEP handling\n  viewer.js           # Main app with sql.js integration\n  styles.css          # Tailwind-based styles\n  vendor/\n    sql-wasm.js       # sql.js library\n    sql-wasm.wasm     # SQLite WASM binary (~1MB)\n    alpine.min.js     # Alpine.js for reactivity\n    marked.min.js     # Markdown rendering\n    dompurify.min.js  # HTML sanitization\n  coi-serviceworker.js  # COOP/COEP for GitHub Pages\n```\n\n## sql.js Integration\n\n### Database Loading\n```javascript\nconst DB_STATE = {\n  sql: null,          // sql.js library\n  db: null,           // Database instance\n  cacheKey: null,     // OPFS cache key\n  source: 'network',  // 'network' | 'cache' | 'chunks'\n};\n\nasync function loadDatabase() {\n  // 1. Initialize sql.js\n  DB_STATE.sql = await initSqlJs({\n    locateFile: file =\u003e `./vendor/${file}`\n  });\n  \n  // 2. Try OPFS cache first\n  const cached = await loadFromOPFS();\n  if (cached) {\n    DB_STATE.db = new DB_STATE.sql.Database(cached);\n    DB_STATE.source = 'cache';\n    return;\n  }\n  \n  // 3. Check for chunked database\n  const config = await fetchJSON('./beads.sqlite3.config.json').catch(() =\u003e null);\n  if (config?.chunked) {\n    const chunks = await loadChunks(config);\n    DB_STATE.db = new DB_STATE.sql.Database(chunks);\n    DB_STATE.source = 'chunks';\n  } else {\n    // 4. Load single file\n    const buf = await fetch('./beads.sqlite3').then(r =\u003e r.arrayBuffer());\n    DB_STATE.db = new DB_STATE.sql.Database(new Uint8Array(buf));\n    DB_STATE.source = 'network';\n  }\n  \n  // 5. Cache to OPFS for next time\n  await cacheToOPFS(DB_STATE.db.export());\n}\n```\n\n### OPFS Caching (like mcp_agent_mail)\n```javascript\nasync function loadFromOPFS() {\n  if (!('storage' in navigator)) return null;\n  try {\n    const root = await navigator.storage.getDirectory();\n    const handle = await root.getFileHandle('beads.sqlite3', { create: false });\n    const file = await handle.getFile();\n    return new Uint8Array(await file.arrayBuffer());\n  } catch {\n    return null;\n  }\n}\n\nasync function cacheToOPFS(data) {\n  if (!('storage' in navigator)) return;\n  try {\n    const root = await navigator.storage.getDirectory();\n    const handle = await root.getFileHandle('beads.sqlite3', { create: true });\n    const writable = await handle.createWritable();\n    await writable.write(data);\n    await writable.close();\n  } catch (e) {\n    console.warn('OPFS cache failed:', e);\n  }\n}\n```\n\n### Query Layer\n```javascript\nfunction queryIssues(filters, sort, limit = 100, offset = 0) {\n  let sql = `SELECT * FROM issue_overview_mv WHERE 1=1`;\n  const params = [];\n  \n  if (filters.status?.length) {\n    sql += ` AND status IN (${filters.status.map(() =\u003e '?').join(',')})`;\n    params.push(...filters.status);\n  }\n  \n  if (filters.search) {\n    sql += ` AND id IN (SELECT id FROM issues_fts WHERE issues_fts MATCH ?)`;\n    params.push(filters.search + '*'); // Prefix search\n  }\n  \n  if (filters.labels?.length) {\n    sql += ` AND (${filters.labels.map(() =\u003e `labels LIKE ?`).join(' OR ')})`;\n    params.push(...filters.labels.map(l =\u003e `%\"${l}\"%`));\n  }\n  \n  // Sorting\n  const sortMap = {\n    'priority': 'priority ASC, triage_score DESC',\n    'updated': 'updated_at DESC',\n    'score': 'triage_score DESC',\n    'blocks': 'blocks_count DESC'\n  };\n  sql += ` ORDER BY ${sortMap[sort] || sortMap.priority}`;\n  sql += ` LIMIT ? OFFSET ?`;\n  params.push(limit, offset);\n  \n  return DB_STATE.db.exec(sql, params);\n}\n\nfunction searchIssues(term) {\n  // FTS5 search with ranking\n  return DB_STATE.db.exec(`\n    SELECT id, title, snippet(issues_fts, 2, '\u003cmark\u003e', '\u003c/mark\u003e', '...', 32) as snippet,\n           bm25(issues_fts) as rank\n    FROM issues_fts\n    WHERE issues_fts MATCH ?\n    ORDER BY rank\n    LIMIT 50\n  `, [term + '*']);\n}\n\nfunction getIssueDependencies(id) {\n  const blocks = DB_STATE.db.exec(`\n    SELECT i.* FROM issues i\n    JOIN dependencies d ON i.id = d.depends_on_id\n    WHERE d.issue_id = ? AND d.type = 'blocks'\n  `, [id]);\n  \n  const blockedBy = DB_STATE.db.exec(`\n    SELECT i.* FROM issues i\n    JOIN dependencies d ON i.id = d.issue_id\n    WHERE d.depends_on_id = ? AND d.type = 'blocks'\n  `, [id]);\n  \n  return { blocks, blockedBy };\n}\n```\n\n### Chunk Loading\n```javascript\nasync function loadChunks(config) {\n  const chunks = [];\n  for (let i = 0; i \u003c config.chunk_count; i++) {\n    const chunkPath = `./chunks/${String(i).padStart(5, '0')}.bin`;\n    const buf = await fetch(chunkPath).then(r =\u003e r.arrayBuffer());\n    chunks.push(new Uint8Array(buf));\n  }\n  // Concatenate chunks\n  const total = chunks.reduce((sum, c) =\u003e sum + c.length, 0);\n  const combined = new Uint8Array(total);\n  let offset = 0;\n  for (const chunk of chunks) {\n    combined.set(chunk, offset);\n    offset += chunk.length;\n  }\n  return combined;\n}\n```\n\n## Security (from mcp_agent_mail)\n\n### Content Security Policy\n```html\n\u003cmeta http-equiv=\"Content-Security-Policy\" content=\"\n  default-src 'self';\n  script-src 'self' 'unsafe-eval' https://cdn.tailwindcss.com;\n  style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;\n  font-src 'self' https://fonts.gstatic.com;\n  img-src 'self' data:;\n  connect-src 'self';\n  worker-src 'self' blob:;\n\"\u003e\n```\n\n### Trusted Types for Markdown\n```javascript\nconst trustedPolicy = trustedTypes.createPolicy('beadsViewer', {\n  createHTML: (dirty) =\u003e DOMPurify.sanitize(dirty)\n});\n\nfunction renderDescription(md) {\n  const html = marked.parse(md);\n  return trustedPolicy.createHTML(html);\n}\n```\n\n### COOP/COEP for OPFS\nInclude `coi-serviceworker.js` for GitHub Pages (which can't set headers):\n```javascript\n// In index.html\nif (!crossOriginIsolated) {\n  const sw = navigator.serviceWorker;\n  if (sw) {\n    sw.register('./coi-serviceworker.js');\n    // Reload after registration to apply isolation\n  }\n}\n```\n\n## Alpine.js Store\n```javascript\nAlpine.store('app', {\n  // State\n  db: null,\n  loading: true,\n  error: null,\n  view: 'dashboard',\n  \n  // Data (lazy loaded via SQL)\n  get issues() { return queryIssues(this.filters, this.sort); },\n  get stats() { return queryStats(); },\n  get triage() { return loadJSON('triage'); },\n  \n  // Filters\n  filters: { status: [], type: [], labels: [], search: '' },\n  sort: 'priority',\n  \n  // Actions\n  async init() {\n    try {\n      await loadDatabase();\n      this.db = DB_STATE.db;\n      this.loading = false;\n    } catch (e) {\n      this.error = e.message;\n    }\n  },\n  \n  search(term) {\n    return searchIssues(term);\n  }\n});\n```\n\n## Acceptance Criteria\n- [ ] sql.js loads and initializes database\n- [ ] OPFS caching works (warm loads \u003c100ms)\n- [ ] Chunk loading works for large DBs\n- [ ] FTS5 search returns ranked results\n- [ ] All queries return correct data\n- [ ] COOP/COEP handled for GitHub Pages\n- [ ] Markdown rendered safely with DOMPurify\n- [ ] CSP doesn't block functionality\n- [ ] Works offline after initial load\n- [ ] Database source shown in diagnostics\n\n## Performance Targets\n- Cold load (network): \u003c2s for 500 issues\n- Warm load (OPFS): \u003c200ms\n- Search query: \u003c50ms\n- Filter change: \u003c100ms","status":"closed","priority":2,"type":"task","labels":["phase-1","static-pages"],"created_at":"2025-12-15 23:05","updated_at":"2025-12-16 02:12","closed_at":"2025-12-16 02:12","blocks":["bv-406","bv-5yb","bv-73f","bv-dyg","bv-gdlt","bv-uun","bv-vt0","bv-y5i"],"pagerank":0.010062580063134458,"betweenness":0,"eigenvector":0,"hub":0,"authority":0.0004151861241768423,"critical_path":7,"in_degree":8,"out_degree":0,"core_number":3,"slack":8,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-jl4n","title":"Unit tests: Issue.Clone() deep copy verification","description":"Add unit tests for Issue.Clone() method to verify deep copy behavior.\n\n**Test cases:**\n1. Clone with all fields populated\n2. Clone with nil pointers (EstimatedMinutes, ClosedAt, ExternalRef, etc.)\n3. Verify modifying clone doesn't affect original\n4. Verify slice fields (Labels, Dependencies, Comments) are deep copied\n5. Edge cases: empty slices vs nil slices\n\n**Coverage target:** 100% for Clone() method","status":"closed","priority":2,"type":"task","labels":["model","testing"],"created_at":"2025-12-16 13:01","updated_at":"2025-12-16 13:04","closed_at":"2025-12-16 13:04","blocked_by":["bv-kvtj"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":1.2580640962046904e-15,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":13,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-jl6j","title":"Port Cycle Break suggestions to Rust WASM","description":"# Port Cycle Break Suggestions\n\n## Context\nCycle Break analyzes which edges to remove to break cycles with minimal collateral damage.\n\n## Go Implementation Reference\n```go\n// generateCycleBreakSuggestions in advanced_insights.go\n```\n\n## Rust Implementation (advanced/cycle_break.rs)\n```rust\nuse crate::graph::DiGraph;\nuse crate::algorithms::cycles::tarjan_scc;\n\npub struct CycleBreakItem {\n    pub from: usize,\n    pub to: usize,\n    pub cycles_broken: usize,\n    pub collateral: usize,\n}\n\n/// Suggest edges to remove for breaking cycles.\npub fn cycle_break_suggestions(graph: \u0026DiGraph, limit: usize) -\u003e Vec\u003cCycleBreakItem\u003e {\n    let scc = tarjan_scc(graph);\n    if !scc.has_cycles {\n        return Vec::new();\n    }\n    \n    let mut suggestions = Vec::new();\n    \n    // For each SCC with \u003e1 node, find edges within it\n    for component in \u0026scc.components {\n        if component.len() \u003c= 1 { continue; }\n        \n        let comp_set: std::collections::HashSet\u003cusize\u003e = component.iter().copied().collect();\n        \n        for \u0026from in component {\n            for \u0026to in graph.successors(from) {\n                if comp_set.contains(\u0026to) {\n                    // This edge is within a cycle\n                    let collateral = graph.successors(from).len() + graph.predecessors(to).len();\n                    \n                    suggestions.push(CycleBreakItem {\n                        from,\n                        to,\n                        cycles_broken: 1, // Simplified: assume breaks 1 cycle\n                        collateral,\n                    });\n                }\n            }\n        }\n    }\n    \n    // Sort by collateral (ascending) - prefer minimal impact\n    suggestions.sort_by(|a, b| a.collateral.cmp(\u0026b.collateral));\n    suggestions.truncate(limit);\n    suggestions\n}\n```\n\n## Acceptance Criteria\n- [ ] Only suggests edges within cycles\n- [ ] Collateral damage computed\n- [ ] Sorted by minimal impact","notes":"DEPENDS ON PROPER CYCLES: Uses enumerate_cycles() from bv-xg92. Ensure Johnson's algorithm is implemented there, not just SCC detection. Cycle break suggestions need actual cycle edges to identify which edges to remove.","status":"closed","priority":2,"type":"task","labels":["advanced","phase-3","wasm"],"created_at":"2025-12-15 23:36","updated_at":"2025-12-16 00:48","closed_at":"2025-12-16 00:48","blocked_by":["bv-xg92"],"blocks":["bv-y7a0"],"pagerank":0.0018889407873369957,"betweenness":0,"eigenvector":0,"hub":0.000002029146711610972,"authority":0.000010677870334373396,"critical_path":4,"in_degree":1,"out_degree":1,"core_number":2,"slack":8,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-jndd","title":"Integrate force-graph library with static viewer","description":"# Integrate force-graph Library\n\n## Context\nAdd the force-graph library to render dependencies as an interactive graph.\n\n## Requirements\n\n### 1. Add Library\n```html\n\u003c!-- From CDN --\u003e\n\u003cscript src=\"https://unpkg.com/force-graph\"\u003e\u003c/script\u003e\n\n\u003c!-- Or vendor locally --\u003e\n\u003cscript src=\"vendor/force-graph.min.js\"\u003e\u003c/script\u003e\n```\n\n### 2. Initialize Graph Container\n```html\n\u003cdiv id=\"graph-container\" style=\"width: 100%; height: 600px;\"\u003e\u003c/div\u003e\n```\n\n### 3. Load Data and Render\n```javascript\nconst graphData = {\n    nodes: issues.map(i =\u003e ({\n        id: i.id,\n        name: i.title,\n        status: i.status,\n        priority: i.priority,\n        val: calculateNodeSize(i) // PageRank or blocker count\n    })),\n    links: dependencies.map(d =\u003e ({\n        source: d.issue_id,\n        target: d.depends_on_id\n    }))\n};\n\nconst Graph = ForceGraph()\n    (document.getElementById('graph-container'))\n    .graphData(graphData)\n    .nodeId('id')\n    .nodeLabel('name')\n    .nodeColor(node =\u003e statusColors[node.status])\n    .nodeVal('val')\n    .linkDirectionalArrowLength(6)\n    .linkDirectionalArrowRelPos(1)\n    .onNodeClick(handleNodeClick)\n    .onNodeHover(handleNodeHover);\n```\n\n### 4. Node Sizing by Impact\n```javascript\nfunction calculateNodeSize(issue) {\n    // Use WASM-computed metrics if available\n    if (WASM_READY) {\n        const idx = NODE_MAP.get(issue.id);\n        const pr = GRAPH.pagerank(0.85, 100);\n        return 5 + pr[idx] * 50; // Scale to reasonable size\n    }\n    // Fallback: use blocker count from SQLite\n    return 5 + (issue.blocker_count || 0) * 2;\n}\n```\n\n## Acceptance Criteria\n- [ ] force-graph loads without errors\n- [ ] All issues rendered as nodes\n- [ ] Dependencies shown as directed edges\n- [ ] Smooth pan/zoom interaction\n- [ ] Basic node coloring by status\n- [ ] Performance: 500 nodes at 60fps","status":"closed","priority":1,"type":"task","labels":["phase-1","visualization","wasm"],"created_at":"2025-12-15 23:55","updated_at":"2025-12-16 01:32","closed_at":"2025-12-16 01:32","blocks":["bv-1opc","bv-470n","bv-gij1","bv-qpt0","bv-uvxe","bv-wb6h","bv-y4km","bv-z38b"],"pagerank":0.009273206978785144,"betweenness":0,"eigenvector":0,"hub":0,"authority":0.000003985586065331241,"critical_path":3,"in_degree":8,"out_degree":0,"core_number":2,"slack":12,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-jtac","title":"watcher: Debouncer should drop stale timer callbacks","description":"Debouncer currently uses time.AfterFunc + Stop(), which can still allow the previous callback to run if it has already started. This can violate the documented 'only last callback runs' behavior and can fire after Cancel/Trigger races. Make Debouncer generation-based so only the latest trigger executes.","acceptance_criteria":"- Debouncer guarantees at-most-once callback for a burst (ignoring stale timers)\n- Cancel prevents callback even if timer fires concurrently\n- Existing watcher tests remain stable","status":"closed","priority":2,"type":"bug","labels":["concurrency","watcher"],"assignee":"BrownBear","created_at":"2025-12-17 04:27","updated_at":"2025-12-17 04:30","closed_at":"2025-12-17 04:30","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-k0cl","title":"E2E tests: Sprint workflow with detailed logging","description":"Create comprehensive E2E tests for the sprint workflow with detailed logging.\n\n**Test workflow:**\n1. Create sprints.jsonl with test data\n2. Run bv --robot-sprint-list\n3. Validate JSON output format and content\n4. Run bv --robot-sprint-show \u003cid\u003e\n5. Validate single sprint output\n6. Test error cases (non-existent sprint)\n\n**Logging requirements:**\n- Log all test inputs and expected outputs\n- Log actual outputs for comparison\n- Log timing information\n- Log any errors with full context\n\n**Location:** tests/e2e/sprint_test.go","status":"closed","priority":2,"type":"task","labels":["e2e","logging","sprint","testing"],"created_at":"2025-12-16 13:02","updated_at":"2025-12-16 13:37","closed_at":"2025-12-16 13:37","blocked_by":["bv-lkz5"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":7.890898495503672e-22,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-k79d","title":"Implement WASM memory management and object lifecycle","description":"# WASM Memory Management\n\n## Context\nRust WASM objects allocated via wasm-bindgen are NOT automatically garbage collected by JavaScript. Each DiGraph, subgraph, or result object must be explicitly freed to prevent memory leaks.\n\n## Requirements\n\n### 1. Implement .free() on all exported types\nwasm-bindgen automatically generates .free() methods, but we need to:\n- Document their usage\n- Ensure all exported types support it\n- Add defensive checks\n\n### 2. JavaScript Patterns for Memory Safety\n```javascript\n// BAD: Memory leak\nfunction analyze() {\n    const subgraph = GRAPH.subgraph(indices);\n    return subgraph.pagerank(0.85, 100);\n    // subgraph never freed!\n}\n\n// GOOD: Explicit cleanup\nfunction analyze() {\n    const subgraph = GRAPH.subgraph(indices);\n    try {\n        return subgraph.pagerank(0.85, 100);\n    } finally {\n        subgraph.free();\n    }\n}\n\n// BETTER: Helper wrapper\nfunction withSubgraph(indices, fn) {\n    const subgraph = GRAPH.subgraph(indices);\n    try {\n        return fn(subgraph);\n    } finally {\n        subgraph.free();\n    }\n}\n```\n\n### 3. Alpine.js Store Cleanup\n```javascript\nAlpine.store('graph', {\n    instance: null,\n    destroy() {\n        if (this.instance) {\n            this.instance.free();\n            this.instance = null;\n        }\n    }\n});\n\n// Call on page unload\nwindow.addEventListener('beforeunload', () =\u003e {\n    Alpine.store('graph').destroy();\n});\n```\n\n## Acceptance Criteria\n- [ ] All DiGraph methods documented re: memory\n- [ ] Helper functions for safe subgraph usage\n- [ ] Cleanup on page unload\n- [ ] No memory leaks in 10-minute usage session","status":"closed","priority":2,"type":"task","labels":["integration","phase-4","wasm"],"created_at":"2025-12-15 23:52","updated_at":"2025-12-16 11:33","closed_at":"2025-12-16 11:33","blocked_by":["bv-y7a0"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":1.2580640962046904e-15,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":7,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-kdn","title":"Implement gh CLI integration for GitHub Pages deployment","description":"# Implement gh CLI Integration for GitHub Pages Deployment\n\n## Context\nIntegration with GitHub's `gh` CLI tool to create repositories, push content, and enable GitHub Pages - matching the approach used in mcp_agent_mail.\n\n## Requirements\n\n### Detection and Installation\n```go\n// pkg/export/github.go\n\nfunc CheckGHInstalled() (bool, error) {\n    _, err := exec.LookPath(\"gh\")\n    return err == nil, nil\n}\n\nfunc CheckGHAuthenticated() (bool, string, error) {\n    cmd := exec.Command(\"gh\", \"auth\", \"status\")\n    output, err := cmd.CombinedOutput()\n    // Parse output for username\n    return err == nil, parseUsername(output), nil\n}\n\nfunc InstallGH() error {\n    // Detect package manager\n    switch detectPackageManager() {\n    case \"brew\":\n        return exec.Command(\"brew\", \"install\", \"gh\").Run()\n    case \"apt\":\n        // Show manual instructions\n        return fmt.Errorf(\"Run: curl -fsSL https://cli.github.com/packages/...\")\n    default:\n        return fmt.Errorf(\"Install gh CLI from: https://cli.github.com/\")\n    }\n}\n\nfunc AuthenticateGH() error {\n    cmd := exec.Command(\"gh\", \"auth\", \"login\")\n    cmd.Stdin = os.Stdin\n    cmd.Stdout = os.Stdout\n    cmd.Stderr = os.Stderr\n    return cmd.Run()\n}\n```\n\n### Repository Operations\n```go\nfunc CreateRepository(name string, private bool, description string) (string, error) {\n    visibility := \"--public\"\n    if private {\n        visibility = \"--private\"\n    }\n    \n    cmd := exec.Command(\"gh\", \"repo\", \"create\", name,\n        visibility,\n        \"--description\", description,\n        \"--clone=false\",\n    )\n    \n    if err := cmd.Run(); err != nil {\n        return \"\", fmt.Errorf(\"failed to create repository: %w\", err)\n    }\n    \n    // Get full repo name (owner/repo)\n    return getRepoFullName(name)\n}\n\nfunc getRepoFullName(name string) (string, error) {\n    cmd := exec.Command(\"gh\", \"repo\", \"view\", name,\n        \"--json\", \"nameWithOwner\",\n        \"-q\", \".nameWithOwner\",\n    )\n    output, err := cmd.Output()\n    return strings.TrimSpace(string(output)), err\n}\n\nfunc RepoExists(name string) bool {\n    cmd := exec.Command(\"gh\", \"repo\", \"view\", name)\n    return cmd.Run() == nil\n}\n```\n\n### Git Operations\n```go\nfunc InitAndPush(bundlePath string, repoFullName string) error {\n    // Initialize git repo\n    cmds := [][]string{\n        {\"git\", \"init\"},\n        {\"git\", \"add\", \".\"},\n        {\"git\", \"commit\", \"-m\", \"Initial static site export\"},\n        {\"git\", \"branch\", \"-M\", \"main\"},\n        {\"git\", \"remote\", \"add\", \"origin\", \n            fmt.Sprintf(\"https://github.com/%s.git\", repoFullName)},\n        {\"git\", \"push\", \"-u\", \"origin\", \"main\", \"--force\"},\n    }\n    \n    for _, args := range cmds {\n        cmd := exec.Command(args[0], args[1:]...)\n        cmd.Dir = bundlePath\n        if output, err := cmd.CombinedOutput(); err != nil {\n            return fmt.Errorf(\"%s failed: %s\", args[0], output)\n        }\n    }\n    \n    return nil\n}\n```\n\n### Enable GitHub Pages\n```go\nfunc EnableGitHubPages(repoFullName string) (string, error) {\n    // Enable Pages via API\n    cmd := exec.Command(\"gh\", \"api\",\n        fmt.Sprintf(\"repos/%s/pages\", repoFullName),\n        \"-X\", \"POST\",\n        \"-f\", \"source[branch]=main\",\n        \"-f\", \"source[path]=/\",\n    )\n    \n    if output, err := cmd.CombinedOutput(); err != nil {\n        // Check if already enabled\n        if strings.Contains(string(output), \"already exists\") {\n            // Pages already enabled, get URL\n            return getGitHubPagesURL(repoFullName)\n        }\n        return \"\", fmt.Errorf(\"failed to enable Pages: %s\", output)\n    }\n    \n    // Wait for Pages to be configured\n    time.Sleep(2 * time.Second)\n    \n    return getGitHubPagesURL(repoFullName)\n}\n\nfunc getGitHubPagesURL(repoFullName string) (string, error) {\n    cmd := exec.Command(\"gh\", \"api\",\n        fmt.Sprintf(\"repos/%s/pages\", repoFullName),\n        \"-q\", \".html_url\",\n    )\n    output, err := cmd.Output()\n    if err != nil {\n        // Construct URL manually as fallback\n        parts := strings.Split(repoFullName, \"/\")\n        return fmt.Sprintf(\"https://%s.github.io/%s/\", parts[0], parts[1]), nil\n    }\n    return strings.TrimSpace(string(output)), nil\n}\n```\n\n### High-Level Deploy Function\n```go\ntype GitHubDeployConfig struct {\n    RepoName        string\n    Private         bool\n    Description     string\n    BundlePath      string\n}\n\nfunc DeployToGitHubPages(config GitHubDeployConfig) (string, error) {\n    // 1. Check/install gh CLI\n    if installed, _ := CheckGHInstalled(); !installed {\n        if err := InstallGH(); err != nil {\n            return \"\", err\n        }\n    }\n    \n    // 2. Check/perform authentication\n    if authed, _, _ := CheckGHAuthenticated(); !authed {\n        if err := AuthenticateGH(); err != nil {\n            return \"\", err\n        }\n    }\n    \n    // 3. Create repository (or use existing)\n    repoFullName, err := CreateRepository(config.RepoName, config.Private, config.Description)\n    if err != nil {\n        if RepoExists(config.RepoName) {\n            repoFullName, _ = getRepoFullName(config.RepoName)\n        } else {\n            return \"\", err\n        }\n    }\n    \n    // 4. Initialize git and push\n    if err := InitAndPush(config.BundlePath, repoFullName); err != nil {\n        return \"\", err\n    }\n    \n    // 5. Enable GitHub Pages\n    pagesURL, err := EnableGitHubPages(repoFullName)\n    if err != nil {\n        return \"\", err\n    }\n    \n    return pagesURL, nil\n}\n```\n\n## Acceptance Criteria\n- [ ] Detects gh CLI installation\n- [ ] Offers to install via brew (macOS)\n- [ ] Shows manual instructions for Linux\n- [ ] Checks and triggers authentication\n- [ ] Creates public/private repositories\n- [ ] Handles existing repository gracefully\n- [ ] Pushes bundle contents to repo\n- [ ] Enables GitHub Pages via API\n- [ ] Returns correct Pages URL\n- [ ] Handles network errors gracefully\n\n## Testing\n- Mock exec.Command for unit tests\n- Integration test with real gh CLI (optional, manual)\n- Test error paths (no network, auth failed, etc.)","notes":"REVISION (2025-12-16): Added safety checks and permission requirements.\n\n**SAFETY IMPROVEMENTS:**\n\n1. **Never auto-install without permission:**\n```go\nfunc InstallGH() error {\n    fmt.Println(\"gh CLI is not installed.\")\n    fmt.Println(\"Install options:\")\n    fmt.Println(\"  macOS:  brew install gh\")\n    fmt.Println(\"  Linux:  https://cli.github.com/\")\n    fmt.Println(\"\")\n    \n    if !confirmPrompt(\"Attempt automatic install via Homebrew?\") {\n        return fmt.Errorf(\"gh CLI required - please install manually\")\n    }\n    // Only then attempt install\n    return exec.Command(\"brew\", \"install\", \"gh\").Run()\n}\n```\n\n2. **Check repository before force push:**\n```go\nfunc InitAndPush(bundlePath, repoFullName string) error {\n    // Check if repo has existing content\n    result := exec.Command(\"gh\", \"api\", \n        fmt.Sprintf(\"repos/%s/contents\", repoFullName),\n        \"-q\", \"length\")\n    output, _ := result.Output()\n    \n    if strings.TrimSpace(string(output)) != \"0\" {\n        fmt.Println(\"‚ö†Ô∏è  Repository has existing content!\")\n        fmt.Println(\"Force push will overwrite all existing files.\")\n        if !confirmPrompt(\"Continue anyway?\") {\n            return fmt.Errorf(\"aborted - repository not empty\")\n        }\n    }\n    \n    // Proceed with push\n    ...\n}\n```\n\n3. **Use --force-with-lease instead of --force:**\n```go\n// Safer than --force, fails if remote has unexpected changes\nexec.Command(\"git\", \"push\", \"-u\", \"origin\", \"main\", \"--force-with-lease\")\n```\n\n4. **Verify user identity before push:**\n```go\nfunc verifyGitIdentity() error {\n    name := exec.Command(\"git\", \"config\", \"user.name\")\n    email := exec.Command(\"git\", \"config\", \"user.email\")\n    \n    nameOut, _ := name.Output()\n    emailOut, _ := email.Output()\n    \n    fmt.Printf(\"Git identity: %s \u003c%s\u003e\\n\", \n        strings.TrimSpace(string(nameOut)),\n        strings.TrimSpace(string(emailOut)))\n    \n    return confirmPrompt(\"Is this correct?\")\n}\n```\n\n**UPDATED ACCEPTANCE CRITERIA:**\n- [ ] Never installs software without explicit permission\n- [ ] Warns before overwriting non-empty repositories\n- [ ] Uses --force-with-lease instead of --force\n- [ ] Shows git identity and asks for confirmation\n- [ ] All destructive operations require confirmation","status":"closed","priority":2,"type":"task","labels":["phase-3","static-pages"],"created_at":"2025-12-15 23:08","updated_at":"2025-12-16 03:21","closed_at":"2025-12-16 03:21","blocks":["bv-10g","bv-ake","bv-y5i"],"pagerank":0.0028722415833529152,"betweenness":0,"eigenvector":0,"hub":0,"authority":0.00025940415814694847,"critical_path":5,"in_degree":3,"out_degree":0,"core_number":3,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-kdug","title":"Implement Reachability queries (from/to) in Rust WASM","description":"# Implement Reachability Queries\n\n## Context\nReachability queries find all nodes reachable from/to a given node. Essential for impact analysis and dependency exploration.\n\n## Rust Implementation (reachability.rs)\n```rust\nuse crate::graph::DiGraph;\nuse std::collections::VecDeque;\n\n/// Find all nodes reachable from source (BFS forward).\npub fn reachable_from(graph: \u0026DiGraph, source: usize) -\u003e Vec\u003cusize\u003e {\n    let n = graph.node_count();\n    if source \u003e= n {\n        return Vec::new();\n    }\n    \n    let mut visited = vec![false; n];\n    let mut queue = VecDeque::new();\n    let mut result = Vec::new();\n    \n    queue.push_back(source);\n    visited[source] = true;\n    \n    while let Some(v) = queue.pop_front() {\n        result.push(v);\n        for \u0026w in graph.successors(v) {\n            if !visited[w] {\n                visited[w] = true;\n                queue.push_back(w);\n            }\n        }\n    }\n    \n    result\n}\n\n/// Find all nodes that can reach target (BFS backward).\npub fn reachable_to(graph: \u0026DiGraph, target: usize) -\u003e Vec\u003cusize\u003e {\n    let n = graph.node_count();\n    if target \u003e= n {\n        return Vec::new();\n    }\n    \n    let mut visited = vec![false; n];\n    let mut queue = VecDeque::new();\n    let mut result = Vec::new();\n    \n    queue.push_back(target);\n    visited[target] = true;\n    \n    while let Some(v) = queue.pop_front() {\n        result.push(v);\n        for \u0026u in graph.predecessors(v) {\n            if !visited[u] {\n                visited[u] = true;\n                queue.push_back(u);\n            }\n        }\n    }\n    \n    result\n}\n\n/// Get direct blockers (predecessors) of a node.\npub fn blockers(graph: \u0026DiGraph, node: usize) -\u003e Vec\u003cusize\u003e {\n    graph.predecessors(node).to_vec()\n}\n\n/// Get direct dependents (successors) of a node.\npub fn dependents(graph: \u0026DiGraph, node: usize) -\u003e Vec\u003cusize\u003e {\n    graph.successors(node).to_vec()\n}\n\n/// Check if all predecessors of node are in closed_set.\npub fn is_actionable(graph: \u0026DiGraph, node: usize, closed_set: \u0026[bool]) -\u003e bool {\n    graph.predecessors(node).iter().all(|\u0026p| {\n        closed_set.get(p).copied().unwrap_or(false)\n    })\n}\n\n/// Get all actionable nodes (no open blockers).\npub fn actionable_nodes(graph: \u0026DiGraph, closed_set: \u0026[bool]) -\u003e Vec\u003cusize\u003e {\n    (0..graph.node_count())\n        .filter(|\u0026i| !closed_set.get(i).copied().unwrap_or(false))\n        .filter(|\u0026i| is_actionable(graph, i, closed_set))\n        .collect()\n}\n```\n\n### WASM Bindings\n```rust\n#[wasm_bindgen]\nimpl DiGraph {\n    pub fn reachable_from(\u0026self, source: usize) -\u003e Vec\u003cusize\u003e {\n        reachability::reachable_from(self, source)\n    }\n    \n    pub fn reachable_to(\u0026self, target: usize) -\u003e Vec\u003cusize\u003e {\n        reachability::reachable_to(self, target)\n    }\n    \n    pub fn blockers(\u0026self, node: usize) -\u003e Vec\u003cusize\u003e {\n        reachability::blockers(self, node)\n    }\n    \n    pub fn dependents(\u0026self, node: usize) -\u003e Vec\u003cusize\u003e {\n        reachability::dependents(self, node)\n    }\n    \n    pub fn actionable_nodes(\u0026self, closed_set: \u0026[u8]) -\u003e Vec\u003cusize\u003e {\n        let closed: Vec\u003cbool\u003e = closed_set.iter().map(|\u0026b| b != 0).collect();\n        reachability::actionable_nodes(self, \u0026closed)\n    }\n}\n```\n\n## Acceptance Criteria\n- [ ] reachable_from returns all forward-reachable nodes\n- [ ] reachable_to returns all backward-reachable nodes\n- [ ] is_actionable correctly checks blocker status\n- [ ] actionable_nodes matches Go GetActionableIssues","notes":"EXPANDED SCOPE: This task now includes actionable_nodes() and open_blockers() from merged task bv-8f0b. \n\nAdditional functions to implement:\n- actionable_nodes(closed_set: \u0026[bool]) -\u003e Vec\u003cusize\u003e  // nodes with all predecessors closed\n- open_blockers(node, closed_set: \u0026[bool]) -\u003e Vec\u003cusize\u003e  // predecessors not in closed set\n\nThe existing blockers() and dependents() already cover the basic cases.","status":"closed","priority":2,"type":"task","labels":["advanced","phase-3","wasm"],"created_at":"2025-12-15 23:36","updated_at":"2025-12-16 00:42","closed_at":"2025-12-16 00:42","blocked_by":["bv-bxoe"],"blocks":["bv-njah"],"pagerank":0.0026443902102538663,"betweenness":3,"eigenvector":0,"hub":0.000008837350028490512,"authority":8.522128708928695e-7,"critical_path":6,"in_degree":1,"out_degree":1,"core_number":2,"slack":7,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-kjna","title":"Unit test: pkg/search/documents.go - Document representation","description":"Create unit tests for pkg/search/documents.go\n\n## File Overview\ndocuments.go defines how issues are converted to searchable documents.\n\n## Test Cases to Implement\n1. **Document Creation**\n   - Issue to Document conversion\n   - Content field composition\n   - Metadata preservation\n\n2. **Content Composition**\n   - Title included\n   - Description included\n   - Labels included\n   - Assignee included\n   - ID searchable\n\n3. **Content Hash**\n   - Hash stability (same input = same hash)\n   - Hash changes on content change\n   - Hash independent of ordering\n\n4. **Edge Cases**\n   - Empty description\n   - No labels\n   - Unicode content\n   - Very long content\n\n## Implementation Notes\n- Create Issue fixtures\n- Verify hash determinism\n- Test content field boundaries","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-16 20:07","updated_at":"2025-12-16 23:35","closed_at":"2025-12-16 23:35","blocks":["bv-ubra"],"pagerank":0.0019171540027831243,"betweenness":0,"eigenvector":0,"hub":0,"authority":8.0286461624274e-14,"critical_path":4,"in_degree":1,"out_degree":0,"core_number":1,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-kozq","title":"E2E: Race condition and concurrent access tests","description":"Test thread safety and concurrent access patterns.\n\n## Scenarios to Test\n1. **File Watcher Concurrency**\n   - Multiple file changes rapidly\n   - File change during analysis\n   - Watcher restart scenarios\n\n2. **Cache Concurrency**\n   - Concurrent cache reads\n   - Cache write during read\n   - Cache invalidation race\n\n3. **Analysis Concurrency**\n   - Phase 2 access during computation\n   - Multiple analyzers on same data\n   - Timeout during concurrent access\n\n4. **Git Operations**\n   - Git operations during analysis\n   - Concurrent revision loading\n   - Cache invalidation on git change\n\n## Test Implementation\n- Use go test -race flag\n- Create concurrent access patterns\n- Stress test with high concurrency\n- Verify no data races\n\n## Success Criteria\n- All tests pass with -race\n- No deadlocks detected\n- Performance acceptable under load\n- Data integrity maintained","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-16 20:08","updated_at":"2025-12-17 00:34","closed_at":"2025-12-17 00:34","blocks":["bv-syeo"],"pagerank":0.0017054007352105605,"betweenness":0,"eigenvector":0,"hub":0,"authority":3.263220574971611e-11,"critical_path":3,"in_degree":1,"out_degree":0,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-ktru","title":"Port Articulation Points (Tarjan cut vertices) to Rust WASM","description":"# Port Articulation Points to Rust WASM\n\n## Context\nArticulation points (cut vertices) are nodes whose removal disconnects the graph. In issue tracking, these are critical coordination points.\n\n## Go Implementation Reference\n```go\n// findArticulationPoints in graph.go\n// Tarjan's algorithm on undirected view\n```\n\n## Rust Implementation (articulation.rs)\n```rust\nuse crate::graph::DiGraph;\n\n/// Find articulation points using Tarjan's algorithm.\n/// Works on undirected view of the graph.\npub fn articulation_points(graph: \u0026DiGraph) -\u003e Vec\u003cusize\u003e {\n    let n = graph.node_count();\n    if n == 0 {\n        return Vec::new();\n    }\n    \n    // Build undirected adjacency\n    let neighbors = build_undirected(graph);\n    \n    let mut disc = vec![0usize; n];\n    let mut low = vec![0usize; n];\n    let mut parent = vec![usize::MAX; n];\n    let mut ap = vec![false; n];\n    let mut visited = vec![false; n];\n    let mut time = 0usize;\n    \n    fn dfs(\n        v: usize,\n        neighbors: \u0026[Vec\u003cusize\u003e],\n        disc: \u0026mut [usize],\n        low: \u0026mut [usize],\n        parent: \u0026mut [usize],\n        ap: \u0026mut [bool],\n        visited: \u0026mut [bool],\n        time: \u0026mut usize,\n    ) {\n        visited[v] = true;\n        *time += 1;\n        disc[v] = *time;\n        low[v] = *time;\n        let mut children = 0;\n        \n        for \u0026u in \u0026neighbors[v] {\n            if !visited[u] {\n                children += 1;\n                parent[u] = v;\n                dfs(u, neighbors, disc, low, parent, ap, visited, time);\n                low[v] = low[v].min(low[u]);\n                \n                // v is root with \u003e1 child, or non-root with low[u] \u003e= disc[v]\n                if parent[v] == usize::MAX \u0026\u0026 children \u003e 1 {\n                    ap[v] = true;\n                }\n                if parent[v] != usize::MAX \u0026\u0026 low[u] \u003e= disc[v] {\n                    ap[v] = true;\n                }\n            } else if u != parent[v] {\n                low[v] = low[v].min(disc[u]);\n            }\n        }\n    }\n    \n    for v in 0..n {\n        if !visited[v] {\n            dfs(v, \u0026neighbors, \u0026mut disc, \u0026mut low, \u0026mut parent, \u0026mut ap, \u0026mut visited, \u0026mut time);\n        }\n    }\n    \n    ap.iter().enumerate()\n        .filter(|(_, \u0026is_ap)| is_ap)\n        .map(|(i, _)| i)\n        .collect()\n}\n\nfn build_undirected(graph: \u0026DiGraph) -\u003e Vec\u003cVec\u003cusize\u003e\u003e {\n    let n = graph.node_count();\n    let mut neighbors: Vec\u003cVec\u003cusize\u003e\u003e = vec![Vec::new(); n];\n    \n    for u in 0..n {\n        for \u0026v in graph.successors(u) {\n            if !neighbors[u].contains(\u0026v) { neighbors[u].push(v); }\n            if !neighbors[v].contains(\u0026u) { neighbors[v].push(u); }\n        }\n    }\n    \n    neighbors\n}\n```\n\n## Acceptance Criteria\n- [ ] Correctly identifies cut vertices\n- [ ] Handles disconnected graphs\n- [ ] Results match Go implementation","status":"closed","priority":2,"type":"task","labels":["algorithm","phase-2","wasm"],"created_at":"2025-12-15 23:35","updated_at":"2025-12-16 00:34","closed_at":"2025-12-16 00:34","blocked_by":["bv-bxoe"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.000008837350028490512,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-kvtj","title":"Test Coverage Completeness Phase 2","description":"Comprehensive unit and integration tests for all recent features without mocks. Target: 80%+ coverage across all packages.\n\n## Coverage Gaps Identified:\n- **pkg/model (35.9%)**: Sprint, Forecast, BurndownPoint types, Issue.Clone()\n- **cmd/bv (17.2%)**: CLI flag handling, sprint commands\n- **pkg/updater (26.4%)**: Auto-update functionality\n- **pkg/export (57.1%)**: Export pipeline gaps\n- **pkg/analysis/eta.go**: New ETA estimation logic\n\n## Goals:\n1. Unit tests for all new Sprint/Forecast types without mocks\n2. Integration tests for CLI sprint commands\n3. Full coverage for ETA estimation algorithm\n4. E2E tests with detailed logging for sprint workflow","status":"closed","priority":1,"type":"epic","labels":["quality","sprint","testing"],"created_at":"2025-12-16 13:00","updated_at":"2025-12-16 14:26","closed_at":"2025-12-16 14:26","blocks":["bv-jl4n","bv-nnsc","bv-ta9l"],"pagerank":0.007214994345813744,"betweenness":0,"eigenvector":0,"hub":0,"authority":7.629546663534489e-15,"critical_path":4,"in_degree":3,"out_degree":0,"core_number":1,"slack":11,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-lgal","title":"Fix UTF-8 truncation bugs in string helper functions","status":"closed","priority":2,"type":"bug","labels":null,"created_at":"2025-12-16 20:02","updated_at":"2025-12-16 20:02","closed_at":"2025-12-16 20:02","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-lkk","title":"AI-Aware Kanban Autoprioritizer","description":"Use graph metrics (PageRank, betweenness, freshness, blocker count) to suggest priority adjustments and surface high-impact items.\n\n## Background \u0026 Motivation\nThe analysis package computes rich metrics but they're only visible in the insights panel. Users and agents want actionable recommendations: 'These 5 items should be prioritized because they unblock the most work.'\n\n## Value Proposition\n- For Humans: 'Smart suggestions' that explain why items should be reprioritized\n- For AI Agents: --robot-priority provides a ranked work queue with reasoning\n\n## Technical Approach\n1. Create priority scoring function combining multiple metrics\n2. Generate recommendations comparing current vs suggested priority\n3. CLI: --robot-priority outputs priority-ranked JSON with explanations\n4. TUI: 'Suggested' badge/indicator on items\n\n## Scoring Function\nimpact_score = (\n    0.3 * normalized_pagerank +\n    0.3 * normalized_betweenness +\n    0.2 * blocker_count / max_blocker_count +\n    0.1 * freshness_penalty +\n    0.1 * explicit_priority_boost\n)","status":"closed","priority":1,"type":"epic","labels":["ai-agent","analysis","prioritization"],"created_at":"2025-11-26 23:36","updated_at":"2025-11-27 01:03","closed_at":"2025-11-27 01:03","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-lkk.1","title":"Implement priority scoring function","description":"Create composite scoring combining PageRank (30%), Betweenness (30%), Blocker count (20%), Staleness (10%), Explicit priority (10%).\n\n## Algorithm\nfunc (a *Analyzer) ComputeImpactScore(issue *model.Issue) ImpactScore:\n  - Normalize all metrics to 0-1 range\n  - Apply weights: 0.3*pagerank + 0.3*betweenness + 0.2*blockerRatio + 0.1*staleness + 0.1*priorityBoost\n  - Return: IssueID, ImpactScore, ScoreBreakdown map\n\n## Staleness Penalty\n- Days since update, normalized: min(daysSinceUpdate / 30, 1.0)\n- Older items get slight penalty to surface them\n\n## Priority Boost\n- P0=1.0, P1=0.75, P2=0.5, P3=0.25, P4=0.0 (higher priority = higher boost)\n\n## File Changes\n- pkg/analysis/priority.go: New scoring logic\n- pkg/analysis/priority_test.go: Tests with known values","status":"closed","priority":1,"type":"task","labels":["analysis","core-logic"],"created_at":"2025-11-26 23:39","updated_at":"2025-11-27 00:26","closed_at":"2025-11-27 00:26","blocks":["bv-lkk.2"],"pagerank":0.0048649952993613495,"betweenness":0,"eigenvector":0,"hub":0,"authority":4.7854460253878835e-21,"critical_path":3,"in_degree":1,"out_degree":0,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-lkk.2","title":"Generate priority recommendations with explanations","description":"Compare impact scores to current priorities and generate actionable recommendations.\n\n## Output Structure\ntype PriorityRecommendation struct {\n    IssueID           string\n    CurrentPriority   int\n    SuggestedPriority int\n    ImpactScore       float64\n    Confidence        float64  // 0-1, higher when score difference is large\n    Reasoning         []string // Human-readable explanations\n}\n\n## Reasoning Templates\n- 'Blocks N high-priority items' (when UnblocksCount \u003e 2)\n- 'Critical path bottleneck' (when Betweenness \u003e 0.5)\n- 'High centrality in graph' (when PageRank \u003e 0.3)\n- 'Stale for N days' (when staleness penalty applied)\n\n## Confidence Calculation\n- Large score vs priority mismatch = high confidence\n- Multiple reasoning factors = higher confidence\n- Single weak signal = low confidence\n\n## File Changes\n- pkg/analysis/priority.go: Add recommendation generation\n- pkg/analysis/priority_test.go: Test recommendations","status":"closed","priority":1,"type":"task","labels":["analysis","recommendations"],"created_at":"2025-11-26 23:39","updated_at":"2025-11-27 00:31","closed_at":"2025-11-27 00:31","blocked_by":["bv-lkk.1"],"blocks":["bv-lkk.3","bv-lkk.4"],"pagerank":0.00398649154786206,"betweenness":2,"eigenvector":0,"hub":7.890898495503672e-22,"authority":3.920237383997754e-17,"critical_path":2,"in_degree":2,"out_degree":1,"core_number":1,"slack":12,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-lkk.3","title":"Add --robot-priority CLI flag","description":"Output priority recommendations as JSON for AI agents and scripts.\n\n## Flag Definition\nrobotPriority := flag.Bool('robot-priority', false, 'Output priority recommendations as JSON')\n\n## Output Format\n{\n  'recommendations': [{\n    'id': 'issue-123',\n    'current_priority': 2,\n    'suggested_priority': 0,\n    'impact_score': 0.85,\n    'confidence': 0.9,\n    'reasoning': ['Blocks 5 high-priority items', 'Critical path bottleneck']\n  }],\n  'summary': {\n    'total_issues': 50,\n    'recommendations': 8,\n    'high_confidence': 3\n  }\n}\n\n## Sorting\n- Sort by confidence DESC, then impact_score DESC\n- Top issues are most confident recommendations\n\n## File Changes\n- cmd/bv/main.go: Add flag and output logic","status":"closed","priority":1,"type":"task","labels":["ai-agent","cli"],"created_at":"2025-11-26 23:39","updated_at":"2025-11-27 00:32","closed_at":"2025-11-27 00:32","blocked_by":["bv-lkk.2"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":6.464224047516608e-18,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-lkk.4","title":"Add TUI priority suggestion indicators","description":"Show ‚¨ÜÔ∏è/‚¨áÔ∏è indicators when suggested priority differs from current. 'p' toggles visibility. Detail view shows full analysis.","status":"closed","priority":2,"type":"task","labels":["tui","user-experience"],"created_at":"2025-11-26 23:39","updated_at":"2025-11-27 01:03","closed_at":"2025-11-27 01:03","blocked_by":["bv-lkk.2"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":6.464224047516608e-18,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-lkz5","title":"Integration tests: Sprint CLI commands (robot-sprint-list/show)","description":"Add integration tests for the new --robot-sprint-list and --robot-sprint-show CLI flags.\n\n**Test scenarios:**\n1. --robot-sprint-list with no sprints (empty response)\n2. --robot-sprint-list with multiple sprints (JSON array)\n3. --robot-sprint-show \u003cid\u003e for existing sprint\n4. --robot-sprint-show \u003cid\u003e for non-existent sprint (error)\n5. JSON output format validation (generated_at, sprint_count, sprints)\n\n**Files involved:**\n- cmd/bv/main.go (sprint handler lines 1733-1786)\n- pkg/loader/sprint.go\n\n**Test approach:** Create temp .beads directory with sprints.jsonl, run bv binary, validate JSON output.","status":"closed","priority":2,"type":"task","labels":["cli","integration","sprint","testing"],"created_at":"2025-12-16 13:01","updated_at":"2025-12-16 13:29","closed_at":"2025-12-16 13:29","blocked_by":["bv-nnsc"],"blocks":["bv-k0cl"],"pagerank":0.002731484890410988,"betweenness":2,"eigenvector":0,"hub":7.890898495503672e-22,"authority":4.7854460253878835e-21,"critical_path":2,"in_degree":1,"out_degree":1,"core_number":1,"slack":11,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-looq","title":"Remove unnecessary mutex and use safer locking patterns","description":"UBS flagged several manual Lock/Unlock sites. In workspace loader, the mutex is unnecessary because each goroutine writes a distinct results index. In debouncer, locking can be structured to avoid manual unlock paths.\n\nAcceptance:\n- Remove unnecessary mutex in pkg/workspace/loader.go without introducing races.\n- Refactor debouncer locking to avoid manual unlock early returns.\n- All tests pass.","status":"closed","priority":3,"type":"chore","labels":["cleanup","concurrency"],"assignee":"BrownBear","created_at":"2025-12-17 05:26","updated_at":"2025-12-17 05:27","closed_at":"2025-12-17 05:27","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-m2cg","title":"Infrastructure: Test fixture generator for graph topologies","description":"Create a test fixture generator for various graph topologies.\n\n## Purpose\nMany tests need graph fixtures with specific properties. Create a generator that produces deterministic test data.\n\n## Topologies to Generate\n1. **chain(n)** - Linear A-\u003eB-\u003eC...\n2. **star(n)** - Hub with n spokes\n3. **diamond(n)** - Diamond with n intermediate nodes\n4. **cycle(n)** - Circular dependency\n5. **tree(depth, breadth)** - Tree structure\n6. **random(n, density)** - Random DAG\n7. **complete(n)** - Fully connected\n8. **disconnected(components, size)** - Multiple components\n\n## Generator Features\n- Deterministic (seeded random)\n- Configurable issue properties\n- Configurable edge types\n- Output as []model.Issue\n- Output as beads.jsonl\n- Output as graph fixtures\n\n## Implementation\n- pkg/testutil/generator.go\n- Table of topology functions\n- Golden files for validation\n- Used by all test packages\n\n## Benefits\n- Consistent test data\n- Easy to add new topologies\n- Reproducible tests\n- Documentation via code","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-16 20:10","updated_at":"2025-12-16 21:50","closed_at":"2025-12-16 21:50","blocks":["bv-3bhq","bv-evyl","bv-q923"],"pagerank":0.00198887630353318,"betweenness":0,"eigenvector":0,"hub":0,"authority":2.5071608021544006e-7,"critical_path":4,"in_degree":3,"out_degree":0,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-mvvu","title":"Data Integrity: Merge Artifact Files Loaded Instead of Canonical Data","description":"## Problem Statement\n\nbv can load stale/outdated issue data when merge artifact files (`beads.left.jsonl`, `beads.base.jsonl`) are present in the `.beads/` directory. Users see closed issues as open, wrong priorities, or missing issues entirely.\n\n## User Impact\n\n**Severity: Critical (P0)**\n- Data integrity issue - users see WRONG information\n- Particularly affects users after git merge conflicts\n- Can lead to working on already-completed issues\n- Reported by @bmjjr in GitHub Issue #5, confirmed by @masonjames\n\n## Root Cause Analysis\n\n**Location:** `pkg/loader/loader.go:36-56`\n\n### Problem 1: Merge Artifacts Not Skipped\n\nThe `FindJSONLPath()` function skips files containing:\n- `.backup`\n- `.orig`  \n- `.merge`\n- `deletions.jsonl`\n\nBut it does NOT skip:\n- `beads.left.jsonl` - Git merge artifact (OURS side)\n- `beads.base.jsonl` - Git merge artifact (BASE side)\n\n### Problem 2: Wrong Priority Order\n\n```go\npreferredNames := []string{\"beads.jsonl\", \"beads.base.jsonl\", \"issues.jsonl\"}\n```\n\nThis prioritizes `beads.base.jsonl` (position #2) OVER `issues.jsonl` (position #3).\n\nPer beads upstream (steveyegge/beads), `issues.jsonl` is the canonical file:\n\u003e Stage all tracked JSONL files (issues.jsonl is canonical, beads.jsonl for backward compat)\n\nSo the priority order is wrong AND merge artifacts aren't being filtered.\n\n## Scenario That Triggers Bug\n\n1. User has a beads project with `issues.jsonl` up to date\n2. Git merge conflict occurs involving `.beads/` files\n3. User resolves conflict but leaves `beads.left.jsonl` and `beads.base.jsonl` behind\n4. bv loads `beads.base.jsonl` (old data) instead of `issues.jsonl` (current data)\n5. User sees stale issue states\n\n## Proposed Solution\n\n### Fix 1: Skip merge artifact patterns\n\n```go\n// Skip backups, merge artifacts, and deletion manifests\nif strings.Contains(name, \".backup\") ||\n    strings.Contains(name, \".orig\") ||\n    strings.Contains(name, \".merge\") ||\n    strings.HasPrefix(name, \"beads.left\") ||  // NEW\n    strings.HasPrefix(name, \"beads.base\") ||  // NEW (when issues.jsonl exists)\n    name == \"deletions.jsonl\" {\n    continue\n}\n```\n\n### Fix 2: Correct priority order\n\n```go\n// Priority order per beads upstream:\n// 1. issues.jsonl (canonical)\n// 2. beads.jsonl (backward compatibility)\n// 3. beads.base.jsonl (only if nothing else exists)\npreferredNames := []string{\"issues.jsonl\", \"beads.jsonl\", \"beads.base.jsonl\"}\n```\n\n### Fix 3: Add detection warning\n\nWhen merge artifacts are detected, emit a warning to stderr:\n```\nWarning: Merge artifact files detected in .beads/. Run 'bd clean' to remove them.\nFound: beads.left.jsonl, beads.base.jsonl\nLoading from: issues.jsonl (canonical)\n```\n\n## Test Plan\n\n1. Test: Directory with only issues.jsonl - loads correctly\n2. Test: Directory with issues.jsonl AND beads.left.jsonl - skips artifact, loads issues.jsonl\n3. Test: Directory with beads.jsonl AND issues.jsonl - loads issues.jsonl (new priority)\n4. Test: Warning emitted when artifacts detected\n5. Test: Fallback to beads.base.jsonl when NO other files exist\n\n## Acceptance Criteria\n\n- [ ] beads.left.jsonl always skipped\n- [ ] beads.base.jsonl skipped when canonical file exists\n- [ ] issues.jsonl prioritized over beads.jsonl\n- [ ] Warning emitted for detected merge artifacts\n- [ ] Existing tests updated, new tests added\n- [ ] No regression for projects without merge artifacts\n\n## Workaround (Current)\n\nUsers can run `bd clean` or manually delete merge artifact files.\n\n## References\n\n- GitHub Issue #5: https://github.com/Dicklesworthstone/beads_viewer/issues/5\n- beads pre-commit hook: https://github.com/steveyegge/beads/blob/main/.beads-hooks/pre-commit#L38\n- Related: PR #18 (openInEditor hardcoded path) depends on this fix","status":"closed","priority":0,"type":"bug","labels":["critical","data","gh-issue-5"],"created_at":"2025-12-15 23:51","updated_at":"2025-12-16 00:14","closed_at":"2025-12-16 00:14","blocks":["bv-3ht4","bv-uqoh","bv-zaxb"],"pagerank":0.004325343254502204,"betweenness":0,"eigenvector":0,"hub":0,"authority":1.1559260543343854e-8,"critical_path":3,"in_degree":3,"out_degree":0,"core_number":2,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-mwlh","title":"E2E: Cloudflare Pages deployment testing","description":"Test Cloudflare Pages deployment workflow.\n\n## Cloudflare-Specific Features\n1. **API Integration**\n   - Authentication with API token\n   - Project creation/selection\n   - Deployment triggering\n\n2. **Build Configuration**\n   - Output directory mapping\n   - Environment variables\n   - Build command configuration\n\n3. **Deployment Verification**\n   - Deployment status checking\n   - Preview URL generation\n   - Production URL routing\n\n## Test Scenarios\n- New project creation\n- Update existing project\n- Custom domain setup\n- Branch deploy preview\n\n## Implementation\n- Mock Cloudflare API for unit tests\n- Integration test with real API (optional)\n- Test API error handling\n- Verify deployment artifacts","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-16 20:09","updated_at":"2025-12-17 01:09","closed_at":"2025-12-17 01:09","blocked_by":["bv-focq"],"blocks":["bv-hdu4"],"pagerank":0.0016726975206033255,"betweenness":0,"eigenvector":0,"hub":7.032456132708617e-11,"authority":3.1573158850443083e-10,"critical_path":3,"in_degree":1,"out_degree":1,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-njah","title":"Port What-If simulation (unblock cascade) to Rust WASM","description":"# Port What-If Simulation to Rust WASM\n\n## Context\nWhat-If analysis answers \"If I close issue X, what happens?\" - computing direct unblocks, transitive cascades, and impact metrics.\n\n## Go Implementation Reference\n```go\n// computeWhatIfDelta in priority.go\n// countTransitiveUnblocks recursive traversal\n// TopWhatIfDeltas ranking\n```\n\n## Rust Implementation (whatif.rs)\n```rust\nuse crate::graph::DiGraph;\nuse wasm_bindgen::prelude::*;\nuse serde::Serialize;\n\n#[derive(Serialize)]\npub struct WhatIfResult {\n    /// Issues directly unblocked (immediate dependents with all blockers satisfied)\n    pub direct_unblocks: usize,\n    /// Total issues transitively unblocked (cascade)\n    pub transitive_unblocks: usize,\n    /// IDs of directly unblocked issues\n    pub unblocked_ids: Vec\u003cusize\u003e,\n    /// Parallelization gain (direct_unblocks - 1)\n    pub parallel_gain: i32,\n}\n\n/// Compute what happens if a node is \"closed\" (removed from blocking consideration).\npub fn what_if_close(graph: \u0026DiGraph, node: usize, closed_set: \u0026[bool]) -\u003e WhatIfResult {\n    let n = graph.node_count();\n    \n    // Create new closed set with this node added\n    let mut new_closed = closed_set.to_vec();\n    if node \u003c n {\n        new_closed[node] = true;\n    }\n    \n    // Find issues that become actionable (all blockers closed)\n    let mut direct_unblocks = Vec::new();\n    \n    for v in 0..n {\n        if new_closed[v] { continue; }\n        \n        // Check if v was blocked before but unblocked now\n        let was_blocked = graph.predecessors(v).iter().any(|\u0026p| !closed_set[p]);\n        let now_unblocked = graph.predecessors(v).iter().all(|\u0026p| new_closed[p]);\n        \n        if was_blocked \u0026\u0026 now_unblocked {\n            direct_unblocks.push(v);\n        }\n    }\n    \n    // Count transitive unblocks (cascade effect)\n    let transitive = count_cascade(graph, \u0026direct_unblocks, \u0026new_closed);\n    \n    WhatIfResult {\n        direct_unblocks: direct_unblocks.len(),\n        transitive_unblocks: transitive,\n        unblocked_ids: direct_unblocks,\n        parallel_gain: direct_unblocks.len() as i32 - 1,\n    }\n}\n\nfn count_cascade(graph: \u0026DiGraph, roots: \u0026[usize], closed: \u0026[bool]) -\u003e usize {\n    let n = graph.node_count();\n    let mut visited = vec![false; n];\n    let mut count = 0;\n    let mut queue: Vec\u003cusize\u003e = roots.to_vec();\n    \n    while let Some(v) = queue.pop() {\n        if visited[v] { continue; }\n        visited[v] = true;\n        count += 1;\n        \n        // Add successors that become actionable\n        for \u0026w in graph.successors(v) {\n            if visited[w] || closed[w] { continue; }\n            // Check if all predecessors of w are now \"resolved\"\n            let all_resolved = graph.predecessors(w).iter()\n                .all(|\u0026p| closed[p] || visited[p]);\n            if all_resolved {\n                queue.push(w);\n            }\n        }\n    }\n    \n    count\n}\n\n/// Find top N issues with highest cascade impact.\npub fn top_what_if(graph: \u0026DiGraph, closed_set: \u0026[bool], n: usize) -\u003e Vec\u003c(usize, WhatIfResult)\u003e {\n    let node_count = graph.node_count();\n    let mut results: Vec\u003c(usize, WhatIfResult)\u003e = (0..node_count)\n        .filter(|\u0026i| !closed_set[i])\n        .map(|i| (i, what_if_close(graph, i, closed_set)))\n        .filter(|(_, r)| r.transitive_unblocks \u003e 0)\n        .collect();\n    \n    results.sort_by(|a, b| b.1.transitive_unblocks.cmp(\u0026a.1.transitive_unblocks));\n    results.truncate(n);\n    results\n}\n```\n\n### WASM Binding\n```rust\n#[wasm_bindgen]\nimpl DiGraph {\n    /// What-if analysis: what happens if node is closed?\n    /// closed_set is array of booleans indicating already-closed nodes.\n    pub fn what_if_close(\u0026self, node: usize, closed_set: \u0026[u8]) -\u003e JsValue {\n        let closed: Vec\u003cbool\u003e = closed_set.iter().map(|\u0026b| b != 0).collect();\n        let result = whatif::what_if_close(self, node, \u0026closed);\n        JsValue::from_serde(\u0026result).unwrap_or(JsValue::NULL)\n    }\n    \n    /// Top N issues by cascade impact\n    pub fn top_what_if(\u0026self, closed_set: \u0026[u8], n: usize) -\u003e JsValue {\n        let closed: Vec\u003cbool\u003e = closed_set.iter().map(|\u0026b| b != 0).collect();\n        let results = whatif::top_what_if(self, \u0026closed, n);\n        JsValue::from_serde(\u0026results).unwrap_or(JsValue::NULL)\n    }\n}\n```\n\n## Acceptance Criteria\n- [ ] Direct unblocks computed correctly\n- [ ] Transitive cascade counts match Go\n- [ ] Parallel gain formula correct\n- [ ] top_what_if returns ranked results\n- [ ] Performance: \u003c10ms for 1000 nodes","status":"closed","priority":2,"type":"task","labels":["advanced","phase-3","wasm"],"created_at":"2025-12-15 23:35","updated_at":"2025-12-16 00:49","closed_at":"2025-12-16 00:49","blocked_by":["bv-kdug","bv-bikt","bv-8f0b"],"blocks":["bv-470n","bv-a00v","bv-y7a0"],"pagerank":0.004122043812221375,"betweenness":22,"eigenvector":0,"hub":0.0000024687698299426288,"authority":0.00001230578757481256,"critical_path":5,"in_degree":3,"out_degree":3,"core_number":2,"slack":6,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-nnsc","title":"Unit tests: Sprint, Forecast, BurndownPoint types","description":"Add comprehensive unit tests to pkg/model for the new Sprint/Forecast system types.\n\n**Files to test:**\n- pkg/model/types.go (Sprint section lines 210-259)\n\n**Test cases needed:**\n1. Sprint.Validate() - valid sprint, empty ID, empty name, end before start\n2. Sprint.IsActive() - before start, during, after end, zero dates\n3. Forecast struct - field validation, JSON serialization\n4. BurndownPoint struct - field validation\n\n**No mocks required** - these are pure data types with deterministic behavior.\n\n**Coverage target:** 95%+ for Sprint-related code","status":"closed","priority":1,"type":"task","labels":["model","sprint","testing"],"created_at":"2025-12-16 13:01","updated_at":"2025-12-16 13:08","closed_at":"2025-12-16 13:08","blocked_by":["bv-kvtj"],"blocks":["bv-lkz5"],"pagerank":0.003798240094886169,"betweenness":2,"eigenvector":0,"hub":1.2580640962046904e-15,"authority":4.7854460253878835e-21,"critical_path":3,"in_degree":1,"out_degree":1,"core_number":1,"slack":11,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-otc5","title":"Unit test: dependency_suggest.go - Dependency fix suggestions","description":"Create comprehensive unit tests for pkg/analysis/dependency_suggest.go\n\n## File Overview\ndependency_suggest.go analyzes the dependency graph and suggests:\n- Missing dependencies based on content similarity\n- Redundant/transitive dependencies to remove\n- Incorrect dependency directions\n\n## Test Cases to Implement\n1. **Missing Dependency Detection**\n   - Two issues with similar titles/content, no dep link\n   - Issue A mentions issue B's ID in description\n   - Parent/child relationships without explicit deps\n   - Epic with tasks but no deps defined\n\n2. **Redundant Dependency Detection**\n   - Transitive dependency (A-\u003eB-\u003eC, A-\u003eC is redundant)\n   - Self-loops if not caught elsewhere\n   - Duplicate dependency entries\n\n3. **Direction Suggestions**\n   - Low-priority depending on high-priority (unusual)\n   - Closed issue depending on open issue\n   - Epic depending on task (should be reversed)\n\n4. **Confidence Scoring**\n   - High confidence for explicit ID mentions\n   - Medium confidence for title similarity\n   - Low confidence for weak signals\n   - Verify scores in 0.0-1.0 range\n\n5. **Edge Cases**\n   - Empty graph\n   - Single issue (no suggestions possible)\n   - Fully connected graph\n   - Graph with cycles\n\n## Implementation Notes\n- Create test graphs with known expected suggestions\n- Use golden files for complex scenarios\n- Test with real-world-like issue content","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-16 20:05","updated_at":"2025-12-16 22:00","closed_at":"2025-12-16 22:00","blocks":["bv-0kll","bv-3bhq"],"pagerank":0.001985274869031905,"betweenness":0,"eigenvector":0,"hub":0,"authority":1.7833198250397624e-7,"critical_path":5,"in_degree":2,"out_degree":0,"core_number":2,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-oxcm","title":"Unit tests: pkg/updater auto-update functionality","description":"Improve test coverage for pkg/updater (currently 26.4%).\n\n**Areas to test:**\n- Version comparison logic\n- Update check mechanism\n- Download and installation flow\n- Error handling (network failures, invalid checksums)\n- Platform-specific behavior (darwin/linux/windows)\n\n**Note:** Some network tests may need to use test servers or careful mocking of HTTP calls. Focus on testable logic paths first.","status":"closed","priority":3,"type":"task","labels":["testing","updater"],"created_at":"2025-12-16 13:01","updated_at":"2025-12-16 13:45","closed_at":"2025-12-16 13:45","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-p0bm","title":"Unit test: pkg/correlation/gitlog.go - Git log parsing","description":"Create unit tests for pkg/correlation/gitlog.go\n\n## File Overview\ngitlog.go wraps git log parsing for the correlation system.\n\n## Test Cases to Implement\n1. **Log Parsing**\n   - Standard git log format\n   - Custom format strings\n   - Date parsing\n   - Author/email extraction\n\n2. **Commit Message Parsing**\n   - Single line message\n   - Multi-line message\n   - Message with issue references\n   - Conventional commit format\n\n3. **File Change Parsing**\n   - Added files\n   - Modified files\n   - Deleted files\n   - Renamed files\n   - Binary files\n\n4. **Edge Cases**\n   - Empty repository (no commits)\n   - Merge commits\n   - Commits with no file changes\n   - Unicode in commit messages\n   - Very long commit messages\n\n5. **Integration Points**\n   - Stream processing\n   - Incremental parsing\n   - Checkpoint support\n\n## Implementation Notes\n- Create mock git log output strings\n- Test without requiring real git repo\n- Verify all git log formats handled","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-16 20:07","updated_at":"2025-12-16 22:02","closed_at":"2025-12-16 22:02","blocks":["bv-ubra"],"pagerank":0.0019171540027831243,"betweenness":0,"eigenvector":0,"hub":0,"authority":8.0286461624274e-14,"critical_path":4,"in_degree":1,"out_degree":0,"core_number":1,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-p32k","title":"Implement WASM fallback for unsupported browsers","description":"# Implement WASM Fallback\n\n## Context\nSome browsers may not support WASM or the specific features we use. The viewer should gracefully degrade.\n\n## Fallback Strategy\n\n### Detection\n```javascript\nasync function checkWASMSupport() {\n    try {\n        // Check basic WASM support\n        if (typeof WebAssembly !== 'object') {\n            return { supported: false, reason: 'WebAssembly not available' };\n        }\n        \n        // Try to load our module\n        await init();\n        return { supported: true };\n    } catch (e) {\n        return { supported: false, reason: e.message };\n    }\n}\n```\n\n### Graceful Degradation\n```javascript\nconst WASM_STATUS = await checkWASMSupport();\n\nif (!WASM_STATUS.supported) {\n    console.warn('WASM not supported:', WASM_STATUS.reason);\n    console.warn('Using pre-computed metrics only');\n    \n    // Show indicator to user\n    Alpine.store('graph').fallbackMode = true;\n}\n```\n\n### UI Indicators\n```html\n\u003cdiv x-show=\"$store.graph.fallbackMode\" class=\"warning-banner\"\u003e\n    ‚ö†Ô∏è Live calculations unavailable. Showing pre-computed data.\n\u003c/div\u003e\n\n\u003c!-- Hide live features --\u003e\n\u003cbutton \n    x-show=\"!$store.graph.fallbackMode\"\n    @click=\"recalculate()\"\u003e\n    Recalculate\n\u003c/button\u003e\n```\n\n### Pre-computed Data Usage\nWhen WASM unavailable, use pre-computed values from SQLite:\n```javascript\nfunction getMetrics(issueId) {\n    if (WASM_STATUS.supported) {\n        // Live calculation\n        return GRAPH.pagerank(...);\n    } else {\n        // Fall back to pre-computed\n        const row = DB.exec(\n            'SELECT pagerank, betweenness FROM issue_metrics WHERE issue_id = ?',\n            [issueId]\n        );\n        return row[0]?.values[0];\n    }\n}\n```\n\n## Acceptance Criteria\n- [ ] WASM support detected correctly\n- [ ] Fallback mode activated when needed\n- [ ] User shown appropriate indicator\n- [ ] Live features hidden in fallback mode\n- [ ] Pre-computed data used as fallback\n- [ ] No JavaScript errors in either mode","status":"closed","priority":2,"type":"task","labels":["integration","phase-4","wasm"],"created_at":"2025-12-15 23:38","updated_at":"2025-12-16 10:54","closed_at":"2025-12-16 10:54","blocked_by":["bv-y7a0"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":1.2580640962046904e-15,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":7,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-pbs6","title":"Implement Density and Degree metrics in Rust WASM","description":"# Implement Density and Degree Metrics\n\n## Context\nBasic graph metrics: density (edge/node ratio), in-degree, out-degree.\n\n## Rust Implementation\nAlready included in DiGraph struct:\n- `out_degree(node)`, `in_degree(node)` - single node\n- `out_degrees()`, `in_degrees()` - all nodes\n- Need to add: `density()`\n\n```rust\n#[wasm_bindgen]\nimpl DiGraph {\n    /// Graph density: E / (V * (V-1)) for directed graphs\n    pub fn density(\u0026self) -\u003e f64 {\n        let n = self.node_count() as f64;\n        let e = self.edge_count() as f64;\n        if n \u003c= 1.0 {\n            0.0\n        } else {\n            e / (n * (n - 1.0))\n        }\n    }\n}\n```\n\n## Acceptance Criteria\n- [ ] Density computed correctly\n- [ ] Handles edge cases (0-1 nodes)\n- [ ] All degree methods work","status":"closed","priority":2,"type":"task","labels":["algorithm","phase-2","wasm"],"created_at":"2025-12-15 23:35","updated_at":"2025-12-15 23:52","closed_at":"2025-12-15 23:52","blocked_by":["bv-bxoe"],"blocks":["bv-y7a0"],"pagerank":0.0018889407873369957,"betweenness":0,"eigenvector":0,"hub":0.000008837350028490512,"authority":0.000010677870334373396,"critical_path":4,"in_degree":1,"out_degree":1,"core_number":2,"slack":9,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-pby8","title":"Optimize regex compilations in export package","status":"closed","priority":3,"type":"task","labels":null,"created_at":"2025-12-16 20:16","updated_at":"2025-12-16 20:16","closed_at":"2025-12-16 20:16","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-psjp","title":"Write comprehensive tests and cross-validate with Go implementation","description":"# Write Comprehensive Tests and Cross-Validate\n\n## Context\nAll Rust WASM algorithms must be tested and cross-validated against the Go implementation to ensure correctness.\n\n## Requirements\n\n### Rust Unit Tests\nEach algorithm module has its own tests:\n```rust\n// tests/algorithms/pagerank_test.rs\n#[test]\nfn test_pagerank_convergence() {...}\n\n#[test]\nfn test_pagerank_chain() {...}\n\n#[test]\nfn test_pagerank_star() {...}\n\n#[test]\nfn test_pagerank_cycle() {...}\n```\n\n### WASM Integration Tests\n```rust\n// tests/web.rs\nuse wasm_bindgen_test::*;\n\nwasm_bindgen_test_configure!(run_in_browser);\n\n#[wasm_bindgen_test]\nfn test_digraph_construction() {\n    let mut g = DiGraph::new();\n    let a = g.add_node(\"a\");\n    let b = g.add_node(\"b\");\n    g.add_edge(a, b);\n    assert_eq!(g.node_count(), 2);\n    assert_eq!(g.edge_count(), 1);\n}\n\n#[wasm_bindgen_test]\nfn test_pagerank_from_js() {\n    // Build graph, call pagerank, verify\n}\n```\n\n### Cross-Validation with Go\nCreate golden test files:\n```\ntestdata/\n  graphs/\n    chain_10.json       # Simple chain\n    star_10.json        # Star topology\n    cycle_5.json        # Cycle\n    real_100.json       # Real bv data sample\n  expected/\n    chain_10_pagerank.json\n    chain_10_betweenness.json\n    ...\n```\n\nGo test generates expected values:\n```go\nfunc TestGenerateGoldenFiles(t *testing.T) {\n    issues := loadTestData(\"testdata/graphs/chain_10.json\")\n    analyzer := NewAnalyzer(issues)\n    stats := analyzer.Analyze()\n    \n    writeJSON(\"testdata/expected/chain_10_pagerank.json\", stats.PageRank())\n    writeJSON(\"testdata/expected/chain_10_betweenness.json\", stats.Betweenness())\n}\n```\n\nRust tests validate against golden files:\n```rust\n#[test]\nfn test_pagerank_golden() {\n    let graph = load_graph(\"testdata/graphs/chain_10.json\");\n    let expected = load_expected(\"testdata/expected/chain_10_pagerank.json\");\n    let actual = pagerank(\u0026graph, \u0026PageRankConfig::default());\n    \n    for (i, (exp, act)) in expected.iter().zip(actual.iter()).enumerate() {\n        assert!((exp - act).abs() \u003c 1e-6, \"Node {}: expected {}, got {}\", i, exp, act);\n    }\n}\n```\n\n### JavaScript Integration Tests\n```javascript\n// viewer.test.js\ndescribe('WASM Graph Engine', () =\u003e {\n    it('loads from SQLite data', async () =\u003e {...});\n    it('computes PageRank correctly', async () =\u003e {...});\n    it('handles subgraph extraction', async () =\u003e {...});\n    it('what-if returns expected cascades', async () =\u003e {...});\n});\n```\n\n### Test Coverage Goals\n- Rust unit tests: \u003e90% line coverage\n- WASM integration: All public API methods\n- Cross-validation: All algorithms\n- JS integration: Core functionality\n\n## Acceptance Criteria\n- [ ] All Rust unit tests pass\n- [ ] WASM browser tests pass (Firefox, Chrome)\n- [ ] Golden file validation passes\n- [ ] Results match Go within tolerance (1e-6)\n- [ ] Test coverage meets goals\n- [ ] CI integration (cargo test + wasm-pack test)","notes":"ADDITIONAL TEST: Include memory leak testing for WASM objects. Use Chrome DevTools heap snapshots to verify no DiGraph/subgraph objects accumulate after repeated operations.","status":"closed","priority":2,"type":"task","labels":["phase-5","testing","wasm"],"created_at":"2025-12-15 23:38","updated_at":"2025-12-16 03:12","closed_at":"2025-12-16 03:12","blocked_by":["bv-y7a0"],"blocks":["bv-dgyb"],"pagerank":0.002731484890410988,"betweenness":18,"eigenvector":0,"hub":1.2580640962046904e-15,"authority":4.7854460253878835e-21,"critical_path":2,"in_degree":1,"out_degree":1,"core_number":1,"slack":6,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-pua7","title":"E2E: Offline functionality testing","description":"Test that exported static site works offline.\n\n## Offline Capabilities\n1. **Page Loading**\n   - Main page loads without network\n   - All assets bundled inline or cached\n   - No external dependencies required\n\n2. **Search Functionality**\n   - Search works without server\n   - Index loaded from static file\n   - Results display correctly\n\n3. **Navigation**\n   - Internal links work\n   - Hash-based routing\n   - Back/forward navigation\n\n4. **Graph Interaction**\n   - Graph renders offline\n   - Pan/zoom works\n   - Node selection works\n\n## Test Implementation\n- Serve static files locally\n- Disable network after initial load\n- Verify all features work\n- Check browser console for errors\n\n## Browser Testing\n- Chrome\n- Firefox\n- Safari\n- Edge (Chromium)\n\n## Success Criteria\n- All features work offline\n- No network requests after load\n- Console error-free\n- Sub-second interactions","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-16 20:09","updated_at":"2025-12-17 01:08","closed_at":"2025-12-17 01:08","blocked_by":["bv-ct7m"],"blocks":["bv-hdu4"],"pagerank":0.0016726975206033255,"betweenness":0,"eigenvector":0,"hub":7.032456132708617e-11,"authority":3.1573158850443083e-10,"critical_path":3,"in_degree":1,"out_degree":1,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-px42","title":"Fix follow-up issues from recent robot/correlation changes","description":"Fresh-eyes review found a few follow-ups:\n\n1) Correlation incremental path (`pkg/correlation/incremental.go`) still uses `--format=%H|...` but now feeds output into `Extractor.parseGitLogOutput`, which expects NUL-delimited headers. This silently breaks incremental history updates.\n\n2) `Extractor.parseGitLogOutput` scanner max token is 1MB while streaming path uses 10MB; align to 10MB to match loader and avoid truncation on large diffs.\n\n3) `--robot-triage` `usage_hints` in `cmd/bv/main.go` reference stale jq paths (e.g. `.triage.blockers`, `.triage.quick_ref.next_up`). Update hints to match current JSON schema.\n\n4) Minor clarity: update outdated comment for `Recommendation.Action` in `pkg/analysis/triage.go` (now a human-readable action hint).\n\nAcceptance:\n- Incremental correlation extraction works again (format matches parser)\n- `--robot-triage` hints are accurate for current schema\n- gofmt + `go test ./...` pass\n","notes":"Fixed follow-ups from fresh-eyes review:\n- Correlation incremental extraction now uses NUL-delimited git log headers to match `Extractor.parseGitLogOutput`.\n- `Extractor.parseGitLogOutput` scanner max token size bumped to 10MB (match loader/stream).\n- `--robot-triage` usage_hints updated to match actual JSON schema.\n- Updated outdated comment for `Recommendation.Action` (human-readable action hint).\n\nTests: gofmt + `go test ./...`.","status":"closed","priority":2,"type":"bug","labels":["correlation","robot","robustness"],"created_at":"2025-12-16 18:56","updated_at":"2025-12-16 19:00","closed_at":"2025-12-16 19:00","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-q923","title":"[EPIC] Complete Test Coverage Initiative - Unit Tests, E2E, Static Export, Graph Viz","description":"Master epic for achieving comprehensive test coverage across the beads_viewer codebase. \n\n## Goals\n- Achieve 95%+ unit test coverage without mocks/fakes\n- Complete E2E integration test suite with detailed logging\n- Full coverage of static GitHub Pages export workflow\n- Comprehensive graph visualization feature testing\n\n## Current State Analysis\n- 122 test files exist covering ~82% of code\n- 27 source files have NO test coverage\n- E2E tests exist but need expansion\n- No formal mock framework (using concrete implementations)\n\n## Key Gaps Identified\n1. pkg/analysis: 7 suggestion-related files untested\n2. pkg/ui: 7 UI rendering files untested  \n3. pkg/search: 3 config/embedder files untested\n4. pkg/correlation: gitlog.go untested\n5. Static site export needs more edge cases\n6. Graph visualization needs dedicated tests\n7. No race condition testing\n8. Missing detailed E2E logging infrastructure","status":"closed","priority":1,"type":"epic","labels":null,"created_at":"2025-12-16 20:04","updated_at":"2025-12-17 01:22","closed_at":"2025-12-17 01:22","blocked_by":["bv-3bhq","bv-ul1l","bv-ubra","bv-syeo","bv-hdu4","bv-evyl","bv-m2cg","bv-gv9v","bv-6tqt"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":1.4605167855494733e-7,"authority":0,"critical_path":1,"in_degree":0,"out_degree":9,"core_number":2,"slack":10,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-qcgs","title":"Unit test: flow_matrix.go - Label flow matrix rendering","description":"Create unit tests for pkg/ui/flow_matrix.go\n\n## File Overview\nflow_matrix.go displays the label-to-label dependency flow as a matrix visualization.\n\n## Test Cases to Implement\n1. **Matrix Rendering Tests**\n   - Empty matrix (no labels)\n   - 2x2 matrix\n   - 5x5 matrix with mixed values\n   - Matrix with zeros\n   - Matrix with max values\n\n2. **Cell Formatting Tests**\n   - Numeric value display\n   - Color coding by value intensity\n   - Cell padding/alignment\n   - Header row/column labels\n\n3. **Interactive Tests**\n   - Cell selection\n   - Row/column highlighting\n   - Keyboard navigation\n   - Help overlay\n\n4. **Sizing Tests**\n   - Narrow terminal (truncate labels)\n   - Wide terminal (full labels)\n   - Many labels (scrolling)\n\n## Implementation Notes\n- Create mock FlowResult data\n- Test ASCII art boundaries\n- Verify color gradient correctness","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-16 20:06","updated_at":"2025-12-16 23:17","closed_at":"2025-12-16 23:17","blocks":["bv-ul1l"],"pagerank":0.0017282929585731776,"betweenness":0,"eigenvector":0,"hub":0,"authority":6.623673282227765e-11,"critical_path":4,"in_degree":1,"out_degree":0,"core_number":1,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-qeqe","title":"Windows install fails: undefined ParseIssues in git.go","status":"closed","priority":1,"type":"bug","labels":["gh-issue-20","installer","windows"],"created_at":"2025-12-16 18:02","updated_at":"2025-12-16 18:06","closed_at":"2025-12-16 18:06","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-qfr5","title":"E2E: Multi-step workflow tests with state verification","description":"Test complete user workflows that span multiple commands.\n\n## Workflows to Test\n1. **New Project Setup**\n   - bv with no .beads directory\n   - Create first issues\n   - Run analysis\n   - Export report\n\n2. **Triage Workflow**\n   - Load existing project\n   - Get robot-triage\n   - Claim recommended issue\n   - Complete and verify plan updates\n\n3. **Time-Travel Analysis**\n   - Create baseline snapshot\n   - Make changes\n   - Run --robot-diff\n   - Verify change detection\n\n4. **Label-Scoped Analysis**\n   - Create multi-label project\n   - Filter by label\n   - Verify scoped metrics\n   - Test label flow analysis\n\n5. **Workspace Multi-Repo**\n   - Setup workspace.yaml\n   - Load multiple repos\n   - Test cross-repo deps\n   - Verify ID namespacing\n\n6. **Export Pipeline**\n   - Generate insights\n   - Export to markdown\n   - Export to static site\n   - Verify all artifacts\n\n## State Verification\n- Checkpoint state after each step\n- Verify expected state transitions\n- Test rollback/recovery\n- Log all intermediate states","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-16 20:08","updated_at":"2025-12-17 00:16","closed_at":"2025-12-17 00:16","blocked_by":["bv-cwzm"],"blocks":["bv-syeo"],"pagerank":0.0017054007352105605,"betweenness":0,"eigenvector":0,"hub":7.799479570458926e-12,"authority":3.263220574971611e-11,"critical_path":3,"in_degree":1,"out_degree":1,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-qjc","title":"Actionable Exports \u0026 Hooks System","description":"Enhance exports to include runnable commands and add a hook system for automation.\n\n## Background \u0026 Motivation\nCurrent exports are read-only reports. Users want exports that enable action: 'here's the command to close these resolved issues' or 'here's the PR description for this work'.\n\n## Value Proposition\n- For Humans: Exports include copy-paste ready commands\n- For AI Agents: Chain exports ‚Üí actions without manual parsing\n\n## Technical Approach\n1. Enhance markdown export with bd command snippets\n2. Add hook system (pre-export, post-export)\n3. Hook configuration in .bv/hooks.yaml\n4. Environment variables passed to hooks\n\n## Hook Use Cases\n- Post to Slack after export\n- Create GitHub issue from bead\n- Trigger CI pipeline\n- Sync to external tracker\n\n## Security Considerations\n- Hooks are opt-in (require explicit config)\n- Commands are not auto-executed\n- Hook output captured but not interpreted","status":"closed","priority":2,"type":"epic","labels":["automation","export","hooks"],"created_at":"2025-11-26 23:36","updated_at":"2025-12-16 15:57","closed_at":"2025-12-16 15:57","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-qjc.1","title":"Add command snippets to markdown export","description":"Include ready-to-run bd commands in markdown exports.\n\n## Export Enhancement\nAdd 'Quick Actions' section to markdown export:\n\n### Quick Actions\n```bash\n# Close all resolved items in this export\nbd close issue-1 issue-2 issue-3\n\n# Bulk priority update\nbd update issue-4 issue-5 -p P1\n```\n\n## Per-Issue Actions\nEach issue card includes:\n- bd close \u003cid\u003e: Mark as done\n- bd comment \u003cid\u003e '\u003ctext\u003e': Add comment\n- bd update \u003cid\u003e -p \u003cpriority\u003e: Change priority\n\n## Implementation\n- Add CommandSnippets field to export.Options\n- Generate commands based on current state\n- Use proper escaping for shell safety\n\n## File Changes\n- pkg/export/markdown.go: Add command generation\n- pkg/export/markdown_test.go: Test command output","status":"closed","priority":2,"type":"task","labels":["automation","export"],"created_at":"2025-11-26 23:40","updated_at":"2025-12-16 13:40","closed_at":"2025-12-16 13:40","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-qjc.2","title":"Design and implement hook configuration system","description":"Design and implement hook configuration system.\n\n## Configuration File\n.bv/hooks.yaml:\n```yaml\nhooks:\n  pre-export:\n    - name: validate-issues\n      command: './scripts/validate.sh'\n      timeout: 10s\n  post-export:\n    - name: slack-notify\n      command: 'curl -X POST ...'\n      timeout: 30s\n      env:\n        SLACK_WEBHOOK: ${SLACK_WEBHOOK}\n```\n\n## Environment Variables Passed to Hooks\n- BV_EXPORT_PATH: Output file path\n- BV_EXPORT_FORMAT: 'markdown' or 'json'\n- BV_ISSUE_COUNT: Number of issues exported\n- BV_TIMESTAMP: Export timestamp\n\n## Hook Execution\n- 30s default timeout, configurable per hook\n- Failures logged but don't break export (unless pre-export)\n- pre-export failure cancels export\n- Stdout/stderr captured and displayed\n\n## File Changes\n- pkg/hooks/config.go: Configuration types and loader\n- pkg/hooks/executor.go: Hook execution logic\n- pkg/hooks/executor_test.go: Tests","status":"closed","priority":2,"type":"task","labels":["configuration","hooks"],"created_at":"2025-11-26 23:40","updated_at":"2025-12-16 12:40","closed_at":"2025-12-16 12:40","blocks":["bv-qjc.3"],"pagerank":0.002731484890410988,"betweenness":0,"eigenvector":0,"hub":0,"authority":4.7854460253878835e-21,"critical_path":2,"in_degree":1,"out_degree":0,"core_number":1,"slack":13,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-qjc.3","title":"Integrate hooks with export pipeline","description":"Wire hooks into export flow: load config ‚Üí pre-export ‚Üí generate ‚Üí write ‚Üí post-export. --no-hooks flag. Hook output displayed.","status":"closed","priority":2,"type":"task","labels":["export","hooks","integration"],"created_at":"2025-11-26 23:40","updated_at":"2025-12-16 12:44","closed_at":"2025-12-16 12:44","blocked_by":["bv-qjc.2"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":7.890898495503672e-22,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":13,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-qpt0","title":"Add label-based clustering and galaxy view","description":"# Label-Based Clustering\n\n## Context\nGroup issues by label into visual clusters ('galaxies') for better organization.\n\n## Requirements\n\n### 1. Force Clustering Configuration\n```javascript\nGraph\n    .d3Force('cluster', forceCluster()\n        .centers(d =\u003e labelCenters[d.labels[0]])\n        .strength(0.5)\n    )\n    .d3Force('collide', d3.forceCollide(d =\u003e d.val + 2));\n\n// Pre-compute label centers\nconst labels = [...new Set(issues.flatMap(i =\u003e i.labels))];\nconst labelCenters = {};\nlabels.forEach((label, i) =\u003e {\n    const angle = (2 * Math.PI * i) / labels.length;\n    labelCenters[label] = {\n        x: Math.cos(angle) * 200,\n        y: Math.sin(angle) * 200\n    };\n});\n```\n\n### 2. Label Legend with Colors\n```javascript\nconst labelColors = {};\nlabels.forEach((label, i) =\u003e {\n    labelColors[label] = d3.schemeCategory10[i % 10];\n});\n\n// Render legend\nconst legend = d3.select('#legend')\n    .selectAll('.label-item')\n    .data(labels)\n    .enter()\n    .append('div')\n    .attr('class', 'label-item')\n    .style('color', d =\u003e labelColors[d])\n    .text(d =\u003e d)\n    .on('click', d =\u003e filterToLabel(d));\n```\n\n### 3. Cluster Hulls\nDraw convex hulls around each label cluster:\n```javascript\nfunction drawClusterHulls() {\n    const hulls = labels.map(label =\u003e {\n        const points = graphData.nodes\n            .filter(n =\u003e n.labels.includes(label))\n            .map(n =\u003e [n.x, n.y]);\n        return { label, hull: d3.polygonHull(points) };\n    });\n    // Render hulls as semi-transparent backgrounds\n}\n```\n\n### 4. Cross-Label Edges Highlighted\nEdges between different label clusters shown with distinct styling.\n\n## Acceptance Criteria\n- [ ] Issues cluster by primary label\n- [ ] Distinct colors per label\n- [ ] Clickable legend filters to label\n- [ ] Cross-label deps visually distinct\n- [ ] Smooth transitions on filter","status":"closed","priority":2,"type":"task","labels":["phase-2","ux","visualization"],"created_at":"2025-12-15 23:56","updated_at":"2025-12-16 16:07","closed_at":"2025-12-16 16:07","blocked_by":["bv-jndd"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":6.571979899005031e-7,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":13,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-r9k7","title":"Robot status output shows pending/empty states","description":"Problem:\n- `bv --robot-plan` and `bv --robot-priority` emit `.status` with `state: pending` for all metrics and empty states for `KCore/Articulation/Slack`.\n- This breaks the robot JSON contract and makes agents think metrics are still running even though bv exits immediately.\n\nRepro:\n- `bv --robot-plan | jq .status`\n- `bv --robot-priority | jq .status`\n\nExpected:\n- Status should be deterministic and reflect what was actually computed for the command (`computed`/`approx`/`timeout`/`skipped`), with no `pending`/empty states.\n\nAcceptance:\n- `--robot-plan` and `--robot-priority` status fields never contain `pending`/empty states at process exit.\n- If metrics are intentionally not computed for a fast path, they are marked `skipped` with a reason.","notes":"Implemented fix: `--robot-plan` and `--robot-priority` now wait for analysis completion before emitting `.status`, eliminating `pending`/empty states.\n\n- `--robot-plan` skips expensive centrality metrics by default and marks them `skipped` with reason `not computed for --robot-plan`; still computes fast structural signals (k-core/articulation/slack) for a complete status contract.\n- Tests updated to enforce no `pending`/empty states in robot outputs.","status":"closed","priority":1,"type":"bug","labels":["ai-agent","cli","robot"],"created_at":"2025-12-16 17:55","updated_at":"2025-12-16 18:06","closed_at":"2025-12-16 18:06","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-runn","title":"Perf: speed up startup by removing redundant work (no output changes)","description":"## Goal\nMake bv measurably faster and more scalable at startup by removing *waste* (redundant computation, dead work, avoidable O(V¬∑E) passes), **without changing any results/output**.\n\nThis is specifically about:\n- TUI startup responsiveness (Model construction, Phase 1 readiness)\n- Robot-mode command latency for analysis-heavy outputs\n- CPU + allocation efficiency when graphs get large (hundreds/thousands of issues)\n\n## Context / Why this matters\nbv is intentionally a ‚Äúgraph sidecar‚Äù for Beads. As projects grow, the analysis pipeline becomes the dominant cost, and the *worst* kind of cost is redundant work that produces identical results.\n\nWe already observed several clear cases of:\n- computing values and discarding them\n- computing the same derived data multiple times from the same inputs\n- per-node work that can be replaced with a linear pass\n\nThese are ‚Äúfree wins‚Äù: they improve speed and reduce CPU without changing behavior.\n\n## Non-goals\n- Do **not** change metric definitions, scoring weights, or recommendation ordering.\n- Do **not** skip metrics or change what gets computed (unless explicitly gated behind an opt-in flag AND the default remains identical).\n- Do **not** change the shape of robot JSON outputs.\n- Do **not** change UI behavior/interaction.\n\n## Out of scope (explicitly)\n- Any product/UX changes.\n- The export wizard / huh dependency decisions.\n\n## Success criteria (high-level)\n- `go test ./...` passes.\n- Output invariants hold on fixtures: triage recommendations/unblocks/velocity remain identical.\n- Measurable reduction in startup CPU/allocations on a ‚Äúlarge graph‚Äù fixture.","design":"## Candidate improvements (no output change)\n1) Remove dead work in triage:\n   - `pkg/analysis/triage.go` calls `analyzer.GetExecutionPlan()` and discards it.\n\n2) Remove unused precompute in impact scoring:\n   - `pkg/analysis/priority.go` builds/sorts a dependents map that is never used.\n\n3) Avoid computing full triage just to extract velocity:\n   - `cmd/bv/main.go` uses `analysis.ComputeTriage()` inside `--robot-insights` only to read `ProjectHealth.Velocity`.\n\n4) Reduce asymptotic cost of ‚Äúunblocks map‚Äù construction:\n   - current triage builds unblocks by calling a per-node graph traversal.\n   - can compute equivalently in ~O(E) by counting open blockers + grouping dependents.\n\n5) Eliminate duplicated analyzer/stats construction in the TUI:\n   - `pkg/ui/model.go` builds analyzer+stats, then calls `analysis.ComputeTriage()` which builds another analyzer+stats.\n\n## Risks / tricky bits\n- Must preserve dependency semantics:\n  - only blocking deps matter (`dep.Type.IsBlocking()`)\n  - missing blockers must not block (graceful degradation)\n  - duplicated deps in JSONL must not double-count (graph edges are unique)\n- Determinism: stable ordering of IDs in outputs.\n- Avoid introducing time-based flaky tests; focus on functional invariants.","acceptance_criteria":"- [ ] No robot JSON output shape changes (field names/types).\n- [ ] Existing unit tests remain green; new invariance tests added where appropriate.\n- [ ] Documented benchmark protocol to measure improvements.\n- [ ] Demonstrated CPU/allocation reduction on at least one large synthetic fixture.","status":"closed","priority":1,"type":"epic","labels":["analysis","performance","startup"],"created_at":"2025-12-17 11:42","updated_at":"2025-12-17 12:41","closed_at":"2025-12-17 12:41","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-runn.1","title":"Perf baseline: define invariants + measurement protocol","description":"## Goal\nBefore we change any code, define what ‚Äústartup time‚Äù means and add guardrails ensuring **outputs do not change**.\n\n## Why\nPerf refactors are safest when we can quickly prove they are semantics-preserving. This work creates the safety net.\n\n## Scope\n- Define benchmark commands/datasets for:\n  - TUI startup (Phase 1 ready + Phase 2 completion)\n  - `bv --robot-triage`, `bv --robot-plan`, `bv --robot-insights`\n- Add *functional* invariance tests (NOT wall-time assertions) for:\n  - unblocks map correctness\n  - velocity computation\n  - (optional) triage recommendation stability on a small fixture\n\n## Principles\n- No flaky time assertions.\n- Prefer fixed clocks (`now`) + deterministic fixtures.\n- Prefer ‚Äúfast vs slow reference‚Äù equivalence tests for algorithmic changes.","acceptance_criteria":"- [ ] Benchmark protocol exists (commands + datasets).\n- [ ] Invariance tests exist for unblocks + velocity at minimum.\n- [ ] Tests are deterministic and fast.","status":"closed","priority":1,"type":"task","labels":["performance","startup","testing"],"created_at":"2025-12-17 11:46","updated_at":"2025-12-17 12:40","closed_at":"2025-12-17 12:40","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-runn.10","title":"Perf: avoid duplicate analyzer/triage computations in TUI startup","description":"## Problem\n`pkg/ui/model.go` currently does redundant work:\n- builds an Analyzer + starts AnalyzeAsync\n- calls `analysis.ComputeTriage(issues)` which builds another Analyzer + AnalyzeAsync\n- later recomputes triage on Phase2Ready\n\nThis can double/triple analysis costs on large graphs.\n\n## Goal\nReuse the already-constructed analyzer/stats for triage and related UI panels.\n\n## Constraints\n- Do not block startup waiting for Phase 2.\n- Preserve semantics (including graceful degradation when Phase 2 isn‚Äôt ready).","status":"closed","priority":2,"type":"task","labels":["analysis","performance","ui"],"created_at":"2025-12-17 11:46","updated_at":"2025-12-17 12:39","closed_at":"2025-12-17 12:39","blocked_by":["bv-runn.2","bv-runn.9"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":3.2320636130960366e-13,"authority":0,"critical_path":1,"in_degree":0,"out_degree":2,"core_number":2,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-runn.11","title":"analysis: add triage entrypoint that reuses analyzer/stats","description":"## Goal\nAdd a triage helper that avoids rebuilding the graph.\n\n## Direction\nRefactor the triage core so it can operate using:\n- an existing `*analysis.Analyzer` (dependency queries)\n- an existing `*analysis.GraphStats` (centrality metrics, phase2 status)\n- a fixed `now`\n\n## Acceptance\nMust match `ComputeTriageWithOptionsAndTime` outputs given equivalent inputs.","status":"closed","priority":2,"type":"task","labels":["analysis","performance"],"created_at":"2025-12-17 11:46","updated_at":"2025-12-17 12:13","closed_at":"2025-12-17 12:13","blocked_by":["bv-runn.2"],"blocks":["bv-runn.12"],"pagerank":0.003798240094886169,"betweenness":2,"eigenvector":0,"hub":2.5235190131036316e-13,"authority":4.7854460253878835e-21,"critical_path":3,"in_degree":1,"out_degree":1,"core_number":1,"slack":11,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-runn.12","title":"ui: wire TUI startup to reuse analyzer/stats for triage","description":"## Goal\nUpdate `pkg/ui/model.go` to stop calling `analysis.ComputeTriage()` redundantly.\n\n## Notes\n- Keep Phase 1 fast.\n- Ensure list sort/filter correctness after Phase 2 completes.","status":"closed","priority":2,"type":"task","labels":["performance","ui"],"created_at":"2025-12-17 11:46","updated_at":"2025-12-17 12:16","closed_at":"2025-12-17 12:16","blocked_by":["bv-runn.11"],"blocks":["bv-runn.13"],"pagerank":0.002731484890410988,"betweenness":2,"eigenvector":0,"hub":7.890898495503672e-22,"authority":4.7854460253878835e-21,"critical_path":2,"in_degree":1,"out_degree":1,"core_number":1,"slack":11,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-runn.13","title":"ui: avoid recomputing triage on Phase2Ready when reuse is possible","description":"## Goal\nOn Phase2Ready, avoid building fresh analyzers for triage; reuse existing analyzer/stats.\n\n## Why P3\nNice-to-have after the initial duplication is removed.","status":"closed","priority":3,"type":"task","labels":["performance","ui"],"created_at":"2025-12-17 11:46","updated_at":"2025-12-17 12:39","closed_at":"2025-12-17 12:39","blocked_by":["bv-runn.12"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":7.890898495503672e-22,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-runn.14","title":"Perf (optional): reduce Phase2 map copy allocations in hot paths","description":"## Idea\n`GraphStats.PageRank()` / `Betweenness()` etc return copies for thread safety.\n\nFor very large graphs and repeated scoring passes, these copies can be a meaningful allocation cost.\n\n## Potential approach\nProvide a callback-based accessor holding an RLock that exposes internal maps read-only.\n\n## Risk\nMust prevent mutation and keep lock holds short.","status":"closed","priority":3,"type":"task","labels":["analysis","performance"],"created_at":"2025-12-17 11:46","updated_at":"2025-12-17 12:56","closed_at":"2025-12-17 12:56","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-runn.2","title":"Perf tests: invariance suite for unblocks + velocity (+ triage sanity)","description":"## Goal\nAdd deterministic tests guaranteeing the planned perf refactors keep identical semantics.\n\n## Unblocks invariance\nCreate a deterministic synthetic issue set that includes:\n- blocking vs non-blocking deps\n- missing dependency IDs\n- duplicated deps\n- mixed statuses (open/blocked/in_progress/closed)\n\nTest strategy:\n- Implement a slow ‚Äúreference‚Äù unblocks computation in *_test.go mirroring current behavior.\n- Implement (or later call) the optimized unblocks computation.\n- Assert equivalence for every issue ID (including deterministic sorted order of unblocks lists).\n\n## Velocity invariance\n- Use a fixed `now` and known `ClosedAt` timestamps.\n- Assert the exported helper matches the existing triage velocity logic.\n\n## Optional triage sanity\n- For a small fixture, assert recommended IDs/order matches a golden list.","acceptance_criteria":"- [ ] Unblocks tests cover edge cases (missing blockers, duplicated deps, non-blocking deps).\n- [ ] Velocity test uses fixed `now` and is stable.\n- [ ] `go test ./...` remains fast and deterministic.","status":"closed","priority":1,"type":"task","labels":["analysis","performance","testing"],"assignee":"LilacBear","created_at":"2025-12-17 11:46","updated_at":"2025-12-17 12:03","closed_at":"2025-12-17 12:03","blocks":["bv-runn.10","bv-runn.11","bv-runn.8","bv-runn.9"],"pagerank":0.007748371948051334,"betweenness":0,"eigenvector":0,"hub":0,"authority":1.5303915058758734e-12,"critical_path":4,"in_degree":4,"out_degree":0,"core_number":2,"slack":11,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-runn.3","title":"Perf docs: benchmark protocol for bv startup + robot commands","description":"## Goal\nWrite a short, copy/paste benchmark protocol for future perf work.\n\n## Include\n- Datasets:\n  - small (‚â§100), medium (~500), large (‚â•2000) synthetic graphs\n- Commands:\n  - `bv --profile-startup --profile-json --robot-triage`\n  - `/usr/bin/time -p bv --robot-triage` (wall time)\n  - representative TUI startup measurement\n- How to interpret Phase 1 vs Phase 2 time.","status":"closed","priority":2,"type":"chore","labels":["docs","performance"],"created_at":"2025-12-17 11:46","updated_at":"2025-12-17 12:56","closed_at":"2025-12-17 12:56","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-runn.4","title":"Perf: remove dead GetExecutionPlan call in triage","description":"## Problem\n`pkg/analysis/triage.go` calls `analyzer.GetExecutionPlan()` and discards the result.\n\nThis is pure waste:\n- It can be expensive on large graphs.\n- It does not affect triage output.\n\n## Proposed change\nDelete the unused call.\n\n## Safety\n`GetExecutionPlan()` should be pure computation with no side effects.","acceptance_criteria":"- [ ] Unused call removed.\n- [ ] `go test ./...` passes.\n- [ ] Triage output unchanged on fixtures.","status":"closed","priority":1,"type":"task","labels":["analysis","performance","triage"],"created_at":"2025-12-17 11:46","updated_at":"2025-12-17 12:33","closed_at":"2025-12-17 12:33","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-runn.5","title":"Perf: remove unused dependents precompute in impact scoring","description":"## Problem\n`pkg/analysis/priority.go` builds + sorts a dependents map labeled as an optimization, but it is never used.\n\nThis adds avoidable overhead every time impact scores are computed.\n\n## Proposed change\nDelete the unused map and sorting.","acceptance_criteria":"- [ ] Unused precompute removed.\n- [ ] Output unchanged (scores, ordering).\n- [ ] `go test ./...` passes.","status":"closed","priority":1,"type":"task","labels":["analysis","performance"],"assignee":"PinkHill","created_at":"2025-12-17 11:46","updated_at":"2025-12-17 12:39","closed_at":"2025-12-17 12:39","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-runn.6","title":"Perf: compute velocity without running full triage","description":"## Problem\n`--robot-insights` currently calls `analysis.ComputeTriage()` solely to extract `ProjectHealth.Velocity`.\n\nThat forces redundant work (new analyzer + triage scoring) unrelated to insights output.\n\n## Goal\nExpose velocity computation as a lightweight helper that does not require graph construction.\n\n## Output invariance\nVelocity numbers must match the existing triage velocity calculation for the same `now`.","status":"closed","priority":1,"type":"task","labels":["analysis","performance","robot"],"created_at":"2025-12-17 11:46","updated_at":"2025-12-17 12:37","closed_at":"2025-12-17 12:37","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-runn.7","title":"analysis: export velocity computation helper (shared)","description":"## Goal\nMake velocity computation reusable without going through ComputeTriage.\n\n## Proposed API (example)\n`analysis.ComputeProjectVelocity(issues []model.Issue, now time.Time, weeks int) *analysis.ProjectVelocity`\n\n## Requirements\n- Must preserve exact semantics used by triage today.\n- Must be testable with a fixed `now`.","status":"closed","priority":1,"type":"task","labels":["analysis","performance"],"created_at":"2025-12-17 11:46","updated_at":"2025-12-17 12:02","closed_at":"2025-12-17 12:02","blocks":["bv-runn.8"],"pagerank":0.0021039815616854516,"betweenness":0,"eigenvector":0,"hub":0,"authority":4.2969782741163935e-13,"critical_path":2,"in_degree":1,"out_degree":0,"core_number":1,"slack":13,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-runn.8","title":"cmd/bv: use velocity helper in --robot-insights (avoid ComputeTriage)","description":"## Goal\nRemove the redundant `analysis.ComputeTriage()` call from the robot-insights path.\n\n## Constraints\n- Robot insights JSON shape must not change.\n- Velocity values must match existing behavior.","status":"closed","priority":1,"type":"task","labels":["performance","robot"],"created_at":"2025-12-17 11:46","updated_at":"2025-12-17 12:03","closed_at":"2025-12-17 12:03","blocked_by":["bv-runn.7","bv-runn.2"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":3.2320636130960366e-13,"authority":0,"critical_path":1,"in_degree":0,"out_degree":2,"core_number":1,"slack":13,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-runn.9","title":"Perf: compute triage unblocks map in O(E) (no per-node traversal)","description":"## Problem\nTriage currently builds an ‚Äúunblocks map‚Äù by calling `analyzer.computeUnblocks(issueID)` for every open issue.\n\nThis can devolve to O(V¬∑E) and becomes expensive on large graphs.\n\n## Goal\nCompute the same unblocks map in ~O(E):\n- Precompute each issue‚Äôs count of open blockers (only existing blocking deps).\n- Build blocker -\u003e dependents adjacency lists.\n- Dependent is unblocked by closing blocker B iff openBlockerCount[dependent] == 1 and B is that blocker.\n\n## Correctness requirements\n- Only blocking deps count (`dep.Type.IsBlocking()`).\n- Missing blockers do not block.\n- Duplicate deps must not double-count.\n- Unblocks lists must be deterministically sorted.","acceptance_criteria":"- [ ] O(E) implementation matches reference algorithm on fixtures.\n- [ ] No triage output changes.\n- [ ] `go test ./...` passes.","status":"closed","priority":1,"type":"task","labels":["analysis","performance","triage"],"assignee":"LilacBear","created_at":"2025-12-17 11:46","updated_at":"2025-12-17 12:24","closed_at":"2025-12-17 12:24","blocked_by":["bv-runn.2"],"blocks":["bv-runn.10"],"pagerank":0.0021039815616854516,"betweenness":0,"eigenvector":0,"hub":2.5235190131036316e-13,"authority":4.2969782741163935e-13,"critical_path":2,"in_degree":1,"out_degree":1,"core_number":2,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-syeo","title":"[SUB-EPIC] E2E Integration Tests with Detailed Logging","description":"Expand E2E integration test suite with comprehensive logging infrastructure.\n\n## Current State\n- 10 E2E test files in tests/e2e/\n- Basic harness.sh script exists\n- Robot commands tested but logging is minimal\n\n## Goals\n1. Enhanced logging infrastructure for all E2E tests\n2. Timestamped logs for each test step\n3. Stdout/stderr capture with context\n4. Test artifact preservation\n5. CI/CD friendly output\n\n## Test Areas to Expand\n- Full robot command matrix testing\n- Multi-step workflow tests\n- Error scenario testing\n- Performance regression tests\n- Concurrent access tests\n\n## Success Criteria\n- All robot commands have dedicated E2E tests\n- Logs capture full execution context\n- Artifacts preserved for debugging\n- CI integration documented","status":"closed","priority":1,"type":"epic","labels":null,"created_at":"2025-12-16 20:04","updated_at":"2025-12-17 00:39","closed_at":"2025-12-17 00:39","blocked_by":["bv-cwzm","bv-0zk6","bv-qfr5","bv-fqpv","bv-kozq","bv-ut9x"],"blocks":["bv-q923"],"pagerank":0.0016159234171211456,"betweenness":6,"eigenvector":0,"hub":3.47037035330027e-11,"authority":7.094593722740486e-8,"critical_path":2,"in_degree":1,"out_degree":6,"core_number":2,"slack":11,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-ta9l","title":"Unit tests: ETA estimation algorithm","description":"Add comprehensive tests for pkg/analysis/eta.go ETA estimation.\n\n**Functions to test:**\n- EstimateETAForIssue() - main entry point\n- estimateComplexityMinutes() - type weights, depth factors, description length\n- estimateVelocityMinutesPerDay() - label-based velocity, fallbacks\n- velocityMinutesPerDayForLabel() - closure filtering, sample counting\n- estimateETAConfidence() - confidence scoring logic\n- computeMedianEstimatedMinutes() - median calculation\n- durationDays(), clampFloat() - utility functions\n\n**Test cases:**\n1. ETA with explicit vs median estimates\n2. Type weights (bug, task, feature, epic, chore)\n3. Depth factor impact on complexity\n4. Description length impact\n5. Velocity from recent closures\n6. Fallback to global velocity\n7. Confidence scoring with various inputs\n8. Edge cases: zero agents, no estimates, no closures\n\n**Coverage target:** 90%+","status":"closed","priority":2,"type":"task","labels":["eta","forecast","testing"],"created_at":"2025-12-16 13:01","updated_at":"2025-12-16 13:06","closed_at":"2025-12-16 13:06","blocked_by":["bv-kvtj"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":1.2580640962046904e-15,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":13,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-tm6c","title":"Unit test: label_suggest.go - Label suggestion logic","description":"Create comprehensive unit tests for pkg/analysis/label_suggest.go\n\n## File Overview\nlabel_suggest.go suggests labels for issues based on:\n- Content analysis (keywords in title/description)\n- Neighbor labels (issues it depends on)\n- Similar issue labels\n- Project-wide label patterns\n\n## Test Cases to Implement\n1. **Content-Based Suggestions**\n   - 'Fix bug in login' -\u003e suggest 'bug', 'auth'\n   - 'Add dark mode feature' -\u003e suggest 'feature', 'ui'\n   - 'Performance optimization' -\u003e suggest 'performance'\n   - Test keyword matching accuracy\n\n2. **Neighbor-Based Suggestions**\n   - Issue depends on 3 'backend' issues -\u003e suggest 'backend'\n   - Issue blocks 5 'api' issues -\u003e suggest 'api'\n   - Mixed neighbor labels -\u003e suggest most common\n\n3. **Similar Issue Suggestions**\n   - Find issues with similar titles\n   - Suggest labels from similar issues\n   - Weight by similarity score\n\n4. **Confidence Scoring**\n   - Multiple signals = higher confidence\n   - Single weak signal = low confidence\n   - Conflicting signals = medium confidence\n\n5. **Edge Cases**\n   - Issue already has the suggested label\n   - No labels in entire project\n   - All issues have same label\n   - Very long label names\n\n## Implementation Notes\n- Create issues with predictable content\n- Test each suggestion source independently\n- Test combination of sources\n- Verify no duplicate label suggestions","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-16 20:05","updated_at":"2025-12-16 22:52","closed_at":"2025-12-16 22:52","blocks":["bv-0kll","bv-3bhq"],"pagerank":0.001985274869031905,"betweenness":0,"eigenvector":0,"hub":0,"authority":1.7833198250397624e-7,"critical_path":5,"in_degree":2,"out_degree":0,"core_number":2,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-u7ay","title":"Robot diff-since auto-enable should not write to stderr","description":"In robot contexts BV_ROBOT=1 can cause --diff-since to auto-enable --robot-diff. That auto-enable path must not emit advisory text to stderr, and related comments should reflect that warnings are suppressed in robot mode.","status":"closed","priority":2,"type":"bug","labels":["robot"],"created_at":"2025-12-17 05:55","updated_at":"2025-12-17 05:55","closed_at":"2025-12-17 05:55","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-ub7","title":"Topological Work-Plan Generator","description":"Leverage the existing DAG analysis to generate linearized, dependency-respecting work plans. This is the highest-value feature because it directly answers the question every developer and AI agent asks: 'What can I actually work on right now?'\n\n## Background \u0026 Motivation\nThe analysis package already computes TopologicalOrder via topo.Sort(). However, this raw ordering isn't directly actionable because:\n1. It includes closed issues\n2. It doesn't filter to 'leaf nodes' (tasks with no open blockers)\n3. It's not exposed via CLI for programmatic access\n\n## Value Proposition\n- For Humans: A 'Smart To-Do' view showing only actionable items eliminates cognitive overhead of scanning blocked tasks.\n- For AI Agents: --robot-plan enables autonomous workflows where agents can request a strictly ordered task list, preventing work on blocked items.\n\n## Technical Approach\n1. Add GetActionableIssues() to analysis package - returns issues where all blocking dependencies are closed\n2. Add GetExecutionPlan() - returns topologically sorted actionable items with parallel tracks identified\n3. CLI flag --robot-plan outputs JSON with execution order\n4. TUI view showing actionable items grouped by parallel tracks\n\n## Success Criteria\n- Agent can request plan and receive valid execution order\n- Plan respects all blocking dependencies\n- Parallel tracks (independent work streams) are identified\n- Zero actionable items shown when all open issues are blocked","status":"closed","priority":0,"type":"epic","labels":["ai-agent","builds-on-existing","high-value"],"created_at":"2025-11-26 23:35","updated_at":"2025-11-27 01:09","closed_at":"2025-11-27 01:09","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-ub7.1","title":"Add GetActionableIssues() to analysis package","description":"Identify issues that can be worked on immediately - those with no open blocking dependencies.\n\n## Algorithm\nfunc (a *Analyzer) GetActionableIssues() []model.Issue:\n  - Skip closed issues\n  - Skip issues with open blockers (only 'blocks' type creates hard deps)\n  - Missing blockers don't block (graceful degradation)\n\n## Key Design Decisions\n1. Only 'blocks' type creates hard dependencies - 'related' and 'parent-child' are informational\n2. Missing blockers don't block - Graceful degradation when referenced issue doesn't exist\n3. Closed issues are never actionable - They're done\n\n## File Changes\n- pkg/analysis/graph.go: Add methods to Analyzer struct\n- pkg/analysis/graph_test.go: Add comprehensive tests\n\n## Acceptance Criteria\n- [ ] Returns only open/in_progress/blocked issues\n- [ ] Correctly identifies issues with no open blockers\n- [ ] Handles missing dependency references gracefully\n- [ ] Handles cycles gracefully\n- [ ] Unit tests cover all edge cases","status":"closed","priority":1,"type":"task","labels":["analysis","core-logic"],"created_at":"2025-11-26 23:37","updated_at":"2025-11-27 00:07","closed_at":"2025-11-27 00:07","blocks":["bv-ub7.2"],"pagerank":0.005931750503836532,"betweenness":0,"eigenvector":0,"hub":0,"authority":4.7854460253878835e-21,"critical_path":3,"in_degree":1,"out_degree":0,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-ub7.2","title":"Add GetExecutionPlan() with parallel track detection","description":"Generate a dependency-respecting execution plan with parallel tracks identified for concurrent work.\n\n## Data Structure\ntype ExecutionPlan struct {\n    Tracks []ExecutionTrack\n    Total  int\n}\n\ntype ExecutionTrack struct {\n    TrackID string\n    Items   []PlanItem\n    Reason  string  // Why these are grouped\n}\n\ntype PlanItem struct {\n    ID          string\n    Title       string\n    Priority    int\n    UnblocksIDs []string  // What becomes actionable when done\n}\n\n## Algorithm\n1. Get actionable issues from GetActionableIssues()\n2. Identify connected components among actionable issues\n3. Within each component, sort by priority then topological order\n4. For each item, compute what it unblocks\n\n## Considerations\n- Parallel Tracks: Independent subgraphs can be worked on concurrently\n- Unblocks Info: Helps prioritize - 'doing X unblocks 5 other tasks'\n- Priority Integration: Within tracks, respect explicit priority\n\n## File Changes\n- pkg/analysis/plan.go: New file with plan generation logic\n- pkg/analysis/plan_test.go: Tests","status":"closed","priority":1,"type":"task","labels":["analysis","core-logic"],"created_at":"2025-11-26 23:37","updated_at":"2025-11-27 00:10","closed_at":"2025-11-27 00:10","blocked_by":["bv-ub7.1"],"blocks":["bv-ub7.3","bv-ub7.4","bv-ub7.5"],"pagerank":0.0052414982053131335,"betweenness":3,"eigenvector":0,"hub":7.890898495503672e-22,"authority":7.629546663534489e-15,"critical_path":2,"in_degree":3,"out_degree":1,"core_number":1,"slack":12,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-ub7.3","title":"Add --robot-plan CLI flag","description":"Expose execution plan via CLI for AI agents and scripts.\n\n## Flag Definition\nrobotPlan := flag.Bool('robot-plan', false, 'Output dependency-respecting execution plan as JSON')\n\n## Output Format\n{\n  'generated_at': '2025-11-26T20:00:00Z',\n  'tracks': [{\n    'track_id': 'track-1',\n    'items': [{\n      'id': 'issue-123',\n      'title': 'Implement feature X',\n      'priority': 1,\n      'unblocks': ['issue-456', 'issue-789']\n    }],\n    'reason': 'Independent work stream focused on auth module'\n  }],\n  'total_actionable': 5,\n  'total_blocked': 12,\n  'summary': {\n    'highest_impact': 'issue-123',\n    'impact_reason': 'Unblocks 3 high-priority tasks'\n  }\n}\n\n## Usage Examples\nbv --robot-plan  # Get full plan\nbv --robot-plan | jq '.tracks[0].items[0]'  # First actionable item\n\n## File Changes\n- cmd/bv/main.go: Add flag parsing and output logic\n\n## Acceptance Criteria\n- [ ] --robot-plan outputs valid JSON\n- [ ] Exit code 0 on success, non-zero on error\n- [ ] Errors go to stderr, plan to stdout\n- [ ] Works with existing filters","status":"closed","priority":1,"type":"task","labels":["ai-agent","cli"],"created_at":"2025-11-26 23:37","updated_at":"2025-11-27 00:12","closed_at":"2025-11-27 00:12","blocked_by":["bv-ub7.2"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":1.2580640962046904e-15,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-ub7.4","title":"Add TUI Actionable view with 'a' keybinding","description":"Provide a focused view showing only items that can be worked on immediately.\n\n## Keybinding\n'a' - Toggle Actionable view (similar to 'b' for board, 'g' for graph)\n\n## View Design\n‚îå‚îÄ ACTIONABLE (5 items) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ Track 1: Auth Module                          ‚îÇ\n‚îÇ ‚îú‚îÄ üî• P0 AUTH-123 Fix login timeout          ‚îÇ\n‚îÇ ‚îÇ      ‚îî‚îÄ Unblocks: AUTH-456, AUTH-789        ‚îÇ\n‚îÇ ‚îî‚îÄ ‚ö° P1 AUTH-124 Add OAuth support          ‚îÇ\n‚îÇ                                               ‚îÇ\n‚îÇ Track 2: API Layer                            ‚îÇ\n‚îÇ ‚îî‚îÄ üîπ P2 API-001 Refactor endpoints          ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n\n## Features\n- Group by track (parallel work streams)\n- Show unblocks count for each item\n- Priority indicators\n- Navigation: j/k for up/down, enter for details\n\n## File Changes\n- pkg/ui/actionable.go: New view component\n- pkg/ui/actionable_test.go: Tests\n- pkg/ui/model.go: Add keybinding and state\n\n## Acceptance Criteria\n- [ ] 'a' key toggles actionable view\n- [ ] Shows items grouped by independent tracks\n- [ ] Displays unblock counts\n- [ ] Navigation works correctly","status":"closed","priority":2,"type":"task","labels":["tui","user-experience"],"created_at":"2025-11-26 23:38","updated_at":"2025-11-27 01:00","closed_at":"2025-11-27 01:00","blocked_by":["bv-ub7.2"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":1.2580640962046904e-15,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-ub7.5","title":"Add comprehensive tests for work plan generation","description":"Ensure work plan generation is correct and handles edge cases.\n\n## Test Cases\n\n### Happy Path\n- [ ] Simple chain: A blocks B blocks C ‚Üí only C is actionable\n- [ ] Parallel chains: A‚ÜíB, C‚ÜíD ‚Üí B and D actionable in separate tracks\n- [ ] Mixed: Some actionable, some blocked\n\n### Edge Cases\n- [ ] Empty issue list ‚Üí empty plan\n- [ ] All issues closed ‚Üí empty plan\n- [ ] All issues blocked by cycles ‚Üí plan may include cycle members\n- [ ] Single issue with no deps ‚Üí one track, one item\n- [ ] Deeply nested chain ‚Üí correct single actionable leaf\n\n### Dependency Edge Cases\n- [ ] Missing blocker reference ‚Üí doesn't block\n- [ ] 'related' type deps ‚Üí don't create blocking\n- [ ] Self-referential dep ‚Üí handled gracefully\n- [ ] Issue blocks itself via chain ‚Üí cycle detection\n\n### Integration Tests\n- [ ] --robot-plan produces valid JSON\n- [ ] Plan respects status filters\n- [ ] Plan updates when issues change\n\n## File Changes\n- pkg/analysis/plan_test.go: Comprehensive unit tests\n- test/e2e/plan_test.go: End-to-end CLI tests\n\n## Acceptance Criteria\n- [ ] 90%+ code coverage on plan generation\n- [ ] All edge cases documented and tested\n- [ ] CI passes with new tests","status":"closed","priority":2,"type":"task","labels":["quality","testing"],"created_at":"2025-11-26 23:38","updated_at":"2025-11-27 01:08","closed_at":"2025-11-27 01:08","blocked_by":["bv-ub7.2"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":1.2580640962046904e-15,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-ubra","title":"[SUB-EPIC] Unit Tests Without Mocks - pkg/search \u0026 pkg/correlation","description":"Add unit tests for untested files in search and correlation packages.\n\n## pkg/search Files to Test\n1. config.go - Search configuration loading and validation\n2. documents.go - Document representation and parsing\n3. embedder.go - Base embedder interface and factory\n\n## pkg/correlation Files to Test\n1. gitlog.go - Git log parsing wrapper (recently added)\n\n## Testing Approach\n- Test config loading with various YAML inputs\n- Test document parsing with real issue data\n- Test embedder interface contracts\n- Test gitlog parsing with mock git output strings\n- Use concrete test data throughout\n\n## Success Criteria\n- 100% coverage for config.go, documents.go\n- Interface contract tests for embedder.go\n- Comprehensive gitlog parsing tests\n- No mock frameworks used","status":"closed","priority":2,"type":"epic","labels":null,"created_at":"2025-12-16 20:04","updated_at":"2025-12-16 23:36","closed_at":"2025-12-16 23:36","blocked_by":["bv-i5st","bv-kjna","bv-ewhp","bv-p0bm"],"blocks":["bv-gv9v","bv-q923"],"pagerank":0.002073768421622436,"betweenness":8,"eigenvector":0,"hub":5.295492339725605e-14,"authority":9.342886875136574e-8,"critical_path":3,"in_degree":2,"out_degree":4,"core_number":2,"slack":11,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-ufd","title":"Context Packs \u0026 Recipes System","description":"Implement named workflow presets ('recipes') that bundle filters, layouts, and exports into one-command operations. This dramatically simplifies common workflows for both humans and AI agents.\n\n## Background \u0026 Motivation\nUsers repeatedly perform the same sequences: 'Show me blocked high-priority items' or 'Export a release changelog'. Currently this requires remembering multiple flags. Recipes encode these patterns.\n\n## Value Proposition\n- For Humans: 'bv --recipe triage' replaces 'bv --status open,blocked --priority 0,1 --sort priority'\n- For AI Agents: Recipes provide semantic entry points - 'triage mode' vs 'release mode' vs 'dependency analysis mode'\n\n## Technical Approach\n1. Define recipe schema (YAML)\n2. Embed sensible default recipes\n3. Allow user-defined recipes in .bv/recipes.yaml\n4. CLI: bv --recipe \u003cname\u003e or bv -r \u003cname\u003e\n5. TUI: Recipe picker with descriptions\n\n## Built-in Recipes\n- triage: Open/blocked issues, sorted by priority\n- release-cut: Recently closed issues for changelog\n- blocked-review: All blocked items with blocker info\n- dependency-risk: High betweenness/PageRank items\n- quick-wins: Low-priority, no-dependency items\n- stale: Items not updated in 14+ days","status":"closed","priority":1,"type":"epic","labels":["ai-agent","developer-experience","workflow"],"created_at":"2025-11-26 23:35","updated_at":"2025-11-27 01:15","closed_at":"2025-11-27 01:15","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-ufd.1","title":"Define recipe schema and configuration structure","description":"Design the YAML schema for recipe definitions that is both human-writable and machine-parseable.\n\n## Schema Design\nrecipes:\n  triage:\n    description: 'Focus on urgent open/blocked items'\n    filters:\n      status: [open, blocked]\n      priority_max: 2\n    sort:\n      by: priority\n      direction: asc\n    view: board\n    export: null\n\n## Schema Fields\n- description: Human-readable explanation\n- filters: Issue filtering criteria\n- sort: Sort order\n- view: Which view to activate\n- export: Optional auto-export configuration\n- metrics: Optional metric-based filtering\n\n## File Changes\n- pkg/recipe/types.go: Schema types\n- pkg/recipe/schema.go: Validation logic\n\n## Acceptance Criteria\n- [ ] Schema supports all current filter options\n- [ ] Relative time expressions work (14d, 1w, etc.)\n- [ ] Validation catches invalid recipes at load time","status":"closed","priority":1,"type":"task","labels":["configuration","design"],"created_at":"2025-11-26 23:38","updated_at":"2025-11-27 00:16","closed_at":"2025-11-27 00:16","blocks":["bv-ufd.2","bv-ufd.3"],"pagerank":0.006120001956812423,"betweenness":0,"eigenvector":0,"hub":0,"authority":3.920237383997754e-17,"critical_path":3,"in_degree":2,"out_degree":0,"core_number":1,"slack":12,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-ufd.2","title":"Implement recipe loader with embedded defaults","description":"Load recipes from embedded defaults and user configuration, with proper merging.\n\n## Loading Order (later overrides earlier)\n1. Embedded defaults (compiled into binary)\n2. User config at ~/.config/bv/recipes.yaml (global)\n3. Project config at .bv/recipes.yaml (local)\n\n## Embedded Defaults\nUse Go embed to include default recipes:\n//go:embed defaults/recipes.yaml\nvar defaultRecipes []byte\n\n## Merge Strategy\n- User recipes with same name override defaults completely\n- User can disable a default recipe: triage: null\n- Unknown keys in user config generate warnings\n\n## Discovery Endpoint\nfunc (l *Loader) ListRecipes() []RecipeSummary\nEnables --robot-recipes for AI agent discovery.\n\n## File Changes\n- pkg/recipe/loader.go: Loading and merging logic\n- pkg/recipe/defaults/recipes.yaml: Embedded defaults\n- pkg/recipe/loader_test.go: Tests","status":"closed","priority":1,"type":"task","labels":["configuration","core-logic"],"created_at":"2025-11-26 23:38","updated_at":"2025-11-27 00:18","closed_at":"2025-11-27 00:18","blocked_by":["bv-ufd.1"],"blocks":["bv-ufd.4","bv-ufd.5"],"pagerank":0.00398649154786206,"betweenness":2,"eigenvector":0,"hub":6.464224047516608e-18,"authority":3.920237383997754e-17,"critical_path":2,"in_degree":2,"out_degree":1,"core_number":1,"slack":12,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-ufd.3","title":"Create built-in recipe library","description":"Provide a curated set of immediately useful recipes.\n\n## Recipes to Implement\n\n### 1. triage\ndescription: Urgent items needing attention\nfilters: status=[open,blocked], priority_max=2\nview: board\n\n### 2. release-cut\ndescription: Recently closed items for changelog\nfilters: status=[closed], updated_since=14d\nview: list\n\n### 3. blocked-review\ndescription: All blocked items with blocker info\nfilters: status=[blocked]\nview: list, show_blockers=true\n\n### 4. dependency-risk\ndescription: High-impact bottleneck nodes\nfilters: status=[open,in_progress]\nview: insights, insights_panel=bottlenecks\n\n### 5. quick-wins\ndescription: Easy items with no blockers\nfilters: status=[open], has_blockers=false\nview: list\n\n### 6. stale\ndescription: Items not updated in 14+ days\nfilters: status=[open,in_progress], updated_before=14d\nview: list\n\n### 7. my-work\ndescription: Items assigned to current user\nfilters: assignee=$USER\nview: board\n\n## File Changes\n- pkg/recipe/defaults/recipes.yaml","status":"closed","priority":2,"type":"task","labels":["content","defaults"],"created_at":"2025-11-26 23:39","updated_at":"2025-11-27 00:19","closed_at":"2025-11-27 00:19","blocked_by":["bv-ufd.1"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":6.464224047516608e-18,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":13,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-ufd.4","title":"Add --recipe CLI flag and --robot-recipes discovery","description":"Expose recipes via command-line interface.\n\n## Flags\n--recipe NAME or -r NAME: Apply named recipe\n--robot-recipes: List available recipes as JSON\n\n## --robot-recipes Output\n{\n  'recipes': [\n    {'name': 'triage', 'description': 'Urgent items needing attention', 'source': 'builtin'},\n    {'name': 'my-custom', 'description': 'Custom team workflow', 'source': 'project'}\n  ]\n}\n\n## Recipe Application\nWhen --recipe triage is used:\n1. Load recipe definition\n2. Apply filters to issue list\n3. Apply sort order\n4. Set initial view mode\n5. If export specified, run export and exit\n\n## Error Handling\n- Unknown recipe name: list available recipes and exit 1\n- Invalid recipe config: show validation error\n\n## File Changes\n- cmd/bv/main.go: Flag parsing and recipe application\n\n## Acceptance Criteria\n- [ ] --recipe triage applies triage recipe\n- [ ] -r triage shorthand works\n- [ ] --robot-recipes lists all available recipes\n- [ ] Unknown recipe shows helpful error","status":"closed","priority":1,"type":"task","labels":["ai-agent","cli"],"created_at":"2025-11-26 23:39","updated_at":"2025-11-27 00:55","closed_at":"2025-11-27 00:55","blocked_by":["bv-ufd.2"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":6.464224047516608e-18,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-ufd.5","title":"Add TUI recipe picker overlay","description":"Allow users to browse and apply recipes from within the TUI.\n\n## Keybinding\n'R' (shift-r) - Open recipe picker overlay\n\n## Overlay Design\n‚îå‚îÄ Select Recipe ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ  \u003e triage                                   ‚îÇ\n‚îÇ    Urgent items needing attention           ‚îÇ\n‚îÇ                                             ‚îÇ\n‚îÇ    release-cut                              ‚îÇ\n‚îÇ    Recently closed items for changelog      ‚îÇ\n‚îÇ                                             ‚îÇ\n‚îÇ j/k: navigate ‚Ä¢ enter: apply ‚Ä¢ esc: cancel  ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n\n## Interaction\n- j/k or up/down to navigate\n- enter to apply selected recipe\n- esc to cancel\n- Applying recipe changes filters, sort, and view\n\n## Footer Update\nWhen recipe is active, show: 'Recipe: triage | ...'\n\n## File Changes\n- pkg/ui/recipe_picker.go: Picker component\n- pkg/ui/model.go: Add keybinding and state","status":"closed","priority":2,"type":"task","labels":["tui","user-experience"],"created_at":"2025-11-26 23:39","updated_at":"2025-11-27 01:14","closed_at":"2025-11-27 01:14","blocked_by":["bv-ufd.2"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":6.464224047516608e-18,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-ufsr","title":"E2E: GitHub Pages deployment end-to-end","description":"Test complete GitHub Pages deployment workflow.\n\n## Deployment Workflow\n1. **Pre-flight Checks**\n   - gh CLI installed and authenticated\n   - Repository access verified\n   - Branch permissions checked\n\n2. **Build Phase**\n   - Static HTML generation\n   - Search index creation\n   - Graph visualization embedding\n   - Asset bundling\n\n3. **Deploy Phase**\n   - Branch creation/checkout\n   - File copying\n   - Commit creation\n   - Push to remote\n\n4. **Post-deploy Verification**\n   - Pages URL accessible\n   - Content renders correctly\n   - Search functionality works\n   - Graphs display properly\n\n## Test Scenarios\n- Fresh deployment to new branch\n- Update existing deployment\n- Deployment with custom domain\n- Deployment with base path\n\n## Mock Requirements\n- Mock gh CLI for unit tests\n- Real gh CLI for integration tests\n- Test repo for deployments\n\n## Success Criteria\n- Deployment completes without error\n- Site accessible at expected URL\n- All features functional\n- Clean rollback on failure","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-16 20:09","updated_at":"2025-12-17 00:50","closed_at":"2025-12-17 00:50","blocked_by":["bv-focq"],"blocks":["bv-hdu4"],"pagerank":0.0016726975206033255,"betweenness":0,"eigenvector":0,"hub":7.032456132708617e-11,"authority":3.1573158850443083e-10,"critical_path":3,"in_degree":1,"out_degree":1,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-ul1l","title":"[SUB-EPIC] Unit Tests Without Mocks - pkg/ui Rendering Components","description":"Add comprehensive unit tests for the 7 untested UI rendering files in pkg/ui.\n\n## Files to Test (all currently have 0% coverage)\n1. attention.go - Attention scoring view rendering\n2. flow_matrix.go - Label-to-label flow matrix display\n3. item.go - List item abstraction\n4. label_dashboard.go - Label dashboard view\n5. semantic_search.go - Search UI integration\n6. sprint_view.go - Sprint view layout\n7. workspace_repos.go - Repository selection UI\n\n## Testing Approach\n- Use concrete Bubble Tea test patterns\n- Test View() output strings contain expected elements\n- Test Update() state transitions\n- Use snapshot testing for complex renders\n- Test keyboard navigation handlers\n\n## Success Criteria\n- 90%+ line coverage for all 7 files\n- View output validated for all states\n- State transitions tested\n- Keyboard handlers verified","status":"closed","priority":2,"type":"epic","labels":null,"created_at":"2025-12-16 20:04","updated_at":"2025-12-16 23:31","closed_at":"2025-12-16 23:31","blocked_by":["bv-wpmc","bv-qcgs","bv-i10k","bv-fou9","bv-ehsl","bv-bw7z","bv-3bez"],"blocks":["bv-gv9v","bv-q923"],"pagerank":0.002073768421622436,"betweenness":14,"eigenvector":0,"hub":7.645413464514362e-11,"authority":9.342886875136574e-8,"critical_path":3,"in_degree":2,"out_degree":7,"core_number":2,"slack":11,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-uq1t","title":"Fix performance issues: O(n¬≤) sorts, per-call regex/map allocation, determinism bugs","status":"closed","priority":2,"type":"bug","labels":null,"created_at":"2025-12-16 20:10","updated_at":"2025-12-16 20:10","closed_at":"2025-12-16 20:10","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-uqoh","title":"GitHub Issue Triage - Community Bug Fixes (December 2025)","description":"## Overview\n\nThis epic tracks all bugs and feature requests identified from GitHub Issues (#5, #6, #7, #8, #12, #13, #14, #17) and PRs (#15, #16, #18) submitted by the community in late 2025. Each issue has been independently verified through code analysis.\n\n## Background \u0026 Context\n\nThe bv (Beads Viewer) project received valuable community feedback identifying real bugs affecting user experience. While we don't accept outside code contributions, this feedback is essential for improving the tool.\n\n### Why This Matters\n\nbv is designed as an AI sidecar tool - a fast, reliable companion for issue triage. These bugs undermine that mission:\n\n1. **Data Integrity Issues** - Showing stale/wrong data (#5) breaks user trust\n2. **UX Friction** - Focus isolation bug (#12) affects every user session\n3. **Feature Gaps** - Missing labels (#14) hides critical info\n4. **Accessibility** - Light mode issues (#17) blocks users entirely\n5. **Discoverability** - Help overlay limitations (#16) hurt onboarding\n\n### Scope\n\n**In Scope:** All verified bugs from community reports, related improvements, comprehensive test coverage.\n\n**Out of Scope:** Major new features, architecture changes beyond fixes, performance optimizations.\n\n### Success Criteria\n\n1. All P0/P1 bugs resolved with tests\n2. No regression in existing functionality\n3. Community reporters can verify fixes\n\n### Key Files\n\n- pkg/ui/model.go - Focus handling, detail view, help overlay\n- pkg/loader/loader.go - File selection, priority order\n- pkg/ui/theme.go - Color definitions\n- install.sh - Bash compatibility\n\n### References\n\nGitHub Issues: #5, #6, #7, #8, #12, #14, #17\nGitHub PRs: #15, #16, #18 (closed, fixes internal)","status":"closed","priority":1,"type":"epic","labels":null,"created_at":"2025-12-15 23:50","updated_at":"2025-12-16 16:19","closed_at":"2025-12-16 16:19","blocked_by":["bv-hmkz","bv-mvvu","bv-3ht4","bv-f103","bv-3fcg","bv-43js","bv-5h6q","bv-g4gs","bv-zaxb","bv-3qi5"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":1.5909046587062613e-8,"authority":0,"critical_path":1,"in_degree":0,"out_degree":10,"core_number":2,"slack":12,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-ut9x","title":"E2E: Performance regression test suite","description":"Automated performance regression detection.\n\n## Metrics to Track\n1. **Startup Time**\n   - Cold start (no cache)\n   - Warm start (cached)\n   - With various data sizes\n\n2. **Analysis Time**\n   - Phase 1 completion\n   - Phase 2 completion\n   - Individual algorithm times\n\n3. **Robot Command Time**\n   - Each robot command latency\n   - JSON serialization time\n   - Output size\n\n4. **Memory Usage**\n   - Peak memory during analysis\n   - Steady-state memory\n   - Memory per 1000 issues\n\n## Baseline Management\n- Store baseline metrics in repo\n- Compare against baseline in CI\n- Alert on regression \u003e 20%\n- Track trends over time\n\n## Implementation\n- Extend benchmark.sh\n- Add CI integration\n- Create baseline files\n- Implement regression detection\n\n## Test Data\n- 100 issues (small)\n- 1000 issues (medium)\n- 10000 issues (large)\n- Pathological graphs","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-16 20:08","updated_at":"2025-12-17 00:38","closed_at":"2025-12-17 00:38","blocks":["bv-syeo"],"pagerank":0.0017054007352105605,"betweenness":0,"eigenvector":0,"hub":0,"authority":3.263220574971611e-11,"critical_path":3,"in_degree":1,"out_degree":0,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-utky","title":"Port Betweenness Centrality (exact + approximate) to Rust WASM","description":"# Port Betweenness Centrality to Rust WASM\n\n## Context\nBetweenness centrality measures how often a node lies on shortest paths between other nodes. High betweenness = bottleneck that many paths flow through. We need both exact (Brandes) and approximate (sampling) versions.\n\n## Go Implementation Reference\n```go\n// Exact: network.Betweenness(a.g) - O(V*E)\n// Approximate: ApproxBetweenness(a.g, sampleSize) - O(k*E)\n```\n\n## Rust Implementation\n\n### betweenness.rs\n```rust\nuse crate::graph::DiGraph;\nuse std::collections::VecDeque;\n\n/// Compute exact betweenness centrality using Brandes' algorithm.\n/// Complexity: O(V*E) for unweighted graphs.\npub fn betweenness(graph: \u0026DiGraph) -\u003e Vec\u003cf64\u003e {\n    let n = graph.node_count();\n    if n == 0 {\n        return Vec::new();\n    }\n    \n    let mut bc = vec![0.0; n];\n    \n    // Run single-source betweenness from each node\n    for s in 0..n {\n        single_source_betweenness(graph, s, \u0026mut bc);\n    }\n    \n    // Normalize (for undirected would divide by 2)\n    bc\n}\n\n/// Compute approximate betweenness using k pivot samples.\n/// Error: O(1/sqrt(k)) - with k=100, ~10% error in ranking.\npub fn betweenness_approx(graph: \u0026DiGraph, sample_size: usize) -\u003e Vec\u003cf64\u003e {\n    let n = graph.node_count();\n    if n == 0 {\n        return Vec::new();\n    }\n    \n    // For small graphs, use exact algorithm\n    if sample_size \u003e= n {\n        return betweenness(graph);\n    }\n    \n    let mut bc = vec![0.0; n];\n    \n    // Sample k random pivot nodes\n    let pivots = sample_nodes(n, sample_size);\n    \n    for \u0026pivot in \u0026pivots {\n        single_source_betweenness(graph, pivot, \u0026mut bc);\n    }\n    \n    // Scale up: BC_approx = BC_partial * (n / k)\n    let scale = n as f64 / sample_size as f64;\n    for score in \u0026mut bc {\n        *score *= scale;\n    }\n    \n    bc\n}\n\n/// Single-source betweenness contribution (Brandes' algorithm).\nfn single_source_betweenness(graph: \u0026DiGraph, source: usize, bc: \u0026mut [f64]) {\n    let n = graph.node_count();\n    \n    // BFS data structures\n    let mut stack: Vec\u003cusize\u003e = Vec::with_capacity(n);\n    let mut pred: Vec\u003cVec\u003cusize\u003e\u003e = vec![Vec::new(); n];\n    let mut sigma = vec![0.0; n];  // Number of shortest paths\n    let mut dist = vec![-1i32; n]; // Distance from source\n    let mut delta = vec![0.0; n];  // Dependency accumulator\n    \n    // BFS from source\n    sigma[source] = 1.0;\n    dist[source] = 0;\n    let mut queue = VecDeque::new();\n    queue.push_back(source);\n    \n    while let Some(v) = queue.pop_front() {\n        stack.push(v);\n        \n        for \u0026w in graph.successors(v) {\n            // First visit to w?\n            if dist[w] \u003c 0 {\n                dist[w] = dist[v] + 1;\n                queue.push_back(w);\n            }\n            \n            // Is v on a shortest path to w?\n            if dist[w] == dist[v] + 1 {\n                sigma[w] += sigma[v];\n                pred[w].push(v);\n            }\n        }\n    }\n    \n    // Back-propagation of dependencies\n    while let Some(w) = stack.pop() {\n        for \u0026v in \u0026pred[w] {\n            let coeff = sigma[v] / sigma[w] * (1.0 + delta[w]);\n            delta[v] += coeff;\n        }\n        \n        if w != source {\n            bc[w] += delta[w];\n        }\n    }\n}\n\n/// Sample k unique indices from 0..n using Fisher-Yates.\nfn sample_nodes(n: usize, k: usize) -\u003e Vec\u003cusize\u003e {\n    use std::time::{SystemTime, UNIX_EPOCH};\n    \n    let seed = SystemTime::now()\n        .duration_since(UNIX_EPOCH)\n        .map(|d| d.as_nanos() as u64)\n        .unwrap_or(42);\n    \n    let mut indices: Vec\u003cusize\u003e = (0..n).collect();\n    let mut rng_state = seed;\n    \n    // Simple LCG for deterministic-ish sampling\n    let lcg = |state: \u0026mut u64| -\u003e usize {\n        *state = state.wrapping_mul(6364136223846793005).wrapping_add(1);\n        (*state \u003e\u003e 33) as usize\n    };\n    \n    for i in 0..k.min(n) {\n        let j = i + lcg(\u0026mut rng_state) % (n - i);\n        indices.swap(i, j);\n    }\n    \n    indices.truncate(k);\n    indices\n}\n\n/// Recommend sample size based on graph size.\npub fn recommend_sample_size(node_count: usize) -\u003e usize {\n    match node_count {\n        0..=99 =\u003e node_count,      // Small: exact\n        100..=499 =\u003e 50.max(node_count / 5), // Medium: 20%\n        500..=1999 =\u003e 100,         // Large: fixed\n        _ =\u003e 200,                  // XL: larger fixed\n    }\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    \n    #[test]\n    fn test_betweenness_line() {\n        // a ‚Üí b ‚Üí c\n        // b has highest betweenness (on path a‚Üíc)\n        let mut graph = DiGraph::new();\n        let a = graph.add_node(\"a\");\n        let b = graph.add_node(\"b\");\n        let c = graph.add_node(\"c\");\n        graph.add_edge(a, b);\n        graph.add_edge(b, c);\n        \n        let bc = betweenness(\u0026graph);\n        assert!(bc[b] \u003e bc[a]);\n        assert!(bc[b] \u003e bc[c]);\n    }\n    \n    #[test]\n    fn test_betweenness_star() {\n        // Hub with 4 spokes: all paths go through hub\n        let mut graph = DiGraph::new();\n        let hub = graph.add_node(\"hub\");\n        let s1 = graph.add_node(\"s1\");\n        let s2 = graph.add_node(\"s2\");\n        let s3 = graph.add_node(\"s3\");\n        let s4 = graph.add_node(\"s4\");\n        graph.add_edge(s1, hub);\n        graph.add_edge(s2, hub);\n        graph.add_edge(hub, s3);\n        graph.add_edge(hub, s4);\n        \n        let bc = betweenness(\u0026graph);\n        // Hub should have highest betweenness\n        assert!(bc[hub] \u003e bc[s1]);\n        assert!(bc[hub] \u003e bc[s2]);\n    }\n}\n```\n\n### WASM Binding\n```rust\n#[wasm_bindgen]\nimpl DiGraph {\n    pub fn betweenness(\u0026self) -\u003e Vec\u003cf64\u003e {\n        algorithms::betweenness::betweenness(self)\n    }\n    \n    pub fn betweenness_approx(\u0026self, sample_size: usize) -\u003e Vec\u003cf64\u003e {\n        algorithms::betweenness::betweenness_approx(self, sample_size)\n    }\n}\n```\n\n## Acceptance Criteria\n- [ ] Exact betweenness matches Go implementation\n- [ ] Approximate version produces reasonable rankings\n- [ ] sample_size \u003e= n falls back to exact\n- [ ] Performance: exact \u003c100ms for 500 nodes\n- [ ] Performance: approx(100) \u003c20ms for 2000 nodes\n- [ ] Unit tests cover line, star, cycle graphs","notes":"IMPROVEMENT: Replace SystemTime::now() seeding with getrandom crate for better randomness in WASM. Add getrandom = { version = \"0.2\", features = [\"js\"] } to Cargo.toml. Or add optional seed parameter for deterministic testing.","status":"closed","priority":2,"type":"task","labels":["algorithm","phase-2","wasm"],"created_at":"2025-12-15 23:33","updated_at":"2025-12-16 00:28","closed_at":"2025-12-16 00:28","blocked_by":["bv-bxoe"],"blocks":["bv-y7a0"],"pagerank":0.0018889407873369957,"betweenness":0,"eigenvector":0,"hub":0.000008837350028490512,"authority":0.000010677870334373396,"critical_path":4,"in_degree":1,"out_degree":1,"core_number":2,"slack":9,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-uun","title":"Implement dashboard view component for static viewer","description":"# Implement Dashboard View Component for Static Viewer\n\n## Context\nThe dashboard is the landing page of the static site. It shows key metrics, health status, and top recommendations at a glance.\n\n## Requirements\n\n### Dashboard Layout\n```\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ  [Logo] Project Issues Dashboard              [Dark Mode] [‚ãÆ]   ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê‚îÇ\n‚îÇ  ‚îÇ    Open     ‚îÇ ‚îÇ  Actionable ‚îÇ ‚îÇ   Blocked   ‚îÇ ‚îÇ In Progress ‚îÇ‚îÇ\n‚îÇ  ‚îÇ     85      ‚îÇ ‚îÇ     34      ‚îÇ ‚îÇ     51      ‚îÇ ‚îÇ      4      ‚îÇ‚îÇ\n‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ  Top Recommendations                                             ‚îÇ\n‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ\n‚îÇ  ‚îÇ 1. bv-99 Labels View: Label-Centric Analysis    [P1][epic]‚îÇ  ‚îÇ\n‚îÇ  ‚îÇ    Score: 0.50 ‚Ä¢ Unblocks 3 items                         ‚îÇ  ‚îÇ\n‚îÇ  ‚îÇ    ‚ñ∏ High centrality ‚Ä¢ High priority                      ‚îÇ  ‚îÇ\n‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ\n‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ\n‚îÇ  ‚îÇ 2. bv-103 Implement composite health score      [P2][task]‚îÇ  ‚îÇ\n‚îÇ  ‚îÇ    Score: 0.32 ‚Ä¢ Critical bottleneck                      ‚îÇ  ‚îÇ\n‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ  Quick Wins                        Blockers to Clear            ‚îÇ\n‚îÇ  ‚îú bv-126 Add keyboard shortcuts   ‚îú bv-99 Labels View epic    ‚îÇ\n‚îÇ  ‚îú bv-128 Document label analysis  ‚îú bv-102 Basic velocity calc‚îÇ\n‚îÇ  ‚îî bv-164 Velocity anomaly detect  ‚îî bv-110 CrossLabelFlow     ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ  By Status              By Type              By Priority        ‚îÇ\n‚îÇ  ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñë‚ñë‚ñë Open 48%    ‚ñ†‚ñ†‚ñ† Bug 15%          ‚ñ† P0  2%           ‚îÇ\n‚îÇ  ‚ñ†‚ñ†‚ñ†‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë Prog 18%    ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ† Task 45%       ‚ñ†‚ñ†‚ñ† P1 18%         ‚îÇ\n‚îÇ  ‚ñ†‚ñ†‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë Block 12%   ‚ñ†‚ñ†‚ñ†‚ñ† Feature 30%     ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ† P2 55%       ‚îÇ\n‚îÇ  ‚ñ†‚ñ†‚ñ†‚ñ†‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë Close 22%   ‚ñ†‚ñ† Epic 10%          ‚ñ†‚ñ† P3 15%          ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n```\n\n### Data Sources\n- Stats: from meta.json and computed from issues.json\n- Recommendations: from triage.json.recommendations\n- Quick Wins: from triage.json.quick_wins\n- Blockers to Clear: from triage.json.blockers_to_clear\n\n### Alpine.js Component\n```javascript\nfunction dashboardView() {\n  return {\n    get stats() {\n      const issues = Alpine.store('app').issues;\n      return {\n        open: issues.filter(i =\u003e i.status === 'open').length,\n        actionable: Alpine.store('app').triage?.quick_ref?.actionable_count || 0,\n        blocked: issues.filter(i =\u003e i.status === 'blocked').length,\n        inProgress: issues.filter(i =\u003e i.status === 'in_progress').length\n      };\n    },\n    \n    get topPicks() {\n      return Alpine.store('app').triage?.quick_ref?.top_picks || [];\n    },\n    \n    get quickWins() {\n      return Alpine.store('app').triage?.quick_wins?.slice(0, 5) || [];\n    },\n    \n    get blockersToClose() {\n      return Alpine.store('app').triage?.blockers_to_clear?.slice(0, 5) || [];\n    },\n    \n    navigateToIssue(id) {\n      window.location.hash = `/issue/${id}`;\n    }\n  };\n}\n```\n\n### Styling\n- Stat cards: Large numbers, subtle backgrounds, hover effects\n- Recommendation cards: Click to navigate, show score visually (bar/badge)\n- Charts: Simple CSS bar charts (no D3/Chart.js needed)\n- Responsive: Stack cards on mobile\n\n### Animations\n- Fade in on load\n- Number count-up animation (optional, progressive enhancement)\n- Hover states on interactive elements\n\n## Acceptance Criteria\n- [ ] Dashboard shows all key metrics\n- [ ] Top recommendations are clickable\n- [ ] Quick wins and blockers sections populated\n- [ ] Distribution charts render correctly\n- [ ] Works on mobile (responsive)\n- [ ] Dark mode styling complete\n- [ ] Keyboard navigation (tab through cards)\n\n## Design Notes\n- Keep it information-dense but scannable\n- Use color consistently with bv TUI conventions\n- Avoid gratuitous animations that slow comprehension","status":"closed","priority":2,"type":"task","labels":["phase-2","static-pages"],"created_at":"2025-12-15 23:06","updated_at":"2025-12-16 03:19","closed_at":"2025-12-16 03:19","blocked_by":["bv-jdl","bv-w97"],"blocks":["bv-awl","bv-gv7","bv-y5i"],"pagerank":0.002905616992104491,"betweenness":3,"eigenvector":0,"hub":0.00013573598174365005,"authority":0.0002389169371777134,"critical_path":4,"in_degree":3,"out_degree":2,"core_number":3,"slack":9,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-uvxe","title":"Add visual cycle detection and highlighting","description":"# Visual Cycle Detection and Highlighting\n\n## Context\nCycles (circular dependencies) are one of the most important problems to spot. Make them visually obvious.\n\n## Requirements\n\n### 1. Detect Cycles via WASM\n```javascript\nfunction detectCycles() {\n    const cyclesJson = GRAPH.detect_cycles(100); // max 100 cycles\n    return JSON.parse(cyclesJson);\n}\n```\n\n### 2. Visual Cycle Highlighting\n```javascript\nfunction highlightCycles(cycles) {\n    // Collect all nodes/edges in cycles\n    const cycleNodes = new Set();\n    const cycleEdges = new Set();\n    \n    cycles.forEach(cycle =\u003e {\n        cycle.forEach((node, i) =\u003e {\n            cycleNodes.add(node);\n            const next = cycle[(i + 1) % cycle.length];\n            cycleEdges.add(`${node}-\u003e${next}`);\n        });\n    });\n    \n    // Red glow for cycle nodes\n    Graph.nodeColor(node =\u003e \n        cycleNodes.has(NODE_MAP.get(node.id)) \n            ? '#f85149' \n            : statusColors[node.status]\n    );\n    \n    // Red, thick, animated edges for cycle edges\n    Graph.linkColor(link =\u003e \n        cycleEdges.has(`${link.source.id}-\u003e${link.target.id}`)\n            ? '#f85149'\n            : '#30363d'\n    );\n    Graph.linkWidth(link =\u003e\n        cycleEdges.has(`${link.source.id}-\u003e${link.target.id}`)\n            ? 3\n            : 1\n    );\n}\n```\n\n### 3. Cycle Navigator\nWhen multiple cycles exist, provide a navigator:\n```html\n\u003cdiv class=\"cycle-navigator\" x-show=\"cycles.length \u003e 0\"\u003e\n    \u003cspan\u003eCycle \u003cspan x-text=\"currentCycle + 1\"\u003e\u003c/span\u003e of \u003cspan x-text=\"cycles.length\"\u003e\u003c/span\u003e\u003c/span\u003e\n    \u003cbutton @click=\"prevCycle()\"\u003e‚Üê\u003c/button\u003e\n    \u003cbutton @click=\"nextCycle()\"\u003e‚Üí\u003c/button\u003e\n    \u003cdiv class=\"cycle-path\" x-text=\"formatCyclePath(cycles[currentCycle])\"\u003e\u003c/div\u003e\n\u003c/div\u003e\n```\n\n### 4. Zoom to Cycle\nButton to zoom the viewport to show just the current cycle:\n```javascript\nfunction zoomToCycle(cycle) {\n    const nodes = cycle.map(id =\u003e graphData.nodes.find(n =\u003e n.id === id));\n    const bounds = computeBounds(nodes);\n    Graph.zoomToFit(400, 50, n =\u003e cycle.includes(n.id));\n}\n```\n\n### 5. Break Suggestion Overlay\nFor each edge in cycle, show 'break' button that highlights what would change:\n```javascript\nfunction showBreakSuggestion(fromId, toId) {\n    // Call WASM cycle break suggestions\n    const suggestions = GRAPH.cycle_break_suggestions(10);\n    // Highlight the suggested edge with special styling\n}\n```\n\n## Acceptance Criteria\n- [ ] Cycles detected on load (if any)\n- [ ] Cycle nodes/edges highlighted in red\n- [ ] Cycle navigator for multiple cycles\n- [ ] Zoom to cycle works\n- [ ] Break suggestions shown\n- [ ] Clear indicator when no cycles exist","status":"closed","priority":2,"type":"task","labels":["phase-2","visualization","wasm"],"created_at":"2025-12-15 23:57","updated_at":"2025-12-16 15:02","closed_at":"2025-12-16 15:02","blocked_by":["bv-jndd","bv-xg92"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.0000026863447015114748,"authority":0,"critical_path":1,"in_degree":0,"out_degree":2,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-vcua","title":"Fix AGENTS.md label analysis examples to match robot JSON schema","description":"AGENTS.md label analysis snippets currently use jq paths like `.labels[]` / `.health`, but the actual robot outputs wrap these under `.results` (e.g. `.results.labels`, `.results.summaries`). This can mislead agents following the cookbook.\n\nAcceptance:\n- Update the label example jq commands in `AGENTS.md` to match current output schema for:\n  - `bv --robot-label-health`\n  - `bv --robot-label-health \u003clabel\u003e` (deep dive)\n  - `bv --robot-label-flow`\n- Keep the rest of the instructions unchanged.\n","notes":"Updated `AGENTS.md` label-analysis examples to match current robot JSON schema:\n- `--robot-label-health` examples now use `.results.labels[...]`\n- label ‚Äúdeep dive‚Äù uses jq select on `.results.labels` instead of unsupported positional arg\n- `--robot-label-flow` example now uses `.flow.bottleneck_labels`.\n","status":"closed","priority":3,"type":"task","labels":["docs","robot"],"created_at":"2025-12-16 18:42","updated_at":"2025-12-16 18:44","closed_at":"2025-12-16 18:44","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-vqym","title":"Fix govulncheck findings (Go 1.25.5 + x/net bump)","description":"govulncheck (via: go run golang.org/x/vuln/cmd/govulncheck@latest ./...) reports:\n- GO-2025-4175 + GO-2025-4155 in stdlib crypto/x509 fixed in go1.25.5 (current toolchain: go1.25.4)\n- GO-2025-3595 in golang.org/x/net fixed in v0.38.0 (current v0.33.0)\n\nAcceptance:\n- Add toolchain directive go1.25.5 and update CI to use Go 1.25.5.\n- Bump golang.org/x/net to at least v0.38.0 (and tidy).\n- go test ./... passes.\n- govulncheck scan no longer flags these vulnerabilities.","status":"closed","priority":1,"type":"bug","labels":["dependencies","security"],"assignee":"BrownBear","created_at":"2025-12-17 05:43","updated_at":"2025-12-17 05:46","closed_at":"2025-12-17 05:46","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-vt0","title":"Implement insights view with graph metrics visualization","description":"# Implement Insights View with Graph Metrics Visualization\n\n## Context\nThe insights view displays the pre-computed graph analysis: bottlenecks, keystones, critical paths, and advanced metrics. This helps users understand project structure without running analysis themselves.\n\n## Requirements\n\n### Layout\n```\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ  Graph Insights                                                 ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê            ‚îÇ\n‚îÇ  ‚îÇ Bottlenecks          ‚îÇ  ‚îÇ Keystones            ‚îÇ            ‚îÇ\n‚îÇ  ‚îÇ (High Betweenness)   ‚îÇ  ‚îÇ (Critical Path)      ‚îÇ            ‚îÇ\n‚îÇ  ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ  ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ            ‚îÇ\n‚îÇ  ‚îÇ 1. bv-103   0.67     ‚îÇ  ‚îÇ 1. bv-99     depth:7 ‚îÇ            ‚îÇ\n‚îÇ  ‚îÇ 2. bv-110   0.45     ‚îÇ  ‚îÇ 2. bv-103    depth:4 ‚îÇ            ‚îÇ\n‚îÇ  ‚îÇ 3. bv-116   0.33     ‚îÇ  ‚îÇ 3. bv-104    depth:3 ‚îÇ            ‚îÇ\n‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò            ‚îÇ\n‚îÇ                                                                  ‚îÇ\n‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê            ‚îÇ\n‚îÇ  ‚îÇ Influencers          ‚îÇ  ‚îÇ Core Numbers         ‚îÇ            ‚îÇ\n‚îÇ  ‚îÇ (High PageRank)      ‚îÇ  ‚îÇ (K-Core Analysis)    ‚îÇ            ‚îÇ\n‚îÇ  ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ  ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ            ‚îÇ\n‚îÇ  ‚îÇ 1. bv-99     1.00    ‚îÇ  ‚îÇ Core 3: 12 issues    ‚îÇ            ‚îÇ\n‚îÇ  ‚îÇ 2. bv-103    0.16    ‚îÇ  ‚îÇ Core 2: 28 issues    ‚îÇ            ‚îÇ\n‚îÇ  ‚îÇ 3. bv-147    0.12    ‚îÇ  ‚îÇ Core 1: 45 issues    ‚îÇ            ‚îÇ\n‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò            ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ  Cycle Detection                                                 ‚îÇ\n‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ\n‚îÇ  ‚úì No circular dependencies detected                            ‚îÇ\n‚îÇ  (or list of cycles if present)                                 ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ  Advanced Insights                                               ‚îÇ\n‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ\n‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê‚îÇ\n‚îÇ  ‚îÇ Cycle Break Suggestions                        [available] ‚îÇ‚îÇ\n‚îÇ  ‚îÇ Remove bv-102 ‚Üí bv-99 to break cycle with minimal impact   ‚îÇ‚îÇ\n‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò‚îÇ\n‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê‚îÇ\n‚îÇ  ‚îÇ Top-K Set (Max Unlock)                          [pending]  ‚îÇ‚îÇ\n‚îÇ  ‚îÇ Analysis pending - will show top issues to unblock most    ‚îÇ‚îÇ\n‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n```\n\n### Data Source\nUses `insights.json` from --robot-insights output:\n```javascript\n// From insights.json\n{\n  \"Bottlenecks\": [...],      // Top betweenness centrality\n  \"Keystones\": [...],        // Critical path scores\n  \"Influencers\": [...],      // PageRank leaders\n  \"Cores\": [...],            // K-core decomposition\n  \"Cycles\": [...],           // Detected cycles\n  \"Articulation\": [...],     // Cut vertices\n  \"Slack\": [...],            // Parallelism headroom\n  \"advanced_insights\": {\n    \"cycle_break\": {...},\n    \"topk_set\": {...},\n    ...\n  }\n}\n```\n\n### Metric Cards Component\n```javascript\nfunction metricCard() {\n  return {\n    formatScore(score) {\n      return score.toFixed(2);\n    },\n    \n    getStatusClass(status) {\n      return {\n        'available': 'text-green-500',\n        'pending': 'text-yellow-500',\n        'skipped': 'text-gray-400',\n        'error': 'text-red-500'\n      }[status] || 'text-gray-500';\n    },\n    \n    navigateToIssue(id) {\n      window.location.hash = `/issue/${id}`;\n    }\n  };\n}\n```\n\n### Visual Elements\n- Score bars: Visual representation of relative scores\n- Issue links: Clickable, show mini-preview on hover\n- Status indicators: Icons for available/pending/skipped\n- Expandable sections: Click to see full lists\n\n### Metric Explanations\nInclude tooltips/help text explaining each metric:\n- **PageRank**: How much this issue \"influences\" the project\n- **Betweenness**: How often this issue lies on paths between others\n- **Critical Path**: Maximum depth of blocking chain\n- **K-Core**: Connectivity density - higher = more interconnected\n\n## Acceptance Criteria\n- [ ] All insight sections display correctly\n- [ ] Metric scores have visual bars/indicators\n- [ ] Issues are clickable links\n- [ ] Cycles displayed if present\n- [ ] Advanced insights show status (available/pending)\n- [ ] Help tooltips explain metrics\n- [ ] Mobile responsive\n- [ ] Dark mode styling\n\n## Design Notes\n- Use consistent color coding across views\n- Keep explanations accessible to non-technical users\n- Highlight actionable insights (e.g., \"fix this bottleneck\")","status":"closed","priority":2,"type":"task","labels":["phase-2","static-pages"],"created_at":"2025-12-15 23:07","updated_at":"2025-12-16 10:31","closed_at":"2025-12-16 10:31","blocked_by":["bv-jdl","bv-w97"],"blocks":["bv-y5i"],"pagerank":0.0015706037203119501,"betweenness":0,"eigenvector":0,"hub":0.00013573598174365005,"authority":0.0001967059030531822,"critical_path":3,"in_degree":1,"out_degree":2,"core_number":3,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-w97","title":"Implement JSON export pipeline for issues","description":"# Implement SQLite Export Pipeline\n\n## Context\nExport bv's issue data to a SQLite database optimized for client-side querying with sql.js WASM. This follows mcp_agent_mail's proven architecture.\n\n## Requirements\n\n### Main Export Function\n```go\n// pkg/export/sqlite_export.go\n\ntype SQLiteExporter struct {\n    issues    []*model.Issue\n    graph     *analysis.Graph\n    insights  *analysis.InsightsOutput\n    triage    *analysis.TriageOutput\n    plan      *analysis.PlanOutput\n    config    ExportConfig\n}\n\nfunc (e *SQLiteExporter) Export(outputDir string) error {\n    // 1. Create SQLite database\n    db, err := sql.Open(\"sqlite3\", filepath.Join(outputDir, \"beads.sqlite3\"))\n    \n    // 2. Create schema\n    if err := e.createSchema(db); err != nil { return err }\n    \n    // 3. Populate issues\n    if err := e.insertIssues(db); err != nil { return err }\n    \n    // 4. Populate dependencies\n    if err := e.insertDependencies(db); err != nil { return err }\n    \n    // 5. Compute and insert metrics\n    if err := e.insertMetrics(db); err != nil { return err }\n    \n    // 6. Create FTS5 index\n    if err := e.createFTSIndex(db); err != nil { return err }\n    \n    // 7. Create materialized views\n    if err := e.createMaterializedViews(db); err != nil { return err }\n    \n    // 8. Optimize for httpvfs\n    if err := e.optimizeDatabase(db); err != nil { return err }\n    \n    // 9. Write robot outputs as JSON (for full detail)\n    if err := e.writeRobotOutputs(outputDir); err != nil { return err }\n    \n    // 10. Chunk if large\n    if err := e.chunkIfNeeded(outputDir); err != nil { return err }\n    \n    return nil\n}\n```\n\n### Database Optimization (Critical for Performance)\n```go\nfunc (e *SQLiteExporter) optimizeDatabase(db *sql.DB) error {\n    optimizations := []string{\n        \"PRAGMA journal_mode=DELETE\",      // Single file\n        \"PRAGMA page_size=1024\",           // Optimal for httpvfs\n        \"INSERT INTO issues_fts(issues_fts) VALUES('optimize')\",\n        \"ANALYZE\",\n        \"PRAGMA optimize\",\n        \"VACUUM\",\n    }\n    for _, sql := range optimizations {\n        if _, err := db.Exec(sql); err != nil {\n            return fmt.Errorf(\"optimization %q failed: %w\", sql, err)\n        }\n    }\n    return nil\n}\n```\n\n### Chunking for Large Databases (\u003e5MB)\n```go\nfunc (e *SQLiteExporter) chunkIfNeeded(outputDir string) error {\n    dbPath := filepath.Join(outputDir, \"beads.sqlite3\")\n    info, _ := os.Stat(dbPath)\n    \n    if info.Size() \u003c 5*1024*1024 { // \u003c5MB, no chunking needed\n        return nil\n    }\n    \n    // Split into 1MB chunks for efficient range requests\n    chunkSize := 1 * 1024 * 1024\n    return e.splitIntoChunks(dbPath, outputDir, chunkSize)\n}\n```\n\n### Metrics Insertion\n```go\nfunc (e *SQLiteExporter) insertMetrics(db *sql.DB) error {\n    stmt, _ := db.Prepare(`\n        INSERT INTO issue_metrics \n        (issue_id, pagerank, betweenness, critical_path_depth, triage_score, blocks_count, blocked_by_count)\n        VALUES (?, ?, ?, ?, ?, ?, ?)\n    `)\n    defer stmt.Close()\n    \n    for _, issue := range e.issues {\n        id := issue.ID\n        pr := e.insights.FullStats.PageRank[id]\n        bw := e.insights.FullStats.Betweenness[id]\n        depth := e.getPathDepth(id)\n        score := e.getTriageScore(id)\n        blocks := len(e.graph.GetBlockedBy(id))\n        blockedBy := len(e.graph.GetBlocks(id))\n        \n        stmt.Exec(id, pr, bw, depth, score, blocks, blockedBy)\n    }\n    return nil\n}\n```\n\n### FTS5 Population\n```go\nfunc (e *SQLiteExporter) createFTSIndex(db *sql.DB) error {\n    // Create FTS5 table\n    _, err := db.Exec(`\n        CREATE VIRTUAL TABLE issues_fts USING fts5(\n            id, title, description, labels, assignee,\n            content='issues', content_rowid='rowid',\n            tokenize='porter unicode61'\n        )\n    `)\n    if err != nil { return err }\n    \n    // Populate from issues table\n    _, err = db.Exec(`\n        INSERT INTO issues_fts(issues_fts) VALUES('rebuild')\n    `)\n    return err\n}\n```\n\n## File Output\n```\noutputDir/\n  beads.sqlite3               # Optimized SQLite database\n  beads.sqlite3.config.json   # Chunk manifest (if chunked)\n  chunks/                     # 1MB chunks (if chunked)\n    00000.bin\n    00001.bin\n    ...\n  data/\n    triage.json               # Full --robot-triage output\n    insights.json             # Full --robot-insights output  \n    plan.json                 # Full --robot-plan output\n    meta.json                 # Export metadata\n```\n\n## Acceptance Criteria\n- [ ] SQLite database created with correct schema\n- [ ] All issues and dependencies exported\n- [ ] Metrics computed and stored\n- [ ] FTS5 index populated and searchable\n- [ ] Materialized views created\n- [ ] Database optimized (page_size, VACUUM)\n- [ ] Large databases chunked automatically\n- [ ] Robot JSON outputs written\n- [ ] Export completes in \u003c5s for 1000 issues\n- [ ] Database queryable by sql.js in browser\n\n## Performance Notes\n- Use prepared statements for batch inserts\n- Transaction wrapping for bulk operations\n- VACUUM at end, not during export\n- page_size=1024 is optimal for httpvfs range requests","status":"closed","priority":2,"type":"task","labels":["phase-1","static-pages"],"created_at":"2025-12-15 23:05","updated_at":"2025-12-16 01:54","closed_at":"2025-12-16 01:54","blocked_by":["bv-6hl"],"blocks":["bv-5yb","bv-73f","bv-ake","bv-dyg","bv-uun","bv-vt0","bv-y5i"],"pagerank":0.008060060155445649,"betweenness":11,"eigenvector":0,"hub":0.000033934421964950344,"authority":0.00040798656611615514,"critical_path":7,"in_degree":7,"out_degree":1,"core_number":3,"slack":7,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-wb6h","title":"Add interactive charts dashboard (burndown, heatmap, distribution)","description":"# Interactive Charts Dashboard\n\n## Context\nProvide complementary chart views alongside the graph for different analytical perspectives.\n\n## Charts to Implement\n\n### 1. Burndown/Burnup Chart\nShow open vs closed issues over time:\n```javascript\n// Using Chart.js\nnew Chart(ctx, {\n    type: 'line',\n    data: {\n        labels: dates,\n        datasets: [\n            { label: 'Open', data: openCounts, borderColor: '#3498db' },\n            { label: 'Closed', data: closedCounts, borderColor: '#2ecc71' }\n        ]\n    }\n});\n```\n\n### 2. Label Dependency Heatmap\nMatrix showing cross-label dependencies:\n```javascript\n// Using D3 or custom canvas\nconst matrix = computeLabelMatrix();\n// matrix[i][j] = count of deps from label i to label j\n\nrenderHeatmap(matrix, {\n    colorScale: d3.scaleSequential(d3.interpolateBlues),\n    onClick: (i, j) =\u003e filterToCrossLabelDeps(labels[i], labels[j])\n});\n```\n\n### 3. Priority Distribution\nPie/donut chart of work by priority:\n```javascript\nnew Chart(ctx, {\n    type: 'doughnut',\n    data: {\n        labels: ['P0', 'P1', 'P2', 'P3', 'P4'],\n        datasets: [{\n            data: priorityCounts,\n            backgroundColor: priorityColors\n        }]\n    }\n});\n```\n\n### 4. Type Breakdown\nBar chart of issues by type (bug/feature/task/etc)\n\n### 5. Stale Issues Over Time\nArea chart showing accumulation of stale issues\n\n## Dashboard Layout\n```html\n\u003cdiv class=\"charts-dashboard\"\u003e\n    \u003cdiv class=\"chart-card\"\u003e\n        \u003ch3\u003eProgress\u003c/h3\u003e\n        \u003ccanvas id=\"burndown\"\u003e\u003c/canvas\u003e\n    \u003c/div\u003e\n    \u003cdiv class=\"chart-card\"\u003e\n        \u003ch3\u003eDependencies\u003c/h3\u003e\n        \u003cdiv id=\"heatmap\"\u003e\u003c/div\u003e\n    \u003c/div\u003e\n    \u003cdiv class=\"chart-row\"\u003e\n        \u003cdiv class=\"chart-card half\"\u003e\n            \u003ch3\u003ePriority\u003c/h3\u003e\n            \u003ccanvas id=\"priority-pie\"\u003e\u003c/canvas\u003e\n        \u003c/div\u003e\n        \u003cdiv class=\"chart-card half\"\u003e\n            \u003ch3\u003eTypes\u003c/h3\u003e\n            \u003ccanvas id=\"type-bar\"\u003e\u003c/canvas\u003e\n        \u003c/div\u003e\n    \u003c/div\u003e\n\u003c/div\u003e\n```\n\n## Acceptance Criteria\n- [ ] Burndown chart shows historical progress\n- [ ] Heatmap visualizes cross-label deps\n- [ ] Priority/type charts render correctly\n- [ ] Charts are interactive (hover, click)\n- [ ] Responsive layout","status":"closed","priority":2,"type":"task","labels":["charts","phase-2","visualization"],"created_at":"2025-12-15 23:56","updated_at":"2025-12-16 16:17","closed_at":"2025-12-16 16:17","blocked_by":["bv-jndd"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":6.571979899005031e-7,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":13,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-wpmc","title":"Unit test: attention.go - Attention scoring view","description":"Create unit tests for pkg/ui/attention.go\n\n## File Overview\nattention.go renders the attention scoring view showing which beads need immediate focus based on combined signals.\n\n## Test Cases to Implement\n1. **View Rendering Tests**\n   - Empty attention list renders correctly\n   - Single item renders with all fields\n   - Multiple items sorted by score\n   - Truncation on narrow terminals\n\n2. **Score Display Tests**\n   - High attention (red highlight)\n   - Medium attention (yellow)\n   - Low attention (green)\n   - Score formatting (2 decimal places)\n\n3. **Update Handler Tests**\n   - Key navigation (j/k)\n   - Selection state changes\n   - Escape returns to parent view\n\n4. **Integration Points**\n   - Verify attention data comes from analysis\n   - Test refresh on data change\n   - Test with real GraphStats data\n\n## Implementation Notes\n- Use Bubble Tea testing patterns\n- Capture View() output and verify content\n- Test with various terminal widths","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-16 20:06","updated_at":"2025-12-16 23:29","closed_at":"2025-12-16 23:29","blocks":["bv-ul1l"],"pagerank":0.0017282929585731776,"betweenness":0,"eigenvector":0,"hub":0,"authority":6.623673282227765e-11,"critical_path":4,"in_degree":1,"out_degree":0,"core_number":1,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-wywa","title":"Robot triage: avoid 'unclaimed' for in_progress","description":"GenerateTriageReasons currently always emits 'Currently unclaimed' when ClaimedByAgent is empty, even if issue status is in_progress. This confuses robot-next/triage output. Fix reasons based on status (in_progress vs open) and update tests.","status":"closed","priority":3,"type":"bug","labels":["ai","robot","triage"],"created_at":"2025-12-17 03:44","updated_at":"2025-12-17 03:47","closed_at":"2025-12-17 03:47","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-wzvo","title":"E2E: Interactive graph navigation testing","description":"Test interactive graph features in TUI.\n\n## Features to Test\n1. **Pan Navigation**\n   - h/l moves viewport left/right\n   - j/k moves viewport up/down\n   - Smooth scrolling\n   - Boundary handling\n\n2. **Zoom (if supported)**\n   - +/- changes zoom level\n   - Zoom center behavior\n   - Min/max zoom limits\n\n3. **Node Selection**\n   - Enter selects focused node\n   - Selection persists\n   - Multi-select if supported\n   - Clear selection\n\n4. **Node Focus**\n   - Focus follows cursor\n   - Focus indicator visible\n   - Tab cycles through nodes\n   - Focus by search\n\n5. **Information Display**\n   - Node details on focus\n   - Edge info on hover\n   - Status in statusbar\n   - Help overlay\n\n## Test Implementation\n- Simulate key sequences\n- Capture view state\n- Verify viewport position\n- Test state transitions","status":"closed","priority":2,"type":"task","labels":null,"created_at":"2025-12-16 20:10","updated_at":"2025-12-16 23:40","closed_at":"2025-12-16 23:40","blocks":["bv-evyl"],"pagerank":0.0016290932344603455,"betweenness":0,"eigenvector":0,"hub":0,"authority":7.205652148943102e-8,"critical_path":3,"in_degree":1,"out_degree":0,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-xcf1","title":"Unit test: suggestions.go - Core suggestion types and interfaces","description":"Create comprehensive unit tests for pkg/analysis/suggestions.go\n\n## File Overview\nsuggestions.go defines the core types and interfaces for the suggestion system:\n- SuggestionType enum (dependency, duplicate, label, cycle)\n- Suggestion struct with confidence scoring\n- SuggestionResult aggregation\n\n## Test Cases to Implement\n1. **Type Tests**\n   - Verify SuggestionType string representations\n   - Test confidence score normalization (0.0-1.0 bounds)\n   - Validate priority ordering\n\n2. **Suggestion Creation**\n   - Create suggestions with all field combinations\n   - Test empty/nil field handling\n   - Validate ID generation if applicable\n\n3. **Result Aggregation**\n   - Test empty result handling\n   - Test single suggestion result\n   - Test multiple suggestions sorting by confidence\n   - Test filtering by type\n   - Test filtering by minimum confidence\n\n4. **Edge Cases**\n   - Zero confidence suggestions\n   - Maximum confidence (1.0)\n   - Very long description strings\n   - Unicode in suggestion text\n\n## Implementation Notes\n- Use table-driven tests\n- No mocks - use concrete Suggestion structs\n- Test JSON serialization if used by robot commands\n- Add benchmarks for sorting operations","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-16 20:05","updated_at":"2025-12-16 21:53","closed_at":"2025-12-16 21:53","blocks":["bv-0kll","bv-3bhq"],"pagerank":0.001985274869031905,"betweenness":0,"eigenvector":0,"hub":0,"authority":1.7833198250397624e-7,"critical_path":5,"in_degree":2,"out_degree":0,"core_number":2,"slack":10,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-xg92","title":"Port Cycle Detection (Tarjan SCC + enumeration) to Rust WASM","description":"# Port Cycle Detection to Rust WASM\n\n## Context\nCycle detection identifies circular dependencies. We need:\n1. Tarjan SCC for fast cycle presence check\n2. Johnson's algorithm for full cycle enumeration\n\n## Go Implementation Reference\n```go\n// topo.TarjanSCC(a.g) - check for SCCs \u003e 1 node\n// topo.DirectedCyclesIn(a.g) - enumerate all cycles\n```\n\n## Rust Implementation (cycles.rs)\n\n### Part 1: Tarjan SCC (fast check)\n```rust\npub struct SCCResult {\n    pub components: Vec\u003cVec\u003cusize\u003e\u003e,\n    pub has_cycles: bool,\n}\n\npub fn tarjan_scc(graph: \u0026DiGraph) -\u003e SCCResult {\n    // Standard Tarjan implementation (already in current description)\n}\n```\n\n### Part 2: Johnson's Algorithm (enumerate cycles)\n```rust\n/// Enumerate elementary cycles using Johnson's algorithm.\n/// Reference: Donald B. Johnson, 'Finding All Elementary Circuits'\npub fn enumerate_cycles(graph: \u0026DiGraph, max_cycles: usize) -\u003e Vec\u003cVec\u003cusize\u003e\u003e {\n    let n = graph.node_count();\n    if n == 0 { return Vec::new(); }\n    \n    let mut cycles = Vec::new();\n    let mut blocked = vec![false; n];\n    let mut blocked_map: Vec\u003cHashSet\u003cusize\u003e\u003e = vec![HashSet::new(); n];\n    let mut stack = Vec::new();\n    \n    // Unblock helper\n    fn unblock(u: usize, blocked: \u0026mut [bool], blocked_map: \u0026mut [HashSet\u003cusize\u003e]) {\n        blocked[u] = false;\n        for w in blocked_map[u].drain() {\n            if blocked[w] {\n                unblock(w, blocked, blocked_map);\n            }\n        }\n    }\n    \n    // Circuit search from start vertex\n    fn circuit(\n        v: usize, start: usize, graph: \u0026DiGraph,\n        blocked: \u0026mut [bool], blocked_map: \u0026mut [HashSet\u003cusize\u003e],\n        stack: \u0026mut Vec\u003cusize\u003e, cycles: \u0026mut Vec\u003cVec\u003cusize\u003e\u003e,\n        max_cycles: usize, active: \u0026[bool],\n    ) -\u003e bool {\n        if cycles.len() \u003e= max_cycles { return false; }\n        \n        let mut found = false;\n        stack.push(v);\n        blocked[v] = true;\n        \n        for \u0026w in graph.successors(v) {\n            if !active[w] { continue; }\n            \n            if w == start {\n                // Found a cycle\n                cycles.push(stack.clone());\n                found = true;\n            } else if !blocked[w] {\n                if circuit(w, start, graph, blocked, blocked_map, \n                          stack, cycles, max_cycles, active) {\n                    found = true;\n                }\n            }\n        }\n        \n        if found {\n            unblock(v, blocked, blocked_map);\n        } else {\n            for \u0026w in graph.successors(v) {\n                if active[w] {\n                    blocked_map[w].insert(v);\n                }\n            }\n        }\n        \n        stack.pop();\n        found\n    }\n    \n    // Run Johnson's algorithm\n    let mut active = vec![true; n];\n    for start in 0..n {\n        if cycles.len() \u003e= max_cycles { break; }\n        \n        // Reset blocked state\n        blocked.iter_mut().for_each(|b| *b = false);\n        blocked_map.iter_mut().for_each(|s| s.clear());\n        \n        circuit(start, start, graph, \u0026mut blocked, \u0026mut blocked_map,\n               \u0026mut stack, \u0026mut cycles, max_cycles, \u0026active);\n        \n        active[start] = false;\n    }\n    \n    cycles\n}\n```\n\n## Acceptance Criteria\n- [ ] Tarjan SCC correctly identifies components\n- [ ] has_cycles flag accurate\n- [ ] Johnson's enumerate_cycles finds all cycles (up to max)\n- [ ] max_cycles limit prevents explosion\n- [ ] Performance: SCC \u003c5ms for 1000 nodes\n- [ ] Performance: enumerate(100) \u003c50ms for 1000 nodes","notes":"CRITICAL FIX: Original enumerate_cycles was incomplete (returned SCCs not cycles). Must implement Johnson's algorithm for proper elementary cycle enumeration. See updated implementation in description. Max_cycles limit required to prevent exponential blowup.","status":"closed","priority":2,"type":"task","labels":["algorithm","phase-2","wasm"],"created_at":"2025-12-15 23:34","updated_at":"2025-12-16 00:37","closed_at":"2025-12-16 00:37","blocked_by":["bv-bxoe"],"blocks":["bv-jl6j","bv-uvxe","bv-y7a0"],"pagerank":0.004122043812221375,"betweenness":4,"eigenvector":0,"hub":0.000008837350028490512,"authority":0.00001230578757481256,"critical_path":5,"in_degree":3,"out_degree":1,"core_number":2,"slack":8,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-xooe","title":"Robot commands must not emit parse warnings to stderr","description":"Robot-mode commands (e.g. --robot-triage/--robot-plan) must keep stdout JSON parseable even when .beads/*.jsonl contains malformed lines. Currently loader/sprints parsing can emit warnings to stderr, which breaks toolchains that treat stderr as fatal.\n\nAcceptance:\n- In robot mode, malformed JSONL lines do not produce stderr output for issues + sprints parsing.\n- Existing interactive behavior can still warn (non-robot).\n- Add E2E tests covering malformed issues.jsonl and sprints.jsonl.","status":"closed","priority":1,"type":"bug","labels":["loader","reliability","robot"],"assignee":"BrownBear","created_at":"2025-12-17 05:02","updated_at":"2025-12-17 05:10","closed_at":"2025-12-17 05:10","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-y4km","title":"Implement dark mode with beautiful color scheme and polish","description":"# Dark Mode and Visual Polish\n\n## Context\nA beautiful, polished dark mode is essential for developer tools. Many users work in low-light environments.\n\n## Color Scheme\n\n### Dark Theme Palette\n```css\n:root[data-theme='dark'] {\n    --bg-primary: #0d1117;\n    --bg-secondary: #161b22;\n    --bg-tertiary: #21262d;\n    --text-primary: #c9d1d9;\n    --text-secondary: #8b949e;\n    --border: #30363d;\n    \n    /* Status Colors (adjusted for dark) */\n    --status-open: #58a6ff;\n    --status-closed: #3fb950;\n    --status-blocked: #f0883e;\n    --status-critical: #f85149;\n    \n    /* Priority Colors */\n    --priority-p0: #f85149;\n    --priority-p1: #f0883e;\n    --priority-p2: #d29922;\n    --priority-p3: #58a6ff;\n    --priority-p4: #8b949e;\n    \n    /* Graph specific */\n    --node-glow: rgba(88, 166, 255, 0.4);\n    --edge-default: #30363d;\n    --edge-highlight: #58a6ff;\n}\n```\n\n### Light Theme (for contrast)\n```css\n:root[data-theme='light'] {\n    --bg-primary: #ffffff;\n    --bg-secondary: #f6f8fa;\n    --bg-tertiary: #eaeef2;\n    --text-primary: #24292f;\n    --text-secondary: #57606a;\n    /* ... corresponding light colors */\n}\n```\n\n## Toggle Implementation\n```javascript\nfunction toggleTheme() {\n    const current = document.documentElement.getAttribute('data-theme');\n    const next = current === 'dark' ? 'light' : 'dark';\n    document.documentElement.setAttribute('data-theme', next);\n    localStorage.setItem('theme', next);\n    \n    // Update force-graph colors\n    updateGraphColors(next);\n}\n\n// Respect system preference\nif (window.matchMedia('(prefers-color-scheme: dark)').matches) {\n    document.documentElement.setAttribute('data-theme', 'dark');\n}\n```\n\n## Visual Polish Elements\n\n### 1. Smooth Transitions\n```css\n* {\n    transition: background-color 0.2s ease, \n                color 0.2s ease, \n                border-color 0.2s ease;\n}\n```\n\n### 2. Subtle Shadows\n```css\n.card {\n    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n}\n[data-theme='dark'] .card {\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);\n}\n```\n\n### 3. Micro-Interactions\n- Button hover states with subtle scale\n- Loading skeletons instead of spinners\n- Toast notifications with slide-in\n\n### 4. Typography\n- JetBrains Mono for code/IDs\n- Inter for UI text\n- Proper font weights and line heights\n\n## Acceptance Criteria\n- [ ] Dark/light toggle works\n- [ ] System preference respected\n- [ ] All components properly themed\n- [ ] Graph colors update with theme\n- [ ] No contrast/accessibility issues\n- [ ] Preference persisted to localStorage","status":"closed","priority":2,"type":"task","labels":["accessibility","phase-2","ux","visualization"],"created_at":"2025-12-15 23:57","updated_at":"2025-12-16 14:34","closed_at":"2025-12-16 14:34","blocked_by":["bv-jndd"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":6.571979899005031e-7,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":13,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-y5i","title":"Static Site Export \u0026 GitHub Pages Deployment","description":"# Static Site Export \u0026 GitHub Pages Deployment\n\n## Overview\nAdd the ability to generate and deploy a slick static website that presents bv's issue tracker data to GitHub Pages (and optionally Cloudflare Pages). This feature mirrors the successful \"shared mailbox\" functionality in mcp_agent_mail, using the SAME proven SQLite + sql.js + FTS5 architecture.\n\n## Motivation \u0026 Goals\n1. **Shareability**: Allow teams to share project status without requiring bv installation\n2. **Archival**: Create point-in-time snapshots of project health for stakeholders\n3. **CI Integration**: Auto-publish project dashboards from CI pipelines\n4. **Accessibility**: View rich analysis data in any browser\n\n## Key Features\n- **Dashboard View**: Quick stats (open/blocked/actionable), health indicators, top picks\n- **Issues List**: Filterable/sortable by status, type, priority, labels, assignee\n- **Issue Detail**: Full description, dependencies (blocks/blocked-by), graph position\n- **Dependency Graph**: Interactive Mermaid.js visualization\n- **Insights View**: PageRank leaders, bottlenecks, critical path, recommendations\n- **Full-Text Search**: FTS5-powered search with ranking and snippets\n\n## Technical Approach (Matching mcp_agent_mail)\n| mcp_agent_mail Component | bv Equivalent |\n|--------------------------|---------------|\n| SQLite snapshot | SQLite export (beads.sqlite3) |\n| sql.js WASM | sql.js WASM (client-side queries) |\n| FTS5 full-text search | FTS5 full-text search |\n| Materialized views | Materialized views (issue_overview_mv) |\n| OPFS caching | OPFS caching (offline support) |\n| Database chunking | Database chunking (\u003e5MB) |\n| Message list | Issues list with SQL filtering |\n| Thread detail | Issue detail + dependency subgraph |\n| Alpine.js + Tailwind | Same stack (proven, lightweight) |\n| DOMPurify + Trusted Types | Same security approach |\n| gh CLI deployment | Same approach |\n| Cloudflare wrangler | Same approach |\n| coi-serviceworker.js | Same (COOP/COEP for OPFS) |\n\n## Bundle Structure\n```\nbv-pages/\n  index.html              # SPA entry with CSP, COOP/COEP via service worker\n  viewer.js               # Main app with sql.js integration\n  styles.css              # Tailwind + custom styles\n  beads.sqlite3           # Optimized SQLite database\n  beads.sqlite3.config.json  # Chunk config (if chunked)\n  chunks/                 # Database chunks (if \u003e5MB)\n  data/\n    triage.json           # Full --robot-triage output\n    insights.json         # Full --robot-insights output\n    plan.json             # Full --robot-plan output\n    meta.json             # Export metadata\n  vendor/\n    sql-wasm.js           # sql.js library\n    sql-wasm.wasm         # SQLite WASM binary\n    alpine.min.js         # Reactive UI framework\n    marked.min.js         # Markdown rendering\n    dompurify.min.js      # HTML sanitization\n  coi-serviceworker.js    # COOP/COEP for GitHub Pages\n  assets/\n    favicon.svg\n```\n\n## Deployment Wizard Flow (Interactive)\n1. Export options: select issues (all/filtered), include closed (yes/no)\n2. Analysis: regenerate or use cached robot outputs\n3. Target selection: GitHub Pages / Cloudflare Pages / Local only\n4. Prerequisites check: gh/wrangler auth, git config, confirm identity\n5. Preview: local server with hot reload\n6. Deploy: create/update repo (with safety checks), push, enable Pages\n\n## CLI Commands\n```bash\n# Full wizard (interactive)\nbv --pages\n\n# Quick export to directory\nbv --export-pages ./bv-pages\n\n# Export with options\nbv --export-pages ./bv-pages --include-closed --title \"My Project\"\n\n# Preview existing bundle\nbv --preview-pages ./bv-pages\n\n# Update existing deployment\nbv --update-pages ./bv-pages\n```\n\n## Security Considerations\n- No secrets in exports (bv data is typically non-sensitive)\n- CSP headers for XSS prevention\n- DOMPurify + Trusted Types for markdown rendering\n- COOP/COEP via service worker for OPFS support\n- Safety checks before any destructive git operations\n- Permission prompts before software installation\n\n## Future Enhancements (Out of Scope for MVP)\n- Historical trend charts (requires multiple snapshots)\n- Embedded search highlighting\n- PDF export option\n- Custom themes/branding\n\n## Success Criteria\n1. User can run `bv --pages` and have a live GitHub Pages site in \u003c5 minutes\n2. Site shows all data from bv TUI in readable format\n3. Site works offline after initial load (OPFS caching)\n4. Works on mobile browsers\n5. Dark mode support\n6. Full-text search works with ranking\n7. Dependency graph is interactive and useful\n\n## Architecture Rationale (Why SQLite, not JSON)\n1. **Real Search**: FTS5 provides full-text search with ranking (bm25), snippets, prefix matching\n2. **Complex Queries**: SQL handles dependency traversal, filtering, sorting without JavaScript complexity\n3. **Scale**: Same approach works for 50 or 50,000 issues\n4. **Performance**: Client queries only what it needs, pagination via LIMIT/OFFSET\n5. **Caching**: OPFS support for offline use with cache invalidation\n6. **Proven**: mcp_agent_mail demonstrates this architecture works exceptionally well\n\n## References\n- mcp_agent_mail share.py (2207 lines): Data export pipeline\n- mcp_agent_mail share_to_github_pages.py (1353 lines): Deployment wizard\n- mcp_agent_mail viewer_assets/: SPA implementation with sql.js","status":"closed","priority":1,"type":"epic","labels":["static-pages"],"created_at":"2025-12-15 23:04","updated_at":"2025-12-16 11:28","closed_at":"2025-12-16 11:28","blocked_by":["bv-6hl","bv-w97","bv-jdl","bv-73f","bv-uun","bv-5yb","bv-dyg","bv-vt0","bv-10g","bv-kdn","bv-5dl","bv-50r","bv-406","bv-awl","bv-ake","bv-gv7","bv-7pu","bv-gdlt","bv-5mgw"],"blocks":["bv-b23i"],"pagerank":0.0021039815616854516,"betweenness":18,"eigenvector":0,"hub":0.000734341286153682,"authority":0.000009530243827152466,"critical_path":2,"in_degree":1,"out_degree":19,"core_number":3,"slack":7,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-y7a0","title":"Integrate WASM graph engine with static viewer JavaScript","description":"# Integrate WASM Graph Engine with Static Viewer\n\n## Context\nThe JavaScript viewer needs to initialize the WASM graph engine, load data from SQLite, and provide live recalculation capabilities.\n\n## Requirements\n\n### Initialization Flow\n```javascript\n// In viewer.js\n\nimport init, { DiGraph } from './vendor/bv_graph.js';\n\nlet GRAPH = null;\nlet NODE_MAP = null;\nlet WASM_READY = false;\n\nasync function initGraphEngine() {\n    try {\n        await init();\n        GRAPH = new DiGraph();\n        NODE_MAP = new Map();\n        \n        // Load from SQLite\n        const deps = DB.exec('SELECT issue_id, depends_on_id FROM dependencies');\n        for (const row of deps[0]?.values || []) {\n            const [from, to] = row;\n            if (!NODE_MAP.has(from)) NODE_MAP.set(from, GRAPH.add_node(from));\n            if (!NODE_MAP.has(to)) NODE_MAP.set(to, GRAPH.add_node(to));\n            GRAPH.add_edge(NODE_MAP.get(from), NODE_MAP.get(to));\n        }\n        \n        WASM_READY = true;\n        console.log(`Graph loaded: ${GRAPH.node_count()} nodes, ${GRAPH.edge_count()} edges`);\n    } catch (e) {\n        console.error('WASM graph init failed:', e);\n        WASM_READY = false;\n    }\n}\n```\n\n### Live Recalculation API\n```javascript\nfunction recalculateMetrics(filteredIds) {\n    if (!WASM_READY) return null;\n    \n    const indices = filteredIds\n        .map(id =\u003e NODE_MAP.get(id))\n        .filter(idx =\u003e idx !== undefined);\n    \n    if (indices.length === 0) return null;\n    \n    const subgraph = GRAPH.subgraph(new Uint32Array(indices));\n    \n    return {\n        pagerank: subgraph.pagerank(0.85, 100),\n        betweenness: subgraph.betweenness(),\n        cycles: JSON.parse(subgraph.detect_cycles()),\n        criticalPath: subgraph.critical_path_heights(),\n        density: subgraph.density(),\n    };\n}\n\nfunction whatIfClose(issueId) {\n    if (!WASM_READY) return null;\n    \n    const idx = NODE_MAP.get(issueId);\n    if (idx === undefined) return null;\n    \n    const closedSet = buildClosedSet();\n    return JSON.parse(GRAPH.what_if_close(idx, closedSet));\n}\n\nfunction buildClosedSet() {\n    const n = GRAPH.node_count();\n    const closed = new Uint8Array(n);\n    \n    const closedIssues = DB.exec('SELECT id FROM issues WHERE status = \"closed\"');\n    for (const [id] of closedIssues[0]?.values || []) {\n        const idx = NODE_MAP.get(id);\n        if (idx !== undefined) closed[idx] = 1;\n    }\n    \n    return closed;\n}\n```\n\n### Alpine.js Store Integration\n```javascript\nAlpine.store('graph', {\n    ready: false,\n    metrics: null,\n    \n    async init() {\n        await initGraphEngine();\n        this.ready = WASM_READY;\n    },\n    \n    recalculate(filteredIds) {\n        if (!this.ready) return;\n        this.metrics = recalculateMetrics(filteredIds);\n    },\n    \n    whatIf(issueId) {\n        if (!this.ready) return null;\n        return whatIfClose(issueId);\n    }\n});\n```\n\n### UI Integration\n```html\n\u003c!-- Recalculate button --\u003e\n\u003cbutton \n    x-show=\"$store.graph.ready \u0026\u0026 filteredIssues.length \u003e 0\"\n    @click=\"$store.graph.recalculate(filteredIssues.map(i =\u003e i.id))\"\n    class=\"btn-secondary\"\u003e\n    Recalculate for Filter\n\u003c/button\u003e\n\n\u003c!-- What-if hover --\u003e\n\u003cdiv \n    x-data=\"{ whatIf: null }\"\n    @mouseenter=\"whatIf = $store.graph.whatIf(issue.id)\"\n    @mouseleave=\"whatIf = null\"\u003e\n    \u003ctemplate x-if=\"whatIf\"\u003e\n        \u003cdiv class=\"tooltip\"\u003e\n            Unblocks: \u003cspan x-text=\"whatIf.direct_unblocks\"\u003e\u003c/span\u003e direct,\n            \u003cspan x-text=\"whatIf.transitive_unblocks\"\u003e\u003c/span\u003e total\n        \u003c/div\u003e\n    \u003c/template\u003e\n\u003c/div\u003e\n```\n\n### Performance Monitoring\n```javascript\nfunction measurePerformance(fn, label) {\n    const start = performance.now();\n    const result = fn();\n    const elapsed = performance.now() - start;\n    console.log(`${label}: ${elapsed.toFixed(2)}ms`);\n    return result;\n}\n\n// Usage\nmeasurePerformance(() =\u003e GRAPH.pagerank(0.85, 100), 'PageRank');\n```\n\n## Acceptance Criteria\n- [ ] WASM loads and initializes from SQLite\n- [ ] NODE_MAP correctly maps IDs to indices\n- [ ] recalculateMetrics works on filtered subsets\n- [ ] whatIfClose returns accurate predictions\n- [ ] UI buttons show when WASM ready\n- [ ] Hover tooltips show what-if data\n- [ ] Performance logged to console\n- [ ] Graceful degradation if WASM fails","status":"closed","priority":2,"type":"task","labels":["integration","phase-4","wasm"],"created_at":"2025-12-15 23:37","updated_at":"2025-12-16 02:26","closed_at":"2025-12-16 02:26","blocked_by":["bv-njah","bv-jl6j","bv-a00v","bv-3m20","bv-1hnb","bv-ywd5","bv-2nyt","bv-dvp3","bv-utky","bv-xg92","bv-bikt","bv-pbs6","bv-bxoe"],"blocks":["bv-k79d","bv-p32k","bv-psjp"],"pagerank":0.006308253409788314,"betweenness":68,"eigenvector":0,"hub":0.000030929785122376714,"authority":7.629546663534489e-15,"critical_path":3,"in_degree":3,"out_degree":13,"core_number":2,"slack":6,"is_articulation":true,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-yc2v","title":"E2E: Graph export format validation","description":"End-to-end tests for all graph export formats.\n\n## Formats to Test\n1. **bv --export-graph graph.json**\n   - Valid JSON\n   - All nodes present\n   - All edges present\n   - Metrics included\n\n2. **bv --export-graph graph.dot**\n   - Valid DOT format\n   - Renders with dot/neato\n   - No syntax errors\n   - Attributes correct\n\n3. **bv --export-graph graph.svg**\n   - Valid SVG\n   - Renders in browser\n   - All elements visible\n   - Interactive features\n\n4. **bv --export-graph graph.png**\n   - Valid PNG image\n   - Correct dimensions\n   - Readable text\n   - Colors accurate\n\n5. **bv --export-graph graph.mermaid**\n   - Valid Mermaid syntax\n   - Renders on GitHub\n   - Renders in Mermaid Live\n   - All nodes/edges\n\n## Test Scenarios\n- Export same graph to all formats\n- Compare node/edge counts\n- Verify format-specific features\n- Test with various graph sizes\n\n## Tools\n- jq for JSON validation\n- GraphViz for DOT validation\n- Browser for SVG/PNG\n- Mermaid CLI for Mermaid","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-16 20:10","updated_at":"2025-12-17 00:11","closed_at":"2025-12-17 00:11","blocked_by":["bv-z5oa","bv-6jyn"],"blocks":["bv-evyl"],"pagerank":0.0016290932344603455,"betweenness":0,"eigenvector":0,"hub":3.147224310888661e-8,"authority":7.205652148943102e-8,"critical_path":3,"in_degree":1,"out_degree":2,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-yi6k","title":"Port Topological Sort to Rust WASM","description":"# Port Topological Sort to Rust WASM\n\n## Context\nTopological sort orders nodes such that for every edge u‚Üív, u comes before v. Essential for execution planning and critical path analysis.\n\n## Rust Implementation (topo.rs)\n```rust\nuse crate::graph::DiGraph;\nuse std::collections::VecDeque;\n\n/// Topological sort using Kahn's algorithm.\n/// Returns None if graph has cycles.\npub fn topological_sort(graph: \u0026DiGraph) -\u003e Option\u003cVec\u003cusize\u003e\u003e {\n    let n = graph.node_count();\n    if n == 0 {\n        return Some(Vec::new());\n    }\n    \n    // Compute in-degrees\n    let mut in_degree: Vec\u003cusize\u003e = graph.in_degrees();\n    \n    // Queue of nodes with no incoming edges\n    let mut queue: VecDeque\u003cusize\u003e = (0..n)\n        .filter(|\u0026i| in_degree[i] == 0)\n        .collect();\n    \n    let mut order = Vec::with_capacity(n);\n    \n    while let Some(u) = queue.pop_front() {\n        order.push(u);\n        \n        for \u0026v in graph.successors(u) {\n            in_degree[v] -= 1;\n            if in_degree[v] == 0 {\n                queue.push_back(v);\n            }\n        }\n    }\n    \n    if order.len() == n {\n        Some(order)\n    } else {\n        None // Cycle detected\n    }\n}\n\n/// Check if graph is a DAG (has valid topological order).\npub fn is_dag(graph: \u0026DiGraph) -\u003e bool {\n    topological_sort(graph).is_some()\n}\n```\n\n## Acceptance Criteria\n- [ ] Returns valid topological order for DAGs\n- [ ] Returns None for cyclic graphs\n- [ ] Deterministic output order\n- [ ] Performance: \u003c2ms for 1000 nodes","notes":"CLARIFICATION: For deterministic output, use a BinaryHeap (min-heap) by node index instead of VecDeque in Kahn's algorithm. This ensures consistent ordering across runs: let mut heap = BinaryHeap::new(); heap.push(Reverse(node));","status":"closed","priority":2,"type":"task","labels":["algorithm","phase-2","wasm"],"created_at":"2025-12-15 23:34","updated_at":"2025-12-16 00:15","closed_at":"2025-12-16 00:15","blocked_by":["bv-bxoe"],"blocks":["bv-3m20","bv-bikt"],"pagerank":0.0070024221674406945,"betweenness":8,"eigenvector":0,"hub":0.000008837350028490512,"authority":0.0000034436099485676586,"critical_path":7,"in_degree":2,"out_degree":1,"core_number":2,"slack":6,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-yrcn","title":"Port HITS algorithm (Hubs \u0026 Authorities) to Rust WASM","description":"# Port HITS Algorithm to Rust WASM\n\n## Context\nHITS (Hyperlink-Induced Topic Search) computes hub and authority scores. Hubs point to many authorities; authorities are pointed to by many hubs.\n\n## Go Implementation Reference\n```go\n// network.HITS(a.g, 1e-3) from gonum\n```\n\n## Rust Implementation (hits.rs)\n```rust\nuse crate::graph::DiGraph;\n\npub struct HITSResult {\n    pub hubs: Vec\u003cf64\u003e,\n    pub authorities: Vec\u003cf64\u003e,\n}\n\n/// Compute HITS hub and authority scores.\npub fn hits(graph: \u0026DiGraph, tolerance: f64, max_iterations: u32) -\u003e HITSResult {\n    let n = graph.node_count();\n    if n == 0 {\n        return HITSResult { hubs: Vec::new(), authorities: Vec::new() };\n    }\n    \n    let mut hubs = vec![1.0; n];\n    let mut auth = vec![1.0; n];\n    \n    for _ in 0..max_iterations {\n        let mut new_auth = vec![0.0; n];\n        let mut new_hubs = vec![0.0; n];\n        \n        // Authority score = sum of hub scores of predecessors\n        for v in 0..n {\n            for \u0026u in graph.predecessors(v) {\n                new_auth[v] += hubs[u];\n            }\n        }\n        \n        // Hub score = sum of authority scores of successors\n        for u in 0..n {\n            for \u0026v in graph.successors(u) {\n                new_hubs[u] += new_auth[v];\n            }\n        }\n        \n        // Normalize\n        let auth_norm = normalize(\u0026mut new_auth);\n        let hubs_norm = normalize(\u0026mut new_hubs);\n        \n        // Check convergence\n        let diff: f64 = hubs.iter().zip(new_hubs.iter())\n            .map(|(a, b)| (a - b).abs())\n            .sum::\u003cf64\u003e()\n            + auth.iter().zip(new_auth.iter())\n            .map(|(a, b)| (a - b).abs())\n            .sum();\n        \n        hubs = new_hubs;\n        auth = new_auth;\n        \n        if diff \u003c tolerance {\n            break;\n        }\n    }\n    \n    HITSResult { hubs, authorities: auth }\n}\n\nfn normalize(vec: \u0026mut [f64]) -\u003e f64 {\n    let sum: f64 = vec.iter().sum();\n    if sum \u003e 0.0 {\n        for v in vec.iter_mut() {\n            *v /= sum;\n        }\n    }\n    sum\n}\n```\n\n## Acceptance Criteria\n- [ ] Hub and authority scores converge\n- [ ] Results match Go gonum implementation\n- [ ] Returns JSON: {hubs: [], authorities: []}","status":"closed","priority":2,"type":"task","labels":["algorithm","phase-2","wasm"],"created_at":"2025-12-15 23:33","updated_at":"2025-12-16 00:30","closed_at":"2025-12-16 00:30","blocked_by":["bv-bxoe"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0.000008837350028490512,"authority":0,"critical_path":1,"in_degree":0,"out_degree":1,"core_number":1,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-ywd5","title":"Implement Subgraph extraction and operations in Rust WASM","description":"# Implement Subgraph Extraction\n\n## Context\nSubgraph extraction creates a new graph containing only specified nodes and their interconnections. Essential for filtered-view analysis.\n\n## Rust Implementation (subgraph.rs)\n```rust\nuse crate::graph::DiGraph;\n\nimpl DiGraph {\n    /// Extract subgraph containing only the specified node indices.\n    /// Returns new DiGraph with edges between retained nodes.\n    pub fn subgraph(\u0026self, node_indices: \u0026[usize]) -\u003e DiGraph {\n        // Create mapping: old index -\u003e new index\n        let mut index_map: Vec\u003cOption\u003cusize\u003e\u003e = vec![None; self.node_count()];\n        let mut new_graph = DiGraph::with_capacity(node_indices.len(), node_indices.len() * 2);\n        \n        // Add nodes\n        for (new_idx, \u0026old_idx) in node_indices.iter().enumerate() {\n            if old_idx \u003c self.nodes.len() {\n                new_graph.add_node(\u0026self.nodes[old_idx]);\n                index_map[old_idx] = Some(new_idx);\n            }\n        }\n        \n        // Add edges between retained nodes\n        for \u0026old_from in node_indices {\n            if let Some(new_from) = index_map.get(old_from).copied().flatten() {\n                for \u0026old_to in self.successors(old_from) {\n                    if let Some(new_to) = index_map.get(old_to).copied().flatten() {\n                        new_graph.add_edge(new_from, new_to);\n                    }\n                }\n            }\n        }\n        \n        new_graph\n    }\n    \n    /// Create subgraph from node IDs (string lookup).\n    pub fn subgraph_by_ids(\u0026self, ids: \u0026[\u0026str]) -\u003e DiGraph {\n        let indices: Vec\u003cusize\u003e = ids.iter()\n            .filter_map(|id| self.node_idx(id))\n            .collect();\n        self.subgraph(\u0026indices)\n    }\n}\n```\n\n### WASM Binding\n```rust\n#[wasm_bindgen]\nimpl DiGraph {\n    /// Extract subgraph with only specified node indices.\n    pub fn subgraph(\u0026self, indices: \u0026[usize]) -\u003e DiGraph {\n        subgraph::extract_subgraph(self, indices)\n    }\n}\n```\n\n## Use Cases\n1. **Filtered analysis**: \"Recalculate PageRank for just 'auth' label issues\"\n2. **Label subgraph**: \"Show cycles within 'api' work\"\n3. **Priority subset**: \"Critical path for P1 issues only\"\n\n## Acceptance Criteria\n- [ ] Subgraph contains only specified nodes\n- [ ] Edges between retained nodes preserved\n- [ ] Node IDs mapped correctly\n- [ ] Can run all algorithms on subgraph","status":"closed","priority":2,"type":"task","labels":["advanced","phase-3","wasm"],"created_at":"2025-12-15 23:36","updated_at":"2025-12-16 00:41","closed_at":"2025-12-16 00:41","blocked_by":["bv-bxoe"],"blocks":["bv-y7a0"],"pagerank":0.0018889407873369957,"betweenness":0,"eigenvector":0,"hub":0.000008837350028490512,"authority":0.000010677870334373396,"critical_path":4,"in_degree":1,"out_degree":1,"core_number":2,"slack":9,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-z38b","title":"Build time-travel animation through git history","description":"# Time-Travel Animation\n\n## Context\nAnimate the graph evolution through git history, showing issues appearing, changing, and closing over time.\n\n## Requirements\n\n### 1. Load Historical Data\nUse bv --robot-history to get commit-to-bead correlations:\n```javascript\nconst history = await fetchJSON('history.json');\n// { commits: [{sha, date, beads_added, beads_closed, ...}] }\n```\n\n### 2. Timeline Scrubber UI\n```html\n\u003cdiv class=\"timeline-controls\"\u003e\n    \u003cbutton id=\"play-btn\"\u003e‚ñ∂Ô∏è Play\u003c/button\u003e\n    \u003cinput type=\"range\" id=\"timeline\" min=\"0\" max=\"100\"\u003e\n    \u003cspan id=\"current-date\"\u003e\u003c/span\u003e\n    \u003cselect id=\"speed\"\u003e\n        \u003coption value=\"1\"\u003e1x\u003c/option\u003e\n        \u003coption value=\"2\"\u003e2x\u003c/option\u003e\n        \u003coption value=\"5\"\u003e5x\u003c/option\u003e\n    \u003c/select\u003e\n\u003c/div\u003e\n```\n\n### 3. Animation Engine\n```javascript\nclass TimeTravel {\n    constructor(history, graph) {\n        this.history = history;\n        this.graph = graph;\n        this.currentIdx = 0;\n    }\n    \n    goToCommit(idx) {\n        const commit = this.history.commits[idx];\n        \n        // Add new nodes with 'appear' animation\n        commit.beads_added.forEach(id =\u003e {\n            this.graph.graphData().nodes.push(\n                createNodeWithAnimation(id, 'appear')\n            );\n        });\n        \n        // Close nodes with 'shrink' animation\n        commit.beads_closed.forEach(id =\u003e {\n            animateNodeClose(id);\n        });\n        \n        this.graph.graphData(this.graph.graphData());\n    }\n    \n    play(speed = 1) {\n        this.playing = true;\n        const step = () =\u003e {\n            if (!this.playing) return;\n            this.currentIdx++;\n            if (this.currentIdx \u003e= this.history.commits.length) {\n                this.playing = false;\n                return;\n            }\n            this.goToCommit(this.currentIdx);\n            setTimeout(step, 1000 / speed);\n        };\n        step();\n    }\n}\n```\n\n### 4. Visual Feedback\n- New nodes: fade in, pulse\n- Closed nodes: shrink, fade out\n- Date display updates\n- Sprint boundaries marked\n\n## Acceptance Criteria\n- [ ] Scrubber moves through history\n- [ ] Nodes appear/disappear with animation\n- [ ] Play/pause/speed controls work\n- [ ] Current date displayed\n- [ ] Smooth performance","status":"closed","priority":3,"type":"task","labels":["advanced","phase-3","visualization"],"created_at":"2025-12-15 23:56","updated_at":"2025-12-16 17:08","closed_at":"2025-12-16 17:08","blocked_by":["bv-jndd","bv-gij1"],"pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":6.96884458500976e-7,"authority":0,"critical_path":1,"in_degree":0,"out_degree":2,"core_number":2,"slack":9,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-z5oa","title":"Unit test: graph_snapshot.go - Static graph export","description":"Unit tests for the static graph snapshot export.\n\n## File Overview\ngraph_snapshot.go exports graphs to various formats for external viewing.\n\n## Test Cases to Implement\n1. **JSON Export**\n   - Node list with all properties\n   - Edge list with source/target\n   - Metadata (hash, counts)\n   - Valid JSON output\n\n2. **DOT Export**\n   - GraphViz DOT format\n   - Node attributes\n   - Edge attributes\n   - Subgraphs for clusters\n   - Valid DOT syntax\n\n3. **Mermaid Export**\n   - Mermaid flowchart syntax\n   - Node styling by status\n   - Edge styling by type\n   - Class definitions\n   - Valid Mermaid output\n\n4. **Filtering**\n   - Filter by root node\n   - Filter by depth\n   - Filter by label\n   - Multiple filters combined\n\n5. **Determinism**\n   - Same input = same output\n   - Stable node ordering\n   - Stable edge ordering\n\n## Implementation Notes\n- Test each export format\n- Validate against format spec\n- Test with various graph sizes\n- Golden file tests for output","status":"closed","priority":1,"type":"task","labels":null,"created_at":"2025-12-16 20:10","updated_at":"2025-12-16 22:04","closed_at":"2025-12-16 22:04","blocks":["bv-evyl","bv-yc2v"],"pagerank":0.0023214579074840426,"betweenness":0,"eigenvector":0,"hub":0,"authority":8.741465485055938e-8,"critical_path":4,"in_degree":2,"out_degree":0,"core_number":2,"slack":11,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-z9ee","title":"Unit tests: pkg/export pipeline gaps","description":"Improve test coverage for pkg/export (currently 57.1%).\n\n**Areas to test:**\n- SQLite export schema generation\n- Graph snapshot export\n- SVG export functionality\n- Static pages export\n- Error handling and edge cases\n\n**Files to review:**\n- pkg/export/sqlite_schema.go\n- pkg/export/sqlite_export.go  \n- pkg/export/graph_snapshot.go\n\n**Coverage target:** 80%+","status":"closed","priority":3,"type":"task","labels":["export","testing"],"created_at":"2025-12-16 13:01","updated_at":"2025-12-16 14:38","closed_at":"2025-12-16 14:38","pagerank":0.0014764782329599153,"betweenness":0,"eigenvector":0,"hub":0,"authority":0,"critical_path":1,"in_degree":0,"out_degree":0,"core_number":0,"slack":14,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0},{"id":"bv-zaxb","title":"Support BEADS_DIR Environment Variable for Custom Directory Location","description":"## Feature Request\n\nAllow users to specify a custom beads directory location via the BEADS_DIR environment variable. When set, it overrides the default `.beads` directory lookup.\n\n## Use Cases\n\n1. **Monorepos**: Single beads directory shared across multiple packages\n2. **Non-standard layouts**: Projects where `.beads` isn't in the working directory\n3. **Testing**: Point to test fixtures without changing directory\n4. **Cross-directory access**: View beads from anywhere on the filesystem\n\n## User Request\n\nSuggested by @burke in GitHub PR #15:\n\u003e Allow users to specify a custom beads directory location via the BEADS_DIR environment variable. When set, it overrides the default .beads directory lookup. This enables more flexible project layouts and cross-directory beads file access.\n\n## Proposed Implementation\n\n### New function in loader.go\n\n```go\n// GetBeadsDir returns the beads directory path, respecting BEADS_DIR env var.\n// If BEADS_DIR is set, it is used directly.\n// Otherwise, falls back to .beads in the given repoPath (or cwd if empty).\nfunc GetBeadsDir(repoPath string) (string, error) {\n    // Check BEADS_DIR environment variable first\n    if envDir := os.Getenv(\"BEADS_DIR\"); envDir != \"\" {\n        return envDir, nil\n    }\n\n    // Fall back to .beads in repo path\n    if repoPath == \"\" {\n        var err error\n        repoPath, err = os.Getwd()\n        if err != nil {\n            return \"\", fmt.Errorf(\"failed to get cwd: %w\", err)\n        }\n    }\n\n    return filepath.Join(repoPath, \".beads\"), nil\n}\n```\n\n### Update LoadIssues to use GetBeadsDir\n\n```go\nfunc LoadIssues(repoPath string) ([]model.Issue, error) {\n    beadsDir, err := GetBeadsDir(repoPath)\n    if err != nil {\n        return nil, err\n    }\n    // ... rest of function\n}\n```\n\n### Update main.go for beadsPath\n\n```go\n// Get beads file path for live reload (respects BEADS_DIR)\nbeadsDir, _ := loader.GetBeadsDir(\"\")\nbeadsPath, _ = loader.FindJSONLPath(beadsDir)\n```\n\n## Design Considerations\n\n1. **Precedence**: BEADS_DIR should always win when set (explicit user intent)\n2. **Validation**: Should we validate the directory exists? Or let it fail naturally?\n3. **CLI flag alternative**: Could also add `--beads-dir` flag for one-off use\n4. **Documentation**: Add to README and help output\n\n## Priority Justification\n\nP3 (Low) because:\n- Not a bug, purely enhancement\n- Workarounds exist (cd to directory, symlinks)\n- Useful for power users but not essential\n- Should wait until data loading bugs (bv-mvvu) are fixed first\n\n## Dependencies\n\n**Blocked by:** bv-mvvu (Data Integrity: Merge Artifact Files)\n- Should implement after file selection logic is corrected\n- Both touch loader.go and file resolution\n\n## Test Plan\n\n1. Test: BEADS_DIR set - uses that directory\n2. Test: BEADS_DIR overrides repoPath parameter\n3. Test: BEADS_DIR unset - falls back to .beads in cwd\n4. Test: BEADS_DIR points to non-existent dir - appropriate error\n\n## Acceptance Criteria\n\n- [ ] BEADS_DIR environment variable respected\n- [ ] Overrides default .beads directory lookup\n- [ ] Error handling for invalid directories\n- [ ] Tests cover all scenarios\n- [ ] Documentation updated\n\n## References\n\n- GitHub PR #15: https://github.com/Dicklesworthstone/beads_viewer/pull/15\n- Related: bv-mvvu (should be fixed first)","status":"closed","priority":3,"type":"feature","labels":["enhancement","gh-pr-15"],"created_at":"2025-12-15 23:55","updated_at":"2025-12-16 14:35","closed_at":"2025-12-16 14:35","blocked_by":["bv-mvvu"],"blocks":["bv-uqoh"],"pagerank":0.0016019788987050227,"betweenness":0,"eigenvector":0,"hub":1.9060491153113305e-9,"authority":9.324854925833239e-9,"critical_path":2,"in_degree":1,"out_degree":1,"core_number":2,"slack":12,"is_articulation":false,"pagerank_rank":0,"betweenness_rank":0}],"triage":{"meta":{"version":"1.0.0","generated_at":"2025-12-17T13:04:12.46259-05:00","phase2_ready":true,"issue_count":344,"compute_time_ms":0},"quick_ref":{"open_count":0,"actionable_count":0,"blocked_count":0,"in_progress_count":0,"top_picks":[]},"recommendations":[],"quick_wins":[],"blockers_to_clear":[],"project_health":{"counts":{"total":344,"open":0,"closed":344,"blocked":0,"actionable":0,"by_status":{"closed":344},"by_type":{"bug":23,"chore":6,"epic":34,"feature":5,"task":276},"by_priority":{"0":3,"1":95,"2":198,"3":47,"4":1}},"graph":{"node_count":344,"edge_count":442,"density":0.003746016679096888,"has_cycles":false,"phase2_ready":true},"velocity":{"closed_last_7_days":320,"closed_last_30_days":344,"avg_days_to_close":1.1023137974110342,"weekly":[{"week_start":"2025-12-15T00:00:00Z","closed":320},{"week_start":"2025-12-08T00:00:00Z","closed":0},{"week_start":"2025-12-01T00:00:00Z","closed":0},{"week_start":"2025-11-24T00:00:00Z","closed":24},{"week_start":"2025-11-17T00:00:00Z","closed":0},{"week_start":"2025-11-10T00:00:00Z","closed":0},{"week_start":"2025-11-03T00:00:00Z","closed":0},{"week_start":"2025-10-27T00:00:00Z","closed":0}]}},"commands":{"claim_top":"bd ready  # No top pick available","show_top":"bd ready  # No top pick available","list_ready":"bd ready","list_blocked":"bd blocked","refresh_triage":"bv --robot-triage"}}};
const STATUS_COLORS = { open: '#22c55e', in_progress: '#f97316', blocked: '#ef4444', closed: '#555577' };
const PRIORITY_COLORS = ['#ef4444', '#f97316', '#eab308', '#22c55e', '#555577'];
const TYPE_COLORS = { feature: '#a855f7', bug: '#ef4444', task: '#22d3ee', epic: '#fbbf24' };

// Configure marked for safe HTML rendering
marked.setOptions({ breaks: true, gfm: true });

// Stats calculation
let actionable = 0, blocked = 0, onCriticalPath = 0, articulationCount = 0;
const blockerCount = {};
DATA.links.forEach(l => blockerCount[l.source] = (blockerCount[l.source] || 0) + 1);
DATA.nodes.forEach(n => {
    n.blockerCount = blockerCount[n.id] || 0;
    if ((n.status === 'open' || n.status === 'in_progress') && n.blockerCount === 0) actionable++;
    if (n.status === 'blocked') blocked++;
    if (n.slack === 0) onCriticalPath++;
    if (n.is_articulation) articulationCount++;
});
document.getElementById('stat-actionable').textContent = actionable;
document.getElementById('stat-blocked').textContent = blocked;
document.getElementById('stat-critical').textContent = onCriticalPath;
document.getElementById('stat-articulation').textContent = articulationCount;

// Max values for sizing
const maxPR = Math.max(...DATA.nodes.map(n => n.pagerank || 0), 0.001);
const maxBW = Math.max(...DATA.nodes.map(n => n.betweenness || 0), 0.001);
const maxCP = Math.max(...DATA.nodes.map(n => n.critical_path || 0), 1);
const maxInDeg = Math.max(...DATA.nodes.map(n => n.in_degree || 0), 1);

let sizeMetric = 'pagerank', heatmapMode = false, hoveredNode = null, highlightedNodes = new Set();

function getNodeSize(n) {
    const base = 5, scale = 16;
    switch(sizeMetric) {
        case 'pagerank': return base + ((n.pagerank || 0) / maxPR) * scale;
        case 'betweenness': return base + ((n.betweenness || 0) / maxBW) * scale;
        case 'critical': return base + ((n.critical_path || 0) / maxCP) * scale;
        case 'indegree': return base + ((n.in_degree || 0) / maxInDeg) * scale;
        default: return base + ((n.pagerank || 0) / maxPR) * scale;
    }
}

function getHeatmapColor(n) {
    let val = 0, max = 1;
    switch(sizeMetric) {
        case 'pagerank': val = n.pagerank || 0; max = maxPR; break;
        case 'betweenness': val = n.betweenness || 0; max = maxBW; break;
        case 'critical': val = n.critical_path || 0; max = maxCP; break;
        case 'indegree': val = n.in_degree || 0; max = maxInDeg; break;
    }
    const ratio = val / max;
    const hue = 120 - ratio * 120; // Green to red
    return 'hsl(' + hue + ', 80%, 50%)';
}

// Get connected subgraph (for golden glow highlight)
function getConnectedNodes(nodeId, depth = 2) {
    const connected = new Set([nodeId]);
    const queue = [{id: nodeId, d: 0}];
    while (queue.length > 0) {
        const {id, d} = queue.shift();
        if (d >= depth) continue;
        DATA.links.forEach(l => {
            const src = typeof l.source === 'object' ? l.source.id : l.source;
            const tgt = typeof l.target === 'object' ? l.target.id : l.target;
            if (src === id && !connected.has(tgt)) { connected.add(tgt); queue.push({id: tgt, d: d+1}); }
            if (tgt === id && !connected.has(src)) { connected.add(src); queue.push({id: src, d: d+1}); }
        });
    }
    return connected;
}

const container = document.getElementById('graph-container');
const Graph = ForceGraph()(container)
    .graphData(JSON.parse(JSON.stringify(DATA)))
    .backgroundColor('transparent')
    .nodeId('id')
    .nodeLabel(null)
    .nodeColor(n => {
        if (highlightedNodes.size > 0 && !highlightedNodes.has(n.id)) return (STATUS_COLORS[n.status] || '#555577') + '20';
        if (heatmapMode) return getHeatmapColor(n);
        return STATUS_COLORS[n.status] || '#555577';
    })
    .nodeVal(n => getNodeSize(n))
    .linkColor(l => {
        const src = typeof l.source === 'object' ? l.source.id : l.source;
        const tgt = typeof l.target === 'object' ? l.target.id : l.target;
        if (highlightedNodes.size > 0) {
            if (highlightedNodes.has(src) && highlightedNodes.has(tgt)) return '#fbbf24aa';
            return '#44475a15';
        }
        return l.critical ? '#ec489980' : '#44475a40';
    })
    .linkWidth(l => {
        const src = typeof l.source === 'object' ? l.source.id : l.source;
        const tgt = typeof l.target === 'object' ? l.target.id : l.target;
        if (highlightedNodes.size > 0 && highlightedNodes.has(src) && highlightedNodes.has(tgt)) return 3;
        return l.critical ? 2 : 1;
    })
    .linkDirectionalArrowLength(5)
    .linkDirectionalArrowColor(l => {
        const src = typeof l.source === 'object' ? l.source.id : l.source;
        const tgt = typeof l.target === 'object' ? l.target.id : l.target;
        if (highlightedNodes.size > 0 && highlightedNodes.has(src) && highlightedNodes.has(tgt)) return '#fbbf24';
        return l.critical ? '#ec4899' : '#44475a';
    })
    .linkDirectionalArrowRelPos(1)
    .linkCurvature(0.1)
    .linkDirectionalParticles(l => l.critical ? 2 : 0)
    .linkDirectionalParticleSpeed(0.003)
    .linkDirectionalParticleWidth(2)
    .linkDirectionalParticleColor(() => '#ec4899')
    .d3AlphaDecay(0.02)
    .d3VelocityDecay(0.25)
    .nodeCanvasObject((node, ctx, globalScale) => {
        const x = node.x, y = node.y;
        if (x === undefined || y === undefined || !isFinite(x) || !isFinite(y)) return;
        const size = getNodeSize(node);
        const baseColor = heatmapMode ? getHeatmapColor(node) : STATUS_COLORS[node.status] || '#555577';
        const isHighlighted = highlightedNodes.size === 0 || highlightedNodes.has(node.id);
        const isHovered = hoveredNode && hoveredNode.id === node.id;
        const alpha = isHighlighted ? 1 : 0.15;

        // Golden glow for hovered node's connected subgraph
        if (isHovered || (highlightedNodes.has(node.id) && highlightedNodes.size > 0)) {
            ctx.beginPath(); ctx.arc(x, y, size + 8, 0, 2 * Math.PI);
            const g = ctx.createRadialGradient(x, y, size, x, y, size + 12);
            g.addColorStop(0, 'rgba(251, 191, 36, 0.6)'); g.addColorStop(1, 'transparent');
            ctx.fillStyle = g; ctx.fill();
        }

        // Articulation point glow
        if (node.is_articulation && isHighlighted) {
            ctx.beginPath(); ctx.arc(x, y, size + 6, 0, 2 * Math.PI);
            const g = ctx.createRadialGradient(x, y, size, x, y, size + 8);
            g.addColorStop(0, '#ec489960'); g.addColorStop(1, 'transparent');
            ctx.fillStyle = g; ctx.fill();
        }

        // Critical path indicator
        if (node.slack === 0 && isHighlighted) {
            ctx.beginPath(); ctx.arc(x, y, size + 3, 0, 2 * Math.PI);
            ctx.fillStyle = baseColor + '30'; ctx.fill();
        }

        // Priority ring
        const pColor = PRIORITY_COLORS[node.priority] || PRIORITY_COLORS[2];
        ctx.globalAlpha = alpha;
        ctx.beginPath(); ctx.arc(x, y, size + 1.5, 0, 2 * Math.PI);
        ctx.strokeStyle = pColor; ctx.lineWidth = 2; ctx.stroke();

        // Node shape based on type
        ctx.fillStyle = baseColor;
        ctx.beginPath();
        switch(node.type) {
            case 'bug': // Triangle
                ctx.moveTo(x, y - size);
                ctx.lineTo(x + size * 0.866, y + size * 0.5);
                ctx.lineTo(x - size * 0.866, y + size * 0.5);
                ctx.closePath();
                break;
            case 'task': // Square
                ctx.rect(x - size * 0.7, y - size * 0.7, size * 1.4, size * 1.4);
                break;
            case 'epic': // Diamond
                ctx.moveTo(x, y - size);
                ctx.lineTo(x + size, y);
                ctx.lineTo(x, y + size);
                ctx.lineTo(x - size, y);
                ctx.closePath();
                break;
            default: // Circle (feature)
                ctx.arc(x, y, size, 0, 2 * Math.PI);
        }
        ctx.fill();

        // Highlight effect
        const hl = ctx.createRadialGradient(x - size/3, y - size/3, 0, x, y, size);
        hl.addColorStop(0, 'rgba(255,255,255,0.2)'); hl.addColorStop(1, 'transparent');
        ctx.fillStyle = hl; ctx.fill();
        ctx.globalAlpha = 1;

        // Labels at zoom
        if (globalScale > 1.2 && isHighlighted) {
            const fontSize = Math.max(10 / globalScale, 3);
            ctx.font = fontSize + 'px Inter, sans-serif';
            ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
            ctx.fillStyle = '#e8e8f0';
            ctx.fillText(node.id, x, y + size + fontSize + 2);
            if (globalScale > 2) {
                ctx.fillStyle = pColor;
                ctx.font = (fontSize * 0.8) + 'px JetBrains Mono, monospace';
                ctx.fillText('P' + node.priority, x, y);
            }
        }
    })
    .nodePointerAreaPaint((n, c, ctx) => {
        if (n.x === undefined || n.y === undefined || !isFinite(n.x) || !isFinite(n.y)) return;
        const size = getNodeSize(n) + 4;
        ctx.fillStyle = c; ctx.beginPath(); ctx.arc(n.x, n.y, size, 0, 2 * Math.PI); ctx.fill();
    })
    .onNodeClick(handleNodeClick)
    .onNodeRightClick((node, event) => { event.preventDefault(); showContextMenu(node, event); })
    .onNodeHover(handleNodeHover)
    .onBackgroundClick(() => { clearSelection(); hideContextMenu(); hideHoverPanel(); })
    .onBackgroundRightClick(() => hideContextMenu());

// Hover handling with golden glow and detail panel
function handleNodeHover(node) {
    hoveredNode = node;
    container.style.cursor = node ? 'pointer' : 'grab';
    if (node) {
        highlightedNodes = getConnectedNodes(node.id, 2);
        showHoverPanel(node);
    } else {
        highlightedNodes = new Set();
        hideHoverPanel();
    }
    Graph.nodeColor(Graph.nodeColor()); // Trigger re-render
    Graph.linkColor(Graph.linkColor());
    Graph.linkWidth(Graph.linkWidth());
}

// Panel mode: 'docked' (left sidebar) or 'floating' (center overlay)
let panelMode = 'docked';

// Populate panel content for a given prefix (hover- or docked-)
function populatePanelContent(prefix, node) {
    document.getElementById(prefix + 'id').textContent = node.id;
    document.getElementById(prefix + 'title').textContent = node.title;

    // Type badge
    const typeBadge = document.getElementById(prefix + 'type-badge');
    typeBadge.textContent = node.type || 'task';
    typeBadge.className = 'hover-type-badge badge-' + (node.type || 'task');

    // Badges
    const badgesEl = document.getElementById(prefix + 'badges');
    badgesEl.innerHTML = '';
    const addBadge = (cls, text) => { const b = document.createElement('span'); b.className = 'badge ' + cls; b.textContent = text; badgesEl.appendChild(b); };
    addBadge('badge-' + node.status, node.status.replace('_', ' '));
    addBadge('', 'P' + node.priority);
    if (node.is_articulation) addBadge('badge-articulation', 'Cut Vertex');
    if (node.slack === 0) addBadge('badge-critical', 'Critical Path');
    (node.labels || []).forEach(l => addBadge('badge-type', l));

    // Description
    const descSection = document.getElementById(prefix + 'description');
    if (node.description) {
        descSection.style.display = 'block';
        document.getElementById(prefix + 'description-content').innerHTML = marked.parse(node.description);
    } else { descSection.style.display = 'none'; }

    // Design
    const designSection = document.getElementById(prefix + 'design');
    if (node.design) {
        designSection.style.display = 'block';
        document.getElementById(prefix + 'design-content').innerHTML = marked.parse(node.design);
    } else { designSection.style.display = 'none'; }

    // Acceptance Criteria
    const acSection = document.getElementById(prefix + 'acceptance');
    if (node.acceptance_criteria) {
        acSection.style.display = 'block';
        document.getElementById(prefix + 'acceptance-content').innerHTML = marked.parse(node.acceptance_criteria);
    } else { acSection.style.display = 'none'; }

    // Notes
    const notesSection = document.getElementById(prefix + 'notes');
    if (node.notes) {
        notesSection.style.display = 'block';
        document.getElementById(prefix + 'notes-content').innerHTML = marked.parse(node.notes);
    } else { notesSection.style.display = 'none'; }

    // Metadata
    const metaEl = document.getElementById(prefix + 'meta');
    metaEl.innerHTML = '';
    const addMeta = (label, value) => {
        if (!value) return;
        metaEl.innerHTML += '<div class="hover-meta-item"><span class="hover-meta-label">' + label + '</span><span class="hover-meta-value">' + value + '</span></div>';
    };
    addMeta('Assignee', node.assignee);
    addMeta('Created', node.created_at);
    addMeta('Updated', node.updated_at);
    addMeta('Due Date', node.due_date);
    if (node.closed_at) addMeta('Closed', node.closed_at);

    // Blocked By
    const blockedBySection = document.getElementById(prefix + 'blocked-by');
    const blockedByList = document.getElementById(prefix + 'blocked-by-list');
    if (node.blocked_by && node.blocked_by.length > 0) {
        blockedBySection.style.display = 'block';
        blockedByList.innerHTML = node.blocked_by.map(id => '<span class="hover-dep-chip" data-id="' + id + '">' + id + '</span>').join('');
    } else { blockedBySection.style.display = 'none'; }

    // Blocks
    const blocksSection = document.getElementById(prefix + 'blocks');
    const blocksList = document.getElementById(prefix + 'blocks-list');
    if (node.blocks && node.blocks.length > 0) {
        blocksSection.style.display = 'block';
        blocksList.innerHTML = node.blocks.map(id => '<span class="hover-dep-chip" data-id="' + id + '">' + id + '</span>').join('');
    } else { blocksSection.style.display = 'none'; }

    // Commits
    const commitsSection = document.getElementById(prefix + 'commits');
    const commitsList = document.getElementById(prefix + 'commits-list');
    if (node.commits && node.commits.length > 0) {
        commitsSection.style.display = 'block';
        commitsList.innerHTML = node.commits.slice(0, 5).map(c => '<div class="hover-commit"><span class="hover-commit-sha">' + c.short_sha + '</span> <span class="hover-commit-msg">' + (c.message || '').split('\\n')[0].substring(0, 60) + '</span></div>').join('');
    } else { commitsSection.style.display = 'none'; }

    // Metrics
    const metricsEl = document.getElementById(prefix + 'metrics');
    metricsEl.innerHTML = '';
    const addMetric = (label, value) => {
        metricsEl.innerHTML += '<div class="hover-meta-item"><span class="hover-meta-label">' + label + '</span><span class="hover-meta-value">' + value + '</span></div>';
    };
    const fmt = (v, d) => (v != null && isFinite(v)) ? v.toFixed(d) : '-';
    addMetric('PageRank', fmt(node.pagerank * 100, 3) + '%');
    addMetric('PR Rank', '#' + (node.pagerank_rank || '-'));
    addMetric('Betweenness', fmt(node.betweenness, 4));
    addMetric('BW Rank', '#' + (node.betweenness_rank || '-'));
    addMetric('Critical Path', fmt(node.critical_path, 1));
    addMetric('Slack', fmt(node.slack, 1));
    addMetric('In-Degree', node.in_degree ?? '-');
    addMetric('Out-Degree', node.out_degree ?? '-');
}

// Wire up dep chip clicks for a container
function wireDepChips(container) {
    container.querySelectorAll('.hover-dep-chip').forEach(chip => {
        chip.onclick = () => {
            const targetId = chip.dataset.id;
            const graphNodes = Graph.graphData().nodes;
            const target = graphNodes.find(n => n.id === targetId);
            if (target) {
                Graph.centerAt(target.x, target.y, 500);
                Graph.zoom(2.5, 500);
                setTimeout(() => showHoverPanel(target), 600);
            }
        };
    });
}

// Show full details panel (docked or floating based on mode)
function showHoverPanel(node) {
    if (panelMode === 'docked') {
        // Update docked panel
        populatePanelContent('docked-', node);
        document.getElementById('docked-panel').classList.add('visible');
        document.getElementById('docked-no-selection').style.display = 'none';
        wireDepChips(document.getElementById('docked-panel'));
    } else {
        // Update floating panel
        populatePanelContent('hover-', node);
        document.getElementById('hover-panel').classList.add('visible');
        wireDepChips(document.getElementById('hover-panel'));
    }
}

function hideHoverPanel() {
    if (panelMode === 'docked') {
        document.getElementById('docked-panel').classList.remove('visible');
        document.getElementById('docked-no-selection').style.display = 'flex';
    } else {
        document.getElementById('hover-panel').classList.remove('visible');
    }
}

// Toggle between docked and floating modes
function togglePanelMode() {
    const detachBtn = document.getElementById('btn-detach');
    const sidebar = document.getElementById('detail-sidebar');

    if (panelMode === 'docked') {
        panelMode = 'floating';
        sidebar.classList.add('collapsed');
        detachBtn.innerHTML = '<span>‚á≤</span> Dock';
        detachBtn.title = 'Dock panel to left side (D)';
        // Show floating panel if we have a hovered node
        if (hoveredNode) {
            populatePanelContent('hover-', hoveredNode);
            document.getElementById('hover-panel').classList.add('visible');
            wireDepChips(document.getElementById('hover-panel'));
        }
    } else {
        panelMode = 'docked';
        sidebar.classList.remove('collapsed');
        detachBtn.innerHTML = '<span>‚á±</span> Detach';
        detachBtn.title = 'Detach panel to float (D)';
        document.getElementById('hover-panel').classList.remove('visible');
        // Show docked panel if we have a hovered node
        if (hoveredNode) {
            populatePanelContent('docked-', hoveredNode);
            document.getElementById('docked-panel').classList.add('visible');
            document.getElementById('docked-no-selection').style.display = 'none';
            wireDepChips(document.getElementById('docked-panel'));
        }
    }
}

document.getElementById('btn-detach').onclick = togglePanelMode;
document.getElementById('hover-close').onclick = () => document.getElementById('hover-panel').classList.remove('visible');

let selectedNode = null;
function selectNode(node) {
    selectedNode = node;
    showHoverPanel(node);
    document.getElementById('detail-id').textContent = node.id;
    document.getElementById('detail-name').textContent = node.title;
    const prioEl = document.getElementById('detail-priority');
    prioEl.textContent = 'P' + node.priority;
    prioEl.style.background = PRIORITY_COLORS[node.priority];
    prioEl.style.color = node.priority <= 1 ? 'white' : '#0f0f1a';
    const badgesEl = document.getElementById('detail-badges');
    badgesEl.innerHTML = '';
    const sb = document.createElement('span'); sb.className = 'badge badge-' + node.status; sb.textContent = node.status.replace('_', ' '); badgesEl.appendChild(sb);
    const tb = document.createElement('span'); tb.className = 'badge badge-' + (node.type || 'task'); tb.textContent = node.type || 'task'; badgesEl.appendChild(tb);
    const fmtSide = (v, d) => (v != null && isFinite(v)) ? v.toFixed(d) : '-';
    document.getElementById('m-pagerank').textContent = fmtSide(node.pagerank * 100, 2) + '%';
    document.getElementById('m-prrank').textContent = '#' + (node.pagerank_rank || '-');
    document.getElementById('m-between').textContent = fmtSide(node.betweenness, 4);
    document.getElementById('m-bwrank').textContent = '#' + (node.betweenness_rank || '-');
    document.getElementById('m-critical').textContent = fmtSide(node.critical_path, 1);
    const slackEl = document.getElementById('m-slack');
    slackEl.textContent = fmtSide(node.slack, 1);
    slackEl.className = 'metric-value' + (node.slack === 0 ? ' highlight' : '');
    document.getElementById('m-indeg').textContent = node.in_degree ?? '-';
    document.getElementById('m-outdeg').textContent = node.out_degree ?? '-';
    document.getElementById('node-detail').classList.add('visible');
    document.getElementById('no-selection').style.display = 'none';
}

function clearSelection() {
    selectedNode = null;
    highlightedNodes = new Set();
    document.getElementById('node-detail').classList.remove('visible');
    document.getElementById('no-selection').style.display = 'block';
    Graph.nodeColor(Graph.nodeColor());
    Graph.linkColor(Graph.linkColor());
}

// Full-text search
let searchDebounce = null;
document.getElementById('search-input').oninput = e => {
    clearTimeout(searchDebounce);
    searchDebounce = setTimeout(() => performSearch(e.target.value), 150);
};

function performSearch(query) {
    const resultsEl = document.getElementById('search-results');
    if (!query || query.length < 2) {
        resultsEl.classList.remove('visible');
        applyFilters();
        return;
    }
    const q = query.toLowerCase();
    const matches = DATA.nodes.filter(n => {
        return n.id.toLowerCase().includes(q) ||
               n.title.toLowerCase().includes(q) ||
               (n.description || '').toLowerCase().includes(q) ||
               (n.design || '').toLowerCase().includes(q) ||
               (n.notes || '').toLowerCase().includes(q) ||
               (n.acceptance_criteria || '').toLowerCase().includes(q) ||
               (n.labels || []).some(l => l.toLowerCase().includes(q)) ||
               (n.assignee || '').toLowerCase().includes(q);
    }).slice(0, 8);

    if (matches.length === 0) {
        resultsEl.innerHTML = '<div class="search-result-item">No results found</div>';
    } else {
        resultsEl.innerHTML = matches.map(n => {
            let preview = '';
            const fields = [n.description, n.design, n.notes, n.acceptance_criteria];
            for (const f of fields) {
                if (f && f.toLowerCase().includes(q)) {
                    const idx = f.toLowerCase().indexOf(q);
                    const start = Math.max(0, idx - 30);
                    const end = Math.min(f.length, idx + q.length + 50);
                    preview = '...' + f.substring(start, end).replace(new RegExp(q, 'gi'), '<mark>$&</mark>') + '...';
                    break;
                }
            }
            return '<div class="search-result-item" data-id="' + n.id + '">' +
                   '<div class="search-result-id">' + n.id + ' <span class="badge badge-' + n.status + '">' + n.status + '</span></div>' +
                   '<div class="search-result-title">' + n.title + '</div>' +
                   (preview ? '<div class="search-result-preview">' + preview + '</div>' : '') +
                   '</div>';
        }).join('');
    }
    resultsEl.classList.add('visible');

    resultsEl.querySelectorAll('.search-result-item[data-id]').forEach(item => {
        item.onclick = () => {
            const id = item.dataset.id;
            const graphNodes = Graph.graphData().nodes;
            const node = graphNodes.find(n => n.id === id);
            if (node) {
                selectNode(node);
                Graph.centerAt(node.x, node.y, 500);
                Graph.zoom(2.5, 500);
            }
            resultsEl.classList.remove('visible');
            document.getElementById('search-input').value = '';
        };
    });
}

// Close search on click outside
document.addEventListener('click', e => {
    if (!e.target.closest('.search-container')) {
        document.getElementById('search-results').classList.remove('visible');
    }
});

// Context menu
let contextNode = null;
function showContextMenu(node, event) {
    contextNode = node;
    const menu = document.getElementById('context-menu');
    menu.style.left = event.clientX + 'px';
    menu.style.top = event.clientY + 'px';
    menu.classList.add('visible');
}
function hideContextMenu() { document.getElementById('context-menu').classList.remove('visible'); contextNode = null; }
document.getElementById('ctx-focus').onclick = () => { if (contextNode) { Graph.centerAt(contextNode.x, contextNode.y, 500); Graph.zoom(3, 500); } hideContextMenu(); };
document.getElementById('ctx-details').onclick = () => { if (contextNode) showHoverPanel(contextNode); hideContextMenu(); };
document.getElementById('ctx-deps').onclick = () => { if (contextNode) highlightDependencies(contextNode, 'deps'); hideContextMenu(); };
document.getElementById('ctx-dependents').onclick = () => { if (contextNode) highlightDependencies(contextNode, 'dependents'); hideContextMenu(); };
document.getElementById('ctx-connected').onclick = () => {
    if (contextNode) {
        highlightedNodes = getConnectedNodes(contextNode.id, 3);
        Graph.nodeColor(Graph.nodeColor());
        Graph.linkColor(Graph.linkColor());
        showToast(highlightedNodes.size + ' connected nodes highlighted');
    }
    hideContextMenu();
};
document.getElementById('ctx-copy').onclick = () => { if (contextNode) { navigator.clipboard.writeText(contextNode.id); showToast('Copied: ' + contextNode.id); } hideContextMenu(); };
document.getElementById('ctx-path').onclick = () => { showToast('Click another node to find path'); pathStartNode = contextNode; hideContextMenu(); };

let pathStartNode = null;
function findPath(startId, endId) {
    const queue = [[startId]];
    const visited = new Set([startId]);
    while (queue.length > 0) {
        const path = queue.shift();
        const current = path[path.length - 1];
        if (current === endId) return path;
        DATA.links.forEach(l => {
            const src = typeof l.source === 'object' ? l.source.id : l.source;
            const tgt = typeof l.target === 'object' ? l.target.id : l.target;
            if (src === current && !visited.has(tgt)) { visited.add(tgt); queue.push([...path, tgt]); }
            if (tgt === current && !visited.has(src)) { visited.add(src); queue.push([...path, src]); }
        });
    }
    return null;
}

function highlightPath(path) {
    highlightedNodes = new Set(path);
    Graph.nodeColor(Graph.nodeColor());
    Graph.linkColor(Graph.linkColor());
    updateVisibleCount();
    showToast('Path: ' + path.length + ' nodes');
}

function handleNodeClick(node) {
    if (pathStartNode) {
        const path = findPath(pathStartNode.id, node.id);
        if (path) highlightPath(path);
        else showToast('No path found');
        pathStartNode = null;
    } else {
        selectNode(node);
    }
}

function highlightDependencies(node, type) {
    const connected = new Set([node.id]);
    DATA.links.forEach(l => {
        const src = typeof l.source === 'object' ? l.source.id : l.source;
        const tgt = typeof l.target === 'object' ? l.target.id : l.target;
        if (type === 'deps' && src === node.id) connected.add(tgt);
        if (type === 'dependents' && tgt === node.id) connected.add(src);
    });
    highlightedNodes = connected;
    Graph.nodeColor(Graph.nodeColor());
    Graph.linkColor(Graph.linkColor());
    updateVisibleCount();
    showToast(connected.size + ' nodes shown');
}

// Filters
let statusFilter = '', typeFilter = '';
let currentVisibilityFilter = () => true;
document.getElementById('filter-status').onchange = e => { statusFilter = e.target.value; applyFilters(); };
document.getElementById('filter-type').onchange = e => { typeFilter = e.target.value; applyFilters(); };

function applyFilters() {
    const searchVal = document.getElementById('search-input').value.toLowerCase();
    currentVisibilityFilter = n => {
        const matchSearch = !searchVal || n.id.toLowerCase().includes(searchVal) || n.title.toLowerCase().includes(searchVal);
        const matchStatus = !statusFilter || n.status === statusFilter;
        const matchType = !typeFilter || n.type === typeFilter;
        return matchSearch && matchStatus && matchType;
    };
    Graph.nodeVisibility(currentVisibilityFilter);
    updateVisibleCount();
}

function updateVisibleCount() {
    const count = DATA.nodes.filter(n => currentVisibilityFilter(n)).length;
    document.getElementById('stat-visible').innerHTML = '<span class="stat-value">' + count + '</span> visible';
}

// View mode
document.getElementById('view-mode').onchange = e => {
    const mode = e.target.value;
    Graph.dagMode(mode === 'force' ? null : mode);
    setTimeout(() => Graph.zoomToFit(400), 100);
};

// Size metric
document.getElementById('size-by').onchange = e => {
    sizeMetric = e.target.value;
    document.getElementById('heatmap-metric').textContent = { pagerank: 'PageRank', betweenness: 'Betweenness', critical: 'Critical Path', indegree: 'In-Degree' }[sizeMetric];
    Graph.nodeVal(n => getNodeSize(n));
    if (heatmapMode) Graph.nodeColor(n => getHeatmapColor(n));
};

// Controls
document.getElementById('btn-fit').onclick = () => Graph.zoomToFit(400, 50);
document.getElementById('btn-reset').onclick = () => {
    document.getElementById('filter-status').value = '';
    document.getElementById('filter-type').value = '';
    document.getElementById('search-input').value = '';
    document.getElementById('view-mode').value = 'force';
    document.getElementById('size-by').value = 'pagerank';
    statusFilter = ''; typeFilter = ''; sizeMetric = 'pagerank'; heatmapMode = false;
    highlightedNodes = new Set();
    Graph.dagMode(null); Graph.nodeVisibility(() => true); Graph.nodeVal(n => getNodeSize(n));
    Graph.nodeColor(n => STATUS_COLORS[n.status] || '#555577');
    Graph.linkColor(l => l.critical ? '#ec489980' : '#44475a40');
    clearSelection(); hideHoverPanel(); Graph.zoomToFit(400, 50); updateVisibleCount();
    document.getElementById('heatmap-legend').classList.remove('heatmap-active');
    document.getElementById('top-nodes-panel').classList.remove('visible');
    document.getElementById('triage-panel').style.display = 'none';
    document.getElementById('btn-heatmap').classList.remove('active');
    document.getElementById('btn-triage').classList.remove('active');
    document.getElementById('btn-top').classList.remove('active');
};

// Heatmap toggle - legend always visible, toggle controls coloring mode
document.getElementById('btn-heatmap').onclick = () => {
    heatmapMode = !heatmapMode;
    document.getElementById('btn-heatmap').classList.toggle('active', heatmapMode);
    document.getElementById('heatmap-legend').classList.toggle('heatmap-active', heatmapMode);
    Graph.nodeColor(n => heatmapMode ? getHeatmapColor(n) : STATUS_COLORS[n.status] || '#555577');
};

// Triage panel
document.getElementById('btn-triage').onclick = () => {
    const panel = document.getElementById('triage-panel');
    const btn = document.getElementById('btn-triage');
    const visible = panel.style.display === 'none';
    panel.style.display = visible ? 'block' : 'none';
    btn.classList.toggle('active', visible);
    if (visible && DATA.triage && DATA.triage.recommendations) {
        const list = document.getElementById('triage-list');
        list.innerHTML = DATA.triage.recommendations.slice(0, 5).map(r => {
            const score = (r.score != null && isFinite(r.score)) ? r.score.toFixed(2) : '-';
            const reason = (r.reasons && r.reasons.length > 0) ? r.reasons[0] : '';
            return '<div class="triage-item" data-id="' + (r.id || '') + '">' +
                '<div class="triage-item-header"><span class="triage-item-id">' + (r.id || '-') + '</span><span class="triage-item-score">' + score + '</span></div>' +
                '<div class="triage-item-title">' + (r.title || '') + '</div>' +
                '<div class="triage-item-reason">' + reason + '</div></div>';
        }).join('');
        list.querySelectorAll('.triage-item').forEach(item => {
            item.onclick = () => {
                const graphNodes = Graph.graphData().nodes;
                const node = graphNodes.find(n => n.id === item.dataset.id);
                if (node) { selectNode(node); Graph.centerAt(node.x, node.y, 500); Graph.zoom(2.5, 500); }
            };
        });
    }
};

// Top nodes panel
document.getElementById('btn-top').onclick = () => {
    const panel = document.getElementById('top-nodes-panel');
    const visible = panel.classList.toggle('visible');
    document.getElementById('btn-top').classList.toggle('active', visible);
    if (visible) {
        const sorted = [...DATA.nodes].sort((a, b) => (b.pagerank || 0) - (a.pagerank || 0)).slice(0, 10);
        panel.innerHTML = sorted.map((n, i) => '<div class="top-node-item" data-id="' + n.id + '"><span class="rank">#' + (i+1) + '</span><span>' + n.id + '</span></div>').join('');
        panel.querySelectorAll('.top-node-item').forEach(el => {
            el.onclick = () => {
                const graphNodes = Graph.graphData().nodes;
                const node = graphNodes.find(n => n.id === el.dataset.id);
                if (node) { selectNode(node); Graph.centerAt(node.x, node.y, 500); Graph.zoom(2.5, 500); }
            };
        });
    }
};

// Fullscreen
document.getElementById('btn-fullscreen').onclick = () => {
    if (!document.fullscreenElement) container.requestFullscreen();
    else document.exitFullscreen();
};

// Toast
function showToast(msg) {
    const toast = document.getElementById('toast');
    toast.textContent = msg; toast.classList.add('visible');
    setTimeout(() => toast.classList.remove('visible'), 2500);
}

// Light/Dark mode toggle
let isDarkMode = true;
function toggleLightMode() {
    isDarkMode = !isDarkMode;
    document.body.classList.toggle('light-mode', !isDarkMode);
    const btn = document.getElementById('btn-theme');
    btn.textContent = isDarkMode ? '‚òÄÔ∏è' : 'üåô';
    btn.title = isDarkMode ? 'Switch to light mode (L)' : 'Switch to dark mode (L)';
}

// Keyboard shortcuts
document.onkeydown = e => {
    if (e.target.tagName === 'INPUT') return;
    switch(e.key.toLowerCase()) {
        case 'f': Graph.zoomToFit(400, 50); break;
        case 'r': document.getElementById('btn-reset').click(); break;
        case 'escape': clearSelection(); hideHoverPanel(); highlightedNodes = new Set(); Graph.nodeColor(Graph.nodeColor()); break;
        case ' ': e.preventDefault(); document.getElementById('btn-fullscreen').click(); break;
        case 'h': document.getElementById('btn-heatmap').click(); break;
        case 't': document.getElementById('btn-top').click(); break;
        case 'g': document.getElementById('btn-triage').click(); break;
        case 'd': togglePanelMode(); break;
        case 'l': toggleLightMode(); break;
        case '1': document.getElementById('view-mode').value = 'force'; Graph.dagMode(null); break;
        case '2': document.getElementById('view-mode').value = 'td'; Graph.dagMode('td'); break;
        case '3': document.getElementById('view-mode').value = 'lr'; Graph.dagMode('lr'); break;
        case '4': document.getElementById('view-mode').value = 'radialout'; Graph.dagMode('radialout'); break;
    }
};

// Wire up theme button
document.getElementById('btn-theme').onclick = toggleLightMode;

// Initial fit
setTimeout(() => { Graph.zoomToFit(400, 50); updateVisibleCount(); }, 800);
    </script>
</body>
</html>